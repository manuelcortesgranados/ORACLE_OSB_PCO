<?xml version="1.0" encoding="UTF-8"?>
<xml-fragment xmlns:ser="http://www.bea.com/wli/sb/services" xmlns:tran="http://www.bea.com/wli/sb/transports" xmlns:env="http://www.bea.com/wli/config/env" xmlns:http="http://www.bea.com/wli/sb/transports/http" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:con="http://www.bea.com/wli/sb/pipeline/config" xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config" xmlns:con2="http://www.bea.com/wli/sb/stages/config">
  <ser:coreEntry isProxy="true" isEnabled="true" isAutoPublish="false" isTracingEnabled="false">
    <ser:binding type="SOAP" isSoap12="false" xsi:type="con:SoapBindingType" xmlns:con="http://www.bea.com/wli/sb/services/bindings/config">
      <con:wsdl ref="ITEL/Core/Resources/WSDLs/servicioProvision_PS"/>
      <con:port>
        <con:name>servicioProvision_PSSOAP</con:name>
        <con:namespace>http://www.comcel.com.co/servicioProvision_PS/</con:namespace>
      </con:port>
      <con:selector type="SOAP body"/>
    </ser:binding>
    <ser:monitoring isEnabled="false">
      <ser:aggregationInterval>10</ser:aggregationInterval>
      <ser:pipelineMonitoringLevel>Pipeline</ser:pipelineMonitoringLevel>
    </ser:monitoring>
    <ser:reporting>true</ser:reporting>
    <ser:logging isEnabled="true">
      <ser:logLevel>debug</ser:logLevel>
    </ser:logging>
    <ser:sla-alerting isEnabled="true">
      <ser:alertLevel>normal</ser:alertLevel>
    </ser:sla-alerting>
    <ser:pipeline-alerting isEnabled="true">
      <ser:alertLevel>normal</ser:alertLevel>
    </ser:pipeline-alerting>
    <ser:ws-policy>
      <ser:binding-mode>wsdl-policy-attachments</ser:binding-mode>
    </ser:ws-policy>
  </ser:coreEntry>
  <ser:endpointConfig>
    <tran:provider-id>local</tran:provider-id>
    <tran:inbound>true</tran:inbound>
    <tran:inbound-properties/>
    <tran:all-headers>true</tran:all-headers>
  </ser:endpointConfig>
  <ser:router>
    <con:pipeline type="error" name="_onErrorHandler-6272406115629407680--4536a5a5.14103396286.-7354">
      <con:stage name="error">
        <con:context xmlns:con3="http://www.bea.com/wli/sb/typesystem/config" xmlns:con2="http://www.bea.com/wli/sb/stages/transform/config" xmlns:con5="http://www.bea.com/wli/sb/stages/publish/config" xmlns:con4="http://www.bea.com/wli/sb/stages/routing/config" xmlns:con1="http://www.bea.com/wli/sb/stages/config"/>
        <con:actions xmlns:con3="http://www.bea.com/wli/sb/typesystem/config" xmlns:con2="http://www.bea.com/wli/sb/stages/transform/config" xmlns:con5="http://www.bea.com/wli/sb/stages/publish/config" xmlns:con4="http://www.bea.com/wli/sb/stages/routing/config" xmlns:con1="http://www.bea.com/wli/sb/stages/config">
          <con1:resume>
            <con1:id>_ActionId-6272406115629407680--4536a5a5.14103396286.-731c</con1:id>
          </con1:resume>
        </con:actions>
      </con:stage>
    </con:pipeline>
    <con:pipeline type="request" name="PipelinePairNode1_request">
      <con:stage name="init" errorHandler="_onErrorHandler-6272406115629407680--4536a5a5.14103396286.-7ffa">
        <con:context>
          <con2:varNsDecl namespace="http://www.comcel.com.co/ServicioProvision/" prefix="ser"/>
        </con:context>
        <con:actions>
          <con1:assign varName="tiempoInicio">
            <con2:id>_ActionId-6272406115629407680--4536a5a5.14103396286.-7fe5</con2:id>
            <con1:expr>
              <con2:xqueryText>fn:current-dateTime()</con2:xqueryText>
            </con1:expr>
          </con1:assign>
          <con1:assign varName="codigoError">
            <con2:id>_ActionId-6272406115629407680--4536a5a5.14103396286.-7fcd</con2:id>
            <con1:expr>
              <con2:xqueryText>"1"</con2:xqueryText>
            </con1:expr>
          </con1:assign>
          <con1:assign varName="descError">
            <con2:id>_ActionId-6272406115629407680--4536a5a5.14103396286.-7e4b</con2:id>
            <con1:expr>
              <con2:xqueryText>"Transaction successful"</con2:xqueryText>
            </con1:expr>
          </con1:assign>
          <con1:assign varName="timeout">
            <con2:id>_ActionId-39473929531945052--32c48d45.1410d964e7e.-7e2c</con2:id>
            <con1:expr>
              <con2:xqueryText>data($body/*:Input_Parameters/TIMEOUT)</con2:xqueryText>
            </con1:expr>
          </con1:assign>
          <con6:assign varName="ipOrigen" xmlns:con3="http://www.bea.com/wli/sb/typesystem/config" xmlns:con2="http://www.bea.com/wli/sb/stages/transform/config" xmlns:con5="http://www.bea.com/wli/sb/stages/publish/config" xmlns:con4="http://www.bea.com/wli/sb/stages/routing/config" xmlns:con1="http://www.bea.com/wli/sb/stages/config" xmlns:con6="http://www.bea.com/wli/sb/stages/transform/config">
            <con1:id>_ActionId-1394807091033924978--3cb9b3a1.1412c130b09.-7fc8</con1:id>
            <con6:expr>
              <con1:xqueryText>"Local"</con1:xqueryText>
            </con6:expr>
          </con6:assign>
          <con1:assign varName="metodo">
            <con2:id>_ActionId-1394807091033924978--3cb9b3a1.1412c130b09.-7ef6</con2:id>
            <con1:expr>
              <con2:xqueryText>data($body/*:Input_Parameters/METODO)</con2:xqueryText>
            </con1:expr>
          </con1:assign>
          <con1:assign varName="min">
            <con2:id>_ActionId-1394807091033924978--3cb9b3a1.1412c130b09.-7ede</con2:id>
            <con1:expr>
              <con2:xqueryText>data($body/*:Input_Parameters/MIN)</con2:xqueryText>
            </con1:expr>
          </con1:assign>
          <con6:javaCallout varName="ipLocal" xmlns:con3="http://www.bea.com/wli/sb/typesystem/config" xmlns:con2="http://www.bea.com/wli/sb/stages/transform/config" xmlns:con5="http://www.bea.com/wli/sb/stages/publish/config" xmlns:con4="http://www.bea.com/wli/sb/stages/routing/config" xmlns:con1="http://www.bea.com/wli/sb/stages/config" xmlns:con6="http://www.bea.com/wli/sb/stages/transform/config">
            <con1:id>_ActionId-1394807091033924978--3cb9b3a1.1412c130b09.-7f8f</con1:id>
            <con6:archive ref="ITEL/Core/Resources/JARs/OSBUtils"/>
            <con6:className>co.com.comcel.osb.OSBUtils</con6:className>
            <con6:method>public static java.lang.String obtenerHostLocal()</con6:method>
          </con6:javaCallout>
        </con:actions>
      </con:stage>
      <con:stage name="calcular">
        <con:context>
          <con2:varNsDecl namespace="http://www.comcel.com.co/ServicioProvision/" prefix="ser"/>
        </con:context>
        <con:actions>
          <con1:wsCallout>
            <con2:id>_ActionId-6272406115629407680--4536a5a5.14103396286.-7eb4</con2:id>
            <con1:service xsi:type="ref:ProxyRef" ref="ITEL/Core/Proxies/consultarRangoMinLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
            <con1:operation>consultarRangoMin</con1:operation>
            <con1:request>
              <con1:body>$consultarRangoMinRequest</con1:body>
            </con1:request>
            <con1:response>
              <con1:body>rangoMinOrigenResponse</con1:body>
            </con1:response>
            <con1:requestTransform>
              <con1:assign varName="consultarRangoMinRequest">
                <con2:id>_ActionId-6272406115629407680--4536a5a5.14103396286.-7e70</con2:id>
                <con1:expr>
                  <con2:xqueryTransform>
                    <con2:resource ref="ITEL/Core/Resources/XQueries/consultarRangoMin_Req"/>
                    <con2:param name="min">
                      <con2:path>data($body/*:Input_Parameters/MIN)</con2:path>
                    </con2:param>
                  </con2:xqueryTransform>
                </con1:expr>
              </con1:assign>
            </con1:requestTransform>
            <con1:responseTransform>
              <con1:ifThenElse xmlns:con3="http://www.bea.com/wli/sb/typesystem/config" xmlns:con5="http://www.bea.com/wli/sb/stages/publish/config" xmlns:con4="http://www.bea.com/wli/sb/stages/routing/config">
                <con2:id>_ActionId-6272406115629407680--4536a5a5.14103396286.-7dd0</con2:id>
                <con1:case>
                  <con1:condition>
                    <con2:xqueryText>data($rangoMinOrigenResponse/CODIGO) != "OK"</con2:xqueryText>
                  </con1:condition>
                  <con1:actions>
                    <con1:assign varName="codigoError">
                      <con2:id>_ActionId-6272406115629407680--4536a5a5.14103396286.-7dcf</con2:id>
                      <con1:expr>
                        <con2:xqueryText>"909"</con2:xqueryText>
                      </con1:expr>
                    </con1:assign>
                    <con1:assign varName="descError">
                      <con2:id>_ActionId-6272406115629407680--4536a5a5.14103396286.-77bd</con2:id>
                      <con1:expr>
                        <con2:xqueryText>"Database Error"</con2:xqueryText>
                      </con1:expr>
                    </con1:assign>
                  </con1:actions>
                </con1:case>
                <con1:case>
                  <con1:condition>
                    <con2:xqueryText>data($rangoMinOrigenResponse/MENSAJE/RMCESTADO) = "0"</con2:xqueryText>
                  </con1:condition>
                  <con1:actions>
                    <con1:assign varName="codigoError">
                      <con2:id>_ActionId-6272406115629407680--4536a5a5.14103396286.-7dce</con2:id>
                      <con1:expr>
                        <con2:xqueryText>"938"</con2:xqueryText>
                      </con1:expr>
                    </con1:assign>
                    <con1:assign varName="descError">
                      <con2:id>_ActionId-6272406115629407680--4536a5a5.14103396286.-779f</con2:id>
                      <con1:expr>
                        <con2:xqueryText>"Numeration Range of MIN is disabled"</con2:xqueryText>
                      </con1:expr>
                    </con1:assign>
                  </con1:actions>
                </con1:case>
                <con1:case>
                  <con1:condition>
                    <con2:xqueryText>data($rangoMinOrigenResponse/MENSAJE/RMCESTADO) = "-1"</con2:xqueryText>
                  </con1:condition>
                  <con1:actions>
                    <con1:assign varName="codigoError">
                      <con2:id>_ActionId-6272406115629407680--4536a5a5.14103396286.-7dcd</con2:id>
                      <con1:expr>
                        <con2:xqueryText>"934"</con2:xqueryText>
                      </con1:expr>
                    </con1:assign>
                    <con1:assign varName="descError">
                      <con2:id>_ActionId-6272406115629407680--4536a5a5.14103396286.-777c</con2:id>
                      <con1:expr>
                        <con2:xqueryText>"MIN cannot be associated with any particular IN"</con2:xqueryText>
                      </con1:expr>
                    </con1:assign>
                  </con1:actions>
                </con1:case>
                <con1:default>
                  <con1:assign varName="inOrigen">
                    <con2:id>_ActionId-6272406115629407680--4536a5a5.14103396286.-7dca</con2:id>
                    <con1:expr>
                      <con2:xqueryText>data($rangoMinOrigenResponse/MENSAJE/RMCCODIGOIN)</con2:xqueryText>
                    </con1:expr>
                  </con1:assign>
                  <con1:assign varName="sdp">
                    <con2:id>_ActionId-5070806379719506431--789c16e1.14117ccee9d.-7fe0</con2:id>
                    <con1:expr>
                      <con2:xqueryText>data($rangoMinOrigenResponse/MENSAJE/SDP)</con2:xqueryText>
                    </con1:expr>
                  </con1:assign>
                </con1:default>
              </con1:ifThenElse>
            </con1:responseTransform>
          </con1:wsCallout>
          <con1:ifThenElse>
            <con2:id>_ActionId-6272406115629407680--4536a5a5.14103396286.-7cf3</con2:id>
            <con1:case>
              <con1:condition>
                <con2:xqueryText>$codigoError = "1"</con2:xqueryText>
              </con1:condition>
              <con1:actions>
                <con1:ifThenElse>
                  <con2:id>_ActionId-6272406115629407680--4536a5a5.14103396286.-7cc6</con2:id>
                  <con1:case>
                    <con1:condition>
                      <con2:xqueryText>data($body/*:Input_Parameters/METODO)= '100'</con2:xqueryText>
                    </con1:condition>
                    <con1:actions>
                      <con1:wsCallout>
                        <con2:id>_ActionId-8203943590893020617--15a757d6.14112b0f349.-7dbf</con2:id>
                        <con1:service xsi:type="ref:ProxyRef" ref="ITEL/Trama100/Proxies/calcularProvisionTrama100Local_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                        <con1:operation>calcularProvisionTrama100</con1:operation>
                        <con1:request>
                          <con1:body>$calcularProvisionTrama100Request</con1:body>
                        </con1:request>
                        <con1:response>
                          <con1:body>reglasProvisionResponse</con1:body>
                        </con1:response>
                        <con1:requestTransform>
                          <con1:assign varName="calcularProvisionTrama100Request">
                            <con2:id>_ActionId-8203943590893020617--15a757d6.14112b0f349.-7da2</con2:id>
                            <con1:expr>
                              <con2:xqueryTransform>
                                <con2:resource ref="ITEL/Core/Resources/XQueries/servicioProvision_Req_calcularProvTrama100"/>
                                <con2:param name="parametosEntrada">
                                  <con2:path>$body/ser:Input_Parameters</con2:path>
                                </con2:param>
                                <con2:param name="SDP">
                                  <con2:path>$sdp</con2:path>
                                </con2:param>
                                <con2:param name="codigoIN">
                                  <con2:path>data($inOrigen)</con2:path>
                                </con2:param>
                              </con2:xqueryTransform>
                            </con1:expr>
                          </con1:assign>
                        </con1:requestTransform>
                        <con1:responseTransform/>
                      </con1:wsCallout>
                    </con1:actions>
                  </con1:case>
                  <con1:case>
                    <con1:condition>
                      <con2:xqueryText>data($body/*:Input_Parameters/METODO)= '400'</con2:xqueryText>
                    </con1:condition>
                    <con1:actions>
                      <con2:assign varName="monto" xmlns:con3="http://www.bea.com/wli/sb/typesystem/config" xmlns:con2="http://www.bea.com/wli/sb/stages/transform/config" xmlns:con5="http://www.bea.com/wli/sb/stages/publish/config" xmlns:con4="http://www.bea.com/wli/sb/stages/routing/config" xmlns:con6="http://www.bea.com/wli/sb/stages/transform/config" xmlns:con1="http://www.bea.com/wli/sb/stages/config">
                        <con1:id>_ActionId-4807539232795849436--2019c98a.14b08252922.-6f4f</con1:id>
                        <con2:expr>
                          <con1:xqueryText>data($body/ser:Input_Parameters/PARAMETROSPROVISION/PARAMETRO[NOMBRE='MONTO']/VALOR/text())</con1:xqueryText>
                        </con2:expr>
                      </con2:assign>
                      <con2:assign varName="vigenciaRecarga" xmlns:con3="http://www.bea.com/wli/sb/typesystem/config" xmlns:con2="http://www.bea.com/wli/sb/stages/transform/config" xmlns:con5="http://www.bea.com/wli/sb/stages/publish/config" xmlns:con4="http://www.bea.com/wli/sb/stages/routing/config" xmlns:con6="http://www.bea.com/wli/sb/stages/transform/config" xmlns:con1="http://www.bea.com/wli/sb/stages/config">
                        <con1:id>_ActionId-4807539232795849436--2019c98a.14b08252922.-6ef9</con1:id>
                        <con2:expr>
                          <con1:xqueryText>data($body/ser:Input_Parameters/PARAMETROSPROVISION/PARAMETRO[NOMBRE='VIGENCIA']/VALOR/text())</con1:xqueryText>
                        </con2:expr>
                      </con2:assign>
                      <con1:wsCallout>
                        <con2:id>_ActionId-4807539232795849436--2019c98a.14b08252922.-71ee</con2:id>
                        <con1:service xsi:type="ref:ProxyRef" ref="ITEL/Trama400/Proxies/calcularProvisionTrama400Local_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                        <con1:operation>calcularProvisionTrama400</con1:operation>
                        <con1:request>
                          <con1:body>$calcularProvisionTrama400Request</con1:body>
                        </con1:request>
                        <con1:response>
                          <con1:body>reglasProvisionResponse</con1:body>
                        </con1:response>
                        <con1:requestTransform>
                          <con1:assign varName="calcularProvisionTrama400Request">
                            <con2:id>_ActionId-4807539232795849436--2019c98a.14b08252922.-71ef</con2:id>
                            <con1:expr>
                              <con2:xqueryTransform>
                                <con2:resource ref="ITEL/Core/Resources/XQueries/servicioProvision_Req_calcularProvTrama400"/>
                                <con2:param name="parametrosEntrada">
                                  <con2:path>$body/ser:Input_Parameters</con2:path>
                                </con2:param>
                                <con2:param name="codigoIN">
                                  <con2:path>data($inOrigen)</con2:path>
                                </con2:param>
                              </con2:xqueryTransform>
                            </con1:expr>
                          </con1:assign>
                        </con1:requestTransform>
                        <con1:responseTransform>
                          <con1:assign varName="codigoError">
                            <con2:id>_ActionId-4807539232795849436--2019c98a.14b08252922.-7044</con2:id>
                            <con1:expr>
                              <con2:xqueryText>data($reglasProvisionResponse/CODIGO)</con2:xqueryText>
                            </con1:expr>
                          </con1:assign>
                        </con1:responseTransform>
                      </con1:wsCallout>
                      <con1:ifThenElse>
                        <con2:id>_ActionId-4807539232795849436--2019c98a.14b08252922.-7098</con2:id>
                        <con1:case>
                          <con1:condition>
                            <con2:xqueryText>$codigoError = "1"</con2:xqueryText>
                          </con1:condition>
                          <con1:actions>
                            <con6:wsCallout xmlns:con3="http://www.bea.com/wli/sb/typesystem/config" xmlns:con2="http://www.bea.com/wli/sb/stages/transform/config" xmlns:con5="http://www.bea.com/wli/sb/stages/publish/config" xmlns:con4="http://www.bea.com/wli/sb/stages/routing/config" xmlns:con1="http://www.bea.com/wli/sb/stages/config" xmlns:con6="http://www.bea.com/wli/sb/stages/transform/config">
                              <con1:id>_ActionId-4807539232795849436--2019c98a.14b08252922.-7040</con1:id>
                              <con6:service xsi:type="ref:ProxyRef" ref="ITEL/OCS/SOI/Proxies/consultarSuscriptorOCSLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                              <con6:operation>consultarSuscriptorOCS</con6:operation>
                              <con6:request>
                                <con6:body>$suscriptorOCSRequest</con6:body>
                              </con6:request>
                              <con6:response>
                                <con6:body>suscriptorOCSResponse</con6:body>
                              </con6:response>
                              <con6:requestTransform>
                                <con6:assign varName="suscriptorOCSRequest" xmlns:con3="http://www.bea.com/wli/sb/stages/transform/config" xmlns:con2="http://www.bea.com/wli/sb/typesystem/config">
                                  <con1:id>_ActionId-4807539232795849436--2019c98a.14b08252922.-7041</con1:id>
                                  <con6:expr>
                                    <con1:xqueryTransform>
                                      <con1:resource ref="ITEL/Core/Resources/XQueries/consultarSuscriptorOCSPS_Req"/>
                                      <con1:param name="timeout">
                                        <con1:path>2000</con1:path>
                                      </con1:param>
                                      <con1:param name="min">
                                        <con1:path>$min</con1:path>
                                      </con1:param>
                                      <con1:param name="in">
                                        <con1:path>data($inOrigen)</con1:path>
                                      </con1:param>
                                    </con1:xqueryTransform>
                                  </con6:expr>
                                </con6:assign>
                              </con6:requestTransform>
                              <con6:responseTransform>
                                <con1:assign varName="codigoError" xmlns:con2="http://www.bea.com/wli/sb/stages/config" xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
                                  <con7:id xmlns:con7="http://www.bea.com/wli/sb/stages/config">_ActionId-4807539232795849436--2019c98a.14b08252922.-6fec</con7:id>
                                  <con1:expr>
                                    <con7:xqueryText xmlns:con7="http://www.bea.com/wli/sb/stages/config">data($suscriptorOCSResponse/CODIGO)</con7:xqueryText>
                                  </con1:expr>
                                </con1:assign>
                              </con6:responseTransform>
                            </con6:wsCallout>
                            <con1:ifThenElse>
                              <con2:id>_ActionId-4807539232795849436--2019c98a.14b08252922.-6fb4</con2:id>
                              <con1:case>
                                <con1:condition>
                                  <con2:xqueryText>$codigoError = "1"</con2:xqueryText>
                                </con1:condition>
                                <con1:actions>
                                  <con6:wsCallout xmlns:con3="http://www.bea.com/wli/sb/typesystem/config" xmlns:con2="http://www.bea.com/wli/sb/stages/transform/config" xmlns:con5="http://www.bea.com/wli/sb/stages/publish/config" xmlns:con4="http://www.bea.com/wli/sb/stages/routing/config" xmlns:con1="http://www.bea.com/wli/sb/stages/config" xmlns:con6="http://www.bea.com/wli/sb/stages/transform/config">
                                    <con1:id>_ActionId-4807539232795849436--2019c98a.14b08252922.-6fa6</con1:id>
                                    <con6:service xsi:type="ref:ProxyRef" ref="ITEL/Core/Proxies/consultarRangoRecargaOCSLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                    <con6:operation>ConsultarRangoRecargaOCS</con6:operation>
                                    <con6:request>
                                      <con6:body>$consultarRangoRecargaOCSRequest</con6:body>
                                    </con6:request>
                                    <con6:response>
                                      <con6:body>consultarRangoRecargaOCSResponse</con6:body>
                                    </con6:response>
                                    <con6:requestTransform>
                                      <con6:assign varName="consultarRangoRecargaOCSRequest">
                                        <con1:id>_ActionId-4807539232795849436--2019c98a.14b08252922.-6fac</con1:id>
                                        <con6:expr>
                                          <con1:xqueryTransform>
                                            <con1:resource ref="ITEL/Core/Resources/XQueries/validar_Req_consultarRangoRecargaOCS"/>
                                            <con1:param name="valor">
                                              <con1:path>$monto</con1:path>
                                            </con1:param>
                                            <con1:param name="regla">
                                              <con1:path>'1'</con1:path>
                                            </con1:param>
                                            <con1:param name="bono">
                                              <con1:path>if (data($body/ser:Input_Parameters/PARAMETROSPROVISION/PARAMETRO[NOMBRE='BONIFICAR']/VALOR/text())!= "") then
data($body/ser:Input_Parameters/PARAMETROSPROVISION/PARAMETRO[NOMBRE='BONIFICAR']/VALOR/text())
else
number("0")</con1:path>
                                            </con1:param>
                                            <con1:param name="sc">
                                              <con1:path>data($suscriptorOCSResponse/MENSAJE/CONSULTAR_SUSCRIPTOR/*:suscriptor/*:PublicRatePlanCode)</con1:path>
                                            </con1:param>
                                          </con1:xqueryTransform>
                                        </con6:expr>
                                      </con6:assign>
                                    </con6:requestTransform>
                                    <con6:responseTransform>
                                      <con6:ifThenElse>
                                        <con1:id>_ActionId-4807539232795849436--2019c98a.14b08252922.-6fab</con1:id>
                                        <con6:case>
                                          <con6:condition>
                                            <con1:xqueryText>data($consultarRangoRecargaOCSResponse/CODIGO)="OK"</con1:xqueryText>
                                          </con6:condition>
                                          <con6:actions>
                                            <con6:assign varName="bono">
                                              <con1:id>_ActionId-4807539232795849436--2019c98a.14b08252922.-6faa</con1:id>
                                              <con6:expr>
                                                <con1:xqueryText>data($consultarRangoRecargaOCSResponse/MENSAJE/BONO)</con1:xqueryText>
                                              </con6:expr>
                                            </con6:assign>
                                            <con6:assign varName="vigencia">
                                              <con1:id>_ActionId-4807539232795849436--2019c98a.14b08252922.-6fa9</con1:id>
                                              <con6:expr>
                                                <con1:xqueryText>data($consultarRangoRecargaOCSResponse/MENSAJE/VIGENCIA)</con1:xqueryText>
                                              </con6:expr>
                                            </con6:assign>
                                          </con6:actions>
                                        </con6:case>
                                        <con6:default>
                                          <con6:assign varName="bono">
                                            <con1:id>_ActionId-4807539232795849436--2019c98a.14b08252922.-6fa8</con1:id>
                                            <con6:expr>
                                              <con1:xqueryText>0</con1:xqueryText>
                                            </con6:expr>
                                          </con6:assign>
                                          <con6:assign varName="vigencia">
                                            <con1:id>_ActionId-4807539232795849436--2019c98a.14b08252922.-6fa7</con1:id>
                                            <con6:expr>
                                              <con1:xqueryText>0</con1:xqueryText>
                                            </con6:expr>
                                          </con6:assign>
                                        </con6:default>
                                      </con6:ifThenElse>
                                    </con6:responseTransform>
                                  </con6:wsCallout>
                                </con1:actions>
                              </con1:case>
                              <con1:default/>
                            </con1:ifThenElse>
                          </con1:actions>
                        </con1:case>
                        <con1:default/>
                      </con1:ifThenElse>
                    </con1:actions>
                  </con1:case>
                  <con1:case>
                    <con1:condition>
                      <con2:xqueryText>data($body/*:Input_Parameters/METODO)= '501'</con2:xqueryText>
                    </con1:condition>
                    <con1:actions>
                      <con1:wsCallout>
                        <con2:id>_ActionId-6272406115629407680--4536a5a5.14103396286.-7c9e</con2:id>
                        <con1:service xsi:type="ref:ProxyRef" ref="ITEL/Trama501/Proxies/calcularProvisionTrama501Local_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                        <con1:operation>calcularProvisionTrama501</con1:operation>
                        <con1:request>
                          <con1:body>$calcularProvisionTrama501Request</con1:body>
                        </con1:request>
                        <con1:response>
                          <con1:body>reglasProvisionResponse</con1:body>
                        </con1:response>
                        <con1:requestTransform>
                          <con1:assign varName="calcularProvisionTrama501Request">
                            <con2:id>_ActionId-6272406115629407680--4536a5a5.14103396286.-7c7d</con2:id>
                            <con1:expr>
                              <con2:xqueryTransform>
                                <con2:resource ref="ITEL/Core/Resources/XQueries/servicioProvision_Req_calcularProvTrama501"/>
                                <con2:param name="min">
                                  <con2:path>$min</con2:path>
                                </con2:param>
                                <con2:param name="trama">
                                  <con2:path>data($body/*:Input_Parameters/TRAMA)</con2:path>
                                </con2:param>
                                <con2:param name="codigoIN">
                                  <con2:path>data($inOrigen)</con2:path>
                                </con2:param>
                                <con2:param name="tiempo">
                                  <con2:path>""</con2:path>
                                </con2:param>
                                <con2:param name="metodo">
                                  <con2:path>$metodo</con2:path>
                                </con2:param>
                              </con2:xqueryTransform>
                            </con1:expr>
                          </con1:assign>
                        </con1:requestTransform>
                        <con1:responseTransform/>
                      </con1:wsCallout>
                    </con1:actions>
                  </con1:case>
                  <con1:case>
                    <con1:condition>
                      <con2:xqueryText>data($body/*:Input_Parameters/METODO)= '601'</con2:xqueryText>
                    </con1:condition>
                    <con1:actions>
                      <con1:assign varName="spcode">
                        <con2:id>_ActionId-4807539232795849436--2019c98a.14b08252922.-737f</con2:id>
                        <con1:expr>
                          <con2:xqueryText>data($body/*:Input_Parameters/PARAMETROSPROVISION/PARAMETRO[NOMBRE='SPCODE']/VALOR/text())</con2:xqueryText>
                        </con1:expr>
                      </con1:assign>
                      <con6:assign varName="tmcode" xmlns:con3="http://www.bea.com/wli/sb/typesystem/config" xmlns:con5="http://www.bea.com/wli/sb/stages/publish/config" xmlns:con4="http://www.bea.com/wli/sb/stages/routing/config" xmlns:con6="http://www.bea.com/wli/sb/stages/transform/config">
                        <con2:id>_ActionId-4807539232795849436--2019c98a.14b08252922.-737e</con2:id>
                        <con6:expr>
                          <con2:xqueryText>data($body/*:Input_Parameters/PARAMETROSPROVISION/PARAMETRO[NOMBRE='TMCODE']/VALOR/text())</con2:xqueryText>
                        </con6:expr>
                      </con6:assign>
                      <con1:wsCallout>
                        <con2:id>_ActionId-8621543710087368318-2f3da784.152d2509959.-7f87</con2:id>
                        <con1:service xsi:type="ref:ProxyRef" ref="ITEL/OCS/SOI/Proxies/consultarSuscriptorOCSLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                        <con1:operation>consultarSuscriptorOCS</con1:operation>
                        <con1:request>
                          <con1:body>$suscriptorOCSRequest</con1:body>
                        </con1:request>
                        <con1:response>
                          <con1:body>suscriptorOCSResponse</con1:body>
                        </con1:response>
                        <con1:requestTransform>
                          <con1:assign varName="suscriptorOCSRequest">
                            <con2:id>_ActionId-8621543710087368318-2f3da784.152d2509959.-7f6c</con2:id>
                            <con1:expr>
                              <con2:xqueryTransform>
                                <con2:resource ref="ITEL/Core/Resources/XQueries/consultarSuscriptorOCSPS_Req"/>
                                <con2:param name="timeout">
                                  <con2:path>2000</con2:path>
                                </con2:param>
                                <con2:param name="in">
                                  <con2:path>"51"</con2:path>
                                </con2:param>
                                <con2:param name="min">
                                  <con2:path>$min</con2:path>
                                </con2:param>
                              </con2:xqueryTransform>
                            </con1:expr>
                          </con1:assign>
                        </con1:requestTransform>
                        <con1:responseTransform>
                          <con1:ifThenElse>
                            <con2:id>_ActionId-8621543710087368318-2f3da784.152d2509959.-7f53</con2:id>
                            <con1:case>
                              <con1:condition>
                                <con2:xqueryText>data($suscriptorOCSResponse/CODIGO) = '1'</con2:xqueryText>
                              </con1:condition>
                              <con1:actions>
                                <con1:assign varName="serviceClassOrigen">
                                  <con2:id>_ActionId-8621543710087368318-2f3da784.152d2509959.-7ef1</con2:id>
                                  <con1:expr>
                                    <con2:xqueryText>data($suscriptorOCSResponse/MENSAJE/CONSULTAR_SUSCRIPTOR/*:suscriptor/*:PublicRatePlanCode)</con2:xqueryText>
                                  </con1:expr>
                                </con1:assign>
                              </con1:actions>
                            </con1:case>
                            <con1:default>
                              <con1:assign varName="codigoError">
                                <con2:id>_ActionId-8621543710087368318-2f3da784.152d2509959.-7f0b</con2:id>
                                <con1:expr>
                                  <con2:xqueryText>data($suscriptorOCSResponse/CODIGO)</con2:xqueryText>
                                </con1:expr>
                              </con1:assign>
                            </con1:default>
                          </con1:ifThenElse>
                        </con1:responseTransform>
                      </con1:wsCallout>
                      <con1:ifThenElse>
                        <con2:id>_ActionId-8621543710087368318-2f3da784.152d2509959.-7ed8</con2:id>
                        <con1:case>
                          <con1:condition>
                            <con2:xqueryText>$codigoError = "1"</con2:xqueryText>
                          </con1:condition>
                          <con1:actions>
                            <con1:wsCallout>
                              <con2:id>_ActionId-8621543710087368318-2f3da784.152d2509959.-7eac</con2:id>
                              <con1:service xsi:type="ref:ProxyRef" ref="ITEL/Core/Proxies/consultarContratoEsPostpagoLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                              <con1:operation>consultarContratoEsPostpago</con1:operation>
                              <con1:request>
                                <con1:body>$consultarContratoEsPospagoRequest</con1:body>
                              </con1:request>
                              <con1:response>
                                <con1:body>consultarContratoEsPospagoResponse</con1:body>
                              </con1:response>
                              <con1:requestTransform>
                                <con1:assign varName="consultarContratoEsPospagoRequest">
                                  <con2:id>_ActionId-8621543710087368318-2f3da784.152d2509959.-7e82</con2:id>
                                  <con1:expr>
                                    <con2:xqueryText>&lt;con:Input_Parameters xmlns:con="http://www.comcel.com.co/ConsultarContractEsPostPago">
    &lt;con:CONTRACT>{ $serviceClassOrigen }&lt;/con:CONTRACT>
&lt;/con:Input_Parameters></con2:xqueryText>
                                  </con1:expr>
                                </con1:assign>
                              </con1:requestTransform>
                              <con1:responseTransform>
                                <con1:ifThenElse>
                                  <con2:id>_ActionId-8621543710087368318-2f3da784.152d2509959.-7d14</con2:id>
                                  <con1:case>
                                    <con1:condition>
                                      <con2:xqueryText>data($consultarContratoEsPospagoResponse/*:CODIGO) = '1'</con2:xqueryText>
                                    </con1:condition>
                                    <con1:actions>
                                      <con1:assign varName="espospago">
                                        <con2:id>_ActionId-8621543710087368318-2f3da784.152d2509959.-7d10</con2:id>
                                        <con1:expr>
                                          <con2:xqueryText>data($consultarContratoEsPospagoResponse/*:MENSAJE/*:ESPOSTPAGO)</con2:xqueryText>
                                        </con1:expr>
                                      </con1:assign>
                                    </con1:actions>
                                  </con1:case>
                                  <con1:default>
                                    <con1:assign varName="codigoError">
                                      <con2:id>_ActionId-8621543710087368318-2f3da784.152d2509959.-7cf8</con2:id>
                                      <con1:expr>
                                        <con2:xqueryText>data($consultarContratoEsPospagoResponse/*:CODIGO)</con2:xqueryText>
                                      </con1:expr>
                                    </con1:assign>
                                  </con1:default>
                                </con1:ifThenElse>
                              </con1:responseTransform>
                            </con1:wsCallout>
                          </con1:actions>
                        </con1:case>
                        <con1:default/>
                      </con1:ifThenElse>
                      <con1:ifThenElse>
                        <con2:id>_ActionId-8621543710087368318-2f3da784.152d2509959.-7deb</con2:id>
                        <con1:case>
                          <con1:condition>
                            <con2:xqueryText>$codigoError = "1"</con2:xqueryText>
                          </con1:condition>
                          <con1:actions>
                            <con1:wsCallout>
                              <con2:id>_ActionId-8621543710087368318-2f3da784.152d2509959.-7dc5</con2:id>
                              <con1:service xsi:type="ref:ProxyRef" ref="ITEL/OCS/AIR/Proxies/consultarBalancesOCSLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                              <con1:operation>consultarBalances</con1:operation>
                              <con1:request>
                                <con1:body>$balancesRequest</con1:body>
                              </con1:request>
                              <con1:response>
                                <con1:body>balancesResponse</con1:body>
                              </con1:response>
                              <con1:requestTransform>
                                <con1:assign varName="balancesRequest">
                                  <con2:id>_ActionId-8621543710087368318-2f3da784.152d2509959.-7da7</con2:id>
                                  <con1:expr>
                                    <con2:xqueryTransform>
                                      <con2:resource ref="ITEL/Core/Resources/XQueries/consultarBalancesPS_Req"/>
                                      <con2:param name="min">
                                        <con2:path>$min</con2:path>
                                      </con2:param>
                                    </con2:xqueryTransform>
                                  </con1:expr>
                                </con1:assign>
                              </con1:requestTransform>
                              <con1:responseTransform/>
                            </con1:wsCallout>
                          </con1:actions>
                        </con1:case>
                        <con1:default/>
                      </con1:ifThenElse>
                      <con6:wsCallout xmlns:con3="http://www.bea.com/wli/sb/typesystem/config" xmlns:con5="http://www.bea.com/wli/sb/stages/publish/config" xmlns:con4="http://www.bea.com/wli/sb/stages/routing/config" xmlns:con6="http://www.bea.com/wli/sb/stages/transform/config">
                        <con2:id>_ActionId-4807539232795849436--2019c98a.14b08252922.-7376</con2:id>
                        <con6:service xsi:type="ref:ProxyRef" ref="ITEL/Core/Proxies/consultarContractTemplateServiceClassLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                        <con6:operation>consultarConTempSC</con6:operation>
                        <con6:request>
                          <con6:body>$contractTemplateRequest</con6:body>
                        </con6:request>
                        <con6:response>
                          <con6:body>contractTemplateResponse</con6:body>
                        </con6:response>
                        <con6:requestTransform>
                          <con6:assign varName="contractTemplateRequest">
                            <con2:id>_ActionId-4807539232795849436--2019c98a.14b08252922.-737b</con2:id>
                            <con6:expr>
                              <con2:xqueryTransform>
                                <con2:resource ref="ITEL/Core/Resources/XQueries/validar_Req_consultarContractTemplate"/>
                                <con2:param name="spcode">
                                  <con2:path>$spcode</con2:path>
                                </con2:param>
                                <con2:param name="tmcode">
                                  <con2:path>$tmcode</con2:path>
                                </con2:param>
                              </con2:xqueryTransform>
                            </con6:expr>
                          </con6:assign>
                        </con6:requestTransform>
                        <con6:responseTransform>
                          <con6:ifThenElse>
                            <con2:id>_ActionId-4807539232795849436--2019c98a.14b08252922.-737a</con2:id>
                            <con6:case>
                              <con6:condition>
                                <con2:xqueryText>data($contractTemplateResponse/CODIGO) != "OK"</con2:xqueryText>
                              </con6:condition>
                              <con6:actions>
                                <con6:assign varName="codigoError ">
                                  <con2:id>_ActionId-4807539232795849436--2019c98a.14b08252922.-7379</con2:id>
                                  <con6:expr>
                                    <con2:xqueryText>"909"</con2:xqueryText>
                                  </con6:expr>
                                </con6:assign>
                              </con6:actions>
                            </con6:case>
                            <con6:case>
                              <con6:condition>
                                <con2:xqueryText>data($contractTemplateResponse/MENSAJE/CONTRACT_TEMPLATE) = "NO_DATA"</con2:xqueryText>
                              </con6:condition>
                              <con6:actions>
                                <con6:assign varName="codigoError ">
                                  <con2:id>_ActionId-4807539232795849436--2019c98a.14b08252922.-7378</con2:id>
                                  <con6:expr>
                                    <con2:xqueryText>"933"</con2:xqueryText>
                                  </con6:expr>
                                </con6:assign>
                              </con6:actions>
                            </con6:case>
                            <con6:default>
                              <con6:assign varName="categoria">
                                <con2:id>_ActionId-4807539232795849436--2019c98a.14b08252922.-7377</con2:id>
                                <con6:expr>
                                  <con2:xqueryText>fn:string-join( (data($contractTemplateResponse/MENSAJE/FAFIDS/FAFID)) ,";")</con2:xqueryText>
                                </con6:expr>
                              </con6:assign>
                              <con6:assign varName="serviceClass">
                                <con2:id>_ActionId-8621543710087368318-2f3da784.152d2509959.-7cd4</con2:id>
                                <con6:expr>
                                  <con2:xqueryText>data($contractTemplateResponse/MENSAJE/SERVICE_CLASS)</con2:xqueryText>
                                </con6:expr>
                              </con6:assign>
                            </con6:default>
                          </con6:ifThenElse>
                        </con6:responseTransform>
                      </con6:wsCallout>
                      <con1:wsCallout xmlns:con3="http://www.bea.com/wli/sb/typesystem/config" xmlns:con5="http://www.bea.com/wli/sb/stages/publish/config" xmlns:con4="http://www.bea.com/wli/sb/stages/routing/config">
                        <con2:id>_ActionId-4807539232795849436--2019c98a.14b08252922.-7372</con2:id>
                        <con1:service xsi:type="ref:ProxyRef" ref="ITEL/OCS/AIR/Proxies/consultarFaFListOCSLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                        <con1:operation>consultarFaFList</con1:operation>
                        <con1:request>
                          <con1:body>$consultarFaFListRequest</con1:body>
                        </con1:request>
                        <con1:response>
                          <con1:body>consultarFaFListResponse</con1:body>
                        </con1:response>
                        <con1:requestTransform>
                          <con1:assign varName="consultarFaFListRequest">
                            <con2:id>_ActionId-4807539232795849436--2019c98a.14b08252922.-7375</con2:id>
                            <con1:expr>
                              <con6:xqueryTransform xmlns:con6="http://www.bea.com/wli/sb/stages/config">
                                <con6:resource ref="ITEL/Core/Resources/XQueries/consultarFaFListPS_Req"/>
                                <con6:param name="min">
                                  <con6:path>$min</con6:path>
                                </con6:param>
                              </con6:xqueryTransform>
                            </con1:expr>
                          </con1:assign>
                        </con1:requestTransform>
                        <con1:responseTransform>
                          <con1:ifThenElse>
                            <con2:id>_ActionId-4807539232795849436--2019c98a.14b08252922.-7374</con2:id>
                            <con1:case>
                              <con1:condition>
                                <con6:xqueryText xmlns:con6="http://www.bea.com/wli/sb/stages/config">data($consultarFaFListResponse/CODIGO) != '1'</con6:xqueryText>
                              </con1:condition>
                              <con1:actions>
                                <con6:assign varName="codigoError" xmlns:con3="http://www.bea.com/wli/sb/stages/transform/config" xmlns:con2="http://www.bea.com/wli/sb/typesystem/config" xmlns:con1="http://www.bea.com/wli/sb/stages/config" xmlns:con6="http://www.bea.com/wli/sb/stages/transform/config">
                                  <con1:id>_ActionId-4807539232795849436--2019c98a.14b08252922.-7373</con1:id>
                                  <con6:expr>
                                    <con1:xqueryText>data($consultarFaFListResponse/CODIGO)</con1:xqueryText>
                                  </con6:expr>
                                </con6:assign>
                              </con1:actions>
                            </con1:case>
                            <con1:default/>
                          </con1:ifThenElse>
                        </con1:responseTransform>
                      </con1:wsCallout>
                      <con6:ifThenElse xmlns:con3="http://www.bea.com/wli/sb/stages/transform/config" xmlns:con2="http://www.bea.com/wli/sb/typesystem/config" xmlns:con5="http://www.bea.com/wli/sb/stages/publish/config" xmlns:con4="http://www.bea.com/wli/sb/stages/routing/config" xmlns:con1="http://www.bea.com/wli/sb/stages/config" xmlns:con6="http://www.bea.com/wli/sb/stages/transform/config">
                        <con1:id>_ActionId-4807539232795849436--2019c98a.14b08252922.-7371</con1:id>
                        <con6:case>
                          <con6:condition>
                            <con1:xqueryText>$codigoError = "1" and 
fn:exists($consultarFaFListResponse/MENSAJE/CONSULTAR_FAFLIST/fafInformationList/Detail/fafIndicator)</con1:xqueryText>
                          </con6:condition>
                          <con6:actions>
                            <con6:wsCallout>
                              <con1:id>_ActionId-4807539232795849436--2019c98a.14b08252922.-736c</con1:id>
                              <con6:service xsi:type="ref:ProxyRef" ref="ITEL/Core/Proxies/consultarFAFTipoLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                              <con6:operation>consultarFAFTipo</con6:operation>
                              <con6:request>
                                <con6:body>$consultarFAFTipoRequest</con6:body>
                              </con6:request>
                              <con6:response>
                                <con6:body>consultarFAFTipoResponse</con6:body>
                              </con6:response>
                              <con6:requestTransform>
                                <con6:assign varName="consultarFAFTipoRequest">
                                  <con1:id>_ActionId-4807539232795849436--2019c98a.14b08252922.-7370</con1:id>
                                  <con6:expr>
                                    <con1:xqueryTransform>
                                      <con1:resource ref="ITEL/Core/Resources/XQueries/consultarFAFTipoPS_Req"/>
                                      <con1:param name="wS_Result1">
                                        <con1:path>$consultarFaFListResponse</con1:path>
                                      </con1:param>
                                    </con1:xqueryTransform>
                                  </con6:expr>
                                </con6:assign>
                              </con6:requestTransform>
                              <con6:responseTransform>
                                <con1:ifThenElse xmlns:con3="http://www.bea.com/wli/sb/typesystem/config" xmlns:con2="http://www.bea.com/wli/sb/stages/config" xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
                                  <con7:id xmlns:con7="http://www.bea.com/wli/sb/stages/config">_ActionId-4807539232795849436--2019c98a.14b08252922.-736f</con7:id>
                                  <con1:case>
                                    <con1:condition>
                                      <con6:xqueryText xmlns:con6="http://www.bea.com/wli/sb/stages/config">data($consultarFAFTipoResponse/CODIGO) != 'OK'</con6:xqueryText>
                                    </con1:condition>
                                    <con1:actions>
                                      <con7:assign varName="codigoError" xmlns:con3="http://www.bea.com/wli/sb/stages/transform/config" xmlns:con2="http://www.bea.com/wli/sb/typesystem/config" xmlns:con1="http://www.bea.com/wli/sb/stages/config" xmlns:con7="http://www.bea.com/wli/sb/stages/transform/config">
                                        <con1:id>_ActionId-4807539232795849436--2019c98a.14b08252922.-736e</con1:id>
                                        <con7:expr>
                                          <con1:xqueryText>"909"</con1:xqueryText>
                                        </con7:expr>
                                      </con7:assign>
                                    </con1:actions>
                                  </con1:case>
                                  <con1:case>
                                    <con1:condition>
                                      <con7:xqueryText xmlns:con7="http://www.bea.com/wli/sb/stages/config">$codigoError = "1" and 
fn:exists($consultarFaFListResponse/MENSAJE/CONSULTAR_FAFLIST/fafInformationList/Detail/fafIndicator)</con7:xqueryText>
                                    </con1:condition>
                                    <con1:actions>
                                      <con1:replace varName="consultarFaFListResponse" contents-only="false">
                                        <con7:id xmlns:con7="http://www.bea.com/wli/sb/stages/config">_ActionId-4807539232795849436--2019c98a.14b08252922.-736d</con7:id>
                                        <con1:expr>
                                          <con6:xqueryTransform xmlns:con6="http://www.bea.com/wli/sb/stages/config">
                                            <con6:resource ref="ITEL/Core/Resources/XQueries/ejecutarReglasNegocio_Res_consultarFaFList"/>
                                            <con6:param name="wS_Result2">
                                              <con6:path>$consultarFaFListResponse</con6:path>
                                            </con6:param>
                                            <con6:param name="wS_Result1">
                                              <con6:path>$consultarFAFTipoResponse</con6:path>
                                            </con6:param>
                                          </con6:xqueryTransform>
                                        </con1:expr>
                                      </con1:replace>
                                    </con1:actions>
                                  </con1:case>
                                  <con1:default/>
                                </con1:ifThenElse>
                              </con6:responseTransform>
                            </con6:wsCallout>
                          </con6:actions>
                        </con6:case>
                        <con6:default/>
                      </con6:ifThenElse>
                      <con6:ifThenElse xmlns:con3="http://www.bea.com/wli/sb/stages/transform/config" xmlns:con2="http://www.bea.com/wli/sb/typesystem/config" xmlns:con5="http://www.bea.com/wli/sb/stages/publish/config" xmlns:con4="http://www.bea.com/wli/sb/stages/routing/config" xmlns:con1="http://www.bea.com/wli/sb/stages/config" xmlns:con6="http://www.bea.com/wli/sb/stages/transform/config">
                        <con1:id>_ActionId-4807539232795849436--2019c98a.14b08252922.-736b</con1:id>
                        <con6:case>
                          <con6:condition>
                            <con1:xqueryText>$codigoError = "1"</con1:xqueryText>
                          </con6:condition>
                          <con6:actions>
                            <con6:wsCallout>
                              <con1:id>_ActionId-4807539232795849436--2019c98a.14b08252922.-7369</con1:id>
                              <con6:service xsi:type="ref:ProxyRef" ref="ITEL/Trama601/Proxies/calcularProvisionTrama601Local_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                              <con6:operation>calcularProvisionTrama601</con6:operation>
                              <con6:request>
                                <con6:body>$calcularProvisionTrama601Request</con6:body>
                              </con6:request>
                              <con6:response>
                                <con6:body>reglasProvisionResponse</con6:body>
                              </con6:response>
                              <con6:requestTransform>
                                <con6:assign varName="calcularProvisionTrama601Request">
                                  <con1:id>_ActionId-4807539232795849436--2019c98a.14b08252922.-736a</con1:id>
                                  <con6:expr>
                                    <con1:xqueryTransform>
                                      <con1:resource ref="ITEL/Core/Resources/XQueries/servicioProvision_Req_calcularProvTrama601"/>
                                      <con1:param name="espospago">
                                        <con1:path>$espospago</con1:path>
                                      </con1:param>
                                      <con1:param name="codigoIN">
                                        <con1:path>data($inOrigen)</con1:path>
                                      </con1:param>
                                      <con1:param name="consultarFaFListResponse">
                                        <con1:path>$consultarFaFListResponse</con1:path>
                                      </con1:param>
                                      <con1:param name="balancesOCS">
                                        <con1:path>$balancesResponse</con1:path>
                                      </con1:param>
                                      <con1:param name="datosOCS">
                                        <con1:path>$suscriptorOCSResponse</con1:path>
                                      </con1:param>
                                      <con1:param name="parametrosEntrada">
                                        <con1:path>$body/ser:Input_Parameters</con1:path>
                                      </con1:param>
                                      <con1:param name="categoria">
                                        <con1:path>$categoria</con1:path>
                                      </con1:param>
                                      <con1:param name="serviceClass">
                                        <con1:path>$serviceClass</con1:path>
                                      </con1:param>
                                    </con1:xqueryTransform>
                                  </con6:expr>
                                </con6:assign>
                              </con6:requestTransform>
                              <con6:responseTransform>
                                <con1:ifThenElse xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config" xmlns:con2="http://www.bea.com/wli/sb/stages/config">
                                  <con2:id>_ActionId-2407471842295814505--34f1d1b.15315211157.-7ee7</con2:id>
                                  <con1:case>
                                    <con1:condition>
                                      <con2:xqueryText>$reglasProvisionResponse/CODIGO/text() != "1"</con2:xqueryText>
                                    </con1:condition>
                                    <con1:actions>
                                      <con1:assign varName="codigoError">
                                        <con2:id>_ActionId-2407471842295814505--34f1d1b.15315211157.-7ee6</con2:id>
                                        <con1:expr>
                                          <con2:xqueryText>$reglasProvisionResponse/CODIGO/text()</con2:xqueryText>
                                        </con1:expr>
                                      </con1:assign>
                                    </con1:actions>
                                  </con1:case>
                                  <con1:default/>
                                </con1:ifThenElse>
                              </con6:responseTransform>
                            </con6:wsCallout>
                          </con6:actions>
                        </con6:case>
                        <con6:default/>
                      </con6:ifThenElse>
                    </con1:actions>
                  </con1:case>
                  <con1:case>
                    <con1:condition>
                      <con2:xqueryText>data($body/*:Input_Parameters/METODO)= '301'</con2:xqueryText>
                    </con1:condition>
                    <con1:actions>
                      <con1:wsCallout>
                        <con2:id>_ActionId-1269905822078885281--c6ba012.153067f54b3.-7726</con2:id>
                        <con1:service xsi:type="ref:ProxyRef" ref="ITEL/OCS/SOI/Proxies/consultarSuscriptorOCSLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                        <con1:operation>consultarSuscriptorOCS</con1:operation>
                        <con1:request>
                          <con1:body>$suscriptorOCSRequest</con1:body>
                        </con1:request>
                        <con1:response>
                          <con1:body>suscriptorOCSResponse</con1:body>
                        </con1:response>
                        <con1:requestTransform>
                          <con1:assign varName="suscriptorOCSRequest">
                            <con2:id>_ActionId-1269905822078885281--c6ba012.153067f54b3.-770b</con2:id>
                            <con1:expr>
                              <con2:xqueryTransform>
                                <con2:resource ref="ITEL/Core/Resources/XQueries/consultarSuscriptorOCSPS_Req"/>
                                <con2:param name="timeout">
                                  <con2:path>2000</con2:path>
                                </con2:param>
                                <con2:param name="in">
                                  <con2:path>"51"</con2:path>
                                </con2:param>
                                <con2:param name="min">
                                  <con2:path>$min</con2:path>
                                </con2:param>
                              </con2:xqueryTransform>
                            </con1:expr>
                          </con1:assign>
                        </con1:requestTransform>
                        <con1:responseTransform>
                          <con1:ifThenElse>
                            <con2:id>_ActionId-1269905822078885281--c6ba012.153067f54b3.-76b2</con2:id>
                            <con1:case>
                              <con1:condition>
                                <con2:xqueryText>data($suscriptorOCSResponse/CODIGO) = '1'</con2:xqueryText>
                              </con1:condition>
                              <con1:actions>
                                <con1:assign varName="accgrpid">
                                  <con2:id>_ActionId-1269905822078885281--c6ba012.153067f54b3.-70a3</con2:id>
                                  <con1:expr>
                                    <con2:xqueryText>data($suscriptorOCSResponse/MENSAJE/CONSULTAR_SUSCRIPTOR/*:suscriptor/*:AccountGroupID)</con2:xqueryText>
                                  </con1:expr>
                                </con1:assign>
                                <con1:assign varName="sc">
                                  <con2:id>_ActionId-1269905822078885281--c6ba012.153067f54b3.-708d</con2:id>
                                  <con1:expr>
                                    <con2:xqueryText>number(data($suscriptorOCSResponse/MENSAJE/CONSULTAR_SUSCRIPTOR/*:suscriptor/*:PublicRatePlanCode))</con2:xqueryText>
                                  </con1:expr>
                                </con1:assign>
                              </con1:actions>
                            </con1:case>
                            <con1:default>
                              <con1:assign varName="codigoError">
                                <con2:id>_ActionId-1269905822078885281--c6ba012.153067f54b3.-769d</con2:id>
                                <con1:expr>
                                  <con2:xqueryText>data($suscriptorOCSResponse/CODIGO)</con2:xqueryText>
                                </con1:expr>
                              </con1:assign>
                            </con1:default>
                          </con1:ifThenElse>
                        </con1:responseTransform>
                      </con1:wsCallout>
                      <con1:ifThenElse>
                        <con2:id>_ActionId-1269905822078885281--c6ba012.153067f54b3.-76e0</con2:id>
                        <con1:case>
                          <con1:condition>
                            <con2:xqueryText>$codigoError = "1"</con2:xqueryText>
                          </con1:condition>
                          <con1:actions>
                            <con1:wsCallout>
                              <con2:id>_ActionId-1269905822078885281--c6ba012.153067f54b3.-76cb</con2:id>
                              <con1:service xsi:type="ref:ProxyRef" ref="ITEL/Core/Proxies/consultarFAFIDVigenciaLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                              <con1:operation>consultarFAFIDVigencia</con1:operation>
                              <con1:request>
                                <con1:body>$fafIdVigenciaRequest</con1:body>
                              </con1:request>
                              <con1:response>
                                <con1:body>fafIdVigenciaResponse</con1:body>
                              </con1:response>
                              <con1:requestTransform>
                                <con1:assign varName="fafIdVigenciaRequest">
                                  <con2:id>_ActionId-1269905822078885281--c6ba012.153067f54b3.-767f</con2:id>
                                  <con1:expr>
                                    <con2:xqueryTransform>
                                      <con2:resource ref="ITEL/Core/Resources/XQueries/consultarFAFIDVigenciaPS_Req"/>
                                      <con2:param name="fafIdGroup">
                                        <con2:path>data($suscriptorOCSResponse/MENSAJE/CONSULTAR_SUSCRIPTOR/*:suscriptor/*:AccountGroupID)</con2:path>
                                      </con2:param>
                                      <con2:param name="tipo">
                                        <con2:path>"ILIMITADO"</con2:path>
                                      </con2:param>
                                      <con2:param name="serviceClass">
                                        <con2:path>number(data($suscriptorOCSResponse/MENSAJE/CONSULTAR_SUSCRIPTOR/*:suscriptor/*:PublicRatePlanCode))</con2:path>
                                      </con2:param>
                                      <con2:param name="vigencia">
                                        <con2:path>data($body/ser:Input_Parameters/PARAMETROSPROVISION/PARAMETRO[NOMBRE='DIASVIGENCIA']/VALOR)</con2:path>
                                      </con2:param>
                                    </con2:xqueryTransform>
                                  </con1:expr>
                                </con1:assign>
                              </con1:requestTransform>
                              <con1:responseTransform>
                                <con1:ifThenElse>
                                  <con2:id>_ActionId-1269905822078885281--c6ba012.153067f54b3.-7663</con2:id>
                                  <con1:case>
                                    <con1:condition>
                                      <con2:xqueryText>$fafIdVigenciaResponse/CODIGO = "OK" and data($fafIdVigenciaResponse/MENSAJE/FAFID)!=""</con2:xqueryText>
                                    </con1:condition>
                                    <con1:actions>
                                      <con1:assign varName="reglasNegocioResponse">
                                        <con2:id>_ActionId-1269905822078885281--c6ba012.153067f54b3.-7641</con2:id>
                                        <con1:expr>
                                          <con2:xqueryText><![CDATA[<ns0:WS_Result xmlns:ns0="http://www.comcel.com.co/ConsultarReglas/">
	<CODIGO>1</CODIGO>
	<MENSAJE>
		<ERROR>1</ERROR>
		<ERRORDESC></ERRORDESC>
		<CONSULTASUSCRIPTOR>FALSE</CONSULTASUSCRIPTOR>
		<PARAMETROS>
			<PARAMETRO>
				<NOMBRE>FAFID</NOMBRE>
				<TIPO>string</TIPO>
				<VALOR>{ data($fafIdVigenciaResponse/MENSAJE/FAFID) }</VALOR>
			</PARAMETRO>
			<PARAMETRO>
				<NOMBRE>VIGENCIA_DEFECTO</NOMBRE>
				<TIPO>string</TIPO>
				<VALOR>{ data($body/ser:Input_Parameters/PARAMETROSPROVISION/PARAMETRO[NOMBRE='DIASVIGENCIA']/VALOR) }</VALOR>
			</PARAMETRO>
		</PARAMETROS>
	</MENSAJE>
</ns0:WS_Result>]]></con2:xqueryText>
                                        </con1:expr>
                                      </con1:assign>
                                    </con1:actions>
                                  </con1:case>
                                  <con1:case>
                                    <con1:condition>
                                      <con2:xqueryText>$fafIdVigenciaResponse/CODIGO = "OK" and data($fafIdVigenciaResponse/MENSAJE/FAFID)=""</con2:xqueryText>
                                    </con1:condition>
                                    <con1:actions>
                                      <con1:assign varName="codigoError">
                                        <con2:id>_ActionId-1269905822078885281--c6ba012.153067f54b3.-761b</con2:id>
                                        <con1:expr>
                                          <con2:xqueryText>"19"</con2:xqueryText>
                                        </con1:expr>
                                      </con1:assign>
                                    </con1:actions>
                                  </con1:case>
                                  <con1:default>
                                    <con1:assign varName="codigoError">
                                      <con2:id>_ActionId-1269905822078885281--c6ba012.153067f54b3.-7601</con2:id>
                                      <con1:expr>
                                        <con2:xqueryText>"909"</con2:xqueryText>
                                      </con1:expr>
                                    </con1:assign>
                                  </con1:default>
                                </con1:ifThenElse>
                              </con1:responseTransform>
                            </con1:wsCallout>
                          </con1:actions>
                        </con1:case>
                        <con1:default/>
                      </con1:ifThenElse>
                      <con1:ifThenElse>
                        <con2:id>_ActionId-1269905822078885281--c6ba012.153067f54b3.-75b0</con2:id>
                        <con1:case>
                          <con1:condition>
                            <con2:xqueryText>$codigoError = "1"</con2:xqueryText>
                          </con1:condition>
                          <con1:actions>
                            <con1:wsCallout>
                              <con2:id>_ActionId-1269905822078885281--c6ba012.153067f54b3.-758d</con2:id>
                              <con1:service xsi:type="ref:ProxyRef" ref="ITEL/OCS/AIR/Proxies/consultarFaFListOCSLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                              <con1:operation>consultarFaFList</con1:operation>
                              <con1:request>
                                <con1:body>$consultarFaFListRequest</con1:body>
                              </con1:request>
                              <con1:response>
                                <con1:body>consultarFaFListResponse</con1:body>
                              </con1:response>
                              <con1:requestTransform>
                                <con1:assign varName="consultarFaFListRequest">
                                  <con2:id>_ActionId-1269905822078885281--c6ba012.153067f54b3.-757b</con2:id>
                                  <con1:expr>
                                    <con2:xqueryTransform>
                                      <con2:resource ref="ITEL/Core/Resources/XQueries/consultarFaFListPS_Req"/>
                                      <con2:param name="min">
                                        <con2:path>$min</con2:path>
                                      </con2:param>
                                    </con2:xqueryTransform>
                                  </con1:expr>
                                </con1:assign>
                              </con1:requestTransform>
                              <con1:responseTransform>
                                <con1:ifThenElse>
                                  <con2:id>_ActionId-1269905822078885281--c6ba012.153067f54b3.-7556</con2:id>
                                  <con1:case>
                                    <con1:condition>
                                      <con2:xqueryText>data($consultarFaFListResponse/CODIGO) != '1'</con2:xqueryText>
                                    </con1:condition>
                                    <con1:actions>
                                      <con1:assign varName="codigoError">
                                        <con2:id>_ActionId-1269905822078885281--c6ba012.153067f54b3.-7530</con2:id>
                                        <con1:expr>
                                          <con2:xqueryText>data($consultarFaFListResponse/CODIGO)</con2:xqueryText>
                                        </con1:expr>
                                      </con1:assign>
                                    </con1:actions>
                                  </con1:case>
                                  <con1:default/>
                                </con1:ifThenElse>
                              </con1:responseTransform>
                            </con1:wsCallout>
                          </con1:actions>
                        </con1:case>
                        <con1:default/>
                      </con1:ifThenElse>
                      <con1:ifThenElse>
                        <con2:id>_ActionId-1269905822078885281--c6ba012.153067f54b3.-7515</con2:id>
                        <con1:case>
                          <con1:condition>
                            <con2:xqueryText>$codigoError = "1"</con2:xqueryText>
                          </con1:condition>
                          <con1:actions>
                            <con1:wsCallout>
                              <con2:id>_ActionId-1269905822078885281--c6ba012.153067f54b3.-74ec</con2:id>
                              <con1:service xsi:type="ref:ProxyRef" ref="ITEL/OCS/AIR/Proxies/consultarOfferOCSLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                              <con1:operation>consultarOffer</con1:operation>
                              <con1:request>
                                <con1:body>$consultarOfferRequest</con1:body>
                              </con1:request>
                              <con1:response>
                                <con1:body>consultarOfferResponse</con1:body>
                              </con1:response>
                              <con1:requestTransform>
                                <con1:assign varName="consultarOfferRequest">
                                  <con2:id>_ActionId-1269905822078885281--c6ba012.153067f54b3.-74cc</con2:id>
                                  <con1:expr>
                                    <con2:xqueryTransform>
                                      <con2:resource ref="ITEL/Core/Resources/XQueries/consultarOfferPS_Req"/>
                                      <con2:param name="min">
                                        <con2:path>$min</con2:path>
                                      </con2:param>
                                    </con2:xqueryTransform>
                                  </con1:expr>
                                </con1:assign>
                              </con1:requestTransform>
                              <con1:responseTransform>
                                <con1:ifThenElse>
                                  <con2:id>_ActionId-1269905822078885281--c6ba012.153067f54b3.-74b1</con2:id>
                                  <con1:case>
                                    <con1:condition>
                                      <con2:xqueryText>data($consultarOfferResponse/CODIGO) != '1'</con2:xqueryText>
                                    </con1:condition>
                                    <con1:actions>
                                      <con1:assign varName="codigoError">
                                        <con2:id>_ActionId-1269905822078885281--c6ba012.153067f54b3.-7490</con2:id>
                                        <con1:expr>
                                          <con2:xqueryText>data($consultarOfferResponse/CODIGO)</con2:xqueryText>
                                        </con1:expr>
                                      </con1:assign>
                                    </con1:actions>
                                  </con1:case>
                                  <con1:default/>
                                </con1:ifThenElse>
                              </con1:responseTransform>
                            </con1:wsCallout>
                          </con1:actions>
                        </con1:case>
                        <con1:default/>
                      </con1:ifThenElse>
                      <con1:ifThenElse>
                        <con2:id>_ActionId-1269905822078885281--c6ba012.153067f54b3.-7475</con2:id>
                        <con1:case>
                          <con1:condition>
                            <con2:xqueryText>$codigoError = "1" and 
fn:exists($consultarFaFListResponse/MENSAJE/CONSULTAR_FAFLIST/fafInformationList/Detail/fafIndicator)</con2:xqueryText>
                          </con1:condition>
                          <con1:actions>
                            <con1:wsCallout>
                              <con2:id>_ActionId-1269905822078885281--c6ba012.153067f54b3.-745a</con2:id>
                              <con1:service xsi:type="ref:ProxyRef" ref="ITEL/Core/Proxies/consultarFAFTipoLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                              <con1:operation>consultarFAFTipo</con1:operation>
                              <con1:request>
                                <con1:body>$consultarFAFTipoRequest</con1:body>
                              </con1:request>
                              <con1:response>
                                <con1:body>consultarFAFTipoResponse</con1:body>
                              </con1:response>
                              <con1:requestTransform>
                                <con1:assign varName="consultarFAFTipoRequest">
                                  <con2:id>_ActionId-1269905822078885281--c6ba012.153067f54b3.-7429</con2:id>
                                  <con1:expr>
                                    <con2:xqueryTransform>
                                      <con2:resource ref="ITEL/Core/Resources/XQueries/consultarFAFTipoPS_Req"/>
                                      <con2:param name="wS_Result1">
                                        <con2:path>$consultarFaFListResponse</con2:path>
                                      </con2:param>
                                    </con2:xqueryTransform>
                                  </con1:expr>
                                </con1:assign>
                              </con1:requestTransform>
                              <con1:responseTransform>
                                <con1:ifThenElse>
                                  <con2:id>_ActionId-1269905822078885281--c6ba012.153067f54b3.-7413</con2:id>
                                  <con1:case>
                                    <con1:condition>
                                      <con2:xqueryText>data($consultarFAFTipoResponse/CODIGO) != 'OK'</con2:xqueryText>
                                    </con1:condition>
                                    <con1:actions>
                                      <con1:assign varName="codigoError">
                                        <con2:id>_ActionId-1269905822078885281--c6ba012.153067f54b3.-73f1</con2:id>
                                        <con1:expr>
                                          <con2:xqueryText>"909"</con2:xqueryText>
                                        </con1:expr>
                                      </con1:assign>
                                    </con1:actions>
                                  </con1:case>
                                  <con1:default/>
                                </con1:ifThenElse>
                              </con1:responseTransform>
                            </con1:wsCallout>
                          </con1:actions>
                        </con1:case>
                        <con1:default/>
                      </con1:ifThenElse>
                      <con1:ifThenElse>
                        <con2:id>_ActionId-1269905822078885281--c6ba012.153067f54b3.-736a</con2:id>
                        <con1:case>
                          <con1:condition>
                            <con2:xqueryText>$codigoError = "1" and 
fn:exists($consultarFaFListResponse/MENSAJE/CONSULTAR_FAFLIST/fafInformationList/Detail/fafIndicator)</con2:xqueryText>
                          </con1:condition>
                          <con1:actions>
                            <con1:assign varName="consultarFaFListResponse">
                              <con2:id>_ActionId-1269905822078885281--c6ba012.153067f54b3.-734a</con2:id>
                              <con1:expr>
                                <con2:xqueryTransform>
                                  <con2:resource ref="ITEL/Core/Resources/XQueries/ejecutarReglasNegocio_Res_consultarFaFList"/>
                                  <con2:param name="wS_Result1">
                                    <con2:path>$consultarFAFTipoResponse</con2:path>
                                  </con2:param>
                                  <con2:param name="wS_Result2">
                                    <con2:path>$consultarFaFListResponse</con2:path>
                                  </con2:param>
                                </con2:xqueryTransform>
                              </con1:expr>
                            </con1:assign>
                          </con1:actions>
                        </con1:case>
                        <con1:default>
                          <con1:assign varName="consultarFaFListResponse">
                            <con2:id>_ActionId-1269905822078885281--c6ba012.153067f54b3.-7332</con2:id>
                            <con1:expr>
                              <con2:xqueryTransform>
                                <con2:resource ref="ITEL/Core/Resources/XQueries/ejecutarReglasNegocio_Res_consultarFaFListOffers"/>
                                <con2:param name="wS_Result1">
                                  <con2:path>$consultarOfferResponse</con2:path>
                                </con2:param>
                                <con2:param name="wS_Result2">
                                  <con2:path>$consultarFaFListResponse</con2:path>
                                </con2:param>
                              </con2:xqueryTransform>
                            </con1:expr>
                          </con1:assign>
                        </con1:default>
                      </con1:ifThenElse>
                      <con1:ifThenElse>
                        <con2:id>_ActionId-1269905822078885281--c6ba012.153067f54b3.-730d</con2:id>
                        <con1:case>
                          <con1:condition>
                            <con2:xqueryText>$codigoError = "1" and 
fn:exists($consultarFaFListResponse/MENSAJE/CONSULTAR_FAFLIST/fafInformationList/Detail)</con2:xqueryText>
                          </con1:condition>
                          <con1:actions>
                            <con1:assign varName="fafIndi">
                              <con2:id>_ActionId-1269905822078885281--c6ba012.153067f54b3.-72e6</con2:id>
                              <con1:expr>
                                <con2:xqueryText>&lt;fafIndicadors>
{
	let $fafIndicador := $consultarFaFListResponse/MENSAJE/CONSULTAR_FAFLIST/fafInformationList/Detail
	for $faf in $fafIndicador
	return 
	&lt;fafIndicador>{$faf/fafIndicator}&lt;/fafIndicador>	
	}
&lt;/fafIndicadors></con2:xqueryText>
                              </con1:expr>
                            </con1:assign>
                            <con1:foreach>
                              <con2:id>_ActionId-1269905822078885281--c6ba012.153067f54b3.-72c7</con2:id>
                              <con1:variable>fafIndi</con1:variable>
                              <con1:expression>
                                <con2:xpathText>./fafIndicador</con2:xpathText>
                              </con1:expression>
                              <con1:value-variable>control</con1:value-variable>
                              <con1:index-variable>indice</con1:index-variable>
                              <con1:total-variable>total</con1:total-variable>
                              <con1:actions>
                                <con1:ifThenElse>
                                  <con2:id>_ActionId-1269905822078885281--c6ba012.153067f54b3.-72af</con2:id>
                                  <con1:case>
                                    <con1:condition>
                                      <con2:xqueryText>contains($control, "ILIMITADO")</con2:xqueryText>
                                    </con1:condition>
                                    <con1:actions>
                                      <con1:assign varName="codigoError">
                                        <con2:id>_ActionId-1269905822078885281--c6ba012.153067f54b3.-727d</con2:id>
                                        <con1:expr>
                                          <con2:xqueryText>"923"</con2:xqueryText>
                                        </con1:expr>
                                      </con1:assign>
                                      <con2:skip>
                                        <con2:id>_ActionId-1269905822078885281--c6ba012.153067f54b3.-7267</con2:id>
                                      </con2:skip>
                                    </con1:actions>
                                  </con1:case>
                                  <con1:default/>
                                </con1:ifThenElse>
                              </con1:actions>
                            </con1:foreach>
                          </con1:actions>
                        </con1:case>
                        <con1:default/>
                      </con1:ifThenElse>
                      <con1:ifThenElse>
                        <con2:id>_ActionId-1269905822078885281--c6ba012.153067f54b3.-71de</con2:id>
                        <con1:case>
                          <con1:condition>
                            <con2:xqueryText>$codigoError = "1"</con2:xqueryText>
                          </con1:condition>
                          <con1:actions>
                            <con1:assign varName="elegidosNRN">
                              <con2:id>_ActionId-1269905822078885281--c6ba012.153067f54b3.-71bc</con2:id>
                              <con1:expr>
                                <con2:xqueryText>data($body/ser:Input_Parameters/PARAMETROSPROVISION/PARAMETRO[NOMBRE='HOSTID']/VALOR)</con2:xqueryText>
                              </con1:expr>
                            </con1:assign>
                            <con1:insert varName="reglasNegocioResponse">
                              <con2:id>_ActionId-1269905822078885281--c6ba012.153067f54b3.-7192</con2:id>
                              <con1:location>
                                <con2:xpathText>./MENSAJE/PARAMETROS</con2:xpathText>
                              </con1:location>
                              <con1:where>last-child</con1:where>
                              <con1:expr>
                                <con2:xqueryText><![CDATA[<PARAMETRO>
	<NOMBRE>ELEGIDOSNRN</NOMBRE>
	<TIPO>string</TIPO>
	<VALOR>{$elegidosNRN}</VALOR>
</PARAMETRO>]]></con2:xqueryText>
                              </con1:expr>
                            </con1:insert>
                          </con1:actions>
                        </con1:case>
                        <con1:default/>
                      </con1:ifThenElse>
                      <con1:ifThenElse>
                        <con2:id>_ActionId-1269905822078885281--c6ba012.153067f54b3.-7244</con2:id>
                        <con1:case>
                          <con1:condition>
                            <con2:xqueryText>$codigoError = "1"</con2:xqueryText>
                          </con1:condition>
                          <con1:actions>
                            <con1:wsCallout>
                              <con2:id>_ActionId-1269905822078885281--c6ba012.153067f54b3.-7217</con2:id>
                              <con1:service xsi:type="ref:ProxyRef" ref="ITEL/Trama301/Proxies/calcularProvisionTrama301Local_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                              <con1:operation>calcularProvisionTrama301</con1:operation>
                              <con1:request>
                                <con1:body>$calcularProvisionTrama301Request</con1:body>
                              </con1:request>
                              <con1:response>
                                <con1:body>reglasProvisionResponse</con1:body>
                              </con1:response>
                              <con1:requestTransform>
                                <con1:assign varName="calcularProvisionTrama301Request">
                                  <con2:id>_ActionId-1269905822078885281--c6ba012.153067f54b3.-71f1</con2:id>
                                  <con1:expr>
                                    <con2:xqueryTransform>
                                      <con2:resource ref="ITEL/Core/Resources/XQueries/servicioProvision_Req_calcularProvTrama301"/>
                                      <con2:param name="parametros">
                                        <con2:path>$reglasNegocioResponse</con2:path>
                                      </con2:param>
                                      <con2:param name="codigoIN">
                                        <con2:path>data($inOrigen)</con2:path>
                                      </con2:param>
                                      <con2:param name="parametrosEntrada">
                                        <con2:path>$body/ser:Input_Parameters</con2:path>
                                      </con2:param>
                                    </con2:xqueryTransform>
                                  </con1:expr>
                                </con1:assign>
                              </con1:requestTransform>
                              <con1:responseTransform>
                                <con1:ifThenElse>
                                  <con2:id>_ActionId-2407471842295814505--34f1d1b.15315211157.-7f21</con2:id>
                                  <con1:case>
                                    <con1:condition>
                                      <con2:xqueryText>$reglasProvisionResponse/CODIGO/text() != "1"</con2:xqueryText>
                                    </con1:condition>
                                    <con1:actions>
                                      <con1:assign varName="codigoError">
                                        <con2:id>_ActionId-2407471842295814505--34f1d1b.15315211157.-7f20</con2:id>
                                        <con1:expr>
                                          <con2:xqueryText>$reglasProvisionResponse/CODIGO/text()</con2:xqueryText>
                                        </con1:expr>
                                      </con1:assign>
                                    </con1:actions>
                                  </con1:case>
                                  <con1:default/>
                                </con1:ifThenElse>
                              </con1:responseTransform>
                            </con1:wsCallout>
                          </con1:actions>
                        </con1:case>
                        <con1:default/>
                      </con1:ifThenElse>
                    </con1:actions>
                  </con1:case>
                  <con1:case>
                    <con1:condition>
                      <con2:xqueryText>data($body/*:Input_Parameters/METODO)= '302'</con2:xqueryText>
                    </con1:condition>
                    <con1:actions>
                      <con1:wsCallout>
                        <con2:id>_ActionId-1269905822078885281--c6ba012.153067f54b3.-6e05</con2:id>
                        <con1:service xsi:type="ref:ProxyRef" ref="ITEL/Core/Proxies/consultarTipoFAFLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                        <con1:operation>consultarTipoFAF</con1:operation>
                        <con1:request>
                          <con1:body>$tipoFAFRequest</con1:body>
                        </con1:request>
                        <con1:response>
                          <con1:body>tipoFAFResponse</con1:body>
                        </con1:response>
                        <con1:requestTransform>
                          <con1:assign varName="tipoFAFRequest">
                            <con2:id>_ActionId-1269905822078885281--c6ba012.153067f54b3.-6dee</con2:id>
                            <con1:expr>
                              <con2:xqueryTransform>
                                <con2:resource ref="ITEL/Core/Resources/XQueries/consultarTipoFAFPS_Req"/>
                                <con2:param name="tipo">
                                  <con2:path>"ILIMITADO"</con2:path>
                                </con2:param>
                              </con2:xqueryTransform>
                            </con1:expr>
                          </con1:assign>
                        </con1:requestTransform>
                        <con1:responseTransform>
                          <con1:ifThenElse>
                            <con2:id>_ActionId-1269905822078885281--c6ba012.153067f54b3.-6d52</con2:id>
                            <con1:case>
                              <con1:condition>
                                <con2:xqueryText>$tipoFAFResponse/CODIGO != "OK"</con2:xqueryText>
                              </con1:condition>
                              <con1:actions>
                                <con1:assign varName="codigoError">
                                  <con2:id>_ActionId-1269905822078885281--c6ba012.153067f54b3.-6d25</con2:id>
                                  <con1:expr>
                                    <con2:xqueryText>"912"</con2:xqueryText>
                                  </con1:expr>
                                </con1:assign>
                              </con1:actions>
                            </con1:case>
                            <con1:default/>
                          </con1:ifThenElse>
                        </con1:responseTransform>
                      </con1:wsCallout>
                      <con1:ifThenElse>
                        <con2:id>_ActionId-1269905822078885281--c6ba012.153067f54b3.-6d0c</con2:id>
                        <con1:case>
                          <con1:condition>
                            <con2:xqueryText>$codigoError = "1"</con2:xqueryText>
                          </con1:condition>
                          <con1:actions>
                            <con1:wsCallout>
                              <con2:id>_ActionId-1269905822078885281--c6ba012.153067f54b3.-6d04</con2:id>
                              <con1:service xsi:type="ref:ProxyRef" ref="ITEL/Core/Proxies/consultarModificacionElegidosLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                              <con1:operation>consultarModificacionElegidos</con1:operation>
                              <con1:request>
                                <con1:body>$consultarModificacionElegidosRequest</con1:body>
                              </con1:request>
                              <con1:response>
                                <con1:body>consultarModificacionElegidosResponse</con1:body>
                              </con1:response>
                              <con1:requestTransform>
                                <con1:assign varName="consultarModificacionElegidosRequest">
                                  <con2:id>_ActionId-1269905822078885281--c6ba012.153067f54b3.-6d07</con2:id>
                                  <con1:expr>
                                    <con2:xqueryTransform>
                                      <con2:resource ref="ITEL/Core/Resources/XQueries/servicioProvision_Req_consultarModificacionElegidos"/>
                                      <con2:param name="min">
                                        <con2:path>data($body/ser:Input_Parameters/MIN)</con2:path>
                                      </con2:param>
                                    </con2:xqueryTransform>
                                  </con1:expr>
                                </con1:assign>
                              </con1:requestTransform>
                              <con1:responseTransform>
                                <con1:ifThenElse>
                                  <con2:id>_ActionId-1269905822078885281--c6ba012.153067f54b3.-6ce0</con2:id>
                                  <con1:case>
                                    <con1:condition>
                                      <con2:xqueryText>data($consultarModificacionElegidosResponse/CODIGO) != '1'</con2:xqueryText>
                                    </con1:condition>
                                    <con1:actions>
                                      <con1:assign varName="codigoError">
                                        <con2:id>_ActionId-1269905822078885281--c6ba012.153067f54b3.-6c6f</con2:id>
                                        <con1:expr>
                                          <con2:xqueryText>"912"</con2:xqueryText>
                                        </con1:expr>
                                      </con1:assign>
                                    </con1:actions>
                                  </con1:case>
                                  <con1:default>
                                    <con1:insert varName="body">
                                      <con2:id>_ActionId-1269905822078885281--c6ba012.153067f54b3.-6c6d</con2:id>
                                      <con1:location>
                                        <con2:xpathText>./ser:Input_Parameters/PARAMETROSPROVISION</con2:xpathText>
                                      </con1:location>
                                      <con1:where>last-child</con1:where>
                                      <con1:expr>
                                        <con2:xqueryText><![CDATA[<PARAMETRO>
	<NOMBRE>CANTIDAD_MODIFICACION_ELEGIDOS</NOMBRE>
	<TIPO>decimal</TIPO>
	<VALOR>{ $consultarModificacionElegidosResponse/*:MENSAJE/*:CANTIDAD_MODIFICACION_ELEGIDOS/text() }</VALOR>
</PARAMETRO>]]></con2:xqueryText>
                                      </con1:expr>
                                    </con1:insert>
                                    <con1:insert varName="body">
                                      <con2:id>_ActionId-1269905822078885281--c6ba012.153067f54b3.-6c6b</con2:id>
                                      <con1:location>
                                        <con2:xpathText>./ser:Input_Parameters/PARAMETROSPROVISION</con2:xpathText>
                                      </con1:location>
                                      <con1:where>last-child</con1:where>
                                      <con1:expr>
                                        <con2:xqueryText><![CDATA[<PARAMETRO>
	<NOMBRE>ELEGIDOS_MODIFICADOS</NOMBRE>
	<TIPO>decimal</TIPO>
	<VALOR>{ $consultarModificacionElegidosResponse/*:MENSAJE/*:ELEGIDOS_MODIFICADOS/text() }</VALOR>
</PARAMETRO>]]></con2:xqueryText>
                                      </con1:expr>
                                    </con1:insert>
                                  </con1:default>
                                </con1:ifThenElse>
                              </con1:responseTransform>
                            </con1:wsCallout>
                          </con1:actions>
                        </con1:case>
                        <con1:default/>
                      </con1:ifThenElse>
                      <con1:ifThenElse>
                        <con2:id>_ActionId-1269905822078885281--c6ba012.153067f54b3.-6c50</con2:id>
                        <con1:case>
                          <con1:condition>
                            <con2:xqueryText>$codigoError = "1"</con2:xqueryText>
                          </con1:condition>
                          <con1:actions>
                            <con1:wsCallout>
                              <con2:id>_ActionId-1269905822078885281--c6ba012.153067f54b3.-6c46</con2:id>
                              <con1:service xsi:type="ref:ProxyRef" ref="ITEL/OCS/AIR/Proxies/consultarFaFListOCSLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                              <con1:operation>consultarFaFList</con1:operation>
                              <con1:request>
                                <con1:body>$consultarFaFListRequest</con1:body>
                              </con1:request>
                              <con1:response>
                                <con1:body>consultarFaFListResponse</con1:body>
                              </con1:response>
                              <con1:requestTransform>
                                <con1:assign varName="consultarFaFListRequest">
                                  <con2:id>_ActionId-1269905822078885281--c6ba012.153067f54b3.-6c4a</con2:id>
                                  <con1:expr>
                                    <con2:xqueryTransform>
                                      <con2:resource ref="ITEL/Core/Resources/XQueries/consultarFaFListPS_Req"/>
                                      <con2:param name="min">
                                        <con2:path>data($body/ser:Input_Parameters/MIN)</con2:path>
                                      </con2:param>
                                    </con2:xqueryTransform>
                                  </con1:expr>
                                </con1:assign>
                              </con1:requestTransform>
                              <con1:responseTransform>
                                <con1:ifThenElse>
                                  <con2:id>_ActionId-1269905822078885281--c6ba012.153067f54b3.-6c49</con2:id>
                                  <con1:case>
                                    <con1:condition>
                                      <con2:xqueryText>data($consultarFaFListResponse/CODIGO) != '1'</con2:xqueryText>
                                    </con1:condition>
                                    <con1:actions>
                                      <con1:assign varName="codigoError">
                                        <con2:id>_ActionId-1269905822078885281--c6ba012.153067f54b3.-6c48</con2:id>
                                        <con1:expr>
                                          <con2:xqueryText>data($consultarFaFListResponse/CODIGO)</con2:xqueryText>
                                        </con1:expr>
                                      </con1:assign>
                                    </con1:actions>
                                  </con1:case>
                                  <con1:default>
                                    <con1:assign varName="fafID">
                                      <con2:id>_ActionId-1269905822078885281--c6ba012.153067f54b3.-6c47</con2:id>
                                      <con1:expr>
                                        <con2:xqueryTransform>
                                          <con2:resource ref="ITEL/Core/Resources/XQueries/obtenerFAFID"/>
                                          <con2:param name="metodoFAF">
                                            <con2:path>$tipoFAFResponse</con2:path>
                                          </con2:param>
                                          <con2:param name="fafList">
                                            <con2:path>$consultarFaFListResponse</con2:path>
                                          </con2:param>
                                        </con2:xqueryTransform>
                                      </con1:expr>
                                    </con1:assign>
                                    <con1:ifThenElse>
                                      <con2:id>_ActionId-1269905822078885281--c6ba012.153067f54b3.-6bb0</con2:id>
                                      <con1:case>
                                        <con1:condition>
                                          <con2:xqueryText>$fafID=""</con2:xqueryText>
                                        </con1:condition>
                                        <con1:actions>
                                          <con1:assign varName="codigoError">
                                            <con2:id>_ActionId-1269905822078885281--c6ba012.153067f54b3.-6b8a</con2:id>
                                            <con1:expr>
                                              <con2:xqueryText>"924"</con2:xqueryText>
                                            </con1:expr>
                                          </con1:assign>
                                        </con1:actions>
                                      </con1:case>
                                      <con1:default>
                                        <con1:assign varName="reglasNegocioResponse">
                                          <con2:id>_ActionId-1269905822078885281--c6ba012.153067f54b3.-6b74</con2:id>
                                          <con1:expr>
                                            <con2:xqueryText><![CDATA[<ns0:WS_Result xmlns:ns0="http://www.comcel.com.co/ConsultarReglas/">
	<CODIGO>1</CODIGO>
	<MENSAJE>
		<ERROR>1</ERROR>
		<ERRORDESC></ERRORDESC>
		<CONSULTASUSCRIPTOR>FALSE</CONSULTASUSCRIPTOR>
		<PARAMETROS>
			<PARAMETRO>
				<NOMBRE>FAFID</NOMBRE>
				<TIPO>string</TIPO>
				<VALOR>{ $fafID }</VALOR>
			</PARAMETRO>
		</PARAMETROS>
	</MENSAJE>
</ns0:WS_Result>]]></con2:xqueryText>
                                          </con1:expr>
                                        </con1:assign>
                                      </con1:default>
                                    </con1:ifThenElse>
                                  </con1:default>
                                </con1:ifThenElse>
                              </con1:responseTransform>
                            </con1:wsCallout>
                          </con1:actions>
                        </con1:case>
                        <con1:default/>
                      </con1:ifThenElse>
                      <con1:assign varName="elegidosNRN">
                        <con2:id>_ActionId-1269905822078885281--c6ba012.153067f54b3.-6c1f</con2:id>
                        <con1:expr>
                          <con2:xqueryText>data($body/ser:Input_Parameters/PARAMETROSPROVISION/PARAMETRO[NOMBRE='HOSTID']/VALOR)</con2:xqueryText>
                        </con1:expr>
                      </con1:assign>
                      <con1:insert varName="reglasNegocioResponse">
                        <con2:id>_ActionId-1269905822078885281--c6ba012.153067f54b3.-6c10</con2:id>
                        <con1:location>
                          <con2:xpathText>./MENSAJE/PARAMETROS</con2:xpathText>
                        </con1:location>
                        <con1:where>last-child</con1:where>
                        <con1:expr>
                          <con2:xqueryText><![CDATA[<PARAMETRO>
	<NOMBRE>ELEGIDOSNRN</NOMBRE>
	<TIPO>string</TIPO>
	<VALOR>{$elegidosNRN}</VALOR>
</PARAMETRO>]]></con2:xqueryText>
                        </con1:expr>
                      </con1:insert>
                      <con1:ifThenElse>
                        <con2:id>_ActionId-1269905822078885281--c6ba012.153067f54b3.-6a92</con2:id>
                        <con1:case>
                          <con1:condition>
                            <con2:xqueryText>$codigoError = "1"</con2:xqueryText>
                          </con1:condition>
                          <con1:actions>
                            <con1:wsCallout>
                              <con2:id>_ActionId-1269905822078885281--c6ba012.153067f54b3.-6a8e</con2:id>
                              <con1:service xsi:type="ref:ProxyRef" ref="ITEL/OCS/SOI/Proxies/consultarSuscriptorOCSLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                              <con1:operation>consultarSuscriptorOCS</con1:operation>
                              <con1:request>
                                <con1:body>$suscriptorOCSRequest</con1:body>
                              </con1:request>
                              <con1:response>
                                <con1:body>suscriptorOCSResponse</con1:body>
                              </con1:response>
                              <con1:requestTransform>
                                <con1:assign varName="suscriptorOCSRequest">
                                  <con2:id>_ActionId-1269905822078885281--c6ba012.153067f54b3.-6a8f</con2:id>
                                  <con1:expr>
                                    <con2:xqueryTransform>
                                      <con2:resource ref="ITEL/Core/Resources/XQueries/consultarSuscriptorOCSPS_Req"/>
                                      <con2:param name="timeout">
                                        <con2:path>2000</con2:path>
                                      </con2:param>
                                      <con2:param name="in">
                                        <con2:path>"51"</con2:path>
                                      </con2:param>
                                      <con2:param name="min">
                                        <con2:path>$min</con2:path>
                                      </con2:param>
                                    </con2:xqueryTransform>
                                  </con1:expr>
                                </con1:assign>
                              </con1:requestTransform>
                              <con1:responseTransform>
                                <con1:ifThenElse>
                                  <con2:id>_ActionId-1269905822078885281--c6ba012.153067f54b3.-6a77</con2:id>
                                  <con1:case>
                                    <con1:condition>
                                      <con2:xqueryText>data($suscriptorOCSResponse/CODIGO) = '1'</con2:xqueryText>
                                    </con1:condition>
                                    <con1:actions>
                                      <con1:assign varName="accgrpid">
                                        <con2:id>_ActionId-2407471842295814505--34f1d1b.15315211157.-7e42</con2:id>
                                        <con1:expr>
                                          <con2:xqueryText>data($suscriptorOCSResponse/MENSAJE/CONSULTAR_SUSCRIPTOR/*:suscriptor/*:AccountGroupID)</con2:xqueryText>
                                        </con1:expr>
                                      </con1:assign>
                                      <con1:assign varName="sc">
                                        <con2:id>_ActionId-1269905822078885281--c6ba012.153067f54b3.-6a4e</con2:id>
                                        <con1:expr>
                                          <con2:xqueryText>data($suscriptorOCSResponse/MENSAJE/CONSULTAR_SUSCRIPTOR/*:suscriptor/*:PublicRatePlanCode)</con2:xqueryText>
                                        </con1:expr>
                                      </con1:assign>
                                    </con1:actions>
                                  </con1:case>
                                  <con1:default>
                                    <con1:assign varName="codigoError">
                                      <con2:id>_ActionId-1269905822078885281--c6ba012.153067f54b3.-6a37</con2:id>
                                      <con1:expr>
                                        <con2:xqueryText>data($suscriptorOCSResponse/CODIGO)</con2:xqueryText>
                                      </con1:expr>
                                    </con1:assign>
                                  </con1:default>
                                </con1:ifThenElse>
                              </con1:responseTransform>
                            </con1:wsCallout>
                          </con1:actions>
                        </con1:case>
                        <con1:default/>
                      </con1:ifThenElse>
                      <con1:ifThenElse>
                        <con2:id>_ActionId-1269905822078885281--c6ba012.153067f54b3.-6b4f</con2:id>
                        <con1:case>
                          <con1:condition>
                            <con2:xqueryText>$codigoError = "1"</con2:xqueryText>
                          </con1:condition>
                          <con1:actions>
                            <con1:wsCallout>
                              <con2:id>_ActionId-1269905822078885281--c6ba012.153067f54b3.-6b28</con2:id>
                              <con1:service xsi:type="ref:ProxyRef" ref="ITEL/Core/Proxies/consultarContratoEsPostpagoLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                              <con1:operation>consultarContratoEsPostpago</con1:operation>
                              <con1:request>
                                <con1:body>$consultarContratoEsPospagoRequest</con1:body>
                              </con1:request>
                              <con1:response>
                                <con1:body>consultarContratoEsPospagoResponse</con1:body>
                              </con1:response>
                              <con1:requestTransform>
                                <con1:assign varName="consultarContratoEsPospagoRequest">
                                  <con2:id>_ActionId-1269905822078885281--c6ba012.153067f54b3.-6b0e</con2:id>
                                  <con1:expr>
                                    <con2:xqueryText>&lt;con:Input_Parameters xmlns:con="http://www.comcel.com.co/ConsultarContractEsPostPago">
    &lt;con:CONTRACT>{ data($sc) }&lt;/con:CONTRACT>
&lt;/con:Input_Parameters></con2:xqueryText>
                                  </con1:expr>
                                </con1:assign>
                              </con1:requestTransform>
                              <con1:responseTransform>
                                <con1:ifThenElse>
                                  <con2:id>_ActionId-1269905822078885281--c6ba012.153067f54b3.-6a10</con2:id>
                                  <con1:case>
                                    <con1:condition>
                                      <con2:xqueryText>data($consultarContratoEsPospagoResponse/CODIGO) = '1'</con2:xqueryText>
                                    </con1:condition>
                                    <con1:actions/>
                                  </con1:case>
                                  <con1:default>
                                    <con1:assign varName="codigoError">
                                      <con2:id>_ActionId-1269905822078885281--c6ba012.153067f54b3.-69fe</con2:id>
                                      <con1:expr>
                                        <con2:xqueryText>data($suscriptorOCSResponse/CODIGO)</con2:xqueryText>
                                      </con1:expr>
                                    </con1:assign>
                                  </con1:default>
                                </con1:ifThenElse>
                              </con1:responseTransform>
                            </con1:wsCallout>
                          </con1:actions>
                        </con1:case>
                        <con1:default/>
                      </con1:ifThenElse>
                      <con1:ifThenElse>
                        <con2:id>_ActionId-1269905822078885281--c6ba012.153067f54b3.-69be</con2:id>
                        <con1:case>
                          <con1:condition>
                            <con2:xqueryText>$codigoError = "1" and fn:exists($consultarFaFListResponse/MENSAJE/CONSULTAR_FAFLIST/fafInformationList/Detail/fafIndicator)</con2:xqueryText>
                          </con1:condition>
                          <con1:actions>
                            <con1:wsCallout>
                              <con2:id>_ActionId-1269905822078885281--c6ba012.153067f54b3.-6998</con2:id>
                              <con1:service xsi:type="ref:ProxyRef" ref="ITEL/Core/Proxies/consultarFAFTipoLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                              <con1:operation>consultarFAFTipo</con1:operation>
                              <con1:request>
                                <con1:body>$consultarFAFTipoRequest</con1:body>
                              </con1:request>
                              <con1:response>
                                <con1:body>consultarFAFTipoResponse</con1:body>
                              </con1:response>
                              <con1:requestTransform>
                                <con1:assign varName="consultarFAFTipoRequest">
                                  <con2:id>_ActionId-1269905822078885281--c6ba012.153067f54b3.-698a</con2:id>
                                  <con1:expr>
                                    <con2:xqueryTransform>
                                      <con2:resource ref="ITEL/Core/Resources/XQueries/consultarFAFTipoPS_Req"/>
                                      <con2:param name="wS_Result1">
                                        <con2:path>$consultarFaFListResponse</con2:path>
                                      </con2:param>
                                    </con2:xqueryTransform>
                                  </con1:expr>
                                </con1:assign>
                              </con1:requestTransform>
                              <con1:responseTransform>
                                <con1:ifThenElse>
                                  <con2:id>_ActionId-1269905822078885281--c6ba012.153067f54b3.-696f</con2:id>
                                  <con1:case>
                                    <con1:condition>
                                      <con2:xqueryText>data($consultarFAFTipoResponse/CODIGO) != 'OK'</con2:xqueryText>
                                    </con1:condition>
                                    <con1:actions>
                                      <con1:assign varName="codigoError">
                                        <con2:id>_ActionId-1269905822078885281--c6ba012.153067f54b3.-694c</con2:id>
                                        <con1:expr>
                                          <con2:xqueryText>"909"</con2:xqueryText>
                                        </con1:expr>
                                      </con1:assign>
                                    </con1:actions>
                                  </con1:case>
                                  <con1:default/>
                                </con1:ifThenElse>
                              </con1:responseTransform>
                            </con1:wsCallout>
                          </con1:actions>
                        </con1:case>
                        <con1:default/>
                      </con1:ifThenElse>
                      <con1:ifThenElse>
                        <con2:id>_ActionId-1269905822078885281--c6ba012.153067f54b3.-6931</con2:id>
                        <con1:case>
                          <con1:condition>
                            <con2:xqueryText>$codigoError = "1"</con2:xqueryText>
                          </con1:condition>
                          <con1:actions>
                            <con1:replace varName="consultarFaFListRes">
                              <con2:id>_ActionId-1269905822078885281--c6ba012.153067f54b3.-691c</con2:id>
                              <con1:expr>
                                <con2:xqueryTransform>
                                  <con2:resource ref="ITEL/Core/Resources/XQueries/ejecutarReglasNegocio_Res_consultarFaFList"/>
                                  <con2:param name="wS_Result1">
                                    <con2:path>$consultarFAFTipoResponse</con2:path>
                                  </con2:param>
                                  <con2:param name="wS_Result2">
                                    <con2:path>$consultarFaFListResponse</con2:path>
                                  </con2:param>
                                </con2:xqueryTransform>
                              </con1:expr>
                            </con1:replace>
                          </con1:actions>
                        </con1:case>
                        <con1:default>
                          <con1:wsCallout>
                            <con2:id>_ActionId-1269905822078885281--c6ba012.153067f54b3.-68eb</con2:id>
                            <con1:service xsi:type="ref:ProxyRef" ref="ITEL/OCS/AIR/Proxies/consultarOfferOCSLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                            <con1:operation>consultarOffer</con1:operation>
                            <con1:request>
                              <con1:body>$consultarOfferRequest</con1:body>
                            </con1:request>
                            <con1:response>
                              <con1:body>consultarOfferResponse</con1:body>
                            </con1:response>
                            <con1:requestTransform>
                              <con1:assign varName="consultarOfferRequest">
                                <con2:id>_ActionId-1269905822078885281--c6ba012.153067f54b3.-68dd</con2:id>
                                <con1:expr>
                                  <con2:xqueryTransform>
                                    <con2:resource ref="ITEL/Core/Resources/XQueries/consultarOfferPS_Req"/>
                                    <con2:param name="min">
                                      <con2:path>$min</con2:path>
                                    </con2:param>
                                  </con2:xqueryTransform>
                                </con1:expr>
                              </con1:assign>
                            </con1:requestTransform>
                            <con1:responseTransform>
                              <con1:ifThenElse>
                                <con2:id>_ActionId-1269905822078885281--c6ba012.153067f54b3.-68c8</con2:id>
                                <con1:case>
                                  <con1:condition>
                                    <con2:xqueryText>data($consultarOfferResponse/CODIGO) != '1'</con2:xqueryText>
                                  </con1:condition>
                                  <con1:actions>
                                    <con1:assign varName="codigoError">
                                      <con2:id>_ActionId-1269905822078885281--c6ba012.153067f54b3.-68b9</con2:id>
                                      <con1:expr>
                                        <con2:xqueryText>data($consultarOfferResponse/CODIGO)</con2:xqueryText>
                                      </con1:expr>
                                    </con1:assign>
                                  </con1:actions>
                                </con1:case>
                                <con1:default/>
                              </con1:ifThenElse>
                            </con1:responseTransform>
                          </con1:wsCallout>
                          <con1:replace varName="consultarFaFListRes">
                            <con2:id>_ActionId-1269905822078885281--c6ba012.153067f54b3.-68ae</con2:id>
                            <con1:expr>
                              <con2:xqueryTransform>
                                <con2:resource ref="ITEL/Core/Resources/XQueries/ejecutarReglasNegocio_Res_consultarFaFListOffers"/>
                                <con2:param name="wS_Result1">
                                  <con2:path>$consultarOfferResponse</con2:path>
                                </con2:param>
                                <con2:param name="wS_Result2">
                                  <con2:path>$consultarFaFListResponse</con2:path>
                                </con2:param>
                              </con2:xqueryTransform>
                            </con1:expr>
                          </con1:replace>
                        </con1:default>
                      </con1:ifThenElse>
                      <con1:insert varName="reglasNegocioResponse">
                        <con2:id>_ActionId-1269905822078885281--c6ba012.153067f54b3.-689e</con2:id>
                        <con1:location>
                          <con2:xpathText>./*:MENSAJE/*:PARAMETROS</con2:xpathText>
                        </con1:location>
                        <con1:where>last-child</con1:where>
                        <con1:expr>
                          <con2:xqueryText><![CDATA[<PARAMETRO>
	<NOMBRE>CANTIDAD_MODIFICACION_ELEGIDOS</NOMBRE>
	<TIPO>decimal</TIPO>
	<VALOR>{ $body/ser:Input_Parameters/PARAMETROSPROVISION/PARAMETRO[NOMBRE='CANTIDAD_MODIFICACION_ELEGIDOS']/VALOR/text() }</VALOR>
</PARAMETRO>]]></con2:xqueryText>
                        </con1:expr>
                      </con1:insert>
                      <con1:insert varName="reglasNegocioResponse">
                        <con2:id>_ActionId-1269905822078885281--c6ba012.153067f54b3.-688f</con2:id>
                        <con1:location>
                          <con2:xpathText>./*:MENSAJE/*:PARAMETROS</con2:xpathText>
                        </con1:location>
                        <con1:where>last-child</con1:where>
                        <con1:expr>
                          <con2:xqueryText><![CDATA[<PARAMETRO>
	<NOMBRE>ELEGIDOS_MODIFICADOS</NOMBRE>
	<TIPO>decimal</TIPO>
	<VALOR>{ $body/ser:Input_Parameters/PARAMETROSPROVISION/PARAMETRO[NOMBRE='ELEGIDOS_MODIFICADOS']/VALOR/text() }</VALOR>
</PARAMETRO>]]></con2:xqueryText>
                        </con1:expr>
                      </con1:insert>
                      <con1:insert varName="reglasNegocioResponse">
                        <con2:id>_ActionId-1269905822078885281--c6ba012.153067f54b3.-6867</con2:id>
                        <con1:location>
                          <con2:xpathText>./*:MENSAJE/*:PARAMETROS</con2:xpathText>
                        </con1:location>
                        <con1:where>last-child</con1:where>
                        <con1:expr>
                          <con2:xqueryText><![CDATA[<PARAMETRO>
	<NOMBRE>ESPOSTPAGO</NOMBRE>
	<TIPO>string</TIPO>
	<VALOR>{ data($consultarContratoEsPospagoResponse/*:MENSAJE/*:ESPOSTPAGO) }</VALOR>
</PARAMETRO>]]></con2:xqueryText>
                        </con1:expr>
                      </con1:insert>
                      <con1:insert varName="reglasNegocioResponse">
                        <con2:id>_ActionId-1269905822078885281--c6ba012.153067f54b3.-684c</con2:id>
                        <con1:location>
                          <con2:xpathText>./*:MENSAJE/*:PARAMETROS</con2:xpathText>
                        </con1:location>
                        <con1:where>last-child</con1:where>
                        <con1:expr>
                          <con2:xqueryText><![CDATA[<PARAMETRO>
	<NOMBRE>FAF_TIPO</NOMBRE>
	<TIPO>string</TIPO>
	<VALOR>{ 'ILIMITADO' }</VALOR>
</PARAMETRO>]]></con2:xqueryText>
                        </con1:expr>
                      </con1:insert>
                      <con1:ifThenElse>
                        <con2:id>_ActionId-1269905822078885281--c6ba012.153067f54b3.-6c0a</con2:id>
                        <con1:case>
                          <con1:condition>
                            <con2:xqueryText>$codigoError = "1"</con2:xqueryText>
                          </con1:condition>
                          <con1:actions>
                            <con1:wsCallout>
                              <con2:id>_ActionId-1269905822078885281--c6ba012.153067f54b3.-6bf0</con2:id>
                              <con1:service xsi:type="ref:ProxyRef" ref="ITEL/Trama302/Proxies/calcularProvisionTrama302Local_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                              <con1:operation>calcularProvisionTrama302</con1:operation>
                              <con1:request>
                                <con1:body>$calcularProvisionTrama302Request</con1:body>
                              </con1:request>
                              <con1:response>
                                <con1:body>reglasProvisionResponse</con1:body>
                              </con1:response>
                              <con1:requestTransform>
                                <con1:assign varName="calcularProvisionTrama302Request">
                                  <con2:id>_ActionId-1269905822078885281--c6ba012.153067f54b3.-6bc4</con2:id>
                                  <con1:expr>
                                    <con2:xqueryTransform>
                                      <con2:resource ref="ITEL/Core/Resources/XQueries/servicioProvision_Req_calcularProvTrama302"/>
                                      <con2:param name="parametros">
                                        <con2:path>$reglasNegocioResponse</con2:path>
                                      </con2:param>
                                      <con2:param name="codigoIN">
                                        <con2:path>data($inOrigen)</con2:path>
                                      </con2:param>
                                      <con2:param name="datosOCS">
                                        <con2:path>$suscriptorOCSResponse</con2:path>
                                      </con2:param>
                                      <con2:param name="consultarFaFListResponse">
                                        <con2:path>$consultarFaFListResponse</con2:path>
                                      </con2:param>
                                      <con2:param name="parametrosEntrada">
                                        <con2:path>$body/ser:Input_Parameters</con2:path>
                                      </con2:param>
                                    </con2:xqueryTransform>
                                  </con1:expr>
                                </con1:assign>
                              </con1:requestTransform>
                              <con1:responseTransform>
                                <con1:ifThenElse>
                                  <con2:id>_ActionId-2407471842295814505--34f1d1b.15315211157.-7fe7</con2:id>
                                  <con1:case>
                                    <con1:condition>
                                      <con2:xqueryText>$reglasProvisionResponse/CODIGO/text() != "1"</con2:xqueryText>
                                    </con1:condition>
                                    <con1:actions>
                                      <con1:assign varName="codigoError">
                                        <con2:id>_ActionId-2407471842295814505--34f1d1b.15315211157.-7fc8</con2:id>
                                        <con1:expr>
                                          <con2:xqueryText>$reglasProvisionResponse/CODIGO/text()</con2:xqueryText>
                                        </con1:expr>
                                      </con1:assign>
                                    </con1:actions>
                                  </con1:case>
                                  <con1:default/>
                                </con1:ifThenElse>
                              </con1:responseTransform>
                            </con1:wsCallout>
                          </con1:actions>
                        </con1:case>
                        <con1:default/>
                      </con1:ifThenElse>
                    </con1:actions>
                  </con1:case>
                  <con1:case>
                    <con1:condition>
                      <con2:xqueryText>data($body/*:Input_Parameters/METODO)= '303'</con2:xqueryText>
                    </con1:condition>
                    <con1:actions>
                      <con1:wsCallout>
                        <con2:id>_ActionId-2861035459535817159--241919cb.153190328ed.-7e6a</con2:id>
                        <con1:service xsi:type="ref:ProxyRef" ref="ITEL/Core/Proxies/consultarTipoFAFLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                        <con1:operation>consultarTipoFAF</con1:operation>
                        <con1:request>
                          <con1:body>$tipoFAFRequest</con1:body>
                        </con1:request>
                        <con1:response>
                          <con1:body>tipoFAFResponse</con1:body>
                        </con1:response>
                        <con1:requestTransform>
                          <con1:assign varName="tipoFAFRequest">
                            <con2:id>_ActionId-2861035459535817159--241919cb.153190328ed.-7e41</con2:id>
                            <con1:expr>
                              <con2:xqueryTransform>
                                <con2:resource ref="ITEL/Core/Resources/XQueries/consultarTipoFAFPS_Req"/>
                                <con2:param name="tipo">
                                  <con2:path>"ILIMITADO"</con2:path>
                                </con2:param>
                              </con2:xqueryTransform>
                            </con1:expr>
                          </con1:assign>
                        </con1:requestTransform>
                        <con1:responseTransform>
                          <con1:ifThenElse>
                            <con2:id>_ActionId-2861035459535817159--241919cb.153190328ed.-7e28</con2:id>
                            <con1:case>
                              <con1:condition>
                                <con2:xqueryText>$tipoFAFResponse/CODIGO != "OK"</con2:xqueryText>
                              </con1:condition>
                              <con1:actions>
                                <con1:assign varName="codigoError">
                                  <con2:id>_ActionId-2861035459535817159--241919cb.153190328ed.-7e10</con2:id>
                                  <con1:expr>
                                    <con2:xqueryText>"912"</con2:xqueryText>
                                  </con1:expr>
                                </con1:assign>
                              </con1:actions>
                            </con1:case>
                            <con1:default/>
                          </con1:ifThenElse>
                        </con1:responseTransform>
                      </con1:wsCallout>
                      <con1:ifThenElse>
                        <con2:id>_ActionId-2861035459535817159--241919cb.153190328ed.-7d53</con2:id>
                        <con1:case>
                          <con1:condition>
                            <con2:xqueryText>$codigoError = "1"</con2:xqueryText>
                          </con1:condition>
                          <con1:actions>
                            <con1:wsCallout>
                              <con2:id>_ActionId-2861035459535817159--241919cb.153190328ed.-7d1d</con2:id>
                              <con1:service xsi:type="ref:ProxyRef" ref="ITEL/OCS/AIR/Proxies/consultarFaFListOCSLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                              <con1:operation>consultarFaFList</con1:operation>
                              <con1:request>
                                <con1:body>$consultarFaFListRequest</con1:body>
                              </con1:request>
                              <con1:response>
                                <con1:body>consultarFaFListResponse</con1:body>
                              </con1:response>
                              <con1:requestTransform>
                                <con1:assign varName="consultarFaFListRequest">
                                  <con2:id>_ActionId-2861035459535817159--241919cb.153190328ed.-7cfa</con2:id>
                                  <con1:expr>
                                    <con2:xqueryTransform>
                                      <con2:resource ref="ITEL/Core/Resources/XQueries/consultarFaFListPS_Req"/>
                                      <con2:param name="min">
                                        <con2:path>$min</con2:path>
                                      </con2:param>
                                    </con2:xqueryTransform>
                                  </con1:expr>
                                </con1:assign>
                              </con1:requestTransform>
                              <con1:responseTransform>
                                <con1:ifThenElse>
                                  <con2:id>_ActionId-2861035459535817159--241919cb.153190328ed.-7cdc</con2:id>
                                  <con1:case>
                                    <con1:condition>
                                      <con2:xqueryText>data($consultarFaFListResponse/CODIGO) != '1'</con2:xqueryText>
                                    </con1:condition>
                                    <con1:actions>
                                      <con1:assign varName="codigoError">
                                        <con2:id>_ActionId-2861035459535817159--241919cb.153190328ed.-7cbc</con2:id>
                                        <con1:expr>
                                          <con2:xqueryText>data($consultarFaFListResponse/CODIGO)</con2:xqueryText>
                                        </con1:expr>
                                      </con1:assign>
                                    </con1:actions>
                                  </con1:case>
                                  <con1:default>
                                    <con1:assign varName="fafID">
                                      <con2:id>_ActionId-2861035459535817159--241919cb.153190328ed.-7c9b</con2:id>
                                      <con1:expr>
                                        <con2:xqueryTransform>
                                          <con2:resource ref="ITEL/Core/Resources/XQueries/obtenerFAFID"/>
                                          <con2:param name="metodoFAF">
                                            <con2:path>$tipoFAFResponse</con2:path>
                                          </con2:param>
                                          <con2:param name="fafList">
                                            <con2:path>$consultarFaFListResponse</con2:path>
                                          </con2:param>
                                        </con2:xqueryTransform>
                                      </con1:expr>
                                    </con1:assign>
                                    <con1:ifThenElse>
                                      <con2:id>_ActionId-2861035459535817159--241919cb.153190328ed.-7c7f</con2:id>
                                      <con1:case>
                                        <con1:condition>
                                          <con2:xqueryText>$fafID=""</con2:xqueryText>
                                        </con1:condition>
                                        <con1:actions>
                                          <con1:assign varName="codigoError">
                                            <con2:id>_ActionId-2861035459535817159--241919cb.153190328ed.-7c49</con2:id>
                                            <con1:expr>
                                              <con2:xqueryText>"924"</con2:xqueryText>
                                            </con1:expr>
                                          </con1:assign>
                                        </con1:actions>
                                      </con1:case>
                                      <con1:default>
                                        <con1:assign varName="reglasNegocioResponse">
                                          <con2:id>_ActionId-2861035459535817159--241919cb.153190328ed.-7c2f</con2:id>
                                          <con1:expr>
                                            <con2:xqueryText><![CDATA[<ns0:WS_Result xmlns:ns0="http://www.comcel.com.co/ConsultarReglas/">
	<CODIGO>1</CODIGO>
	<MENSAJE>
		<ERROR>1</ERROR>
		<ERRORDESC></ERRORDESC>
		<CONSULTASUSCRIPTOR>FALSE</CONSULTASUSCRIPTOR>
		<PARAMETROS>
			<PARAMETRO>
				<NOMBRE>FAFID</NOMBRE>
				<TIPO>string</TIPO>
				<VALOR>{ $fafID }</VALOR>
			</PARAMETRO>
		</PARAMETROS>
	</MENSAJE>
</ns0:WS_Result>]]></con2:xqueryText>
                                          </con1:expr>
                                        </con1:assign>
                                      </con1:default>
                                    </con1:ifThenElse>
                                  </con1:default>
                                </con1:ifThenElse>
                              </con1:responseTransform>
                            </con1:wsCallout>
                          </con1:actions>
                        </con1:case>
                        <con1:default/>
                      </con1:ifThenElse>
                      <con1:ifThenElse>
                        <con2:id>_ActionId-2861035459535817159--241919cb.153190328ed.-7c1f</con2:id>
                        <con1:case>
                          <con1:condition>
                            <con2:xqueryText>$codigoError = "1"</con2:xqueryText>
                          </con1:condition>
                          <con1:actions>
                            <con1:wsCallout>
                              <con2:id>_ActionId-2861035459535817159--241919cb.153190328ed.-7bf1</con2:id>
                              <con1:service xsi:type="ref:ProxyRef" ref="ITEL/OCS/SOI/Proxies/consultarSuscriptorOCSLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                              <con1:operation>consultarSuscriptorOCS</con1:operation>
                              <con1:request>
                                <con1:body>$suscriptorOCSRequest</con1:body>
                              </con1:request>
                              <con1:response>
                                <con1:body>suscriptorOCSResponse</con1:body>
                              </con1:response>
                              <con1:requestTransform>
                                <con1:assign varName="suscriptorOCSRequest">
                                  <con2:id>_ActionId-2861035459535817159--241919cb.153190328ed.-7bdc</con2:id>
                                  <con1:expr>
                                    <con2:xqueryTransform>
                                      <con2:resource ref="ITEL/Core/Resources/XQueries/consultarSuscriptorOCSPS_Req"/>
                                      <con2:param name="timeout">
                                        <con2:path>2000</con2:path>
                                      </con2:param>
                                      <con2:param name="in">
                                        <con2:path>"51"</con2:path>
                                      </con2:param>
                                      <con2:param name="min">
                                        <con2:path>$min</con2:path>
                                      </con2:param>
                                    </con2:xqueryTransform>
                                  </con1:expr>
                                </con1:assign>
                              </con1:requestTransform>
                              <con1:responseTransform>
                                <con1:ifThenElse>
                                  <con2:id>_ActionId-2861035459535817159--241919cb.153190328ed.-7bc2</con2:id>
                                  <con1:case>
                                    <con1:condition>
                                      <con2:xqueryText>data($suscriptorOCSResponse/CODIGO) = '1'</con2:xqueryText>
                                    </con1:condition>
                                    <con1:actions>
                                      <con1:assign varName="accgrpid">
                                        <con2:id>_ActionId-2861035459535817159--241919cb.153190328ed.-7bac</con2:id>
                                        <con1:expr>
                                          <con2:xqueryText>data($suscriptorOCSResponse/MENSAJE/CONSULTAR_SUSCRIPTOR/*:suscriptor/*:AccountGroupID)</con2:xqueryText>
                                        </con1:expr>
                                      </con1:assign>
                                      <con1:assign varName="sc">
                                        <con2:id>_ActionId-2861035459535817159--241919cb.153190328ed.-7b77</con2:id>
                                        <con1:expr>
                                          <con2:xqueryText>data($suscriptorOCSResponse/MENSAJE/CONSULTAR_SUSCRIPTOR/*:suscriptor/*:PublicRatePlanCode)</con2:xqueryText>
                                        </con1:expr>
                                      </con1:assign>
                                    </con1:actions>
                                  </con1:case>
                                  <con1:default>
                                    <con1:assign varName="codigoError">
                                      <con2:id>_ActionId-2861035459535817159--241919cb.153190328ed.-7b5a</con2:id>
                                      <con1:expr>
                                        <con2:xqueryText>data($suscriptorOCSResponse/CODIGO)</con2:xqueryText>
                                      </con1:expr>
                                    </con1:assign>
                                  </con1:default>
                                </con1:ifThenElse>
                              </con1:responseTransform>
                            </con1:wsCallout>
                          </con1:actions>
                        </con1:case>
                        <con1:default/>
                      </con1:ifThenElse>
                      <con1:ifThenElse>
                        <con2:id>_ActionId-2861035459535817159--241919cb.153190328ed.-7b41</con2:id>
                        <con1:case>
                          <con1:condition>
                            <con2:xqueryText>$codigoError = "1"</con2:xqueryText>
                          </con1:condition>
                          <con1:actions>
                            <con1:wsCallout>
                              <con2:id>_ActionId-2861035459535817159--241919cb.153190328ed.-7b1d</con2:id>
                              <con1:service xsi:type="ref:ProxyRef" ref="ITEL/Trama303/Proxies/calcularProvisionTrama303Local_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                              <con1:operation>calcularProvisionTrama303</con1:operation>
                              <con1:request>
                                <con1:body>$calcularProvisionTrama303Request</con1:body>
                              </con1:request>
                              <con1:response>
                                <con1:body>reglasProvisionResponse</con1:body>
                              </con1:response>
                              <con1:requestTransform>
                                <con1:assign varName="calcularProvisionTrama303Request">
                                  <con2:id>_ActionId-2861035459535817159--241919cb.153190328ed.-7b00</con2:id>
                                  <con1:expr>
                                    <con2:xqueryTransform>
                                      <con2:resource ref="ITEL/Core/Resources/XQueries/servicioProvision_Req_calcularProvTrama303"/>
                                      <con2:param name="parametros">
                                        <con2:path>$reglasNegocioResponse</con2:path>
                                      </con2:param>
                                      <con2:param name="codigoIN">
                                        <con2:path>data($inOrigen)</con2:path>
                                      </con2:param>
                                      <con2:param name="parametrosEntrada">
                                        <con2:path>$body/ser:Input_Parameters</con2:path>
                                      </con2:param>
                                    </con2:xqueryTransform>
                                  </con1:expr>
                                </con1:assign>
                              </con1:requestTransform>
                              <con1:responseTransform>
                                <con1:ifThenElse>
                                  <con2:id>_ActionId-2861035459535817159--241919cb.153190328ed.-7ae9</con2:id>
                                  <con1:case>
                                    <con1:condition>
                                      <con2:xqueryText>$reglasProvisionResponse/CODIGO/text() != "1"</con2:xqueryText>
                                    </con1:condition>
                                    <con1:actions>
                                      <con1:assign varName="codigoError">
                                        <con2:id>_ActionId-2861035459535817159--241919cb.153190328ed.-7ad2</con2:id>
                                        <con1:expr>
                                          <con2:xqueryText>$reglasProvisionResponse/CODIGO/text()</con2:xqueryText>
                                        </con1:expr>
                                      </con1:assign>
                                    </con1:actions>
                                  </con1:case>
                                  <con1:default/>
                                </con1:ifThenElse>
                              </con1:responseTransform>
                            </con1:wsCallout>
                          </con1:actions>
                        </con1:case>
                        <con1:default/>
                      </con1:ifThenElse>
                    </con1:actions>
                  </con1:case>
                  <con1:case>
                    <con1:condition>
                      <con2:xqueryText>data($body/*:Input_Parameters/METODO)= '304'</con2:xqueryText>
                    </con1:condition>
                    <con1:actions>
                      <con1:wsCallout>
                        <con2:id>_ActionId-2407471842295814505--34f1d1b.15315211157.-7bee</con2:id>
                        <con1:service xsi:type="ref:ProxyRef" ref="ITEL/Core/Proxies/consultarTipoFAFLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                        <con1:operation>consultarTipoFAF</con1:operation>
                        <con1:request>
                          <con1:body>$tipoFAFRequest</con1:body>
                        </con1:request>
                        <con1:response>
                          <con1:body>tipoFAFResponse</con1:body>
                        </con1:response>
                        <con1:requestTransform>
                          <con1:assign varName="tipoFAFRequest">
                            <con2:id>_ActionId-2407471842295814505--34f1d1b.15315211157.-7bd7</con2:id>
                            <con1:expr>
                              <con2:xqueryTransform>
                                <con2:resource ref="ITEL/Core/Resources/XQueries/consultarTipoFAFPS_Req"/>
                                <con2:param name="tipo">
                                  <con2:path>"ILIMITADO"</con2:path>
                                </con2:param>
                              </con2:xqueryTransform>
                            </con1:expr>
                          </con1:assign>
                        </con1:requestTransform>
                        <con1:responseTransform>
                          <con1:ifThenElse>
                            <con2:id>_ActionId-2407471842295814505--34f1d1b.15315211157.-7b8d</con2:id>
                            <con1:case>
                              <con1:condition>
                                <con2:xqueryText>$tipoFAFResponse/CODIGO != "OK"</con2:xqueryText>
                              </con1:condition>
                              <con1:actions>
                                <con1:assign varName="codigoError">
                                  <con2:id>_ActionId-2407471842295814505--34f1d1b.15315211157.-7b8b</con2:id>
                                  <con1:expr>
                                    <con2:xqueryText>"912"</con2:xqueryText>
                                  </con1:expr>
                                </con1:assign>
                              </con1:actions>
                            </con1:case>
                            <con1:default/>
                          </con1:ifThenElse>
                        </con1:responseTransform>
                      </con1:wsCallout>
                      <con1:ifThenElse>
                        <con2:id>_ActionId-2407471842295814505--34f1d1b.15315211157.-7b33</con2:id>
                        <con1:case>
                          <con1:condition>
                            <con2:xqueryText>$codigoError = "1"</con2:xqueryText>
                          </con1:condition>
                          <con1:actions>
                            <con1:wsCallout>
                              <con2:id>_ActionId-2407471842295814505--34f1d1b.15315211157.-7b10</con2:id>
                              <con1:service xsi:type="ref:ProxyRef" ref="ITEL/OCS/AIR/Proxies/consultarFaFListOCSLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                              <con1:operation>consultarFaFList</con1:operation>
                              <con1:request>
                                <con1:body>$consultarFaFListRequest</con1:body>
                              </con1:request>
                              <con1:response>
                                <con1:body>consultarFaFListResponse</con1:body>
                              </con1:response>
                              <con1:requestTransform>
                                <con1:assign varName="consultarFaFListRequest">
                                  <con2:id>_ActionId-2407471842295814505--34f1d1b.15315211157.-7aea</con2:id>
                                  <con1:expr>
                                    <con2:xqueryTransform>
                                      <con2:resource ref="ITEL/Core/Resources/XQueries/consultarFaFListPS_Req"/>
                                      <con2:param name="min">
                                        <con2:path>$min</con2:path>
                                      </con2:param>
                                    </con2:xqueryTransform>
                                  </con1:expr>
                                </con1:assign>
                              </con1:requestTransform>
                              <con1:responseTransform>
                                <con1:ifThenElse>
                                  <con2:id>_ActionId-2407471842295814505--34f1d1b.15315211157.-7acc</con2:id>
                                  <con1:case>
                                    <con1:condition>
                                      <con2:xqueryText>data($consultarFaFListResponse/CODIGO) != '1'</con2:xqueryText>
                                    </con1:condition>
                                    <con1:actions>
                                      <con1:assign varName="codigoError">
                                        <con2:id>_ActionId-2407471842295814505--34f1d1b.15315211157.-7a8b</con2:id>
                                        <con1:expr>
                                          <con2:xqueryText>data($consultarFaFListResponse/CODIGO)</con2:xqueryText>
                                        </con1:expr>
                                      </con1:assign>
                                    </con1:actions>
                                  </con1:case>
                                  <con1:default>
                                    <con1:assign varName="fafID">
                                      <con2:id>_ActionId-2407471842295814505--34f1d1b.15315211157.-7a69</con2:id>
                                      <con1:expr>
                                        <con2:xqueryTransform>
                                          <con2:resource ref="ITEL/Core/Resources/XQueries/obtenerFAFID"/>
                                          <con2:param name="metodoFAF">
                                            <con2:path>$tipoFAFResponse</con2:path>
                                          </con2:param>
                                          <con2:param name="fafList">
                                            <con2:path>$consultarFaFListResponse</con2:path>
                                          </con2:param>
                                        </con2:xqueryTransform>
                                      </con1:expr>
                                    </con1:assign>
                                    <con1:ifThenElse>
                                      <con2:id>_ActionId-2407471842295814505--34f1d1b.15315211157.-7aae</con2:id>
                                      <con1:case>
                                        <con1:condition>
                                          <con2:xqueryText>$fafID=""</con2:xqueryText>
                                        </con1:condition>
                                        <con1:actions>
                                          <con1:assign varName="codigoError">
                                            <con2:id>_ActionId-2407471842295814505--34f1d1b.15315211157.-7a4c</con2:id>
                                            <con1:expr>
                                              <con2:xqueryText>"924"</con2:xqueryText>
                                            </con1:expr>
                                          </con1:assign>
                                        </con1:actions>
                                      </con1:case>
                                      <con1:default>
                                        <con1:assign varName="reglasNegocioResponse">
                                          <con2:id>_ActionId-2407471842295814505--34f1d1b.15315211157.-7a38</con2:id>
                                          <con1:expr>
                                            <con2:xqueryText><![CDATA[<ns0:WS_Result xmlns:ns0="http://www.comcel.com.co/ConsultarReglas/">
	<CODIGO>1</CODIGO>
	<MENSAJE>
		<ERROR>1</ERROR>
		<ERRORDESC></ERRORDESC>
		<CONSULTASUSCRIPTOR>FALSE</CONSULTASUSCRIPTOR>
		<PARAMETROS>
			<PARAMETRO>
				<NOMBRE>FAFID</NOMBRE>
				<TIPO>string</TIPO>
				<VALOR>{ $fafID }</VALOR>
			</PARAMETRO>
		</PARAMETROS>
	</MENSAJE>
</ns0:WS_Result>]]></con2:xqueryText>
                                          </con1:expr>
                                        </con1:assign>
                                      </con1:default>
                                    </con1:ifThenElse>
                                  </con1:default>
                                </con1:ifThenElse>
                              </con1:responseTransform>
                            </con1:wsCallout>
                          </con1:actions>
                        </con1:case>
                        <con1:default/>
                      </con1:ifThenElse>
                      <con1:assign varName="elegidosNRN">
                        <con2:id>_ActionId-2407471842295814505--34f1d1b.15315211157.-79d2</con2:id>
                        <con1:expr>
                          <con2:xqueryText>data($body/ser:Input_Parameters/PARAMETROSPROVISION/PARAMETRO[NOMBRE='HOSTID']/VALOR)</con2:xqueryText>
                        </con1:expr>
                      </con1:assign>
                      <con1:insert varName="reglasNegocioResponse">
                        <con2:id>_ActionId-2407471842295814505--34f1d1b.15315211157.-79b3</con2:id>
                        <con1:location>
                          <con2:xpathText>./MENSAJE/PARAMETROS</con2:xpathText>
                        </con1:location>
                        <con1:where>last-child</con1:where>
                        <con1:expr>
                          <con2:xqueryText><![CDATA[<PARAMETRO>
	<NOMBRE>ELEGIDOSNRN</NOMBRE>
	<TIPO>string</TIPO>
	<VALOR>{$elegidosNRN}</VALOR>
</PARAMETRO>]]></con2:xqueryText>
                        </con1:expr>
                      </con1:insert>
                      <con1:ifThenElse>
                        <con2:id>_ActionId-2407471842295814505--34f1d1b.15315211157.-78a0</con2:id>
                        <con1:case>
                          <con1:condition>
                            <con2:xqueryText>$codigoError = "1"</con2:xqueryText>
                          </con1:condition>
                          <con1:actions>
                            <con1:wsCallout>
                              <con2:id>_ActionId-2407471842295814505--34f1d1b.15315211157.-787f</con2:id>
                              <con1:service xsi:type="ref:ProxyRef" ref="ITEL/OCS/SOI/Proxies/consultarSuscriptorOCSLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                              <con1:operation>consultarSuscriptorOCS</con1:operation>
                              <con1:request>
                                <con1:body>$suscriptorOCSRequest</con1:body>
                              </con1:request>
                              <con1:response>
                                <con1:body>suscriptorOCSResponse</con1:body>
                              </con1:response>
                              <con1:requestTransform>
                                <con1:assign varName="suscriptorOCSRequest">
                                  <con2:id>_ActionId-2407471842295814505--34f1d1b.15315211157.-7859</con2:id>
                                  <con1:expr>
                                    <con2:xqueryTransform>
                                      <con2:resource ref="ITEL/Core/Resources/XQueries/consultarSuscriptorOCSPS_Req"/>
                                      <con2:param name="timeout">
                                        <con2:path>2000</con2:path>
                                      </con2:param>
                                      <con2:param name="in">
                                        <con2:path>"51"</con2:path>
                                      </con2:param>
                                      <con2:param name="min">
                                        <con2:path>$min</con2:path>
                                      </con2:param>
                                    </con2:xqueryTransform>
                                  </con1:expr>
                                </con1:assign>
                              </con1:requestTransform>
                              <con1:responseTransform>
                                <con1:ifThenElse>
                                  <con2:id>_ActionId-2407471842295814505--34f1d1b.15315211157.-783f</con2:id>
                                  <con1:case>
                                    <con1:condition>
                                      <con2:xqueryText>data($suscriptorOCSResponse/CODIGO) = '1'</con2:xqueryText>
                                    </con1:condition>
                                    <con1:actions>
                                      <con1:assign varName="accgrpid">
                                        <con2:id>_ActionId-2407471842295814505--34f1d1b.15315211157.-7763</con2:id>
                                        <con1:expr>
                                          <con2:xqueryText>data($suscriptorOCSResponse/MENSAJE/CONSULTAR_SUSCRIPTOR/*:suscriptor/*:AccountGroupID)</con2:xqueryText>
                                        </con1:expr>
                                      </con1:assign>
                                      <con1:assign varName="sc">
                                        <con2:id>_ActionId-2407471842295814505--34f1d1b.15315211157.-7746</con2:id>
                                        <con1:expr>
                                          <con2:xqueryText>data($suscriptorOCSResponse/MENSAJE/CONSULTAR_SUSCRIPTOR/*:suscriptor/*:PublicRatePlanCode)</con2:xqueryText>
                                        </con1:expr>
                                      </con1:assign>
                                    </con1:actions>
                                  </con1:case>
                                  <con1:default>
                                    <con1:assign varName="codigoError">
                                      <con2:id>_ActionId-2407471842295814505--34f1d1b.15315211157.-772c</con2:id>
                                      <con1:expr>
                                        <con2:xqueryText>data($suscriptorOCSResponse/CODIGO)</con2:xqueryText>
                                      </con1:expr>
                                    </con1:assign>
                                  </con1:default>
                                </con1:ifThenElse>
                              </con1:responseTransform>
                            </con1:wsCallout>
                          </con1:actions>
                        </con1:case>
                        <con1:default/>
                      </con1:ifThenElse>
                      <con1:ifThenElse>
                        <con2:id>_ActionId-2407471842295814505--34f1d1b.15315211157.-799e</con2:id>
                        <con1:case>
                          <con1:condition>
                            <con2:xqueryText>$codigoError = "1"</con2:xqueryText>
                          </con1:condition>
                          <con1:actions>
                            <con1:wsCallout>
                              <con2:id>_ActionId-2407471842295814505--34f1d1b.15315211157.-7979</con2:id>
                              <con1:service xsi:type="ref:ProxyRef" ref="ITEL/Trama304/Proxies/calcularProvisionTrama304Local_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                              <con1:operation>calcularProvision</con1:operation>
                              <con1:request>
                                <con1:body>$calcularProvisionTrama304Request</con1:body>
                              </con1:request>
                              <con1:response>
                                <con1:body>reglasProvisionResponse</con1:body>
                              </con1:response>
                              <con1:requestTransform>
                                <con1:assign varName="calcularProvisionTrama304Request">
                                  <con2:id>_ActionId-2407471842295814505--34f1d1b.15315211157.-795b</con2:id>
                                  <con1:expr>
                                    <con2:xqueryTransform>
                                      <con2:resource ref="ITEL/Core/Resources/XQueries/servicioProvision_Req_calcularProvTrama304"/>
                                      <con2:param name="parametros">
                                        <con2:path>$reglasNegocioResponse</con2:path>
                                      </con2:param>
                                      <con2:param name="codigoIN">
                                        <con2:path>data($inOrigen)</con2:path>
                                      </con2:param>
                                      <con2:param name="datosOCS">
                                        <con2:path>$suscriptorOCSResponse</con2:path>
                                      </con2:param>
                                      <con2:param name="consultarFaFListResponse">
                                        <con2:path>$consultarFaFListResponse</con2:path>
                                      </con2:param>
                                      <con2:param name="parametrosEntrada">
                                        <con2:path>$body/ser:Input_Parameters</con2:path>
                                      </con2:param>
                                    </con2:xqueryTransform>
                                  </con1:expr>
                                </con1:assign>
                              </con1:requestTransform>
                              <con1:responseTransform>
                                <con1:ifThenElse>
                                  <con2:id>_ActionId-2407471842295814505--34f1d1b.15315211157.-7936</con2:id>
                                  <con1:case>
                                    <con1:condition>
                                      <con2:xqueryText>$reglasProvisionResponse/CODIGO/text() != "1"</con2:xqueryText>
                                    </con1:condition>
                                    <con1:actions>
                                      <con1:assign varName="codigoError">
                                        <con2:id>_ActionId-2407471842295814505--34f1d1b.15315211157.-7712</con2:id>
                                        <con1:expr>
                                          <con2:xqueryText>$reglasProvisionResponse/CODIGO/text()</con2:xqueryText>
                                        </con1:expr>
                                      </con1:assign>
                                    </con1:actions>
                                  </con1:case>
                                  <con1:default/>
                                </con1:ifThenElse>
                              </con1:responseTransform>
                            </con1:wsCallout>
                          </con1:actions>
                        </con1:case>
                        <con1:default/>
                      </con1:ifThenElse>
                    </con1:actions>
                  </con1:case>
                  <con1:case>
                    <con1:condition>
                      <con2:xqueryText>data($body/*:Input_Parameters/METODO)= '306'</con2:xqueryText>
                    </con1:condition>
                    <con1:actions>
                      <con1:wsCallout>
                        <con2:id>_ActionId-2861035459535817159--241919cb.153190328ed.-7574</con2:id>
                        <con1:service xsi:type="ref:ProxyRef" ref="ITEL/OCS/SOI/Proxies/consultarSuscriptorOCSLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                        <con1:operation>consultarSuscriptorOCS</con1:operation>
                        <con1:request>
                          <con1:body>$suscriptorOCSRequest</con1:body>
                        </con1:request>
                        <con1:response>
                          <con1:body>suscriptorOCSResponse</con1:body>
                        </con1:response>
                        <con1:requestTransform>
                          <con1:assign varName="suscriptorOCSRequest">
                            <con2:id>_ActionId-2861035459535817159--241919cb.153190328ed.-7553</con2:id>
                            <con1:expr>
                              <con2:xqueryTransform>
                                <con2:resource ref="ITEL/Core/Resources/XQueries/consultarSuscriptorOCSPS_Req"/>
                                <con2:param name="timeout">
                                  <con2:path>2000</con2:path>
                                </con2:param>
                                <con2:param name="in">
                                  <con2:path>"51"</con2:path>
                                </con2:param>
                                <con2:param name="min">
                                  <con2:path>$min</con2:path>
                                </con2:param>
                              </con2:xqueryTransform>
                            </con1:expr>
                          </con1:assign>
                        </con1:requestTransform>
                        <con1:responseTransform>
                          <con1:ifThenElse>
                            <con2:id>_ActionId-2861035459535817159--241919cb.153190328ed.-7495</con2:id>
                            <con1:case>
                              <con1:condition>
                                <con2:xqueryText>data($suscriptorOCSResponse/CODIGO) = '1'</con2:xqueryText>
                              </con1:condition>
                              <con1:actions>
                                <con1:assign varName="accgrpid">
                                  <con2:id>_ActionId-2861035459535817159--241919cb.153190328ed.-7494</con2:id>
                                  <con1:expr>
                                    <con2:xqueryText>data($suscriptorOCSResponse/MENSAJE/CONSULTAR_SUSCRIPTOR/*:suscriptor/*:AccountGroupID)</con2:xqueryText>
                                  </con1:expr>
                                </con1:assign>
                                <con1:assign varName="sc">
                                  <con2:id>_ActionId-2861035459535817159--241919cb.153190328ed.-7493</con2:id>
                                  <con1:expr>
                                    <con2:xqueryText>data($suscriptorOCSResponse/MENSAJE/CONSULTAR_SUSCRIPTOR/*:suscriptor/*:PublicRatePlanCode)</con2:xqueryText>
                                  </con1:expr>
                                </con1:assign>
                              </con1:actions>
                            </con1:case>
                            <con1:default>
                              <con1:assign varName="codigoError">
                                <con2:id>_ActionId-2861035459535817159--241919cb.153190328ed.-7492</con2:id>
                                <con1:expr>
                                  <con2:xqueryText>data($suscriptorOCSResponse/CODIGO)</con2:xqueryText>
                                </con1:expr>
                              </con1:assign>
                            </con1:default>
                          </con1:ifThenElse>
                        </con1:responseTransform>
                      </con1:wsCallout>
                      <con1:ifThenElse>
                        <con2:id>_ActionId-2861035459535817159--241919cb.153190328ed.-7531</con2:id>
                        <con1:case>
                          <con1:condition>
                            <con2:xqueryText>$codigoError = "1"</con2:xqueryText>
                          </con1:condition>
                          <con1:actions>
                            <con1:wsCallout>
                              <con2:id>_ActionId-2861035459535817159--241919cb.153190328ed.-7525</con2:id>
                              <con1:service xsi:type="ref:ProxyRef" ref="ITEL/Core/Proxies/consultarFAFIDVigenciaLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                              <con1:operation>consultarFAFIDVigencia</con1:operation>
                              <con1:request>
                                <con1:body>$fafIdVigenciaRequest</con1:body>
                              </con1:request>
                              <con1:response>
                                <con1:body>fafIdVigenciaResponse</con1:body>
                              </con1:response>
                              <con1:requestTransform>
                                <con1:assign varName="fafIdVigenciaRequest">
                                  <con2:id>_ActionId-2861035459535817159--241919cb.153190328ed.-752a</con2:id>
                                  <con1:expr>
                                    <con2:xqueryTransform>
                                      <con2:resource ref="ITEL/Core/Resources/XQueries/consultarFAFIDVigenciaPS_Req"/>
                                      <con2:param name="fafIdGroup">
                                        <con2:path>$accgrpid</con2:path>
                                      </con2:param>
                                      <con2:param name="tipo">
                                        <con2:path>"FNF"</con2:path>
                                      </con2:param>
                                      <con2:param name="serviceClass">
                                        <con2:path>$sc</con2:path>
                                      </con2:param>
                                      <con2:param name="vigencia">
                                        <con2:path>"0"</con2:path>
                                      </con2:param>
                                    </con2:xqueryTransform>
                                  </con1:expr>
                                </con1:assign>
                              </con1:requestTransform>
                              <con1:responseTransform>
                                <con1:ifThenElse>
                                  <con2:id>_ActionId-2861035459535817159--241919cb.153190328ed.-7529</con2:id>
                                  <con1:case>
                                    <con1:condition>
                                      <con2:xqueryText>$fafIdVigenciaResponse/CODIGO = "OK" and data($fafIdVigenciaResponse/MENSAJE/FAFID)!=""</con2:xqueryText>
                                    </con1:condition>
                                    <con1:actions>
                                      <con1:assign varName="reglasNegocioResponse">
                                        <con2:id>_ActionId-2861035459535817159--241919cb.153190328ed.-7528</con2:id>
                                        <con1:expr>
                                          <con2:xqueryText><![CDATA[let $fafids := tokenize(data($fafIdVigenciaResponse/MENSAJE/FAFID), ";")
return
<ns0:WS_Result xmlns:ns0="http://www.comcel.com.co/ConsultarReglas/">
	<CODIGO>1</CODIGO>
	<MENSAJE>
		<ERROR>1</ERROR>
		<ERRORDESC></ERRORDESC>
		<CONSULTASUSCRIPTOR>FALSE</CONSULTASUSCRIPTOR>
		<PARAMETROS>
			<PARAMETRO>
				<NOMBRE>FAFID_FNF</NOMBRE>
				<TIPO>string</TIPO>
				<VALOR>{ $fafids[1] }</VALOR>
			</PARAMETRO>
			{
			if( exists($fafids[2]) and $fafids[2]!="") then
				<PARAMETRO>
					<NOMBRE>FAFID_FA</NOMBRE>
					<TIPO>string</TIPO>
					<VALOR>{ $fafids[2] }</VALOR>
				</PARAMETRO>
			else ()
			}
		</PARAMETROS>
	</MENSAJE>
</ns0:WS_Result>]]></con2:xqueryText>
                                        </con1:expr>
                                      </con1:assign>
                                    </con1:actions>
                                  </con1:case>
                                  <con1:case>
                                    <con1:condition>
                                      <con2:xqueryText>$fafIdVigenciaResponse/CODIGO = "OK" and data($fafIdVigenciaResponse/MENSAJE/FAFID)=""</con2:xqueryText>
                                    </con1:condition>
                                    <con1:actions>
                                      <con1:assign varName="codigoError">
                                        <con2:id>_ActionId-2861035459535817159--241919cb.153190328ed.-7527</con2:id>
                                        <con1:expr>
                                          <con2:xqueryText>"912"</con2:xqueryText>
                                        </con1:expr>
                                      </con1:assign>
                                    </con1:actions>
                                  </con1:case>
                                  <con1:default>
                                    <con1:assign varName="codigoError">
                                      <con2:id>_ActionId-2861035459535817159--241919cb.153190328ed.-7526</con2:id>
                                      <con1:expr>
                                        <con2:xqueryText>"909"</con2:xqueryText>
                                      </con1:expr>
                                    </con1:assign>
                                  </con1:default>
                                </con1:ifThenElse>
                              </con1:responseTransform>
                            </con1:wsCallout>
                          </con1:actions>
                        </con1:case>
                        <con1:default/>
                      </con1:ifThenElse>
                      <con1:ifThenElse>
                        <con2:id>_ActionId-2861035459535817159--241919cb.153190328ed.-7448</con2:id>
                        <con1:case>
                          <con1:condition>
                            <con2:xqueryText>$codigoError = "1"</con2:xqueryText>
                          </con1:condition>
                          <con1:actions>
                            <con1:wsCallout>
                              <con2:id>_ActionId-2861035459535817159--241919cb.153190328ed.-742e</con2:id>
                              <con1:service xsi:type="ref:ProxyRef" ref="ITEL/OCS/OLM/Proxies/consultarSuscripcionOCSLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                              <con1:operation>consultarSuscripcionOCS</con1:operation>
                              <con1:request>
                                <con1:body>$consultarSuscripcionOCSRequest</con1:body>
                              </con1:request>
                              <con1:response>
                                <con1:body>consultarSuscripcionOCSResponse</con1:body>
                              </con1:response>
                              <con1:requestTransform>
                                <con1:assign varName="consultarSuscripcionOCSRequest">
                                  <con2:id>_ActionId-2861035459535817159--241919cb.153190328ed.-73ff</con2:id>
                                  <con1:expr>
                                    <con2:xqueryTransform>
                                      <con2:resource ref="ITEL/Core/Resources/XQueries/consultarSuscripcionOCSPS_Req"/>
                                      <con2:param name="min">
                                        <con2:path>$min</con2:path>
                                      </con2:param>
                                    </con2:xqueryTransform>
                                  </con1:expr>
                                </con1:assign>
                              </con1:requestTransform>
                              <con1:responseTransform/>
                            </con1:wsCallout>
                          </con1:actions>
                        </con1:case>
                        <con1:default/>
                      </con1:ifThenElse>
                      <con1:ifThenElse>
                        <con2:id>_ActionId-2861035459535817159--241919cb.153190328ed.-72d2</con2:id>
                        <con1:case>
                          <con1:condition>
                            <con2:xqueryText>$codigoError = "1"</con2:xqueryText>
                          </con1:condition>
                          <con1:actions>
                            <con1:wsCallout>
                              <con2:id>_ActionId-2861035459535817159--241919cb.153190328ed.-72ca</con2:id>
                              <con1:service xsi:type="ref:ProxyRef" ref="ITEL/OCS/AIR/Proxies/consultarFaFListOCSLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                              <con1:operation>consultarFaFList</con1:operation>
                              <con1:request>
                                <con1:body>$consultarFaFListRequest</con1:body>
                              </con1:request>
                              <con1:response>
                                <con1:body>consultarFaFListResponse</con1:body>
                              </con1:response>
                              <con1:requestTransform>
                                <con1:assign varName="consultarFaFListRequest">
                                  <con2:id>_ActionId-2861035459535817159--241919cb.153190328ed.-72cd</con2:id>
                                  <con1:expr>
                                    <con2:xqueryTransform>
                                      <con2:resource ref="ITEL/Core/Resources/XQueries/consultarFaFListPS_Req"/>
                                      <con2:param name="min">
                                        <con2:path>$min</con2:path>
                                      </con2:param>
                                    </con2:xqueryTransform>
                                  </con1:expr>
                                </con1:assign>
                              </con1:requestTransform>
                              <con1:responseTransform>
                                <con1:ifThenElse>
                                  <con2:id>_ActionId-2861035459535817159--241919cb.153190328ed.-72cc</con2:id>
                                  <con1:case>
                                    <con1:condition>
                                      <con2:xqueryText>data($consultarFaFListResponse/CODIGO) != '1'</con2:xqueryText>
                                    </con1:condition>
                                    <con1:actions>
                                      <con1:assign varName="codigoError">
                                        <con2:id>_ActionId-2861035459535817159--241919cb.153190328ed.-72cb</con2:id>
                                        <con1:expr>
                                          <con2:xqueryText>data($consultarFaFListResponse/CODIGO)</con2:xqueryText>
                                        </con1:expr>
                                      </con1:assign>
                                    </con1:actions>
                                  </con1:case>
                                  <con1:default/>
                                </con1:ifThenElse>
                              </con1:responseTransform>
                            </con1:wsCallout>
                          </con1:actions>
                        </con1:case>
                        <con1:default/>
                      </con1:ifThenElse>
                      <con1:ifThenElse>
                        <con2:id>_ActionId-2861035459535817159--241919cb.153190328ed.-73c9</con2:id>
                        <con1:case>
                          <con1:condition>
                            <con2:xqueryText>$codigoError = "1"</con2:xqueryText>
                          </con1:condition>
                          <con1:actions>
                            <con1:wsCallout>
                              <con2:id>_ActionId-2861035459535817159--241919cb.153190328ed.-7298</con2:id>
                              <con1:service xsi:type="ref:ProxyRef" ref="ITEL/OCS/AIR/Proxies/consultarOfferOCSLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                              <con1:operation>consultarOffer</con1:operation>
                              <con1:request>
                                <con1:body>$consultarOfferRequest</con1:body>
                              </con1:request>
                              <con1:response>
                                <con1:body>consultarOfferResponse</con1:body>
                              </con1:response>
                              <con1:requestTransform>
                                <con1:assign varName="consultarOfferRequest">
                                  <con2:id>_ActionId-2861035459535817159--241919cb.153190328ed.-7269</con2:id>
                                  <con1:expr>
                                    <con2:xqueryTransform>
                                      <con2:resource ref="ITEL/Core/Resources/XQueries/consultarOfferPS_Req"/>
                                      <con2:param name="min">
                                        <con2:path>$min</con2:path>
                                      </con2:param>
                                    </con2:xqueryTransform>
                                  </con1:expr>
                                </con1:assign>
                              </con1:requestTransform>
                              <con1:responseTransform>
                                <con1:ifThenElse>
                                  <con2:id>_ActionId-2861035459535817159--241919cb.153190328ed.-724d</con2:id>
                                  <con1:case>
                                    <con1:condition>
                                      <con2:xqueryText>data($consultarOfferResponse/CODIGO) != '1'</con2:xqueryText>
                                    </con1:condition>
                                    <con1:actions>
                                      <con1:assign varName="codigoError">
                                        <con2:id>_ActionId-2861035459535817159--241919cb.153190328ed.-7212</con2:id>
                                        <con1:expr>
                                          <con2:xqueryText>data($consultarOfferResponse/CODIGO)</con2:xqueryText>
                                        </con1:expr>
                                      </con1:assign>
                                    </con1:actions>
                                  </con1:case>
                                  <con1:default/>
                                </con1:ifThenElse>
                              </con1:responseTransform>
                            </con1:wsCallout>
                          </con1:actions>
                        </con1:case>
                        <con1:default/>
                      </con1:ifThenElse>
                      <con1:ifThenElse>
                        <con2:id>_ActionId-2861035459535817159--241919cb.153190328ed.-71f6</con2:id>
                        <con1:case>
                          <con1:condition>
                            <con2:xqueryText>$codigoError = "1" and 
fn:exists($consultarFaFListResponse/MENSAJE/CONSULTAR_FAFLIST/fafInformationList/Detail/fafIndicator)</con2:xqueryText>
                          </con1:condition>
                          <con1:actions>
                            <con1:wsCallout>
                              <con2:id>_ActionId-2861035459535817159--241919cb.153190328ed.-71db</con2:id>
                              <con1:service xsi:type="ref:ProxyRef" ref="ITEL/Core/Proxies/consultarFAFTipoLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                              <con1:operation>consultarFAFTipo</con1:operation>
                              <con1:request>
                                <con1:body>$consultarFAFTipoRequest</con1:body>
                              </con1:request>
                              <con1:response>
                                <con1:body>consultarFAFTipoResponse</con1:body>
                              </con1:response>
                              <con1:requestTransform>
                                <con1:assign varName="consultarFAFTipoRequest">
                                  <con2:id>_ActionId-2861035459535817159--241919cb.153190328ed.-71bb</con2:id>
                                  <con1:expr>
                                    <con2:xqueryTransform>
                                      <con2:resource ref="ITEL/Core/Resources/XQueries/consultarFAFTipoPS_Req"/>
                                      <con2:param name="wS_Result1">
                                        <con2:path>$consultarFaFListResponse</con2:path>
                                      </con2:param>
                                    </con2:xqueryTransform>
                                  </con1:expr>
                                </con1:assign>
                              </con1:requestTransform>
                              <con1:responseTransform>
                                <con1:ifThenElse>
                                  <con2:id>_ActionId-2861035459535817159--241919cb.153190328ed.-7197</con2:id>
                                  <con1:case>
                                    <con1:condition>
                                      <con2:xqueryText>data($consultarFAFTipoResponse/CODIGO) != 'OK'</con2:xqueryText>
                                    </con1:condition>
                                    <con1:actions>
                                      <con1:assign varName="codigoError">
                                        <con2:id>_ActionId-2861035459535817159--241919cb.153190328ed.-7180</con2:id>
                                        <con1:expr>
                                          <con2:xqueryText>"909"</con2:xqueryText>
                                        </con1:expr>
                                      </con1:assign>
                                    </con1:actions>
                                  </con1:case>
                                  <con1:default/>
                                </con1:ifThenElse>
                              </con1:responseTransform>
                            </con1:wsCallout>
                          </con1:actions>
                        </con1:case>
                        <con1:default/>
                      </con1:ifThenElse>
                      <con1:ifThenElse>
                        <con2:id>_ActionId-2861035459535817159--241919cb.153190328ed.-7171</con2:id>
                        <con1:case>
                          <con1:condition>
                            <con2:xqueryText>$codigoError = "1" and 
fn:exists($consultarFaFListResponse/MENSAJE/CONSULTAR_FAFLIST/fafInformationList/Detail/fafIndicator)</con2:xqueryText>
                          </con1:condition>
                          <con1:actions>
                            <con1:replace varName="consultarFaFListRes">
                              <con2:id>_ActionId-2861035459535817159--241919cb.153190328ed.-7103</con2:id>
                              <con1:expr>
                                <con2:xqueryTransform>
                                  <con2:resource ref="ITEL/Core/Resources/XQueries/ejecutarReglasNegocio_Res_consultarFaFList"/>
                                  <con2:param name="wS_Result1">
                                    <con2:path>$consultarFAFTipoResponse</con2:path>
                                  </con2:param>
                                  <con2:param name="wS_Result2">
                                    <con2:path>$consultarFaFListResponse</con2:path>
                                  </con2:param>
                                </con2:xqueryTransform>
                              </con1:expr>
                            </con1:replace>
                          </con1:actions>
                        </con1:case>
                        <con1:default>
                          <con1:replace varName="consultarFaFListRes">
                            <con2:id>_ActionId-2861035459535817159--241919cb.153190328ed.-70eb</con2:id>
                            <con1:expr>
                              <con2:xqueryTransform>
                                <con2:resource ref="ITEL/Core/Resources/XQueries/ejecutarReglasNegocio_Res_consultarFaFListOffers"/>
                                <con2:param name="wS_Result1">
                                  <con2:path>$consultarOfferResponse</con2:path>
                                </con2:param>
                                <con2:param name="wS_Result2">
                                  <con2:path>$consultarFaFListResponse</con2:path>
                                </con2:param>
                              </con2:xqueryTransform>
                            </con1:expr>
                          </con1:replace>
                        </con1:default>
                      </con1:ifThenElse>
                      <con1:ifThenElse>
                        <con2:id>_ActionId-2861035459535817159--241919cb.153190328ed.-70d2</con2:id>
                        <con1:case>
                          <con1:condition>
                            <con2:xqueryText>$codigoError = "1"</con2:xqueryText>
                          </con1:condition>
                          <con1:actions>
                            <con1:assign varName="elegidosNRN">
                              <con2:id>_ActionId-2861035459535817159--241919cb.153190328ed.-70b3</con2:id>
                              <con1:expr>
                                <con2:xqueryText>data($body/ser:Input_Parameters/PARAMETROSPROVISION/PARAMETRO[NOMBRE='MONTORECARGA']/VALOR)</con2:xqueryText>
                              </con1:expr>
                            </con1:assign>
                            <con1:insert varName="reglasNegocioResponse">
                              <con2:id>_ActionId-2861035459535817159--241919cb.153190328ed.-7075</con2:id>
                              <con1:location>
                                <con2:xpathText>./MENSAJE/PARAMETROS</con2:xpathText>
                              </con1:location>
                              <con1:where>last-child</con1:where>
                              <con1:expr>
                                <con2:xqueryText><![CDATA[<PARAMETRO>
	<NOMBRE>ELEGIDOSNRN</NOMBRE>
	<TIPO>string</TIPO>
	<VALOR>{$elegidosNRN}</VALOR>
</PARAMETRO>]]></con2:xqueryText>
                              </con1:expr>
                            </con1:insert>
                          </con1:actions>
                        </con1:case>
                        <con1:default/>
                      </con1:ifThenElse>
                      <con1:ifThenElse>
                        <con2:id>_ActionId-2861035459535817159--241919cb.153190328ed.-7067</con2:id>
                        <con1:case>
                          <con1:condition>
                            <con2:xqueryText>$codigoError = "1"</con2:xqueryText>
                          </con1:condition>
                          <con1:actions>
                            <con1:wsCallout>
                              <con2:id>_ActionId-2861035459535817159--241919cb.153190328ed.-7042</con2:id>
                              <con1:service xsi:type="ref:ProxyRef" ref="ITEL/Trama306/Proxies/calcularProvisionTrama306Local_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                              <con1:operation>calcularProvisionTrama306</con1:operation>
                              <con1:request>
                                <con1:body>$calcularProvisionTrama306Request</con1:body>
                              </con1:request>
                              <con1:response>
                                <con1:body>reglasProvisionResponse</con1:body>
                              </con1:response>
                              <con1:requestTransform>
                                <con1:assign varName="calcularProvisionTrama306Request">
                                  <con2:id>_ActionId-2861035459535817159--241919cb.153190328ed.-7026</con2:id>
                                  <con1:expr>
                                    <con2:xqueryTransform>
                                      <con2:resource ref="ITEL/Core/Resources/XQueries/servicioProvision_Req_calcularProvTrama306"/>
                                      <con2:param name="parametros">
                                        <con2:path>$reglasNegocioResponse</con2:path>
                                      </con2:param>
                                      <con2:param name="codigoIN">
                                        <con2:path>data($inOrigen)</con2:path>
                                      </con2:param>
                                      <con2:param name="consultarFaFListResponse">
                                        <con2:path>$consultarFaFListResponse</con2:path>
                                      </con2:param>
                                      <con2:param name="datosOCS">
                                        <con2:path>$suscriptorOCSResponse</con2:path>
                                      </con2:param>
                                      <con2:param name="parametrosEntrada">
                                        <con2:path>$body/ser:Input_Parameters</con2:path>
                                      </con2:param>
                                      <con2:param name="suscripcionOCS">
                                        <con2:path>$consultarSuscripcionOCSResponse</con2:path>
                                      </con2:param>
                                    </con2:xqueryTransform>
                                  </con1:expr>
                                </con1:assign>
                              </con1:requestTransform>
                              <con1:responseTransform>
                                <con1:ifThenElse>
                                  <con2:id>_ActionId-2861035459535817159--241919cb.153190328ed.-6fb5</con2:id>
                                  <con1:case>
                                    <con1:condition>
                                      <con2:xqueryText>$reglasProvisionResponse/CODIGO/text() != "1"</con2:xqueryText>
                                    </con1:condition>
                                    <con1:actions>
                                      <con1:assign varName="codigoError">
                                        <con2:id>_ActionId-2861035459535817159--241919cb.153190328ed.-6fb4</con2:id>
                                        <con1:expr>
                                          <con2:xqueryText>$reglasProvisionResponse/CODIGO/text()</con2:xqueryText>
                                        </con1:expr>
                                      </con1:assign>
                                    </con1:actions>
                                  </con1:case>
                                  <con1:default/>
                                </con1:ifThenElse>
                              </con1:responseTransform>
                            </con1:wsCallout>
                          </con1:actions>
                        </con1:case>
                        <con1:default/>
                      </con1:ifThenElse>
                    </con1:actions>
                  </con1:case>
                  <con1:case>
                    <con1:condition>
                      <con2:xqueryText>data($body/ser:Input_Parameters/METODO) = '600'</con2:xqueryText>
                    </con1:condition>
                    <con1:actions>
                      <con1:assign varName="spcode">
                        <con2:id>_ActionId-3892020321559485577-13095404.1526badb0b6.-7887</con2:id>
                        <con1:expr>
                          <con2:xqueryText>data($body/*:Input_Parameters/PARAMETROSPROVISION/PARAMETRO[NOMBRE='SPCODE']/VALOR/text())</con2:xqueryText>
                        </con1:expr>
                      </con1:assign>
                      <con1:assign varName="tmcode">
                        <con2:id>_ActionId-3892020321559485577-13095404.1526badb0b6.-7863</con2:id>
                        <con1:expr>
                          <con2:xqueryText>data($body/*:Input_Parameters/PARAMETROSPROVISION/PARAMETRO[NOMBRE='TMCODE']/VALOR/text())</con2:xqueryText>
                        </con1:expr>
                      </con1:assign>
                      <con1:assign varName="accgrpid">
                        <con2:id>_ActionId-4311059365767334517-6fdb0658.152a93a7d3f.-7e6a</con2:id>
                        <con1:expr>
                          <con2:xqueryText>data($body/*:Input_Parameters/PARAMETROSPROVISION/PARAMETRO[NOMBRE='ACC_GRP_ID']/VALOR/text())</con2:xqueryText>
                        </con1:expr>
                      </con1:assign>
                      <con1:wsCallout>
                        <con2:id>_ActionId-4311059365767334517-6fdb0658.152a93a7d3f.-7dd9</con2:id>
                        <con1:service xsi:type="ref:ProxyRef" ref="ITEL/OCS/SOI/Proxies/consultarSuscriptorOCSLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                        <con1:operation>consultarSuscriptorOCS</con1:operation>
                        <con1:request>
                          <con1:body>$suscriptorOrigenOCSRequest</con1:body>
                        </con1:request>
                        <con1:response>
                          <con1:body>suscriptorOrigenOCSResponse</con1:body>
                        </con1:response>
                        <con1:requestTransform>
                          <con1:assign varName="suscriptorOrigenOCSRequest">
                            <con2:id>_ActionId-4311059365767334517-6fdb0658.152a93a7d3f.-7d84</con2:id>
                            <con1:expr>
                              <con2:xqueryTransform>
                                <con2:resource ref="ITEL/Core/Resources/XQueries/consultarSuscriptorOCSPS_Req"/>
                                <con2:param name="timeout">
                                  <con2:path>2000</con2:path>
                                </con2:param>
                                <con2:param name="in">
                                  <con2:path>"51"</con2:path>
                                </con2:param>
                                <con2:param name="min">
                                  <con2:path>$min</con2:path>
                                </con2:param>
                              </con2:xqueryTransform>
                            </con1:expr>
                          </con1:assign>
                        </con1:requestTransform>
                        <con1:responseTransform>
                          <con1:ifThenElse>
                            <con2:id>_ActionId-4311059365767334517-6fdb0658.152a93a7d3f.-7c13</con2:id>
                            <con1:case>
                              <con1:condition>
                                <con2:xqueryText>data($suscriptorOrigenOCSResponse/CODIGO) = '1' and data($suscriptorOrigenOCSResponse/MENSAJE/CONSULTAR_SUSCRIPTOR/*:suscriptor/*:ContractStatus) = "3"</con2:xqueryText>
                              </con1:condition>
                              <con1:actions>
                                <con1:assign varName="codigoError">
                                  <con2:id>_ActionId-4311059365767334517-6fdb0658.152a93a7d3f.-7c12</con2:id>
                                  <con1:expr>
                                    <con2:xqueryText>"902"</con2:xqueryText>
                                  </con1:expr>
                                </con1:assign>
                              </con1:actions>
                            </con1:case>
                            <con1:case>
                              <con1:condition>
                                <con2:xqueryText>data($suscriptorOrigenOCSResponse/CODIGO) = '1' and data($suscriptorOrigenOCSResponse/MENSAJE/CONSULTAR_SUSCRIPTOR/*:suscriptor/*:RefillBarredUntil) != ""</con2:xqueryText>
                              </con1:condition>
                              <con1:actions>
                                <con1:assign varName="codigoError">
                                  <con2:id>_ActionId-4311059365767334517-6fdb0658.152a93a7d3f.-7c11</con2:id>
                                  <con1:expr>
                                    <con2:xqueryText>"910"</con2:xqueryText>
                                  </con1:expr>
                                </con1:assign>
                              </con1:actions>
                            </con1:case>
                            <con1:case>
                              <con1:condition>
                                <con2:xqueryText>data($suscriptorOrigenOCSResponse/CODIGO) = '900'</con2:xqueryText>
                              </con1:condition>
                              <con1:actions>
                                <con1:assign varName="codigoError">
                                  <con2:id>_ActionId-4311059365767334517-6fdb0658.152a93a7d3f.-7c10</con2:id>
                                  <con1:expr>
                                    <con2:xqueryText>data($suscriptorOrigenOCSResponse/CODIGO)</con2:xqueryText>
                                  </con1:expr>
                                </con1:assign>
                              </con1:actions>
                            </con1:case>
                            <con1:default>
                              <con1:assign varName="codigoError">
                                <con2:id>_ActionId-8621543710087368318-2f3da784.152d2509959.-7f3b</con2:id>
                                <con1:expr>
                                  <con2:xqueryText>data($suscriptorOrigenOCSResponse/CODIGO)</con2:xqueryText>
                                </con1:expr>
                              </con1:assign>
                            </con1:default>
                          </con1:ifThenElse>
                        </con1:responseTransform>
                      </con1:wsCallout>
                      <con1:ifThenElse>
                        <con2:id>_ActionId-4311059365767334517-6fdb0658.152a93a7d3f.-7c4e</con2:id>
                        <con1:case>
                          <con1:condition>
                            <con2:xqueryText>$codigoError = "1"</con2:xqueryText>
                          </con1:condition>
                          <con1:actions>
                            <con1:wsCallout>
                              <con2:id>_ActionId-4311059365767334517-6fdb0658.152a93a7d3f.-7c4a</con2:id>
                              <con1:service xsi:type="ref:ProxyRef" ref="ITEL/OCS/SOI/Proxies/consultarSuscriptorOCSLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                              <con1:operation>consultarSuscriptorOCS</con1:operation>
                              <con1:request>
                                <con1:body>$suscriptorDestinoOCSRequest</con1:body>
                              </con1:request>
                              <con1:response>
                                <con1:body>suscriptorDestinoOCSResponse</con1:body>
                              </con1:response>
                              <con1:requestTransform>
                                <con1:assign varName="suscriptorDestinoOCSRequest">
                                  <con2:id>_ActionId-4311059365767334517-6fdb0658.152a93a7d3f.-7c4b</con2:id>
                                  <con1:expr>
                                    <con2:xqueryTransform>
                                      <con2:resource ref="ITEL/Core/Resources/XQueries/consultarSuscriptorOCSPS_Req"/>
                                      <con2:param name="timeout">
                                        <con2:path>2000</con2:path>
                                      </con2:param>
                                      <con2:param name="in">
                                        <con2:path>"51"</con2:path>
                                      </con2:param>
                                      <con2:param name="min">
                                        <con2:path>data($body/ser:Input_Parameters/PARAMETROSPROVISION/PARAMETRO[NOMBRE='MINDESTINO']/VALOR/text())</con2:path>
                                      </con2:param>
                                    </con2:xqueryTransform>
                                  </con1:expr>
                                </con1:assign>
                              </con1:requestTransform>
                              <con1:responseTransform>
                                <con1:ifThenElse>
                                  <con2:id>_ActionId-4311059365767334517-6fdb0658.152a93a7d3f.-7c0d</con2:id>
                                  <con1:case>
                                    <con1:condition>
                                      <con2:xqueryText>data($suscriptorDestinoOCSResponse/CODIGO) = '1'</con2:xqueryText>
                                    </con1:condition>
                                    <con1:actions>
                                      <con1:assign varName="codigoError">
                                        <con2:id>_ActionId-4311059365767334517-6fdb0658.152a93a7d3f.-7c0c</con2:id>
                                        <con1:expr>
                                          <con2:xqueryText>"922"</con2:xqueryText>
                                        </con1:expr>
                                      </con1:assign>
                                    </con1:actions>
                                  </con1:case>
                                  <con1:case>
                                    <con1:condition>
                                      <con2:xqueryText>data($suscriptorDestinoOCSResponse/CODIGO) != '900'</con2:xqueryText>
                                    </con1:condition>
                                    <con1:actions>
                                      <con1:assign varName="codigoError">
                                        <con2:id>_ActionId-4311059365767334517-6fdb0658.152a93a7d3f.-7beb</con2:id>
                                        <con1:expr>
                                          <con2:xqueryText>data($suscriptorDestinoOCSResponse/CODIGO)</con2:xqueryText>
                                        </con1:expr>
                                      </con1:assign>
                                    </con1:actions>
                                  </con1:case>
                                  <con1:default/>
                                </con1:ifThenElse>
                              </con1:responseTransform>
                            </con1:wsCallout>
                          </con1:actions>
                        </con1:case>
                        <con1:default/>
                      </con1:ifThenElse>
                      <con1:ifThenElse>
                        <con2:id>_ActionId-4311059365767334517-6fdb0658.152a93a7d3f.-7bd1</con2:id>
                        <con1:case>
                          <con1:condition>
                            <con2:xqueryText>$codigoError = "1"</con2:xqueryText>
                          </con1:condition>
                          <con1:actions>
                            <con1:wsCallout>
                              <con2:id>_ActionId-4311059365767334517-6fdb0658.152a93a7d3f.-7bbb</con2:id>
                              <con1:service xsi:type="ref:ProxyRef" ref="ITEL/Core/Proxies/consultarRangoMinLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                              <con1:operation>consultarRangoMin</con1:operation>
                              <con1:request>
                                <con1:body>$rangoMinDestinoRequest</con1:body>
                              </con1:request>
                              <con1:response>
                                <con1:body>rangoMinDestinoResponse</con1:body>
                              </con1:response>
                              <con1:requestTransform>
                                <con1:assign varName="rangoMinDestinoRequest">
                                  <con2:id>_ActionId-4311059365767334517-6fdb0658.152a93a7d3f.-7bc5</con2:id>
                                  <con1:expr>
                                    <con2:xqueryTransform>
                                      <con2:resource ref="ITEL/Core/Resources/XQueries/consultarRangoMin_Req"/>
                                      <con2:param name="min">
                                        <con2:path>data($body/*:Input_Parameters/PARAMETROSPROVISION/PARAMETRO[NOMBRE='MINDESTINO']/VALOR/text())</con2:path>
                                      </con2:param>
                                    </con2:xqueryTransform>
                                  </con1:expr>
                                </con1:assign>
                              </con1:requestTransform>
                              <con1:responseTransform>
                                <con1:ifThenElse xmlns:con3="http://www.bea.com/wli/sb/typesystem/config" xmlns:con5="http://www.bea.com/wli/sb/stages/publish/config" xmlns:con4="http://www.bea.com/wli/sb/stages/routing/config">
                                  <con2:id>_ActionId-4311059365767334517-6fdb0658.152a93a7d3f.-7bc4</con2:id>
                                  <con1:case>
                                    <con1:condition>
                                      <con2:xqueryText>data($rangoMinDestinoResponse/CODIGO) != "OK"</con2:xqueryText>
                                    </con1:condition>
                                    <con1:actions>
                                      <con1:assign varName="codigoError">
                                        <con2:id>_ActionId-4311059365767334517-6fdb0658.152a93a7d3f.-7bc3</con2:id>
                                        <con1:expr>
                                          <con2:xqueryText>"909"</con2:xqueryText>
                                        </con1:expr>
                                      </con1:assign>
                                      <con1:assign varName="descError">
                                        <con2:id>_ActionId-4311059365767334517-6fdb0658.152a93a7d3f.-7bc2</con2:id>
                                        <con1:expr>
                                          <con2:xqueryText>"Database Error"</con2:xqueryText>
                                        </con1:expr>
                                      </con1:assign>
                                    </con1:actions>
                                  </con1:case>
                                  <con1:case>
                                    <con1:condition>
                                      <con2:xqueryText>data($rangoMinDestinoResponse/MENSAJE/RMCESTADO) = "0"</con2:xqueryText>
                                    </con1:condition>
                                    <con1:actions>
                                      <con1:assign varName="codigoError">
                                        <con2:id>_ActionId-4311059365767334517-6fdb0658.152a93a7d3f.-7bc1</con2:id>
                                        <con1:expr>
                                          <con2:xqueryText>"938"</con2:xqueryText>
                                        </con1:expr>
                                      </con1:assign>
                                      <con1:assign varName="descError">
                                        <con2:id>_ActionId-4311059365767334517-6fdb0658.152a93a7d3f.-7bc0</con2:id>
                                        <con1:expr>
                                          <con2:xqueryText>"Numeration Range of MIN is disabled"</con2:xqueryText>
                                        </con1:expr>
                                      </con1:assign>
                                    </con1:actions>
                                  </con1:case>
                                  <con1:case>
                                    <con1:condition>
                                      <con2:xqueryText>data($rangoMinDestinoResponse/MENSAJE/RMCESTADO) = "-1"</con2:xqueryText>
                                    </con1:condition>
                                    <con1:actions>
                                      <con1:assign varName="codigoError">
                                        <con2:id>_ActionId-4311059365767334517-6fdb0658.152a93a7d3f.-7bbf</con2:id>
                                        <con1:expr>
                                          <con2:xqueryText>"934"</con2:xqueryText>
                                        </con1:expr>
                                      </con1:assign>
                                      <con1:assign varName="descError">
                                        <con2:id>_ActionId-4311059365767334517-6fdb0658.152a93a7d3f.-7bbe</con2:id>
                                        <con1:expr>
                                          <con2:xqueryText>"MIN cannot be associated with any particular IN"</con2:xqueryText>
                                        </con1:expr>
                                      </con1:assign>
                                    </con1:actions>
                                  </con1:case>
                                  <con1:default>
                                    <con1:assign varName="inOrigen">
                                      <con2:id>_ActionId-4311059365767334517-6fdb0658.152a93a7d3f.-7bbd</con2:id>
                                      <con1:expr>
                                        <con2:xqueryText>data($rangoMinDestinoResponse/MENSAJE/RMCCODIGOIN)</con2:xqueryText>
                                      </con1:expr>
                                    </con1:assign>
                                    <con1:assign varName="sdp">
                                      <con2:id>_ActionId-4311059365767334517-6fdb0658.152a93a7d3f.-7bbc</con2:id>
                                      <con1:expr>
                                        <con2:xqueryText>data($rangoMinDestinoResponse/MENSAJE/SDP)</con2:xqueryText>
                                      </con1:expr>
                                    </con1:assign>
                                  </con1:default>
                                </con1:ifThenElse>
                              </con1:responseTransform>
                            </con1:wsCallout>
                          </con1:actions>
                        </con1:case>
                        <con1:default/>
                      </con1:ifThenElse>
                      <con1:ifThenElse>
                        <con2:id>_ActionId-3892020321559485577-13095404.1526badb0b6.-71e4</con2:id>
                        <con1:case>
                          <con1:condition>
                            <con2:xqueryText>$codigoError = "1"</con2:xqueryText>
                          </con1:condition>
                          <con1:actions>
                            <con1:wsCallout>
                              <con2:id>_ActionId-3892020321559485577-13095404.1526badb0b6.-71c5</con2:id>
                              <con1:service xsi:type="ref:ProxyRef" ref="ITEL/OCS/AIR/Proxies/consultarBalancesOCSLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                              <con1:operation>consultarBalances</con1:operation>
                              <con1:request>
                                <con1:body>$balancesRequest</con1:body>
                              </con1:request>
                              <con1:response>
                                <con1:body>balancesResponse</con1:body>
                              </con1:response>
                              <con1:requestTransform>
                                <con1:assign varName="balancesRequest">
                                  <con2:id>_ActionId-3892020321559485577-13095404.1526badb0b6.-7194</con2:id>
                                  <con1:expr>
                                    <con2:xqueryTransform>
                                      <con2:resource ref="ITEL/Core/Resources/XQueries/consultarBalancesPS_Req"/>
                                      <con2:param name="min">
                                        <con2:path>$min</con2:path>
                                      </con2:param>
                                    </con2:xqueryTransform>
                                  </con1:expr>
                                </con1:assign>
                              </con1:requestTransform>
                              <con1:responseTransform/>
                            </con1:wsCallout>
                          </con1:actions>
                        </con1:case>
                        <con1:default/>
                      </con1:ifThenElse>
                      <con1:ifThenElse>
                        <con2:id>_ActionId-3892020321559485577-13095404.1526badb0b6.-771c</con2:id>
                        <con1:case>
                          <con1:condition>
                            <con2:xqueryText>$codigoError = "1"</con2:xqueryText>
                          </con1:condition>
                          <con1:actions>
                            <con1:wsCallout>
                              <con2:id>_ActionId-3892020321559485577-13095404.1526badb0b6.-7555</con2:id>
                              <con1:service xsi:type="ref:ProxyRef" ref="ITEL/Core/Proxies/consultarContractTemplateServiceClassLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                              <con1:operation>consultarConTempSC</con1:operation>
                              <con1:request>
                                <con1:body>$contractTemplateRequest</con1:body>
                              </con1:request>
                              <con1:response>
                                <con1:body>contractTemplateResponse</con1:body>
                              </con1:response>
                              <con1:requestTransform>
                                <con1:assign varName="contractTemplateRequest">
                                  <con2:id>_ActionId-3892020321559485577-13095404.1526badb0b6.-753d</con2:id>
                                  <con1:expr>
                                    <con2:xqueryTransform>
                                      <con2:resource ref="ITEL/Core/Resources/XQueries/validar_Req_consultarContractTemplate"/>
                                      <con2:param name="tmcode">
                                        <con2:path>$tmcode</con2:path>
                                      </con2:param>
                                      <con2:param name="spcode">
                                        <con2:path>$spcode</con2:path>
                                      </con2:param>
                                    </con2:xqueryTransform>
                                  </con1:expr>
                                </con1:assign>
                              </con1:requestTransform>
                              <con1:responseTransform>
                                <con6:ifThenElse xmlns:con6="http://www.bea.com/wli/sb/stages/transform/config" xmlns:con4="http://www.bea.com/wli/sb/stages/routing/config" xmlns:con5="http://www.bea.com/wli/sb/stages/publish/config" xmlns:con3="http://www.bea.com/wli/sb/typesystem/config">
                                  <con2:id>_ActionId-3892020321559485577-13095404.1526badb0b6.-74c8</con2:id>
                                  <con6:case>
                                    <con6:condition>
                                      <con2:xqueryText>data($contractTemplateResponse/CODIGO) != "OK"</con2:xqueryText>
                                    </con6:condition>
                                    <con6:actions>
                                      <con6:assign varName="codigoError ">
                                        <con2:id>_ActionId-3892020321559485577-13095404.1526badb0b6.-74c7</con2:id>
                                        <con6:expr>
                                          <con2:xqueryText>"909"</con2:xqueryText>
                                        </con6:expr>
                                      </con6:assign>
                                    </con6:actions>
                                  </con6:case>
                                  <con6:case>
                                    <con6:condition>
                                      <con2:xqueryText>data($contractTemplateResponse/MENSAJE/CONTRACT_TEMPLATE) = "NO_DATA"</con2:xqueryText>
                                    </con6:condition>
                                    <con6:actions>
                                      <con6:assign varName="codigoError ">
                                        <con2:id>_ActionId-3892020321559485577-13095404.1526badb0b6.-74c6</con2:id>
                                        <con6:expr>
                                          <con2:xqueryText>"933"</con2:xqueryText>
                                        </con6:expr>
                                      </con6:assign>
                                    </con6:actions>
                                  </con6:case>
                                  <con6:default>
                                    <con6:assign varName="sc">
                                      <con2:id>_ActionId-3892020321559485577-13095404.1526badb0b6.-74c5</con2:id>
                                      <con6:expr>
                                        <con2:xqueryText>data($contractTemplateResponse/MENSAJE/SERVICE_CLASS)</con2:xqueryText>
                                      </con6:expr>
                                    </con6:assign>
                                  </con6:default>
                                </con6:ifThenElse>
                              </con1:responseTransform>
                            </con1:wsCallout>
                          </con1:actions>
                        </con1:case>
                        <con1:default/>
                      </con1:ifThenElse>
                      <con1:ifThenElse>
                        <con2:id>_ActionId-3892020321559485577-13095404.1526badb0b6.-74a4</con2:id>
                        <con1:case>
                          <con1:condition>
                            <con2:xqueryText>$codigoError = "1"</con2:xqueryText>
                          </con1:condition>
                          <con1:actions>
                            <con1:wsCallout>
                              <con2:id>_ActionId-3892020321559485577-13095404.1526badb0b6.-7482</con2:id>
                              <con1:service xsi:type="ref:ProxyRef" ref="ITEL/OCS/AIR/Proxies/consultarFaFListOCSLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                              <con1:operation>consultarFaFList</con1:operation>
                              <con1:request>
                                <con1:body>$consultarFaFListRequest</con1:body>
                              </con1:request>
                              <con1:response>
                                <con1:body>consultarFaFListResponse</con1:body>
                              </con1:response>
                              <con1:requestTransform>
                                <con1:assign varName="consultarFaFListRequest">
                                  <con2:id>_ActionId-3892020321559485577-13095404.1526badb0b6.-7469</con2:id>
                                  <con1:expr>
                                    <con2:xqueryTransform>
                                      <con2:resource ref="ITEL/Core/Resources/XQueries/consultarFaFListPS_Req"/>
                                      <con2:param name="min">
                                        <con2:path>$min</con2:path>
                                      </con2:param>
                                    </con2:xqueryTransform>
                                  </con1:expr>
                                </con1:assign>
                              </con1:requestTransform>
                              <con1:responseTransform>
                                <con1:ifThenElse xmlns:con4="http://www.bea.com/wli/sb/stages/routing/config" xmlns:con5="http://www.bea.com/wli/sb/stages/publish/config" xmlns:con3="http://www.bea.com/wli/sb/typesystem/config">
                                  <con2:id>_ActionId-3892020321559485577-13095404.1526badb0b6.-73f8</con2:id>
                                  <con1:case>
                                    <con1:condition>
                                      <con6:xqueryText xmlns:con6="http://www.bea.com/wli/sb/stages/config">data($consultarFaFListResponse/CODIGO) != '1'</con6:xqueryText>
                                    </con1:condition>
                                    <con1:actions>
                                      <con6:assign varName="codigoError" xmlns:con3="http://www.bea.com/wli/sb/stages/transform/config" xmlns:con2="http://www.bea.com/wli/sb/typesystem/config" xmlns:con1="http://www.bea.com/wli/sb/stages/config" xmlns:con6="http://www.bea.com/wli/sb/stages/transform/config">
                                        <con1:id>_ActionId-3892020321559485577-13095404.1526badb0b6.-73f7</con1:id>
                                        <con6:expr>
                                          <con1:xqueryText>data($consultarFaFListResponse/CODIGO)</con1:xqueryText>
                                        </con6:expr>
                                      </con6:assign>
                                    </con1:actions>
                                  </con1:case>
                                  <con1:default/>
                                </con1:ifThenElse>
                              </con1:responseTransform>
                            </con1:wsCallout>
                          </con1:actions>
                        </con1:case>
                        <con1:default/>
                      </con1:ifThenElse>
                      <con1:ifThenElse>
                        <con2:id>_ActionId-3892020321559485577-13095404.1526badb0b6.-73a6</con2:id>
                        <con1:case>
                          <con1:condition>
                            <con2:xqueryText>$codigoError = "1" and 
fn:exists($consultarFaFListResponse/MENSAJE/CONSULTAR_FAFLIST/fafInformationList/Detail/fafIndicator)</con2:xqueryText>
                          </con1:condition>
                          <con1:actions>
                            <con1:wsCallout>
                              <con2:id>_ActionId-3892020321559485577-13095404.1526badb0b6.-737e</con2:id>
                              <con1:service xsi:type="ref:ProxyRef" ref="ITEL/Core/Proxies/consultarFAFTipoLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                              <con1:operation>consultarFAFTipo</con1:operation>
                              <con1:request>
                                <con1:body>$consultarFAFTipoRequest</con1:body>
                              </con1:request>
                              <con1:response>
                                <con1:body>consultarFAFTipoResponse</con1:body>
                              </con1:response>
                              <con1:requestTransform>
                                <con1:assign varName="consultarFAFTipoRequest">
                                  <con2:id>_ActionId-3892020321559485577-13095404.1526badb0b6.-7360</con2:id>
                                  <con1:expr>
                                    <con2:xqueryTransform>
                                      <con2:resource ref="ITEL/Core/Resources/XQueries/consultarFAFTipoPS_Req"/>
                                      <con2:param name="wS_Result1">
                                        <con2:path>$consultarFaFListResponse</con2:path>
                                      </con2:param>
                                    </con2:xqueryTransform>
                                  </con1:expr>
                                </con1:assign>
                              </con1:requestTransform>
                              <con1:responseTransform>
                                <con6:ifThenElse xmlns:con3="http://www.bea.com/wli/sb/typesystem/config" xmlns:con6="http://www.bea.com/wli/sb/stages/transform/config" xmlns:con4="http://www.bea.com/wli/sb/stages/routing/config" xmlns:con5="http://www.bea.com/wli/sb/stages/publish/config">
                                  <con2:id>_ActionId-3892020321559485577-13095404.1526badb0b6.-72ed</con2:id>
                                  <con6:case>
                                    <con6:condition>
                                      <con6:xqueryText xmlns:con6="http://www.bea.com/wli/sb/stages/config">data($consultarFAFTipoResponse/CODIGO) != 'OK'</con6:xqueryText>
                                    </con6:condition>
                                    <con6:actions>
                                      <con7:assign varName="codigoError" xmlns:con3="http://www.bea.com/wli/sb/stages/transform/config" xmlns:con2="http://www.bea.com/wli/sb/typesystem/config" xmlns:con1="http://www.bea.com/wli/sb/stages/config" xmlns:con7="http://www.bea.com/wli/sb/stages/transform/config">
                                        <con1:id>_ActionId-3892020321559485577-13095404.1526badb0b6.-72ec</con1:id>
                                        <con7:expr>
                                          <con1:xqueryText>"909"</con1:xqueryText>
                                        </con7:expr>
                                      </con7:assign>
                                    </con6:actions>
                                  </con6:case>
                                  <con6:default/>
                                </con6:ifThenElse>
                              </con1:responseTransform>
                            </con1:wsCallout>
                          </con1:actions>
                        </con1:case>
                        <con1:default/>
                      </con1:ifThenElse>
                      <con1:ifThenElse>
                        <con2:id>_ActionId-3892020321559485577-13095404.1526badb0b6.-72d2</con2:id>
                        <con1:case>
                          <con1:condition>
                            <con2:xqueryText>$codigoError = "1"</con2:xqueryText>
                          </con1:condition>
                          <con1:actions>
                            <con1:wsCallout>
                              <con2:id>_ActionId-3892020321559485577-13095404.1526badb0b6.-72af</con2:id>
                              <con1:service xsi:type="ref:ProxyRef" ref="ITEL/OCS/OLM/Proxies/consultarSuscripcionOCSLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                              <con1:operation>consultarSuscripcionOCS</con1:operation>
                              <con1:request>
                                <con1:body>$consultarSuscripcionOCSRequest</con1:body>
                              </con1:request>
                              <con1:response>
                                <con1:body>consultarSuscripcionOCSResponse</con1:body>
                              </con1:response>
                              <con1:requestTransform>
                                <con1:assign varName="consultarSuscripcionOCSRequest">
                                  <con2:id>_ActionId-3892020321559485577-13095404.1526badb0b6.-7294</con2:id>
                                  <con1:expr>
                                    <con2:xqueryTransform>
                                      <con2:resource ref="ITEL/Core/Resources/XQueries/consultarSuscripcionOCSPS_Req"/>
                                      <con2:param name="min">
                                        <con2:path>$min</con2:path>
                                      </con2:param>
                                    </con2:xqueryTransform>
                                  </con1:expr>
                                </con1:assign>
                              </con1:requestTransform>
                              <con1:responseTransform>
                                <con1:ifThenElse>
                                  <con2:id>_ActionId-3892020321559485577-13095404.1526badb0b6.-727c</con2:id>
                                  <con1:case>
                                    <con1:condition>
                                      <con2:xqueryText>data($consultarSuscripcionOCSResponse/CODIGO) != '1' and  data($consultarSuscripcionOCSResponse/CODIGO) != '900'</con2:xqueryText>
                                    </con1:condition>
                                    <con1:actions>
                                      <con1:assign varName="codError">
                                        <con2:id>_ActionId-3892020321559485577-13095404.1526badb0b6.-720b</con2:id>
                                        <con1:expr>
                                          <con2:xqueryText>"901"</con2:xqueryText>
                                        </con1:expr>
                                      </con1:assign>
                                    </con1:actions>
                                  </con1:case>
                                  <con1:default>
                                    <con1:replace varName="consultarFaFListResponse">
                                      <con2:id>_ActionId-3892020321559485577-13095404.1526badb0b6.-7227</con2:id>
                                      <con1:expr>
                                        <con2:xqueryTransform>
                                          <con2:resource ref="ITEL/Core/Resources/XQueries/servicioProvision_Res_consultarFaFList_600"/>
                                          <con2:param name="wS_Result1">
                                            <con2:path>$consultarFAFTipoResponse</con2:path>
                                          </con2:param>
                                          <con2:param name="wS_Result3">
                                            <con2:path>$consultarSuscripcionOCSResponse</con2:path>
                                          </con2:param>
                                          <con2:param name="wS_Result2">
                                            <con2:path>$consultarFaFListResponse</con2:path>
                                          </con2:param>
                                        </con2:xqueryTransform>
                                      </con1:expr>
                                    </con1:replace>
                                  </con1:default>
                                </con1:ifThenElse>
                              </con1:responseTransform>
                            </con1:wsCallout>
                          </con1:actions>
                        </con1:case>
                        <con1:default/>
                      </con1:ifThenElse>
                      <con1:ifThenElse>
                        <con2:id>_ActionId-4311059365767334517-6fdb0658.152a93a7d3f.-7ba6</con2:id>
                        <con1:case>
                          <con1:condition>
                            <con2:xqueryText>$codigoError = "1"</con2:xqueryText>
                          </con1:condition>
                          <con1:actions>
                            <con1:wsCallout>
                              <con2:id>_ActionId-4311059365767334517-6fdb0658.152a93a7d3f.-7ba2</con2:id>
                              <con1:service xsi:type="ref:ProxyRef" ref="ITEL/Trama600/Proxies/calcularProvisionTrama600Local_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                              <con1:operation>calcularProvisionTrama600</con1:operation>
                              <con1:request>
                                <con1:body>$calcularProvisionTrama600Request</con1:body>
                              </con1:request>
                              <con1:response>
                                <con1:body>reglasProvisionResponse</con1:body>
                              </con1:response>
                              <con1:requestTransform>
                                <con1:assign varName="calcularProvisionTrama600Request">
                                  <con2:id>_ActionId-4311059365767334517-6fdb0658.152a93a7d3f.-7ba3</con2:id>
                                  <con1:expr>
                                    <con2:xqueryTransform>
                                      <con2:resource ref="ITEL/Core/Resources/XQueries/servicioProvision_Req_calcularProvTrama600"/>
                                      <con2:param name="sdp">
                                        <con2:path>$sdp</con2:path>
                                      </con2:param>
                                      <con2:param name="balancesOCS">
                                        <con2:path>if( fn:empty( $balancesResponse) ) then
	&lt;con:WS_Result xmlns:con="http://www.comcel.com.co/ConsultarBalancesOCS/" />
else
	$balancesResponse</con2:path>
                                      </con2:param>
                                      <con2:param name="fafListOCS">
                                        <con2:path>if( fn:empty( $consultarFaFListResponse) ) then
	&lt;con:WS_Result xmlns:con="http://www.comcel.com.co/ConsultarFaFListOCS/" />
else
	$consultarFaFListResponse</con2:path>
                                      </con2:param>
                                      <con2:param name="parametrosEntrada">
                                        <con2:path>$body/ser:Input_Parameters</con2:path>
                                      </con2:param>
                                      <con2:param name="suscripcionOCS">
                                        <con2:path>if( fn:empty( $consultarSuscripcionOCSResponse) ) then
	&lt;con:WS_Result xmlns:con="http://www.comcel.com.co/ConsultarSuscripcionOCS/" />
else
	$consultarSuscripcionOCSResponse</con2:path>
                                      </con2:param>
                                    </con2:xqueryTransform>
                                  </con1:expr>
                                </con1:assign>
                              </con1:requestTransform>
                              <con1:responseTransform>
                                <con1:ifThenElse>
                                  <con2:id>_ActionId-2407471842295814505--34f1d1b.15315211157.-7ead</con2:id>
                                  <con1:case>
                                    <con1:condition>
                                      <con2:xqueryText>$reglasProvisionResponse/CODIGO/text() != "1"</con2:xqueryText>
                                    </con1:condition>
                                    <con1:actions>
                                      <con1:assign varName="codigoError">
                                        <con2:id>_ActionId-2407471842295814505--34f1d1b.15315211157.-7eac</con2:id>
                                        <con1:expr>
                                          <con2:xqueryText>$reglasProvisionResponse/CODIGO/text()</con2:xqueryText>
                                        </con1:expr>
                                      </con1:assign>
                                    </con1:actions>
                                  </con1:case>
                                  <con1:default/>
                                </con1:ifThenElse>
                              </con1:responseTransform>
                            </con1:wsCallout>
                          </con1:actions>
                        </con1:case>
                        <con1:default/>
                      </con1:ifThenElse>
                    </con1:actions>
                  </con1:case>
                  <con1:case>
                    <con1:condition>
                      <con2:xqueryText>data($body/*:Input_Parameters/METODO)= '705'</con2:xqueryText>
                    </con1:condition>
                    <con1:actions>
                      <con1:wsCallout>
                        <con2:id>_ActionId-1394807091033924978--3cb9b3a1.1412c130b09.-7e88</con2:id>
                        <con1:service xsi:type="ref:ProxyRef" ref="ITEL/Core/Proxies/consultarDatosMinesLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                        <con1:operation>consultarDatosMines</con1:operation>
                        <con1:request>
                          <con1:body>$datos</con1:body>
                        </con1:request>
                        <con1:response>
                          <con1:body>respMines</con1:body>
                        </con1:response>
                        <con1:requestTransform>
                          <con6:assign varName="datos" xmlns:con3="http://www.bea.com/wli/sb/stages/transform/config" xmlns:con2="http://www.bea.com/wli/sb/typesystem/config" xmlns:con5="http://www.bea.com/wli/sb/stages/publish/config" xmlns:con4="http://www.bea.com/wli/sb/stages/routing/config" xmlns:con1="http://www.bea.com/wli/sb/stages/config" xmlns:con6="http://www.bea.com/wli/sb/stages/transform/config">
                            <con1:id>_ActionId-1394807091033924978--3cb9b3a1.1412c130b09.-7e34</con1:id>
                            <con6:expr>
                              <con1:xqueryTransform>
                                <con1:resource ref="ITEL/Core/Resources/XQueries/ejecutarReglasNegocio_Req_consultarDatosMines"/>
                                <con1:param name="inOrigen">
                                  <con1:path>""</con1:path>
                                </con1:param>
                                <con1:param name="timeout">
                                  <con1:path>"4300"</con1:path>
                                </con1:param>
                                <con1:param name="minOrigen">
                                  <con1:path>""</con1:path>
                                </con1:param>
                                <con1:param name="minDestino">
                                  <con1:path>$min</con1:path>
                                </con1:param>
                                <con1:param name="prefijo">
                                  <con1:path>"1-101-57"</con1:path>
                                </con1:param>
                                <con1:param name="inDestino">
                                  <con1:path>data($inOrigen)</con1:path>
                                </con1:param>
                              </con1:xqueryTransform>
                            </con6:expr>
                          </con6:assign>
                        </con1:requestTransform>
                        <con1:responseTransform/>
                      </con1:wsCallout>
                      <con1:wsCallout>
                        <con2:id>_ActionId-1394807091033924978--3cb9b3a1.1412c130b09.-7ebe</con2:id>
                        <con1:service xsi:type="ref:ProxyRef" ref="ITEL/Trama705/Proxies/calcularProvisionTrama705Local_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                        <con1:operation>calcularProvisionTrama705</con1:operation>
                        <con1:request>
                          <con1:body>$calcularProvisionTrama705Request</con1:body>
                        </con1:request>
                        <con1:response>
                          <con1:body>reglasProvisionResponse</con1:body>
                        </con1:response>
                        <con1:requestTransform>
                          <con1:assign varName="calcularProvisionTrama705Request">
                            <con2:id>_ActionId-1394807091033924978--3cb9b3a1.1412c130b09.-7ea2</con2:id>
                            <con1:expr>
                              <con2:xqueryTransform>
                                <con2:resource ref="ITEL/Core/Resources/XQueries/servicioProvision_Req_calcularProvTrama705"/>
                                <con2:param name="parametrosEntrada">
                                  <con2:path>$body/*:Input_Parameters</con2:path>
                                </con2:param>
                                <con2:param name="datosSuscriptor">
                                  <con2:path>$respMines</con2:path>
                                </con2:param>
                                <con2:param name="codigoIN">
                                  <con2:path>data($inOrigen)</con2:path>
                                </con2:param>
                              </con2:xqueryTransform>
                            </con1:expr>
                          </con1:assign>
                        </con1:requestTransform>
                        <con1:responseTransform/>
                      </con1:wsCallout>
                    </con1:actions>
                  </con1:case>
                  <con1:case>
                    <con1:condition>
                      <con2:xqueryText>data($body/*:Input_Parameters/METODO)= '602'</con2:xqueryText>
                    </con1:condition>
                    <con1:actions>
                      <con1:wsCallout>
                        <con2:id>_ActionId-8586227976793519540--38f7db6a.147a6b60536.-7f92</con2:id>
                        <con1:service xsi:type="ref:ProxyRef" ref="ITEL/Trama602/Proxies/calcularProvisionTrama602Local_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                        <con1:operation>calcularProvisionTrama602</con1:operation>
                        <con1:request>
                          <con1:body>$calcularProvisionTrama602Request</con1:body>
                        </con1:request>
                        <con1:response>
                          <con1:body>reglasProvisionResponse</con1:body>
                        </con1:response>
                        <con1:requestTransform>
                          <con1:assign varName="calcularProvisionTrama602Request">
                            <con2:id>_ActionId-8586227976793519540--38f7db6a.147a6b60536.-7f24</con2:id>
                            <con1:expr>
                              <con2:xqueryTransform>
                                <con2:resource ref="ITEL/Core/Resources/XQueries/servicioProvision_Req_calcularProvTrama602"/>
                                <con2:param name="codigoIN">
                                  <con2:path>data($inOrigen)</con2:path>
                                </con2:param>
                                <con2:param name="parametrosEntrada">
                                  <con2:path>$body/*:Input_Parameters</con2:path>
                                </con2:param>
                              </con2:xqueryTransform>
                            </con1:expr>
                          </con1:assign>
                        </con1:requestTransform>
                        <con1:responseTransform/>
                      </con1:wsCallout>
                    </con1:actions>
                  </con1:case>
                  <con1:case>
                    <con1:condition>
                      <con2:xqueryText>data($body/*:Input_Parameters/METODO)= '201'</con2:xqueryText>
                    </con1:condition>
                    <con1:actions>
                      <con1:wsCallout>
                        <con2:id>_ActionId-8586227976793519540--38f7db6a.147a6b60536.-7ac4</con2:id>
                        <con1:service xsi:type="ref:ProxyRef" ref="ITEL/Core/Proxies/ejecutarReglasNegocioLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                        <con1:operation>ejecutarReglasNegocio</con1:operation>
                        <con1:request>
                          <con1:body>$ejecutarReglasNegocioRequest</con1:body>
                        </con1:request>
                        <con1:response>
                          <con1:body>reglasNegocioResponse</con1:body>
                        </con1:response>
                        <con1:requestTransform>
                          <con1:assign varName="ejecutarReglasNegocioRequest">
                            <con2:id>_ActionId-8586227976793519540--38f7db6a.147a6b60536.-7a8c</con2:id>
                            <con1:expr>
                              <con2:xqueryTransform>
                                <con2:resource ref="ITEL/Core/Resources/XQueries/servicioProvision_Req_calcularRegNegocioTrama201"/>
                                <con2:param name="timeout">
                                  <con2:path>data($body/*:Input_Parameters/TIMEOUT)</con2:path>
                                </con2:param>
                                <con2:param name="metodo">
                                  <con2:path>data($body/*:Input_Parameters/METODO)</con2:path>
                                </con2:param>
                                <con2:param name="in">
                                  <con2:path>data($inOrigen)</con2:path>
                                </con2:param>
                                <con2:param name="min">
                                  <con2:path>data($body/*:Input_Parameters/MIN)</con2:path>
                                </con2:param>
                              </con2:xqueryTransform>
                            </con1:expr>
                          </con1:assign>
                        </con1:requestTransform>
                        <con1:responseTransform>
                          <con1:assign varName="codigoError">
                            <con2:id>_ActionId-8586227976793519540--38f7db6a.147a6b60536.-7956</con2:id>
                            <con1:expr>
                              <con2:xqueryText>data($reglasNegocioResponse/CODIGO)</con2:xqueryText>
                            </con1:expr>
                          </con1:assign>
                        </con1:responseTransform>
                      </con1:wsCallout>
                      <con1:ifThenElse>
                        <con2:id>_ActionId-8586227976793519540--38f7db6a.147a6b60536.-798e</con2:id>
                        <con1:case>
                          <con1:condition>
                            <con2:xqueryText>$codigoError = "1"</con2:xqueryText>
                          </con1:condition>
                          <con1:actions>
                            <con2:assign varName="parametrosSalida" xmlns:con1="http://www.bea.com/wli/sb/stages/config" xmlns:con4="http://www.bea.com/wli/sb/stages/routing/config" xmlns:con5="http://www.bea.com/wli/sb/stages/publish/config" xmlns:con2="http://www.bea.com/wli/sb/stages/transform/config" xmlns:con3="http://www.bea.com/wli/sb/typesystem/config">
                              <con6:id xmlns:con6="http://www.bea.com/wli/sb/stages/config">_ActionId-8586227976793519540--38f7db6a.147a6b60536.-7954</con6:id>
                              <con2:expr>
                                <con6:xqueryTransform xmlns:con6="http://www.bea.com/wli/sb/stages/config">
                                  <con6:resource ref="ITEL/Core/Resources/XQueries/servicioProvision_adaptarParametrosSalidaTrama201OCS"/>
                                  <con6:param name="wS_Result">
                                    <con6:path>$reglasNegocioResponse</con6:path>
                                  </con6:param>
                                </con6:xqueryTransform>
                              </con2:expr>
                            </con2:assign>
                            <con1:assign varName="descError">
                              <con2:id>_ActionId-8586227976793519540--38f7db6a.147a6b60536.-7952</con2:id>
                              <con1:expr>
                                <con2:xqueryText>if($parametrosSalida !="") 
  then $parametrosSalida 
  else $descError</con2:xqueryText>
                              </con1:expr>
                            </con1:assign>
                          </con1:actions>
                        </con1:case>
                        <con1:default/>
                      </con1:ifThenElse>
                    </con1:actions>
                  </con1:case>
                  <con1:default/>
                </con1:ifThenElse>
              </con1:actions>
            </con1:case>
            <con1:default/>
          </con1:ifThenElse>
        </con:actions>
      </con:stage>
      <con:stage name="ejecutar">
        <con:context>
          <con2:varNsDecl namespace="http://www.comcel.com.co/ServicioProvision/" prefix="ser"/>
        </con:context>
        <con:actions>
          <con5:assign varName="duracionServicios" xmlns:con3="http://www.bea.com/wli/sb/typesystem/config" xmlns:con2="http://www.bea.com/wli/sb/stages/transform/config" xmlns:con4="http://www.bea.com/wli/sb/stages/publish/config" xmlns:con1="http://www.bea.com/wli/sb/stages/config" xmlns:con5="http://www.bea.com/wli/sb/stages/transform/config">
            <con1:id>_ActionId-39473929531945052--32c48d45.1410d964e7e.-7e58</con1:id>
            <con5:expr>
              <con1:xqueryText>"0"</con1:xqueryText>
            </con5:expr>
          </con5:assign>
          <con5:assign varName="serviciosEjecutados" xmlns:con3="http://www.bea.com/wli/sb/typesystem/config" xmlns:con2="http://www.bea.com/wli/sb/stages/transform/config" xmlns:con4="http://www.bea.com/wli/sb/stages/publish/config" xmlns:con1="http://www.bea.com/wli/sb/stages/config" xmlns:con5="http://www.bea.com/wli/sb/stages/transform/config">
            <con1:id>_ActionId-6272406115629407680--4536a5a5.14103396286.-7ae3</con1:id>
            <con5:expr>
              <con1:xqueryText>&lt;SERVICIOS_EJECUTADOS xmlns="http://www.comcel.com.co/Ejecutador/" /></con1:xqueryText>
            </con5:expr>
          </con5:assign>
          <con1:ifThenElse>
            <con2:id>_ActionId-6272406115629407680--4536a5a5.14103396286.-7c55</con2:id>
            <con1:case>
              <con1:condition>
                <con2:xqueryText>$codigoError = "1"</con2:xqueryText>
              </con1:condition>
              <con1:actions>
                <con1:foreach>
                  <con2:id>_ActionId-6272406115629407680--4536a5a5.14103396286.-7b37</con2:id>
                  <con1:variable>reglasProvisionResponse</con1:variable>
                  <con1:expression>
                    <con2:xpathText>./MENSAJE/SERVICIO</con2:xpathText>
                  </con1:expression>
                  <con1:value-variable>v_servicio</con1:value-variable>
                  <con1:index-variable>v_indice</con1:index-variable>
                  <con1:total-variable>v_total</con1:total-variable>
                  <con1:actions>
                    <con5:assign varName="tiempoInicioServicio" xmlns:con3="http://www.bea.com/wli/sb/typesystem/config" xmlns:con2="http://www.bea.com/wli/sb/stages/transform/config" xmlns:con4="http://www.bea.com/wli/sb/stages/publish/config" xmlns:con1="http://www.bea.com/wli/sb/stages/config" xmlns:con5="http://www.bea.com/wli/sb/stages/transform/config">
                      <con1:id>_ActionId-39473929531945052--32c48d45.1410d964e7e.-7eac</con1:id>
                      <con5:expr>
                        <con1:xqueryText>fn:current-dateTime()</con1:xqueryText>
                      </con5:expr>
                    </con5:assign>
                    <con5:wsCallout xmlns:con3="http://www.bea.com/wli/sb/typesystem/config" xmlns:con2="http://www.bea.com/wli/sb/stages/transform/config" xmlns:con4="http://www.bea.com/wli/sb/stages/publish/config" xmlns:con1="http://www.bea.com/wli/sb/stages/config" xmlns:con5="http://www.bea.com/wli/sb/stages/transform/config">
                      <con1:id>_ActionId-6272406115629407680--4536a5a5.14103396286.-7a6d</con1:id>
                      <con5:service xsi:type="ref:ProxyRef" ref="ITEL/Core/Proxies/dymanicDispatcherLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                      <con5:operation>dynamicDispatcher</con5:operation>
                      <con5:request>
                        <con5:body>$servicio</con5:body>
                      </con5:request>
                      <con5:response>
                        <con5:body>respServicio</con5:body>
                      </con5:response>
                      <con5:requestTransform>
                        <con5:assign varName="servicio">
                          <con1:id>_ActionId-6272406115629407680--4536a5a5.14103396286.-7a6e</con1:id>
                          <con5:expr>
                            <con1:xqueryTransform>
                              <con1:resource ref="ITEL/Core/Resources/XQueries/servicioProv_Req_DynamiDispatcher"/>
                              <con1:param name="indice">
                                <con1:path>$v_indice</con1:path>
                              </con1:param>
                              <con1:param name="wS_Result1">
                                <con1:path>$reglasProvisionResponse</con1:path>
                              </con1:param>
                            </con1:xqueryTransform>
                          </con5:expr>
                        </con5:assign>
                      </con5:requestTransform>
                      <con5:responseTransform/>
                    </con5:wsCallout>
                    <con5:assign varName="duracionServicios" xmlns:con3="http://www.bea.com/wli/sb/typesystem/config" xmlns:con2="http://www.bea.com/wli/sb/stages/transform/config" xmlns:con4="http://www.bea.com/wli/sb/stages/publish/config" xmlns:con1="http://www.bea.com/wli/sb/stages/config" xmlns:con5="http://www.bea.com/wli/sb/stages/transform/config">
                      <con1:id>_ActionId-39473929531945052--32c48d45.1410d964e7e.-7dd8</con1:id>
                      <con5:expr>
                        <con1:xqueryText>xs:integer($duracionServicios) + fn:seconds-from-duration(fn:current-dateTime() - xs:dateTime($tiempoInicioServicio)) * 1000</con1:xqueryText>
                      </con5:expr>
                    </con5:assign>
                    <con5:ifThenElse xmlns:con3="http://www.bea.com/wli/sb/typesystem/config" xmlns:con2="http://www.bea.com/wli/sb/stages/transform/config" xmlns:con4="http://www.bea.com/wli/sb/stages/publish/config" xmlns:con1="http://www.bea.com/wli/sb/stages/config" xmlns:con5="http://www.bea.com/wli/sb/stages/transform/config">
                      <con1:id>_ActionId-6272406115629407680--4536a5a5.14103396286.-7893</con1:id>
                      <con5:case>
                        <con5:condition>
                          <con1:xqueryText>$respServicio/Codigo/text() = "OK"
and $respServicio/Mensaje/*/*/CODIGO/text() = "1"
or (($respServicio/Mensaje/*/*/CODIGO/text() = "900" 
or contains($respServicio/Mensaje/*/*/DESCRIPCION/text(), "21126")
or contains($respServicio/Mensaje/*/*/DESCRIPCION/text(), "21047"))
and fn:contains($servicio/servicio/nombre_servicio, "eliminarSuscripcionOCSLocal_PS")
and $body/*:Input_Parameters/METODO = ("501","600"))
or (
 $respServicio/Mensaje/*/*/CODIGO/text() = "923"
 and $body/ser:Input_Parameters/METODO = ("301")
)</con1:xqueryText>
                        </con5:condition>
                        <con5:actions>
                          <con5:replace contents-only="false" varName="v_servicio">
                            <con1:id>_ActionId-6272406115629407680--4536a5a5.14103396286.-7892</con1:id>
                            <con5:expr>
                              <con1:xqueryText>&lt;SERVICIO>{$respServicio/Mensaje/*/*/MENSAJE/*/@cluster , $v_servicio/node()}&lt;/SERVICIO></con1:xqueryText>
                            </con5:expr>
                          </con5:replace>
                          <con5:ifThenElse>
                            <con1:id>_ActionId-1269905822078885281--c6ba012.153067f54b3.-7062</con1:id>
                            <con5:case>
                              <con5:condition>
                                <con1:xqueryText>$respServicio/Mensaje/*/*/CODIGO/text() = "1"</con1:xqueryText>
                              </con5:condition>
                              <con5:actions>
                                <con5:insert varName="serviciosEjecutados">
                                  <con1:id>_ActionId-1269905822078885281--c6ba012.153067f54b3.-7060</con1:id>
                                  <con5:location/>
                                  <con5:where>last-child</con5:where>
                                  <con5:expr>
                                    <con1:xqueryText>$v_servicio</con1:xqueryText>
                                  </con5:expr>
                                </con5:insert>
                              </con5:actions>
                            </con5:case>
                            <con5:default/>
                          </con5:ifThenElse>
                          <con5:ifThenElse>
                            <con1:id>_ActionId-6272406115629407680--4536a5a5.14103396286.-788b</con1:id>
                            <con5:case>
                              <con5:condition>
                                <con1:xqueryText>xs:decimal($duracionServicios) &lt;= xs:decimal($timeout)</con1:xqueryText>
                              </con5:condition>
                              <con5:actions/>
                            </con5:case>
                            <con5:default>
                              <con5:assign varName="codigoError">
                                <con1:id>_ActionId-6272406115629407680--4536a5a5.14103396286.-788a</con1:id>
                                <con5:expr>
                                  <con1:xqueryText>"3"</con1:xqueryText>
                                </con5:expr>
                              </con5:assign>
                              <con5:assign varName="descError">
                                <con1:id>_ActionId-6272406115629407680--4536a5a5.14103396286.-774e</con1:id>
                                <con5:expr>
                                  <con1:xqueryText>"Transaction Timed Out"</con1:xqueryText>
                                </con5:expr>
                              </con5:assign>
                              <con6:assign varName="duracionEjecucion" xmlns:con3="http://www.bea.com/wli/sb/stages/transform/config" xmlns:con2="http://www.bea.com/wli/sb/typesystem/config" xmlns:con5="http://www.bea.com/wli/sb/stages/publish/config" xmlns:con4="http://www.bea.com/wli/sb/stages/routing/config" xmlns:con6="http://www.bea.com/wli/sb/stages/transform/config">
                                <con1:id>_ActionId-6272406115629407680--4536a5a5.14103396286.-7889</con1:id>
                                <con6:expr>
                                  <con1:xqueryText>fn:seconds-from-duration(fn:current-dateTime() - xs:dateTime($tiempoReglas)) * 1000</con1:xqueryText>
                                </con6:expr>
                              </con6:assign>
                              <con1:skip>
                                <con1:id>_ActionId-6272406115629407680--4536a5a5.14103396286.-7888</con1:id>
                              </con1:skip>
                            </con5:default>
                          </con5:ifThenElse>
                        </con5:actions>
                      </con5:case>
                      <con5:default>
                        <con5:assign varName="descError">
                          <con1:id>_ActionId-39473929531945052--32c48d45.1410d964e7e.-7f00</con1:id>
                          <con5:expr>
                            <con1:xqueryText>data($respServicio/Mensaje/*/*/DESCRIPCION)</con1:xqueryText>
                          </con5:expr>
                        </con5:assign>
                        <con5:assign varName="codigoError">
                          <con1:id>_ActionId-6272406115629407680--4536a5a5.14103396286.-7887</con1:id>
                          <con5:expr>
                            <con1:xqueryText>data($respServicio/Mensaje/*/*/CODIGO)</con1:xqueryText>
                          </con5:expr>
                        </con5:assign>
                        <con6:assign varName="duracionEjecucion" xmlns:con3="http://www.bea.com/wli/sb/stages/transform/config" xmlns:con2="http://www.bea.com/wli/sb/typesystem/config" xmlns:con5="http://www.bea.com/wli/sb/stages/publish/config" xmlns:con4="http://www.bea.com/wli/sb/stages/routing/config" xmlns:con6="http://www.bea.com/wli/sb/stages/transform/config">
                          <con1:id>_ActionId-6272406115629407680--4536a5a5.14103396286.-7886</con1:id>
                          <con6:expr>
                            <con1:xqueryText>fn:seconds-from-duration(fn:current-dateTime() - xs:dateTime($tiempoReglas)) * 1000</con1:xqueryText>
                          </con6:expr>
                        </con6:assign>
                        <con1:skip>
                          <con1:id>_ActionId-6272406115629407680--4536a5a5.14103396286.-7885</con1:id>
                        </con1:skip>
                      </con5:default>
                    </con5:ifThenElse>
                  </con1:actions>
                </con1:foreach>
              </con1:actions>
            </con1:case>
            <con1:default/>
          </con1:ifThenElse>
        </con:actions>
      </con:stage>
      <con:stage name="operacionAdicional">
        <con:context>
          <con2:varNsDecl namespace="http://www.comcel.com.co/ServicioProvision/" prefix="ser"/>
        </con:context>
        <con:actions>
          <con1:ifThenElse>
            <con2:id>_ActionId-1269905822078885281--c6ba012.153067f54b3.-683a</con2:id>
            <con1:case>
              <con1:condition>
                <con2:xqueryText>$codError = "1" and $metodo = ("302")
and data($reglasNegocioResponse/*:MENSAJE/*:PARAMETROS/PARAMETRO[NOMBRE="ESPOSTPAGO"]/VALOR) = 'FALSE'</con2:xqueryText>
              </con1:condition>
              <con1:actions>
                <con1:wsCallout>
                  <con2:id>_ActionId-1269905822078885281--c6ba012.153067f54b3.-6824</con2:id>
                  <con1:service xsi:type="ref:ProxyRef" ref="ITEL/Core/Proxies/insertarModificacionElegidosLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                  <con1:operation>insertarModificacionElegidos</con1:operation>
                  <con1:request>
                    <con1:body>$insertarModificacionElegidosRequest</con1:body>
                  </con1:request>
                  <con1:response>
                    <con1:body>insertarModificacionElegidosResponse</con1:body>
                  </con1:response>
                  <con1:requestTransform>
                    <con1:assign varName="insertarModificacionElegidosRequest">
                      <con2:id>_ActionId-1269905822078885281--c6ba012.153067f54b3.-6816</con2:id>
                      <con1:expr>
                        <con2:xqueryTransform>
                          <con2:resource ref="ITEL/Core/Resources/XQueries/ejecutador_Req_InsertarModificacionElegidos"/>
                          <con2:param name="elegidosModificados">
                            <con2:path>string-join(data($reglasProvisionResponse/MENSAJE/SERVICIO/PARAMETROS/PARAMETRO[NOMBRE="MSISDNELEGIDOTOREGISTER"]/VALOR/Detail),';')</con2:path>
                          </con2:param>
                          <con2:param name="min">
                            <con2:path>$min</con2:path>
                          </con2:param>
                        </con2:xqueryTransform>
                      </con1:expr>
                    </con1:assign>
                  </con1:requestTransform>
                  <con1:responseTransform/>
                </con1:wsCallout>
              </con1:actions>
            </con1:case>
            <con1:default/>
          </con1:ifThenElse>
          <con1:ifThenElse>
            <con2:id>_ActionId-1269905822078885281--c6ba012.153067f54b3.-702c</con2:id>
            <con1:case>
              <con1:condition>
                <con2:xqueryText>$codigoError = "1" and $metodo = "301"</con2:xqueryText>
              </con1:condition>
              <con1:actions>
                <con1:wsCallout>
                  <con2:id>_ActionId-1269905822078885281--c6ba012.153067f54b3.-7014</con2:id>
                  <con1:service xsi:type="ref:ProxyRef" ref="ITEL/OCS/OLM/Proxies/consultarSuscripcionOCSLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                  <con1:operation>consultarSuscripcionOCS</con1:operation>
                  <con1:request>
                    <con1:body>$suscripcionRequest</con1:body>
                  </con1:request>
                  <con1:response>
                    <con1:body>suscripcionResponse</con1:body>
                  </con1:response>
                  <con1:requestTransform>
                    <con1:assign varName="suscripcionRequest">
                      <con2:id>_ActionId-1269905822078885281--c6ba012.153067f54b3.-6fde</con2:id>
                      <con1:expr>
                        <con2:xqueryTransform>
                          <con2:resource ref="ITEL/Core/Resources/XQueries/consultarSuscripcionOCSPS_Req"/>
                          <con2:param name="min">
                            <con2:path>data($body/ser:Input_Parameters/MIN)</con2:path>
                          </con2:param>
                        </con2:xqueryTransform>
                      </con1:expr>
                    </con1:assign>
                  </con1:requestTransform>
                  <con1:responseTransform/>
                </con1:wsCallout>
                <con1:wsCallout>
                  <con2:id>_ActionId-1269905822078885281--c6ba012.153067f54b3.-6ffc</con2:id>
                  <con1:service xsi:type="ref:ProxyRef" ref="ITEL/Core/Proxies/insertarElegidoOCSLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                  <con1:operation>insertarElegidoOCS</con1:operation>
                  <con1:request>
                    <con1:body>$elegidoRequest</con1:body>
                  </con1:request>
                  <con1:response>
                    <con1:body>elegidoResponse</con1:body>
                  </con1:response>
                  <con1:requestTransform>
                    <con1:assign varName="elegidoRequest">
                      <con2:id>_ActionId-1269905822078885281--c6ba012.153067f54b3.-6fc3</con2:id>
                      <con1:expr>
                        <con2:xqueryTransform>
                          <con2:resource ref="ITEL/Core/Resources/XQueries/servicioProvision_Req_insertarElegidoIlimitadoOCS"/>
                          <con2:param name="elegidoAntiguo">
                            <con2:path>""</con2:path>
                          </con2:param>
                          <con2:param name="elegido">
                            <con2:path>$elegidosNRN</con2:path>
                          </con2:param>
                          <con2:param name="fechaCreacion">
                            <con2:path>data($suscripcionResponse/MENSAJE/CONSULTAR_SUSCRIPCION/result[fafID=data($fafIdVigenciaResponse/MENSAJE/FAFID)]/startDate)</con2:path>
                          </con2:param>
                          <con2:param name="min">
                            <con2:path>data($body/ser:Input_Parameters/MIN)</con2:path>
                          </con2:param>
                          <con2:param name="fechaExpiracion">
                            <con2:path>data($suscripcionResponse/MENSAJE/CONSULTAR_SUSCRIPCION/result[fafID=data($fafIdVigenciaResponse/MENSAJE/FAFID)]/expiryDate)</con2:path>
                          </con2:param>
                        </con2:xqueryTransform>
                      </con1:expr>
                    </con1:assign>
                  </con1:requestTransform>
                  <con1:responseTransform/>
                </con1:wsCallout>
                <con1:ifThenElse>
                  <con2:id>_ActionId-1269905822078885281--c6ba012.153067f54b3.-6568</con2:id>
                  <con1:case>
                    <con1:condition>
                      <con2:xqueryText>data($elegidoResponse/MENSAJE/EXITO) != "TRUE"</con2:xqueryText>
                    </con1:condition>
                    <con1:actions>
                      <con1:assign varName="codigoError">
                        <con2:id>_ActionId-1269905822078885281--c6ba012.153067f54b3.-6431</con2:id>
                        <con1:expr>
                          <con2:xqueryText>"909"</con2:xqueryText>
                        </con1:expr>
                      </con1:assign>
                    </con1:actions>
                  </con1:case>
                  <con1:default/>
                </con1:ifThenElse>
              </con1:actions>
            </con1:case>
            <con1:case>
              <con1:condition>
                <con2:xqueryText>$codigoError = "1" and $metodo = "100"</con2:xqueryText>
              </con1:condition>
              <con1:actions>
                <con1:ifThenElse>
                  <con2:id>_ActionId-6278836250458011283-161826d0.157b08d8da5.-7ee1</con2:id>
                  <con1:case>
                    <con1:condition>
                      <con2:xqueryText>contains(data($body/ser:Input_Parameters/PARAMETROSPROVISION/PARAMETRO[NOMBRE="MATERIALESRTC"]/VALOR),
data($body/ser:Input_Parameters/PARAMETROSPROVISION/PARAMETRO[NOMBRE="POSTPAGO"]/VALOR))</con2:xqueryText>
                    </con1:condition>
                    <con1:actions>
                      <con1:wsCallout>
                        <con2:id>_ActionId-6278836250458011283-161826d0.157b08d8da5.-7edd</con2:id>
                        <con1:service xsi:type="ref:ProxyRef" ref="ITEL/OCS/AIR/Proxies/actualizarAccumulatorOCSLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                        <con1:operation>actualizarAccumulator</con1:operation>
                        <con1:request>
                          <con1:body>$actualizarAccumulatorRequest</con1:body>
                        </con1:request>
                        <con1:response>
                          <con1:body>actualizarAccumulatorResponse</con1:body>
                        </con1:response>
                        <con1:requestTransform>
                          <con1:assign varName="actualizarAccumulatorRequest">
                            <con2:id>_ActionId-6278836250458011283-161826d0.157b08d8da5.-7ee0</con2:id>
                            <con1:expr>
                              <con2:xqueryTransform>
                                <con2:resource ref="ITEL/Core/Resources/XQueries/servicioProvision_Req_UpdateAccumulator"/>
                                <con2:param name="input_Parameters1">
                                  <con2:path>$body/ser:Input_Parameters</con2:path>
                                </con2:param>
                              </con2:xqueryTransform>
                            </con1:expr>
                          </con1:assign>
                        </con1:requestTransform>
                        <con1:responseTransform>
                          <con1:ifThenElse>
                            <con2:id>_ActionId-6278836250458011283-161826d0.157b08d8da5.-7edf</con2:id>
                            <con1:case>
                              <con1:condition>
                                <con2:xqueryText>data($actualizarAccumulatorResponse/MENSAJE/ACTUALIZAR_ACCUMULATOR/MethodResponse/responseCode) != '0'</con2:xqueryText>
                              </con1:condition>
                              <con1:actions>
                                <con1:assign varName="codigoError">
                                  <con2:id>_ActionId-6278836250458011283-161826d0.157b08d8da5.-7ede</con2:id>
                                  <con1:expr>
                                    <con2:xqueryText>"62"</con2:xqueryText>
                                  </con1:expr>
                                </con1:assign>
                              </con1:actions>
                            </con1:case>
                            <con1:default/>
                          </con1:ifThenElse>
                        </con1:responseTransform>
                      </con1:wsCallout>
                      <con1:ifThenElse>
                        <con2:id>_ActionId-6278836250458011283-161826d0.157b08d8da5.-7edc</con2:id>
                        <con1:case>
                          <con1:condition>
                            <con2:xqueryText>$codigoError = '1'</con2:xqueryText>
                          </con1:condition>
                          <con1:actions>
                            <con1:wsCallout>
                              <con2:id>_ActionId-6278836250458011283-161826d0.157b08d8da5.-7ed8</con2:id>
                              <con1:service xsi:type="ref:ProxyRef" ref="ITEL/OCS/AIR/Proxies/actualizarOfferOCSLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                              <con1:operation>actualizarOffer</con1:operation>
                              <con1:request>
                                <con1:body>$actualizarOfferRequest</con1:body>
                              </con1:request>
                              <con1:response>
                                <con1:body>actualizarOfferResponse</con1:body>
                              </con1:response>
                              <con1:requestTransform>
                                <con1:assign varName="actualizarOfferRequest">
                                  <con2:id>_ActionId-6278836250458011283-161826d0.157b08d8da5.-7edb</con2:id>
                                  <con1:expr>
                                    <con2:xqueryTransform>
                                      <con2:resource ref="ITEL/Core/Resources/XQueries/servicioProvision_Req_UpdateOffer"/>
                                      <con2:param name="input_Parameters1">
                                        <con2:path>$body/ser:Input_Parameters</con2:path>
                                      </con2:param>
                                    </con2:xqueryTransform>
                                  </con1:expr>
                                </con1:assign>
                              </con1:requestTransform>
                              <con1:responseTransform>
                                <con1:ifThenElse>
                                  <con2:id>_ActionId-6278836250458011283-161826d0.157b08d8da5.-7eda</con2:id>
                                  <con1:case>
                                    <con1:condition>
                                      <con2:xqueryText>data($actualizarOfferResponse/CODIGO) !='1' or data($actualizarOfferResponse/MENSAJE/ACTUALIZAR_OFFER/MethodResponse/responseCode) != '0'</con2:xqueryText>
                                    </con1:condition>
                                    <con1:actions>
                                      <con1:assign varName="codigoError">
                                        <con2:id>_ActionId-6278836250458011283-161826d0.157b08d8da5.-7ed9</con2:id>
                                        <con1:expr>
                                          <con2:xqueryText>"62"</con2:xqueryText>
                                        </con1:expr>
                                      </con1:assign>
                                    </con1:actions>
                                  </con1:case>
                                  <con1:default/>
                                </con1:ifThenElse>
                              </con1:responseTransform>
                            </con1:wsCallout>
                          </con1:actions>
                        </con1:case>
                        <con1:default/>
                      </con1:ifThenElse>
                    </con1:actions>
                  </con1:case>
                  <con1:default/>
                </con1:ifThenElse>
              </con1:actions>
            </con1:case>
            <con1:case>
              <con1:condition>
                <con2:xqueryText>$codigoError = "1" and $metodo = "302"</con2:xqueryText>
              </con1:condition>
              <con1:actions>
                <con1:wsCallout>
                  <con2:id>_ActionId-1269905822078885281--c6ba012.153067f54b3.-6709</con2:id>
                  <con1:service xsi:type="ref:ProxyRef" ref="ITEL/OCS/OLM/Proxies/consultarSuscripcionOCSLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                  <con1:operation>consultarSuscripcionOCS</con1:operation>
                  <con1:request>
                    <con1:body>$suscripcionRequest</con1:body>
                  </con1:request>
                  <con1:response>
                    <con1:body>suscripcionResponse</con1:body>
                  </con1:response>
                  <con1:requestTransform>
                    <con1:assign varName="suscripcionRequest">
                      <con2:id>_ActionId-1269905822078885281--c6ba012.153067f54b3.-66b5</con2:id>
                      <con1:expr>
                        <con2:xqueryTransform>
                          <con2:resource ref="ITEL/Core/Resources/XQueries/consultarSuscripcionOCSPS_Req"/>
                          <con2:param name="min">
                            <con2:path>data($body/ser:Input_Parameters/MIN)</con2:path>
                          </con2:param>
                        </con2:xqueryTransform>
                      </con1:expr>
                    </con1:assign>
                  </con1:requestTransform>
                  <con1:responseTransform/>
                </con1:wsCallout>
                <con1:wsCallout>
                  <con2:id>_ActionId-1269905822078885281--c6ba012.153067f54b3.-662c</con2:id>
                  <con1:service xsi:type="ref:ProxyRef" ref="ITEL/Core/Proxies/insertarElegidoOCSLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                  <con1:operation>insertarElegidoOCS</con1:operation>
                  <con1:request>
                    <con1:body>$elegidoRequest</con1:body>
                  </con1:request>
                  <con1:response>
                    <con1:body>elegidoResponse</con1:body>
                  </con1:response>
                  <con1:requestTransform>
                    <con1:assign varName="elegidoRequest">
                      <con2:id>_ActionId-1269905822078885281--c6ba012.153067f54b3.-65d8</con2:id>
                      <con1:expr>
                        <con2:xqueryTransform>
                          <con2:resource ref="ITEL/Core/Resources/XQueries/servicioProvision_Req_insertarElegidoIlimitadoOCS"/>
                          <con2:param name="elegidoAntiguo">
                            <con2:path>data($consultarFaFListResponse/MENSAJE/CONSULTAR_FAFLIST/fafInformationList/Detail/DetailNumber/fafNumber[1])</con2:path>
                          </con2:param>
                          <con2:param name="elegido">
                            <con2:path>$elegidosNRN</con2:path>
                          </con2:param>
                          <con2:param name="fechaCreacion">
                            <con2:path>data($suscripcionResponse/MENSAJE/CONSULTAR_SUSCRIPCION/result[fafID=data($reglasNegocioResponse/MENSAJE/PARAMETROS/PARAMETRO[NOMBRE='FAFID']/VALOR)]/startDate)</con2:path>
                          </con2:param>
                          <con2:param name="min">
                            <con2:path>data($body/ser:Input_Parameters/MIN)</con2:path>
                          </con2:param>
                          <con2:param name="fechaExpiracion">
                            <con2:path>data($suscripcionResponse/MENSAJE/CONSULTAR_SUSCRIPCION/result[fafID=data($reglasNegocioResponse/MENSAJE/PARAMETROS/PARAMETRO[NOMBRE='FAFID']/VALOR)]/expiryDate)</con2:path>
                          </con2:param>
                        </con2:xqueryTransform>
                      </con1:expr>
                    </con1:assign>
                  </con1:requestTransform>
                  <con1:responseTransform/>
                </con1:wsCallout>
                <con1:ifThenElse>
                  <con2:id>_ActionId-1269905822078885281--c6ba012.153067f54b3.-65a4</con2:id>
                  <con1:case>
                    <con1:condition>
                      <con2:xqueryText>data($elegidoResponse/MENSAJE/EXITO) != "TRUE"</con2:xqueryText>
                    </con1:condition>
                    <con1:actions>
                      <con1:assign varName="codigoError">
                        <con2:id>_ActionId-1269905822078885281--c6ba012.153067f54b3.-6587</con2:id>
                        <con1:expr>
                          <con2:xqueryText>"909"</con2:xqueryText>
                        </con1:expr>
                      </con1:assign>
                    </con1:actions>
                  </con1:case>
                  <con1:default/>
                </con1:ifThenElse>
              </con1:actions>
            </con1:case>
            <con1:case>
              <con1:condition>
                <con2:xqueryText>$codigoError = "1" and $metodo = "303"</con2:xqueryText>
              </con1:condition>
              <con1:actions>
                <con1:wsCallout>
                  <con2:id>_ActionId-2861035459535817159--241919cb.153190328ed.-79c8</con2:id>
                  <con1:service xsi:type="ref:ProxyRef" ref="ITEL/OCS/OLM/Proxies/consultarSuscripcionOCSLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                  <con1:operation>consultarSuscripcionOCS</con1:operation>
                  <con1:request>
                    <con1:body>$suscripcionRequest</con1:body>
                  </con1:request>
                  <con1:response>
                    <con1:body>suscripcionResponse</con1:body>
                  </con1:response>
                  <con1:requestTransform>
                    <con1:assign varName="suscripcionRequest">
                      <con2:id>_ActionId-2861035459535817159--241919cb.153190328ed.-7987</con2:id>
                      <con1:expr>
                        <con2:xqueryTransform>
                          <con2:resource ref="ITEL/Core/Resources/XQueries/consultarSuscripcionOCSPS_Req"/>
                          <con2:param name="min">
                            <con2:path>data($body/ser:Input_Parameters/MIN)</con2:path>
                          </con2:param>
                        </con2:xqueryTransform>
                      </con1:expr>
                    </con1:assign>
                  </con1:requestTransform>
                  <con1:responseTransform/>
                </con1:wsCallout>
                <con1:wsCallout>
                  <con2:id>_ActionId-2861035459535817159--241919cb.153190328ed.-79ad</con2:id>
                  <con1:service xsi:type="ref:ProxyRef" ref="ITEL/Core/Proxies/insertarElegidoOCSLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                  <con1:operation>insertarElegidoOCS</con1:operation>
                  <con1:request>
                    <con1:body>$elegidoRequest</con1:body>
                  </con1:request>
                  <con1:response>
                    <con1:body>elegidoResponse</con1:body>
                  </con1:response>
                  <con1:requestTransform>
                    <con1:assign varName="elegidoRequest">
                      <con2:id>_ActionId-2861035459535817159--241919cb.153190328ed.-7968</con2:id>
                      <con1:expr>
                        <con2:xqueryTransform>
                          <con2:resource ref="ITEL/Core/Resources/XQueries/servicioProvision_Req_insertarElegidoIlimitadoOCS"/>
                          <con2:param name="elegidoAntiguo">
                            <con2:path>""</con2:path>
                          </con2:param>
                          <con2:param name="elegido">
                            <con2:path>""</con2:path>
                          </con2:param>
                          <con2:param name="fechaCreacion">
                            <con2:path>data($suscripcionResponse/MENSAJE/CONSULTAR_SUSCRIPCION/result[fafID=data($reglasNegocioResponse/MENSAJE/PARAMETROS/PARAMETRO[NOMBRE='FAFID']/VALOR)]/startDate)</con2:path>
                          </con2:param>
                          <con2:param name="fechaExpiracion">
                            <con2:path>data($suscripcionResponse/MENSAJE/CONSULTAR_SUSCRIPCION/result[fafID=data($reglasNegocioResponse/MENSAJE/PARAMETROS/PARAMETRO[NOMBRE='FAFID']/VALOR)]/expiryDate)</con2:path>
                          </con2:param>
                          <con2:param name="min">
                            <con2:path>data($body/ser:Input_Parameters/MIN)</con2:path>
                          </con2:param>
                        </con2:xqueryTransform>
                      </con1:expr>
                    </con1:assign>
                  </con1:requestTransform>
                  <con1:responseTransform/>
                </con1:wsCallout>
                <con1:ifThenElse>
                  <con2:id>_ActionId-2861035459535817159--241919cb.153190328ed.-7948</con2:id>
                  <con1:case>
                    <con1:condition>
                      <con2:xqueryText>data($elegidoResponse/MENSAJE/EXITO) != "TRUE"</con2:xqueryText>
                    </con1:condition>
                    <con1:actions>
                      <con1:assign varName="codigoError">
                        <con2:id>_ActionId-2861035459535817159--241919cb.153190328ed.-792e</con2:id>
                        <con1:expr>
                          <con2:xqueryText>"909"</con2:xqueryText>
                        </con1:expr>
                      </con1:assign>
                    </con1:actions>
                  </con1:case>
                  <con1:default/>
                </con1:ifThenElse>
              </con1:actions>
            </con1:case>
            <con1:case>
              <con1:condition>
                <con2:xqueryText>$codigoError = "1" and $metodo = "304"</con2:xqueryText>
              </con1:condition>
              <con1:actions>
                <con1:wsCallout>
                  <con2:id>_ActionId-2407471842295814505--34f1d1b.15315211157.-76fa</con2:id>
                  <con1:service xsi:type="ref:ProxyRef" ref="ITEL/Core/Proxies/eliminarElegidoIlimitadoLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                  <con1:operation>eliminarElegidoIlimitado</con1:operation>
                  <con1:request>
                    <con1:body>$eliminarRequest</con1:body>
                  </con1:request>
                  <con1:response>
                    <con1:body>eliminarResponse</con1:body>
                  </con1:response>
                  <con1:requestTransform>
                    <con1:assign varName="eliminarRequest">
                      <con2:id>_ActionId-2407471842295814505--34f1d1b.15315211157.-76dd</con2:id>
                      <con1:expr>
                        <con2:xqueryTransform>
                          <con2:resource ref="ITEL/Core/Resources/XQueries/eliminarElegidoIlimitadoPS_Req"/>
                          <con2:param name="elegido">
                            <con2:path>$elegidosNRN</con2:path>
                          </con2:param>
                          <con2:param name="min">
                            <con2:path>$min</con2:path>
                          </con2:param>
                        </con2:xqueryTransform>
                      </con1:expr>
                    </con1:assign>
                  </con1:requestTransform>
                  <con1:responseTransform/>
                </con1:wsCallout>
                <con1:ifThenElse>
                  <con2:id>_ActionId-2407471842295814505--34f1d1b.15315211157.-76b8</con2:id>
                  <con1:case>
                    <con1:condition>
                      <con2:xqueryText>data($eliminarResponse/MENSAJE/EXITO) != "TRUE"</con2:xqueryText>
                    </con1:condition>
                    <con1:actions>
                      <con1:assign varName="codigoError">
                        <con2:id>_ActionId-2407471842295814505--34f1d1b.15315211157.-7688</con2:id>
                        <con1:expr>
                          <con2:xqueryText>"909"</con2:xqueryText>
                        </con1:expr>
                      </con1:assign>
                    </con1:actions>
                  </con1:case>
                  <con1:default/>
                </con1:ifThenElse>
              </con1:actions>
            </con1:case>
            <con1:case>
              <con1:condition>
                <con2:xqueryText>$codigoError = "1" and $metodo = "501"</con2:xqueryText>
              </con1:condition>
              <con1:actions>
                <con1:wsCallout>
                  <con2:id>_ActionId-8834681232170300452-19a06721.156dd1d2b01.-7ff1</con2:id>
                  <con1:service xsi:type="ref:ProxyRef" ref="ITEL/Core/Proxies/eliminarMSISDNTblCtrlLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                  <con1:operation>eliminarMSISDNTblCtrl</con1:operation>
                  <con1:request>
                    <con1:body>$eliminarMSISDNTblCtrlRequest</con1:body>
                  </con1:request>
                  <con1:response>
                    <con1:body>eliminarMSISDNTblCtrlResponse</con1:body>
                  </con1:response>
                  <con1:requestTransform>
                    <con1:assign varName="eliminarMSISDNTblCtrlRequest">
                      <con2:id>_ActionId-8834681232170300452-19a06721.156dd1d2b01.-7fd2</con2:id>
                      <con1:expr>
                        <con2:xqueryTransform>
                          <con2:resource ref="ITEL/Core/Resources/XQueries/eliminarMSISDNTblCtrlPS_Req"/>
                          <con2:param name="MIN">
                            <con2:path>$min</con2:path>
                          </con2:param>
                        </con2:xqueryTransform>
                      </con1:expr>
                    </con1:assign>
                  </con1:requestTransform>
                  <con1:responseTransform/>
                </con1:wsCallout>
                <con1:ifThenElse>
                  <con2:id>_ActionId-8834681232170300452-19a06721.156dd1d2b01.-7fb8</con2:id>
                  <con1:case>
                    <con1:condition>
                      <con2:xqueryText>data($eliminarMSISDNTblCtrlResponse/MENSAJE/EXITO) != "TRUE"</con2:xqueryText>
                    </con1:condition>
                    <con1:actions>
                      <con1:assign varName="codigoError">
                        <con2:id>_ActionId-8834681232170300452-19a06721.156dd1d2b01.-7f9c</con2:id>
                        <con1:expr>
                          <con2:xqueryText>"909"</con2:xqueryText>
                        </con1:expr>
                      </con1:assign>
                    </con1:actions>
                  </con1:case>
                  <con1:default/>
                </con1:ifThenElse>
              </con1:actions>
            </con1:case>
            <con1:default/>
          </con1:ifThenElse>
        </con:actions>
      </con:stage>
    </con:pipeline>
    <con:pipeline type="error" name="_onErrorHandler-6272406115629407680--4536a5a5.14103396286.-7ffa"/>
    <con:pipeline type="error" name="_onErrorHandler-6272406115629407680--4536a5a5.14103396286.-73cf">
      <con:stage name="error">
        <con:context xmlns:con3="http://www.bea.com/wli/sb/typesystem/config" xmlns:con2="http://www.bea.com/wli/sb/stages/transform/config" xmlns:con5="http://www.bea.com/wli/sb/stages/publish/config" xmlns:con4="http://www.bea.com/wli/sb/stages/routing/config" xmlns:con1="http://www.bea.com/wli/sb/stages/config"/>
        <con:actions xmlns:con3="http://www.bea.com/wli/sb/typesystem/config" xmlns:con2="http://www.bea.com/wli/sb/stages/transform/config" xmlns:con5="http://www.bea.com/wli/sb/stages/publish/config" xmlns:con4="http://www.bea.com/wli/sb/stages/routing/config" xmlns:con1="http://www.bea.com/wli/sb/stages/config">
          <con6:ifThenElse xmlns:con6="http://www.bea.com/wli/sb/stages/transform/config">
            <con1:id>_ActionId-6272406115629407680--4536a5a5.14103396286.-7392</con1:id>
            <con6:case>
              <con6:condition>
                <con1:xqueryText>$codigoError = "1"</con1:xqueryText>
              </con6:condition>
              <con6:actions>
                <con6:assign varName="codigoMapeado">
                  <con1:id>_ActionId-6272406115629407680--4536a5a5.14103396286.-7391</con1:id>
                  <con6:expr>
                    <con1:xqueryText>"1"</con1:xqueryText>
                  </con6:expr>
                </con6:assign>
                <con6:assign varName="descripcionError">
                  <con1:id>_ActionId-6272406115629407680--4536a5a5.14103396286.-7390</con1:id>
                  <con6:expr>
                    <con1:xqueryText>"Transaction successful"</con1:xqueryText>
                  </con6:expr>
                </con6:assign>
              </con6:actions>
            </con6:case>
            <con6:default>
              <con6:assign varName="codigoMapeado">
                <con1:id>_ActionId-6272406115629407680--4536a5a5.14103396286.-738f</con1:id>
                <con6:expr>
                  <con1:xqueryText>"903"</con1:xqueryText>
                </con6:expr>
              </con6:assign>
              <con6:assign varName="descripcionError">
                <con1:id>_ActionId-6272406115629407680--4536a5a5.14103396286.-738e</con1:id>
                <con6:expr>
                  <con1:xqueryText>"Transaction not processed"</con1:xqueryText>
                </con6:expr>
              </con6:assign>
            </con6:default>
          </con6:ifThenElse>
          <con1:resume>
            <con1:id>_ActionId-6272406115629407680--4536a5a5.14103396286.-738d</con1:id>
          </con1:resume>
        </con:actions>
      </con:stage>
    </con:pipeline>
    <con:pipeline type="response" name="PipelinePairNode1_response">
      <con:stage name="consultarError" errorHandler="_onErrorHandler-6272406115629407680--4536a5a5.14103396286.-73cf">
        <con:context>
          <con2:varNsDecl namespace="http://www.comcel.com.co/ServicioProvision/" prefix="ser"/>
        </con:context>
        <con:actions>
          <con6:wsCallout xmlns:con3="http://www.bea.com/wli/sb/typesystem/config" xmlns:con2="http://www.bea.com/wli/sb/stages/transform/config" xmlns:con5="http://www.bea.com/wli/sb/stages/publish/config" xmlns:con4="http://www.bea.com/wli/sb/stages/routing/config" xmlns:con1="http://www.bea.com/wli/sb/stages/config" xmlns:con6="http://www.bea.com/wli/sb/stages/transform/config">
            <con1:id>_ActionId-6272406115629407680--4536a5a5.14103396286.-740c</con1:id>
            <con6:service xsi:type="ref:ProxyRef" ref="ITEL/Core/Proxies/consultarRespuestaProvisionLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
            <con6:operation>consultarRespuestaProvision</con6:operation>
            <con6:request>
              <con6:body>$respuestaRequest</con6:body>
            </con6:request>
            <con6:response>
              <con6:body>respuestaResponse</con6:body>
            </con6:response>
            <con6:requestTransform>
              <con6:assign varName="respuestaRequest">
                <con1:id>_ActionId-6272406115629407680--4536a5a5.14103396286.-7417</con1:id>
                <con6:expr>
                  <con1:xqueryTransform>
                    <con1:resource ref="ITEL/Core/Resources/XQueries/consultarRespuestaProv_Req"/>
                    <con1:param name="codigo">
                      <con1:path>if(data($codigoError) = "923" and data($metodo) = "100") then "901" else if (data($codigoError) = "923" and data($metodo) = "701") then "1301" else $codigoError</con1:path>
                    </con1:param>
                  </con1:xqueryTransform>
                </con6:expr>
              </con6:assign>
            </con6:requestTransform>
            <con6:responseTransform>
              <con6:ifThenElse>
                <con1:id>_ActionId-6272406115629407680--4536a5a5.14103396286.-7416</con1:id>
                <con6:case>
                  <con6:condition>
                    <con1:xqueryText>data($respuestaResponse/CODIGO) != "OK"</con1:xqueryText>
                  </con6:condition>
                  <con6:actions>
                    <con6:assign varName="codigoMapeado">
                      <con1:id>_ActionId-6272406115629407680--4536a5a5.14103396286.-7415</con1:id>
                      <con6:expr>
                        <con1:xqueryText>"909"</con1:xqueryText>
                      </con6:expr>
                    </con6:assign>
                    <con6:assign varName="descripcionError">
                      <con1:id>_ActionId-6272406115629407680--4536a5a5.14103396286.-7414</con1:id>
                      <con6:expr>
                        <con1:xqueryText>"Database Error"</con1:xqueryText>
                      </con6:expr>
                    </con6:assign>
                  </con6:actions>
                </con6:case>
                <con6:case>
                  <con6:condition>
                    <con1:xqueryText>data($respuestaResponse/MENSAJE/CODIGO) = ""</con1:xqueryText>
                  </con6:condition>
                  <con6:actions>
                    <con6:ifThenElse>
                      <con1:id>_ActionId-6272406115629407680--4536a5a5.14103396286.-7413</con1:id>
                      <con6:case>
                        <con6:condition>
                          <con1:xqueryText>$codigoError = "1"</con1:xqueryText>
                        </con6:condition>
                        <con6:actions>
                          <con6:assign varName="codigoMapeado">
                            <con1:id>_ActionId-6272406115629407680--4536a5a5.14103396286.-7412</con1:id>
                            <con6:expr>
                              <con1:xqueryText>"1"</con1:xqueryText>
                            </con6:expr>
                          </con6:assign>
                          <con6:assign varName="descripcionError">
                            <con1:id>_ActionId-6272406115629407680--4536a5a5.14103396286.-7411</con1:id>
                            <con6:expr>
                              <con1:xqueryText>"Transaction successful"</con1:xqueryText>
                            </con6:expr>
                          </con6:assign>
                        </con6:actions>
                      </con6:case>
                      <con6:default>
                        <con6:assign varName="codigoMapeado">
                          <con1:id>_ActionId-6272406115629407680--4536a5a5.14103396286.-7410</con1:id>
                          <con6:expr>
                            <con1:xqueryText>"903"</con1:xqueryText>
                          </con6:expr>
                        </con6:assign>
                        <con6:assign varName="descripcionError">
                          <con1:id>_ActionId-6272406115629407680--4536a5a5.14103396286.-740f</con1:id>
                          <con6:expr>
                            <con1:xqueryText>"Transaction not processed"</con1:xqueryText>
                          </con6:expr>
                        </con6:assign>
                      </con6:default>
                    </con6:ifThenElse>
                  </con6:actions>
                </con6:case>
                <con6:default>
                  <con6:assign varName="codigoMapeado">
                    <con1:id>_ActionId-6272406115629407680--4536a5a5.14103396286.-740e</con1:id>
                    <con6:expr>
                      <con1:xqueryText>data($respuestaResponse/MENSAJE/CODIGO)</con1:xqueryText>
                    </con6:expr>
                  </con6:assign>
                  <con6:assign varName="descripcionError">
                    <con1:id>_ActionId-6272406115629407680--4536a5a5.14103396286.-740d</con1:id>
                    <con6:expr>
                      <con1:xqueryText>data($respuestaResponse/MENSAJE/RESDESCRIPCION)</con1:xqueryText>
                    </con6:expr>
                  </con6:assign>
                </con6:default>
              </con6:ifThenElse>
            </con6:responseTransform>
          </con6:wsCallout>
          <con1:assign varName="tramaIN">
            <con2:id>_ActionId-6112810524730703591-768111a.153ce40d0ea.-7f1e</con2:id>
            <con1:expr>
              <con2:xqueryTransform>
                <con2:resource ref="ITEL/Core/Resources/XQueries/servicioProv_Req_TramaIN"/>
                <con2:param name="parametrosTrama">
                  <con2:path>$body/*:Input_Parameters</con2:path>
                </con2:param>
              </con2:xqueryTransform>
            </con1:expr>
          </con1:assign>
          <con1:assign varName="tramaOut">
            <con2:id>_ActionId-1394807091033924978--3cb9b3a1.1412c130b09.-7f59</con2:id>
            <con1:expr>
              <con2:xqueryTransform>
                <con2:resource ref="ITEL/Core/Resources/XQueries/servicioProv_Req_TramaOut"/>
                <con2:param name="parametrosSalida">
                  <con2:path>if (exists($parametrosSalida)) then
	$parametrosSalida
else
	""</con2:path>
                </con2:param>
                <con2:param name="parametrosTrama">
                  <con2:path>$body/ser:Input_Parameters</con2:path>
                </con2:param>
                <con2:param name="codigoError">
                  <con2:path>$codigoMapeado</con2:path>
                </con2:param>
                <con2:param name="descripcionError">
                  <con2:path>$descripcionError</con2:path>
                </con2:param>
              </con2:xqueryTransform>
            </con1:expr>
          </con1:assign>
          <con1:replace varName="body" contents-only="true">
            <con2:id>_ActionId-6272406115629407680--4536a5a5.14103396286.-72a6</con2:id>
            <con1:expr>
              <con2:xqueryTransform>
                <con2:resource ref="ITEL/Core/Resources/XQueries/servicioProvision_Res"/>
                <con2:param name="descripcion">
                  <con2:path>$descripcionError</con2:path>
                </con2:param>
                <con2:param name="mensaje">
                  <con2:path>$descError</con2:path>
                </con2:param>
                <con2:param name="codigo">
                  <con2:path>$codigoMapeado</con2:path>
                </con2:param>
                <con2:param name="wS_Result1">
                  <con2:path>$rangoMinOrigenResponse</con2:path>
                </con2:param>
              </con2:xqueryTransform>
            </con1:expr>
          </con1:replace>
          <con1:ifThenElse>
            <con2:id>_ActionId-4807539232795849436--2019c98a.14b08252922.-7140</con2:id>
            <con1:case>
              <con1:condition>
                <con2:xqueryText>$metodo = '400'</con2:xqueryText>
              </con1:condition>
              <con1:actions>
                <con1:assign varName="parametrosTrama400">
                  <con2:id>_ActionId-4807539232795849436--2019c98a.14b08252922.-70d0</con2:id>
                  <con1:expr>
                    <con2:xqueryText><![CDATA[<PARAMETROS_TRAMA400>
 	<PARAMETRO>
	<NOMBRE>MONTO_BONIFICACION</NOMBRE>
	<VALOR>{$bono}</VALOR>
	</PARAMETRO>
 	<PARAMETRO>
	<NOMBRE>VIGENCIA_BONIFICACION</NOMBRE>
	<VALOR>{$vigencia}</VALOR>
	</PARAMETRO>
 	<PARAMETRO>
	<NOMBRE>MONTO_RECARGA</NOMBRE>
	<VALOR>{$monto }</VALOR>
	</PARAMETRO>	
 	<PARAMETRO>
	<NOMBRE>VIGENCIA_RECARGA</NOMBRE>
	<VALOR>{$vigenciaRecarga }</VALOR>
	</PARAMETRO>				
</PARAMETROS_TRAMA400>]]></con2:xqueryText>
                  </con1:expr>
                </con1:assign>
                <con1:insert varName="body">
                  <con2:id>_ActionId-4807539232795849436--2019c98a.14b08252922.-7108</con2:id>
                  <con1:location>
                    <con2:xpathText>./ser:WS_Result/MENSAJE/PARAMETROS</con2:xpathText>
                  </con1:location>
                  <con1:where>last-child</con1:where>
                  <con1:expr>
                    <con2:xqueryText>$parametrosTrama400/PARAMETRO</con2:xqueryText>
                  </con1:expr>
                </con1:insert>
              </con1:actions>
            </con1:case>
            <con1:default/>
          </con1:ifThenElse>
          <con1:assign varName="tiempoFinal">
            <con2:id>_ActionId-487992328900966859--699d13cb.14b504e023e.-7f92</con2:id>
            <con1:expr>
              <con2:xqueryText>fn:current-dateTime()</con2:xqueryText>
            </con1:expr>
          </con1:assign>
        </con:actions>
      </con:stage>
      <con:stage name="auditoria" errorHandler="_onErrorHandler-6272406115629407680--4536a5a5.14103396286.-7354">
        <con:context>
          <con2:varNsDecl namespace="http://www.comcel.com.co/ServicioProvision/" prefix="ser"/>
        </con:context>
        <con:actions>
          <con2:wsCallout xmlns:con3="http://www.bea.com/wli/sb/typesystem/config" xmlns:con2="http://www.bea.com/wli/sb/stages/transform/config" xmlns:con5="http://www.bea.com/wli/sb/stages/publish/config" xmlns:con4="http://www.bea.com/wli/sb/stages/routing/config" xmlns:con6="http://www.bea.com/wli/sb/stages/transform/config" xmlns:con1="http://www.bea.com/wli/sb/stages/config">
            <con1:id>_ActionId-1394807091033924978--3cb9b3a1.1412c130b09.-7f5d</con1:id>
            <con2:service xsi:type="ref:ProxyRef" ref="ITEL/Core/Proxies/enviarAuditoriaLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
            <con2:operation>auditoriaITEL</con2:operation>
            <con2:request>
              <con2:body wrapped="false">$auditoriaRequest</con2:body>
              <con2:header/>
            </con2:request>
            <con2:response>
              <con2:body wrapped="false">auditoriaResponse</con2:body>
              <con2:header/>
            </con2:response>
            <con2:requestTransform>
              <con2:assign varName="auditoriaRequest">
                <con1:id>_ActionId-1394807091033924978--3cb9b3a1.1412c130b09.-7f5e</con1:id>
                <con2:expr>
                  <con:xqueryTransform xmlns:con="http://www.bea.com/wli/sb/stages/config">
                    <con:resource ref="ITEL/Core/Resources/XQueries/servicioProv_Req_Auditoria"/>
                    <con:param name="codigoError">
                      <con:path>$codigoMapeado</con:path>
                    </con:param>
                    <con:param name="tramaEntrada">
                      <con:path>$tramaIN</con:path>
                    </con:param>
                    <con:param name="host">
                      <con:path>$ipLocal</con:path>
                    </con:param>
                    <con:param name="usuario">
                      <con:path>"provision"</con:path>
                    </con:param>
                    <con:param name="tramaSalida">
                      <con:path>$tramaOut</con:path>
                    </con:param>
                    <con:param name="metodo">
                      <con:path>$metodo</con:path>
                    </con:param>
                    <con:param name="inDestino">
                      <con:path>""</con:path>
                    </con:param>
                    <con:param name="duracionFinal">
                      <con:path>fn:seconds-from-duration(xs:dateTime($tiempoFinal) - xs:dateTime($tiempoInicio)) * 1000</con:path>
                    </con:param>
                    <con:param name="fechaSalida">
                      <con:path>$tiempoFinal</con:path>
                    </con:param>
                    <con:param name="minDestino">
                      <con:path>$min</con:path>
                    </con:param>
                    <con:param name="ip">
                      <con:path>$ipOrigen</con:path>
                    </con:param>
                    <con:param name="fechaEntrada">
                      <con:path>$tiempoInicio</con:path>
                    </con:param>
                    <con:param name="inOrigen">
                      <con:path>$inOrigen</con:path>
                    </con:param>
                    <con:param name="duracionTransaccion">
                      <con:path>fn:seconds-from-duration(xs:dateTime($tiempoFinal) - xs:dateTime($tiempoInicio)) * 1000</con:path>
                    </con:param>
                    <con:param name="duracionSuscriptor">
                      <con:path>0</con:path>
                    </con:param>
                  </con:xqueryTransform>
                </con2:expr>
              </con2:assign>
            </con2:requestTransform>
            <con2:responseTransform/>
          </con2:wsCallout>
        </con:actions>
      </con:stage>
      <con:stage name="compensacion" errorHandler="_onErrorHandler-3892020321559485577-13095404.1526badb0b6.-70e4">
        <con:context>
          <con2:varNsDecl namespace="http://www.comcel.com.co/ServicioProvision/" prefix="ser"/>
        </con:context>
        <con:actions>
          <con1:ifThenElse>
            <con2:id>_ActionId-3892020321559485577-13095404.1526badb0b6.-713b</con2:id>
            <con1:case>
              <con1:condition>
                <con2:xqueryText>$codigoError != '1' and fn:count($serviciosEjecutados/SERVICIO) != 0
and $metodo = ('600','301','302','303','304','306')</con2:xqueryText>
              </con1:condition>
              <con1:actions>
                <con1:wsCallout>
                  <con2:id>_ActionId-3892020321559485577-13095404.1526badb0b6.-710b</con2:id>
                  <con1:service xsi:type="ref:ProxyRef" ref="ITEL/Compensacion/Proxies/enviarCompensacionLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                  <con1:operation>compensacionITEL</con1:operation>
                  <con1:request>
                    <con1:body>$compensacionRequest</con1:body>
                  </con1:request>
                  <con1:response>
                    <con1:body>compensacionResponse</con1:body>
                  </con1:response>
                  <con1:requestTransform>
                    <con1:assign varName="compensacionRequest">
                      <con2:id>_ActionId-3892020321559485577-13095404.1526badb0b6.-70e5</con2:id>
                      <con1:expr>
                        <con2:xqueryTransform>
                          <con2:resource ref="ITEL/Core/Resources/XQueries/servicioProvision_Req_compensacion"/>
                          <con2:param name="metodo">
                            <con2:path>$metodo</con2:path>
                          </con2:param>
                          <con2:param name="accgrpid">
                            <con2:path>$accgrpid</con2:path>
                          </con2:param>
                          <con2:param name="serviciosEjecutados">
                            <con2:path>$serviciosEjecutados</con2:path>
                          </con2:param>
                          <con2:param name="sc">
                            <con2:path>$sc</con2:path>
                          </con2:param>
                          <con2:param name="min">
                            <con2:path>$min</con2:path>
                          </con2:param>
                        </con2:xqueryTransform>
                      </con1:expr>
                    </con1:assign>
                  </con1:requestTransform>
                  <con1:responseTransform/>
                </con1:wsCallout>
              </con1:actions>
            </con1:case>
            <con1:default/>
          </con1:ifThenElse>
        </con:actions>
      </con:stage>
    </con:pipeline>
    <con:pipeline type="error" name="_onErrorHandler-3892020321559485577-13095404.1526badb0b6.-70e4">
      <con:stage name="error">
        <con:context/>
        <con:actions>
          <con2:reply>
            <con2:id>_ActionId-3892020321559485577-13095404.1526badb0b6.-70ca</con2:id>
          </con2:reply>
        </con:actions>
      </con:stage>
    </con:pipeline>
    <con:flow>
      <con:pipeline-node name="PipelinePairNode1">
        <con:request>PipelinePairNode1_request</con:request>
        <con:response>PipelinePairNode1_response</con:response>
      </con:pipeline-node>
    </con:flow>
  </ser:router>
</xml-fragment>