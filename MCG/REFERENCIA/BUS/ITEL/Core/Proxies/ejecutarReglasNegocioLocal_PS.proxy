<?xml version="1.0" encoding="UTF-8"?>
<xml-fragment xmlns:ser="http://www.bea.com/wli/sb/services" xmlns:tran="http://www.bea.com/wli/sb/transports" xmlns:env="http://www.bea.com/wli/config/env" xmlns:http="http://www.bea.com/wli/sb/transports/http" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:con="http://www.bea.com/wli/sb/pipeline/config" xmlns:con1="http://www.bea.com/wli/sb/stages/config" xmlns:con2="http://www.bea.com/wli/sb/typesystem/config" xmlns:con3="http://www.bea.com/wli/sb/stages/transform/config" xmlns:con4="http://www.bea.com/wli/sb/stages/routing/config" xmlns:con5="http://www.bea.com/wli/sb/stages/publish/config">
  <ser:coreEntry isProxy="true" isEnabled="true" isAutoPublish="false" isTracingEnabled="false">
    <ser:binding type="SOAP" isSoap12="false" xsi:type="con:SoapBindingType" xmlns:con="http://www.bea.com/wli/sb/services/bindings/config">
      <con:wsdl ref="ITEL/Core/Resources/WSDLs/ejecutarReglasNegocio_PS"/>
      <con:binding>
        <con:name>EjecutarReglasNegocioSOAP</con:name>
        <con:namespace>http://www.comcel.com.co/EjecutarReglasNegocio/</con:namespace>
      </con:binding>
      <con:selector type="SOAP body"/>
    </ser:binding>
    <ser:monitoring isEnabled="false">
      <ser:aggregationInterval>10</ser:aggregationInterval>
      <ser:pipelineMonitoringLevel>Pipeline</ser:pipelineMonitoringLevel>
    </ser:monitoring>
    <ser:reporting>true</ser:reporting>
    <ser:logging isEnabled="true">
      <ser:logLevel>debug</ser:logLevel>
    </ser:logging>
    <ser:sla-alerting isEnabled="true">
      <ser:alertLevel>normal</ser:alertLevel>
    </ser:sla-alerting>
    <ser:pipeline-alerting isEnabled="true">
      <ser:alertLevel>normal</ser:alertLevel>
    </ser:pipeline-alerting>
    <ser:ws-policy>
      <ser:binding-mode>wsdl-policy-attachments</ser:binding-mode>
    </ser:ws-policy>
  </ser:coreEntry>
  <ser:endpointConfig>
    <tran:provider-id>local</tran:provider-id>
    <tran:inbound>true</tran:inbound>
    <tran:inbound-properties/>
    <tran:all-headers>true</tran:all-headers>
  </ser:endpointConfig>
  <ser:router errorHandler="_onErrorHandler-1641293207969743559--28a4b30a.12fb0e9a486.-7fd3">
    <con:pipeline type="request" name="PipelinePairNode1_request">
      <con:stage name="inicializacion">
        <con:context>
          <con1:varNsDecl namespace="http://www.comcel.com.co/EjecutarReglasNegocio/" prefix="ejec"/>
        </con:context>
        <con:actions>
          <con3:assign varName="tiempoInicioEtapa">
            <con1:id>_ActionId-1249725777529623680--7e870f75.13022d8dff2.-7fde</con1:id>
            <con3:expr>
              <con1:xqueryText>fn:current-dateTime()</con1:xqueryText>
            </con3:expr>
          </con3:assign>
          <con3:assign varName="codError">
            <con1:id>_ActionId-1684182584636093251-6b8ad8d.12f92005b76.-7977</con1:id>
            <con3:expr>
              <con1:xqueryText>"1"</con1:xqueryText>
            </con3:expr>
          </con3:assign>
          <con3:assign varName="metodo">
            <con1:id>_ActionId-3712703115507925614-5d7c170d.1336eb77365.-7a6f</con1:id>
            <con3:expr>
              <con1:xqueryText>data($body/ejec:Input_Parameters/METODO)</con1:xqueryText>
            </con3:expr>
          </con3:assign>
          <con3:assign varName="prefijo">
            <con1:id>_ActionId-3712703115507925614-5d7c170d.1336eb77365.-7c5f</con1:id>
            <con3:expr>
              <con1:xqueryText>data($body/ejec:Input_Parameters/PREFIJO)</con1:xqueryText>
            </con3:expr>
          </con3:assign>
          <con3:assign varName="tiempoInicio">
            <con1:id>_ActionId-3712703115507925614-5d7c170d.1336eb77365.-7c5c</con1:id>
            <con3:expr>
              <con1:xqueryText>data($body/ejec:Input_Parameters/TIEMPO_INICIO)</con1:xqueryText>
            </con3:expr>
          </con3:assign>
          <con3:assign varName="timeout">
            <con1:id>_ActionId-3712703115507925614-5d7c170d.1336eb77365.-7c59</con1:id>
            <con3:expr>
              <con1:xqueryText>data($body/ejec:Input_Parameters/TIMEOUT)</con1:xqueryText>
            </con3:expr>
          </con3:assign>
          <con3:assign varName="inOrigen">
            <con1:id>_ActionId-5174370892286694528-6956db40.133a81e5a33.-7fc9</con1:id>
            <con3:expr>
              <con1:xqueryText>if (empty($body/ejec:Input_Parameters/IN_ORIGEN)) then
	""
else
	data($body/ejec:Input_Parameters/IN_ORIGEN)</con1:xqueryText>
            </con3:expr>
          </con3:assign>
          <con3:assign varName="minOrigen">
            <con1:id>_ActionId-5174370892286694528-6956db40.133a81e5a33.-7fc8</con1:id>
            <con3:expr>
              <con1:xqueryText>if (empty($body/ejec:Input_Parameters/MIN_ORIGEN)) then
	""
else
	data($body/ejec:Input_Parameters/MIN_ORIGEN)</con1:xqueryText>
            </con3:expr>
          </con3:assign>
          <con3:assign varName="sinReglas">
            <con1:id>_ActionId-8872955765745653892--43b99895.13920d941a7.-7f9f</con1:id>
            <con3:expr>
              <con1:xqueryText>fn:false()</con1:xqueryText>
            </con3:expr>
          </con3:assign>
          <con3:assign varName="esOCS">
            <con1:id>_ActionId-7619517632386627082-190dd107.139f9f9a39c.-7f08</con1:id>
            <con3:expr>
              <con1:xqueryText>number($body/ejec:Input_Parameters/IN_DESTINO) >= 50</con1:xqueryText>
            </con3:expr>
          </con3:assign>
        </con:actions>
      </con:stage>
      <con:stage name="datosAdicionales" errorHandler="_onErrorHandler-5985043086313793460-3dcd6be3.1374b9d51ec.-7105">
        <con:context>
          <con1:userNsDecl namespace="http://www.comcel.com.co/ConsultarCantidadConsultasDia/" prefix="con"/>
          <con1:userNsDecl namespace="http://www.comcel.com.co/ConsultarContract" prefix="con2"/>
          <con1:varNsDecl namespace="http://www.comcel.com.co/EjecutarReglasNegocio/" prefix="ejec"/>
        </con:context>
        <con:actions>
          <con3:ifThenElse>
            <con1:id>_ActionId-440002342435620209--3fe474f1.133d60c8086.-71a7</con1:id>
            <con3:case>
              <con3:condition>
                <con1:xqueryText>$metodo = "200"</con1:xqueryText>
              </con3:condition>
              <con3:actions>
                <con3:wsCallout>
                  <con1:id>_ActionId-440002342435620209--3fe474f1.133d60c8086.-71a5</con1:id>
                  <con3:service xsi:type="ref:ProxyRef" ref="ITEL/Core/Proxies/consultarCantidadConsultasDiaLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                  <con3:operation>bd_consultarCantidadConsultasDia</con3:operation>
                  <con3:request>
                    <con3:body>$consultasDiaRequest</con3:body>
                  </con3:request>
                  <con3:response>
                    <con3:body>consultasDiaResponse</con3:body>
                  </con3:response>
                  <con3:requestTransform>
                    <con3:assign varName="consultasDiaRequest">
                      <con1:id>_ActionId-440002342435620209--3fe474f1.133d60c8086.-71a6</con1:id>
                      <con3:expr>
                        <con1:xqueryTransform>
                          <con1:resource ref="ITEL/Core/Resources/XQueries/ejecutarReglasNegocio_Req_consultarCantidadConsultas"/>
                          <con1:param name="min">
                            <con1:path>$body/ejec:Input_Parameters/MIN_DESTINO/text()</con1:path>
                          </con1:param>
                        </con1:xqueryTransform>
                      </con3:expr>
                    </con3:assign>
                  </con3:requestTransform>
                  <con3:responseTransform>
                    <con3:ifThenElse>
                      <con1:id>_ActionId-2883577540949710205--6e2d26f9.138d97a2861.-7e53</con1:id>
                      <con3:case>
                        <con3:condition>
                          <con1:xqueryText>data($consultasDiaResponse/CODIGO) != 'OK'</con1:xqueryText>
                        </con3:condition>
                        <con3:actions>
                          <con3:assign varName="codError">
                            <con1:id>_ActionId-2883577540949710205--6e2d26f9.138d97a2861.-7e52</con1:id>
                            <con3:expr>
                              <con1:xqueryText>"909"</con1:xqueryText>
                            </con3:expr>
                          </con3:assign>
                        </con3:actions>
                      </con3:case>
                      <con3:default>
                        <con3:insert varName="body">
                          <con1:id>_ActionId-2883577540949710205--6e2d26f9.138d97a2861.-7e4f</con1:id>
                          <con3:location>
                            <con1:xpathText>./ejec:Input_Parameters/PARAMETROS_TRAMA</con1:xpathText>
                          </con3:location>
                          <con3:where>last-child</con3:where>
                          <con3:expr>
                            <con1:xqueryText><![CDATA[<PARAMETRO>
	<NOMBRE>CONSULTASDIA</NOMBRE>
	<TIPO>decimal</TIPO>
	<VALOR>{ $consultasDiaResponse/con:MENSAJE/con:CONSULTASGRATIS/text() }</VALOR>
</PARAMETRO>]]></con1:xqueryText>
                          </con3:expr>
                        </con3:insert>
                        <con3:insert varName="body">
                          <con1:id>_ActionId-2883577540949710205--6e2d26f9.138d97a2861.-7e4d</con1:id>
                          <con3:location>
                            <con1:xpathText>./ejec:Input_Parameters/PARAMETROS_TRAMA</con1:xpathText>
                          </con3:location>
                          <con3:where>last-child</con3:where>
                          <con3:expr>
                            <con1:xqueryText><![CDATA[<PARAMETRO>
	<NOMBRE>CONSULTASREALIZADAS</NOMBRE>
	<TIPO>decimal</TIPO>
	<VALOR>{ $consultasDiaResponse/con:MENSAJE/con:CONSULTASREALIZADAS/text() }</VALOR>
</PARAMETRO>]]></con1:xqueryText>
                          </con3:expr>
                        </con3:insert>
                      </con3:default>
                    </con3:ifThenElse>
                  </con3:responseTransform>
                </con3:wsCallout>
              </con3:actions>
            </con3:case>
            <con3:case>
              <con3:condition>
                <con1:xqueryText>$metodo = "500"</con1:xqueryText>
              </con3:condition>
              <con3:actions>
                <con3:wsCallout>
                  <con1:id>_ActionId-6957142443986133387--18dd92a.1350b41ec2a.-7d4e</con1:id>
                  <con3:service xsi:type="ref:ProxyRef" ref="ITEL/Core/Proxies/consultarEstadoRecargaLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                  <con3:operation>consultarEstadoRecarga</con3:operation>
                  <con3:request>
                    <con3:body>$consultarEstadoRequest</con3:body>
                  </con3:request>
                  <con3:response>
                    <con3:body>consultarEstadoResponse</con3:body>
                  </con3:response>
                  <con3:requestTransform>
                    <con3:assign varName="consultarEstadoRequest">
                      <con1:id>_ActionId-6957142443986133387--18dd92a.1350b41ec2a.-7d06</con1:id>
                      <con3:expr>
                        <con1:xqueryTransform>
                          <con1:resource ref="ITEL/Core/Resources/XQueries/consultarEstadoRecarga_Req"/>
                          <con1:param name="hostId">
                            <con1:path>data($body/ejec:Input_Parameters/PARAMETROS_TRAMA/PARAMETRO[NOMBRE="HOSTID"]/VALOR)</con1:path>
                          </con1:param>
                          <con1:param name="min">
                            <con1:path>data($body/ejec:Input_Parameters/MIN_DESTINO)</con1:path>
                          </con1:param>
                          <con1:param name="fechaRecarga">
                            <con1:path>data($body/ejec:Input_Parameters/PARAMETROS_TRAMA/PARAMETRO[NOMBRE="MONTORECARGA"]/VALOR)</con1:path>
                          </con1:param>
                          <con1:param name="consecutivo">
                            <con1:path>data($body/ejec:Input_Parameters/PARAMETROS_TRAMA/PARAMETRO[NOMBRE="CONSECUTIVO"]/VALOR)</con1:path>
                          </con1:param>
                        </con1:xqueryTransform>
                      </con3:expr>
                    </con3:assign>
                  </con3:requestTransform>
                  <con3:responseTransform>
                    <con3:ifThenElse>
                      <con1:id>_ActionId-2883577540949710205--6e2d26f9.138d97a2861.-7e62</con1:id>
                      <con3:case>
                        <con3:condition>
                          <con1:xqueryText>data($consultarEstadoResponse/CODIGO) = 'OK' and data($consultarEstadoResponse/MENSAJE/RESPUESTA) != ''</con1:xqueryText>
                        </con3:condition>
                        <con3:actions>
                          <con3:assign varName="reglasNegocioResponse">
                            <con1:id>_ActionId-2926045931761452018--634be8ce.1394a3b26bb.-7014</con1:id>
                            <con3:expr>
                              <con1:xqueryText><![CDATA[<ns0:WS_Result xmlns:ns0="http://www.comcel.com.co/ConsultarReglas/">
	<CODIGO>{ data($consultarEstadoResponse/CODIGO) }</CODIGO>
	<MENSAJE>
		<ERROR>{ data($consultarEstadoResponse/CODIGO) }</ERROR>
		<ERRORDESC>{ data($consultarEstadoResponse/DESCRIPCION) }</ERRORDESC>
		<CONSULTASUSCRIPTOR>FALSE</CONSULTASUSCRIPTOR>
		<PARAMETROS>
			<PARAMETRO>
				<NOMBRE>TRAMA</NOMBRE>
				<TIPO>string</TIPO>
				<VALOR>{ data($consultarEstadoResponse/MENSAJE/RESPUESTA) }</VALOR>
			</PARAMETRO>
		</PARAMETROS>
	</MENSAJE>
</ns0:WS_Result>]]></con1:xqueryText>
                            </con3:expr>
                          </con3:assign>
                        </con3:actions>
                      </con3:case>
                      <con3:case>
                        <con3:condition>
                          <con1:xqueryText>data($consultarEstadoResponse/CODIGO) = 'OK' and data($consultarEstadoResponse/MENSAJE/RESPUESTA) = ''</con1:xqueryText>
                        </con3:condition>
                        <con3:actions>
                          <con3:assign varName="codError">
                            <con1:id>_ActionId-2926045931761452018--634be8ce.1394a3b26bb.-6fbc</con1:id>
                            <con3:expr>
                              <con1:xqueryText>"937"</con1:xqueryText>
                            </con3:expr>
                          </con3:assign>
                        </con3:actions>
                      </con3:case>
                      <con3:default>
                        <con3:assign varName="codError">
                          <con1:id>_ActionId-2926045931761452018--634be8ce.1394a3b26bb.-7012</con1:id>
                          <con3:expr>
                            <con1:xqueryText>"909"</con1:xqueryText>
                          </con3:expr>
                        </con3:assign>
                      </con3:default>
                    </con3:ifThenElse>
                  </con3:responseTransform>
                </con3:wsCallout>
              </con3:actions>
            </con3:case>
            <con3:case>
              <con3:condition>
                <con1:xqueryText>$metodo = ("302","303","304","305","308", "311","312","314","315")</con1:xqueryText>
              </con3:condition>
              <con3:actions>
                <con3:ifThenElse>
                  <con1:id>_ActionId-8479204426743659348-9651aae.139d5c9a89c.-7c72</con1:id>
                  <con3:case>
                    <con3:condition>
                      <con1:xqueryText>$esOCS = "true"</con1:xqueryText>
                    </con3:condition>
                    <con3:actions>
                      <con3:wsCallout>
                        <con1:id>_ActionId-8479204426743659348-9651aae.139d5c9a89c.-7c6e</con1:id>
                        <con3:service xsi:type="ref:ProxyRef" ref="ITEL/Core/Proxies/consultarTipoFAFLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                        <con3:operation>consultarTipoFAF</con3:operation>
                        <con3:request>
                          <con3:body>$tipoFAFRequest</con3:body>
                        </con3:request>
                        <con3:response>
                          <con3:body>tipoFAFResponse</con3:body>
                        </con3:response>
                        <con3:requestTransform>
                          <con3:assign varName="tipoFAFRequest">
                            <con1:id>_ActionId-8479204426743659348-9651aae.139d5c9a89c.-7c6f</con1:id>
                            <con3:expr>
                              <con1:xqueryTransform>
                                <con1:resource ref="ITEL/Core/Resources/XQueries/consultarTipoFAFPS_Req"/>
                                <con1:param name="tipo">
                                  <con1:path>if ($metodo = "311" or $metodo = "312")then
"FNF"
else 
"ILIMITADO"</con1:path>
                                </con1:param>
                              </con1:xqueryTransform>
                            </con3:expr>
                          </con3:assign>
                        </con3:requestTransform>
                        <con3:responseTransform/>
                      </con3:wsCallout>
                      <con3:ifThenElse>
                        <con1:id>_ActionId-2999359011571076042--72c97c75.156955b6f47.-67c5</con1:id>
                        <con3:case>
                          <con3:condition>
                            <con1:xqueryText>$metodo = ("311", "314")</con1:xqueryText>
                          </con3:condition>
                          <con3:actions>
                            <con3:assign varName="reglasNegocioResponse">
                              <con1:id>_ActionId-2999359011571076042--72c97c75.156955b6f47.-66cf</con1:id>
                              <con3:expr>
                                <con1:xqueryText><![CDATA[<ns0:WS_Result xmlns:ns0="http://www.comcel.com.co/ConsultarReglas/">
	<CODIGO>1</CODIGO>
	<MENSAJE>
		<ERROR>1</ERROR>
		<ERRORDESC></ERRORDESC>
		<CONSULTASUSCRIPTOR>FALSE</CONSULTASUSCRIPTOR>
		<PARAMETROS>
		</PARAMETROS>
	</MENSAJE>
</ns0:WS_Result>]]></con1:xqueryText>
                              </con3:expr>
                            </con3:assign>
                            <con3:wsCallout>
                              <con1:id>_ActionId-2999359011571076042--72c97c75.156955b6f47.-66bf</con1:id>
                              <con3:service xsi:type="ref:ProxyRef" ref="ITEL/Core/Proxies/consultarCantidadCambiosFNFLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                              <con3:operation>consultarCambiosFNF</con3:operation>
                              <con3:request>
                                <con3:body>$consultarCambiosFNF_Req</con3:body>
                              </con3:request>
                              <con3:response>
                                <con3:body>consultarCambiosFNF_Res</con3:body>
                              </con3:response>
                              <con3:requestTransform>
                                <con3:assign varName="consultarCambiosFNF_Req">
                                  <con1:id>_ActionId-2999359011571076042--72c97c75.156955b6f47.-66c6</con1:id>
                                  <con3:expr>
                                    <con1:xqueryTransform>
                                      <con1:resource ref="ITEL/Core/Resources/XQueries/ejecutarReglasNegocio_Req_consultarCambiosFNF"/>
                                      <con1:param name="min">
                                        <con1:path>data($body/ejec:Input_Parameters/MIN_DESTINO)</con1:path>
                                      </con1:param>
                                    </con1:xqueryTransform>
                                  </con3:expr>
                                </con3:assign>
                              </con3:requestTransform>
                              <con3:responseTransform>
                                <con3:ifThenElse>
                                  <con1:id>_ActionId-2999359011571076042--72c97c75.156955b6f47.-66c5</con1:id>
                                  <con3:case>
                                    <con3:condition>
                                      <con1:xqueryText>data($consultarCambiosFNF_Res//*:CODIGO) != '1'</con1:xqueryText>
                                    </con3:condition>
                                    <con3:actions>
                                      <con3:assign varName="codError">
                                        <con1:id>_ActionId-2999359011571076042--72c97c75.156955b6f47.-66c4</con1:id>
                                        <con3:expr>
                                          <con1:xqueryText>"909"</con1:xqueryText>
                                        </con3:expr>
                                      </con3:assign>
                                    </con3:actions>
                                  </con3:case>
                                  <con3:default>
                                    <con3:insert varName="body">
                                      <con1:id>_ActionId-2999359011571076042--72c97c75.156955b6f47.-66c3</con1:id>
                                      <con3:location>
                                        <con1:xpathText>./ejec:Input_Parameters/PARAMETROS_TRAMA</con1:xpathText>
                                      </con3:location>
                                      <con3:where>last-child</con3:where>
                                      <con3:expr>
                                        <con1:xqueryText><![CDATA[<PARAMETRO>
	<NOMBRE>CAMBIOS_FNF</NOMBRE>
	<TIPO>decimal</TIPO>
	<VALOR>{ $consultarCambiosFNF_Res//*:CANTIDAD_CAMBIOS_FNF/text() }</VALOR>
</PARAMETRO>]]></con1:xqueryText>
                                      </con3:expr>
                                    </con3:insert>
                                    <con3:insert varName="reglasNegocioResponse">
                                      <con1:id>_ActionId-2999359011571076042--72c97c75.156955b6f47.-66c2</con1:id>
                                      <con3:location>
                                        <con1:xpathText>./MENSAJE/PARAMETROS</con1:xpathText>
                                      </con3:location>
                                      <con3:where>last-child</con3:where>
                                      <con3:expr>
                                        <con1:xqueryText><![CDATA[<PARAMETRO>
	<NOMBRE>CAMBIOS_FNF</NOMBRE>
	<TIPO>decimal</TIPO>
	<VALOR>{ $consultarCambiosFNF_Res//*:CANTIDAD_CAMBIOS_FNF/text() }</VALOR>
</PARAMETRO>]]></con1:xqueryText>
                                      </con3:expr>
                                    </con3:insert>
                                    <con3:insert varName="reglasNegocioResponse">
                                      <con1:id>_ActionId-2999359011571076042--72c97c75.156955b6f47.-66c1</con1:id>
                                      <con3:location>
                                        <con1:xpathText>./MENSAJE/PARAMETROS</con1:xpathText>
                                      </con3:location>
                                      <con3:where>first-child</con3:where>
                                      <con3:expr>
                                        <con1:xqueryText><![CDATA[<PARAMETRO>
	<NOMBRE>ACREDITACUENTA</NOMBRE>
	<TIPO>string</TIPO>
	<VALOR>{ 
	   if(data($body/ejec:Input_Parameters/PARAMETROS_TRAMA/PARAMETRO[NOMBRE='BONIFICAR']/VALOR)
= '1') then 'TRUE' else 'FALSE'
	 }</VALOR>
</PARAMETRO>]]></con1:xqueryText>
                                      </con3:expr>
                                    </con3:insert>
                                  </con3:default>
                                </con3:ifThenElse>
                              </con3:responseTransform>
                            </con3:wsCallout>
                          </con3:actions>
                        </con3:case>
                        <con3:default/>
                      </con3:ifThenElse>
                      <con3:ifThenElse>
                        <con1:id>_ActionId-5671802006698221921-7dba416a.149c03ee681.-7365</con1:id>
                        <con3:case>
                          <con3:condition>
                            <con1:xqueryText>$metodo = ("302","308","314")</con1:xqueryText>
                          </con3:condition>
                          <con3:actions>
                            <con3:wsCallout>
                              <con1:id>_ActionId-5671802006698221921-7dba416a.149c03ee681.-7361</con1:id>
                              <con3:service xsi:type="ref:ProxyRef" ref="ITEL/Core/Proxies/consultarModificacionElegidosLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                              <con3:operation>consultarModificacionElegidos</con3:operation>
                              <con3:request>
                                <con3:body>$consultarModificacionElegidosRequest</con3:body>
                              </con3:request>
                              <con3:response>
                                <con3:body>consultarModificacionElegidosResponse</con3:body>
                              </con3:response>
                              <con3:requestTransform>
                                <con3:assign varName="consultarModificacionElegidosRequest">
                                  <con1:id>_ActionId-5671802006698221921-7dba416a.149c03ee681.-7362</con1:id>
                                  <con3:expr>
                                    <con1:xqueryTransform>
                                      <con1:resource ref="ITEL/Core/Resources/XQueries/ejecutarReglasNegocio_Req_consultarModificacionElegidos"/>
                                      <con1:param name="min">
                                        <con1:path>$body/ejec:Input_Parameters/MIN_DESTINO/text()</con1:path>
                                      </con1:param>
                                    </con1:xqueryTransform>
                                  </con3:expr>
                                </con3:assign>
                              </con3:requestTransform>
                              <con3:responseTransform>
                                <con3:insert varName="body">
                                  <con1:id>_ActionId-5671802006698221921-7dba416a.149c03ee681.-7102</con1:id>
                                  <con3:location>
                                    <con1:xpathText>./ejec:Input_Parameters/PARAMETROS_TRAMA</con1:xpathText>
                                  </con3:location>
                                  <con3:where>last-child</con3:where>
                                  <con3:expr>
                                    <con1:xqueryText><![CDATA[<PARAMETRO>
	<NOMBRE>CANTIDAD_MODIFICACION_ELEGIDOS</NOMBRE>
	<TIPO>decimal</TIPO>
	<VALOR>{ $consultarModificacionElegidosResponse/*:MENSAJE/*:CANTIDAD_MODIFICACION_ELEGIDOS/text() }</VALOR>
</PARAMETRO>]]></con1:xqueryText>
                                  </con3:expr>
                                </con3:insert>
                                <con3:insert varName="body">
                                  <con1:id>_ActionId-5671802006698221921-7dba416a.149c03ee681.-7156</con1:id>
                                  <con3:location>
                                    <con1:xpathText>./ejec:Input_Parameters/PARAMETROS_TRAMA</con1:xpathText>
                                  </con3:location>
                                  <con3:where>last-child</con3:where>
                                  <con3:expr>
                                    <con1:xqueryText><![CDATA[<PARAMETRO>
	<NOMBRE>ELEGIDOS_MODIFICADOS</NOMBRE>
	<TIPO>decimal</TIPO>
	<VALOR>{ $consultarModificacionElegidosResponse/*:MENSAJE/*:ELEGIDOS_MODIFICADOS/text() }</VALOR>
</PARAMETRO>]]></con1:xqueryText>
                                  </con3:expr>
                                </con3:insert>
                              </con3:responseTransform>
                            </con3:wsCallout>
                          </con3:actions>
                        </con3:case>
                        <con3:default/>
                      </con3:ifThenElse>
                    </con3:actions>
                  </con3:case>
                  <con3:default>
                    <con3:wsCallout>
                      <con1:id>_ActionId-8479204426743659348-9651aae.139d5c9a89c.-7c64</con1:id>
                      <con3:service xsi:type="ref:ProxyRef" ref="ITEL/Core/Proxies/consultarVigenciaElegidoLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                      <con3:operation>consultarVigenciaElegido</con3:operation>
                      <con3:request>
                        <con3:body>$vigenciaRequest</con3:body>
                      </con3:request>
                      <con3:response>
                        <con3:body>vigenciaResponse</con3:body>
                      </con3:response>
                      <con3:requestTransform>
                        <con3:assign varName="vigenciaRequest">
                          <con1:id>_ActionId-8479204426743659348-9651aae.139d5c9a89c.-7c68</con1:id>
                          <con3:expr>
                            <con1:xqueryTransform>
                              <con1:resource ref="ITEL/Core/Resources/XQueries/consultarVigenciaElegido_Req"/>
                              <con1:param name="min">
                                <con1:path>data($body/ejec:Input_Parameters/MIN_DESTINO)</con1:path>
                              </con1:param>
                              <con1:param name="minElegido">
                                <con1:path>"0"</con1:path>
                              </con1:param>
                            </con1:xqueryTransform>
                          </con3:expr>
                        </con3:assign>
                      </con3:requestTransform>
                      <con3:responseTransform>
                        <con3:ifThenElse>
                          <con1:id>_ActionId-8479204426743659348-9651aae.139d5c9a89c.-7c67</con1:id>
                          <con3:case>
                            <con3:condition>
                              <con1:xqueryText>data($vigenciaResponse/CODIGO) != 'OK'</con1:xqueryText>
                            </con3:condition>
                            <con3:actions>
                              <con3:assign varName="codError">
                                <con1:id>_ActionId-8479204426743659348-9651aae.139d5c9a89c.-7c66</con1:id>
                                <con3:expr>
                                  <con1:xqueryText>"909"</con1:xqueryText>
                                </con3:expr>
                              </con3:assign>
                            </con3:actions>
                          </con3:case>
                          <con3:default>
                            <con3:assign varName="reglasNegocioResponse">
                              <con1:id>_ActionId-8479204426743659348-9651aae.139d5c9a89c.-7c65</con1:id>
                              <con3:expr>
                                <con1:xqueryText><![CDATA[<ns0:WS_Result xmlns:ns0="http://www.comcel.com.co/ConsultarReglas/">
	<CODIGO>{ data($consultarEstadoResponse/CODIGO) }</CODIGO>
	<MENSAJE>
		<ERROR>{ data($consultarEstadoResponse/CODIGO) }</ERROR>
		<ERRORDESC>{ data($consultarEstadoResponse/DESCRIPCION) }</ERRORDESC>
		<CONSULTASUSCRIPTOR>FALSE</CONSULTASUSCRIPTOR>
		<PARAMETROS>
			<PARAMETRO>
				<NOMBRE>TRAMA</NOMBRE>
				<TIPO>string</TIPO>
				<VALOR>{ data($consultarEstadoResponse/MENSAJE/RESPUESTA) }</VALOR>
			</PARAMETRO>
		</PARAMETROS>
	</MENSAJE>
</ns0:WS_Result>]]></con1:xqueryText>
                              </con3:expr>
                            </con3:assign>
                          </con3:default>
                        </con3:ifThenElse>
                      </con3:responseTransform>
                    </con3:wsCallout>
                    <con3:insert varName="body">
                      <con1:id>_ActionId-8479204426743659348-9651aae.139d5c9a89c.-7c62</con1:id>
                      <con3:location>
                        <con1:xpathText>./ejec:Input_Parameters/PARAMETROS_TRAMA</con1:xpathText>
                      </con3:location>
                      <con3:where>last-child</con3:where>
                      <con3:expr>
                        <con1:xqueryText><![CDATA[<PARAMETRO>
	<NOMBRE>VIGENCIA</NOMBRE>
	<TIPO>string</TIPO>
	<VALOR>{data($vigenciaResponse/MENSAJE/VIGENCIA)}</VALOR>
</PARAMETRO>]]></con1:xqueryText>
                      </con3:expr>
                    </con3:insert>
                  </con3:default>
                </con3:ifThenElse>
              </con3:actions>
            </con3:case>
            <con3:case>
              <con3:condition>
                <con1:xqueryText>$metodo = ("306")</con1:xqueryText>
              </con3:condition>
              <con3:actions>
                <con3:assign varName="reglasNegocioResponse">
                  <con1:id>_ActionId-2999359011571076042--72c97c75.156955b6f47.-70d5</con1:id>
                  <con3:expr>
                    <con1:xqueryText><![CDATA[<ns0:WS_Result xmlns:ns0="http://www.comcel.com.co/ConsultarReglas/">
	<CODIGO>1</CODIGO>
	<MENSAJE>
		<ERROR>1</ERROR>
		<ERRORDESC></ERRORDESC>
		<CONSULTASUSCRIPTOR>FALSE</CONSULTASUSCRIPTOR>
		<PARAMETROS>
		</PARAMETROS>
	</MENSAJE>
</ns0:WS_Result>]]></con1:xqueryText>
                  </con3:expr>
                </con3:assign>
                <con3:wsCallout>
                  <con1:id>_ActionId-2999359011571076042--72c97c75.156955b6f47.-70c7</con1:id>
                  <con3:service xsi:type="ref:ProxyRef" ref="ITEL/Core/Proxies/consultarCantidadCambiosFNFLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                  <con3:operation>consultarCambiosFNF</con3:operation>
                  <con3:request>
                    <con3:body>$consultarCambiosFNF_Req</con3:body>
                  </con3:request>
                  <con3:response>
                    <con3:body>consultarCambiosFNF_Res</con3:body>
                  </con3:response>
                  <con3:requestTransform>
                    <con3:assign varName="consultarCambiosFNF_Req">
                      <con1:id>_ActionId-2999359011571076042--72c97c75.156955b6f47.-70cd</con1:id>
                      <con3:expr>
                        <con1:xqueryTransform>
                          <con1:resource ref="ITEL/Core/Resources/XQueries/ejecutarReglasNegocio_Req_consultarCambiosFNF"/>
                          <con1:param name="min">
                            <con1:path>data($body/ejec:Input_Parameters/MIN_DESTINO)</con1:path>
                          </con1:param>
                        </con1:xqueryTransform>
                      </con3:expr>
                    </con3:assign>
                  </con3:requestTransform>
                  <con3:responseTransform>
                    <con3:ifThenElse>
                      <con1:id>_ActionId-2999359011571076042--72c97c75.156955b6f47.-70cc</con1:id>
                      <con3:case>
                        <con3:condition>
                          <con1:xqueryText>data($consultarCambiosFNF_Res//*:CODIGO) != '1'</con1:xqueryText>
                        </con3:condition>
                        <con3:actions>
                          <con3:assign varName="codError">
                            <con1:id>_ActionId-2999359011571076042--72c97c75.156955b6f47.-70cb</con1:id>
                            <con3:expr>
                              <con1:xqueryText>"909"</con1:xqueryText>
                            </con3:expr>
                          </con3:assign>
                        </con3:actions>
                      </con3:case>
                      <con3:default>
                        <con3:insert varName="body">
                          <con1:id>_ActionId-2999359011571076042--72c97c75.156955b6f47.-70ca</con1:id>
                          <con3:location>
                            <con1:xpathText>./ejec:Input_Parameters/PARAMETROS_TRAMA</con1:xpathText>
                          </con3:location>
                          <con3:where>last-child</con3:where>
                          <con3:expr>
                            <con1:xqueryText><![CDATA[<PARAMETRO>
	<NOMBRE>CAMBIOS_FNF</NOMBRE>
	<TIPO>decimal</TIPO>
	<VALOR>{ $consultarCambiosFNF_Res//*:CANTIDAD_CAMBIOS_FNF/text() }</VALOR>
</PARAMETRO>]]></con1:xqueryText>
                          </con3:expr>
                        </con3:insert>
                        <con3:insert varName="reglasNegocioResponse">
                          <con1:id>_ActionId-2999359011571076042--72c97c75.156955b6f47.-70c9</con1:id>
                          <con3:location>
                            <con1:xpathText>./MENSAJE/PARAMETROS</con1:xpathText>
                          </con3:location>
                          <con3:where>last-child</con3:where>
                          <con3:expr>
                            <con1:xqueryText><![CDATA[<PARAMETRO>
	<NOMBRE>CAMBIOS_FNF</NOMBRE>
	<TIPO>decimal</TIPO>
	<VALOR>{ $consultarCambiosFNF_Res//*:CANTIDAD_CAMBIOS_FNF/text() }</VALOR>
</PARAMETRO>]]></con1:xqueryText>
                          </con3:expr>
                        </con3:insert>
                        <con3:insert varName="reglasNegocioResponse">
                          <con1:id>_ActionId-2999359011571076042--72c97c75.156955b6f47.-6ea9</con1:id>
                          <con3:location>
                            <con1:xpathText>./MENSAJE/PARAMETROS</con1:xpathText>
                          </con3:location>
                          <con3:where>first-child</con3:where>
                          <con3:expr>
                            <con1:xqueryText><![CDATA[<PARAMETRO>
	<NOMBRE>ACREDITACUENTA</NOMBRE>
	<TIPO>string</TIPO>
	<VALOR>{ 
	   if(data($body/ejec:Input_Parameters/PARAMETROS_TRAMA/PARAMETRO[NOMBRE='BONIFICAR']/VALOR)
= '1') then 'TRUE' else 'FALSE'
	 }</VALOR>
</PARAMETRO>]]></con1:xqueryText>
                          </con3:expr>
                        </con3:insert>
                        <con3:assign varName="PRUEBA">
                          <con1:id>_ActionId-2999359011571076042--72c97c75.156955b6f47.-70c8</con1:id>
                          <con3:expr>
                            <con1:xqueryText>$body</con1:xqueryText>
                          </con3:expr>
                        </con3:assign>
                      </con3:default>
                    </con3:ifThenElse>
                  </con3:responseTransform>
                </con3:wsCallout>
              </con3:actions>
            </con3:case>
            <con3:case>
              <con3:condition>
                <con1:xqueryText>$metodo = ("310","313")</con1:xqueryText>
              </con3:condition>
              <con3:actions>
                <con3:assign varName="reglasNegocioResponse">
                  <con1:id>_ActionId-8017300725784662414--5e8352b9.157721b702d.-54bf</con1:id>
                  <con3:expr>
                    <con1:xqueryText><![CDATA[<ns0:WS_Result xmlns:ns0="http://www.comcel.com.co/ConsultarReglas/">
	<CODIGO>1</CODIGO>
	<MENSAJE>
		<ERROR>1</ERROR>
		<ERRORDESC></ERRORDESC>
		<CONSULTASUSCRIPTOR>FALSE</CONSULTASUSCRIPTOR>
		<PARAMETROS>
		</PARAMETROS>
	</MENSAJE>
</ns0:WS_Result>]]></con1:xqueryText>
                  </con3:expr>
                </con3:assign>
              </con3:actions>
            </con3:case>
            <con3:case>
              <con3:condition>
                <con1:xqueryText>$metodo = "100"</con1:xqueryText>
              </con3:condition>
              <con3:actions>
                <con3:insert varName="reglasNegocioResponse">
                  <con1:id>_ActionId-3942861544137076758-6df4cc71.134332be51d.-7ac0</con1:id>
                  <con3:location>
                    <con1:xpathText>./MENSAJE/PARAMETROS</con1:xpathText>
                  </con3:location>
                  <con3:where>last-child</con3:where>
                  <con3:expr>
                    <con1:xqueryText><![CDATA[<PARAMETRO>
	<NOMBRE>CONSULTASDIA</NOMBRE>
	<TIPO>decimal</TIPO>
	<VALOR>{ $consultasDiaResponse/con:MENSAJE/con:CONSULTASREALIZADAS/text() }</VALOR>
</PARAMETRO>]]></con1:xqueryText>
                  </con3:expr>
                </con3:insert>
                <con3:insert varName="body">
                  <con1:id>_ActionId-3942861544137076758-6df4cc71.134332be51d.-7abf</con1:id>
                  <con3:location>
                    <con1:xpathText>./ejec:Input_Parameters/PARAMETROS_TRAMA</con1:xpathText>
                  </con3:location>
                  <con3:where>last-child</con3:where>
                  <con3:expr>
                    <con1:xqueryText><![CDATA[<PARAMETRO>
	<NOMBRE>CONTRATOESPOSTPAGO</NOMBRE>
	<TIPO>string</TIPO>
	<VALOR>{ $body/ejec:Input_Parameters/CONTRATOESPOSTPAGO/text() }</VALOR>
</PARAMETRO>]]></con1:xqueryText>
                  </con3:expr>
                </con3:insert>
                <con3:insert varName="body">
                  <con1:id>_ActionId-3942861544137076758-6df4cc71.134332be51d.-7a9d</con1:id>
                  <con3:location>
                    <con1:xpathText>./ejec:Input_Parameters/PARAMETROS_TRAMA</con1:xpathText>
                  </con3:location>
                  <con3:where>last-child</con3:where>
                  <con3:expr>
                    <con1:xqueryText><![CDATA[<PARAMETRO>
	<NOMBRE>CATEGORIA</NOMBRE>
	<TIPO>string</TIPO>
	<VALOR>{ $body/ejec:Input_Parameters/CATEGORIA/text() }</VALOR>
</PARAMETRO>]]></con1:xqueryText>
                  </con3:expr>
                </con3:insert>
                <con3:insert varName="body">
                  <con1:id>_ActionId-3942861544137076758-6df4cc71.134332be51d.-7a78</con1:id>
                  <con3:location>
                    <con1:xpathText>./ejec:Input_Parameters/PARAMETROS_TRAMA</con1:xpathText>
                  </con3:location>
                  <con3:where>last-child</con3:where>
                  <con3:expr>
                    <con1:xqueryText><![CDATA[<PARAMETRO>
	<NOMBRE>CARGAINICIAL</NOMBRE>
	<TIPO>string</TIPO>
	<VALOR>{ $body/ejec:Input_Parameters/CARGAINICIAL/text() }</VALOR>
</PARAMETRO>]]></con1:xqueryText>
                  </con3:expr>
                </con3:insert>
                <con3:insert varName="body">
                  <con1:id>_ActionId-3942861544137076758-6df4cc71.134332be51d.-7a5c</con1:id>
                  <con3:location>
                    <con1:xpathText>./ejec:Input_Parameters/PARAMETROS_TRAMA</con1:xpathText>
                  </con3:location>
                  <con3:where>last-child</con3:where>
                  <con3:expr>
                    <con1:xqueryText><![CDATA[<PARAMETRO>
	<NOMBRE>BLOQUEA</NOMBRE>
	<TIPO>decimal</TIPO>
	<VALOR>{ $body/ejec:Input_Parameters/BLOQUEA/text() }</VALOR>
</PARAMETRO>]]></con1:xqueryText>
                  </con3:expr>
                </con3:insert>
                <con3:insert varName="body">
                  <con1:id>_ActionId-6778688775837748595--2fa85a0b.1345663b4be.-5feb</con1:id>
                  <con3:location>
                    <con1:xpathText>./ejec:Input_Parameters/PARAMETROS_TRAMA</con1:xpathText>
                  </con3:location>
                  <con3:where>last-child</con3:where>
                  <con3:expr>
                    <con1:xqueryText><![CDATA[<PARAMETRO>
	<NOMBRE>VIGENCIA</NOMBRE>
	<TIPO>decimal</TIPO>
	<VALOR>{ $body/ejec:Input_Parameters/VIGENCIA/text() }</VALOR>
</PARAMETRO>]]></con1:xqueryText>
                  </con3:expr>
                </con3:insert>
              </con3:actions>
            </con3:case>
            <con3:case>
              <con3:condition>
                <con1:xqueryText>$metodo = ("400","401","403") and $esOCS != "true"</con1:xqueryText>
              </con3:condition>
              <con3:actions>
                <con3:assign varName="tiempoTemp">
                  <con1:id>_ActionId-1785534810374007599--15529676.13d6447c397.-7f75</con1:id>
                  <con3:expr>
                    <con1:xqueryText>fn:current-dateTime()</con1:xqueryText>
                  </con3:expr>
                </con3:assign>
                <con3:wsCallout>
                  <con1:id>_ActionId-9136876008661476161--4d26bcbf.13cf3e5ea0b.-7dcf</con1:id>
                  <con3:service xsi:type="ref:ProxyRef" ref="ITEL/Core/Proxies/consultarDatosMinesLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                  <con3:operation>consultarDatosMines</con3:operation>
                  <con3:request>
                    <con3:body>$datos</con3:body>
                  </con3:request>
                  <con3:response>
                    <con3:body>respMines</con3:body>
                  </con3:response>
                  <con3:requestTransform>
                    <con3:assign varName="datos">
                      <con1:id>_ActionId-9136876008661476161--4d26bcbf.13cf3e5ea0b.-7dd0</con1:id>
                      <con3:expr>
                        <con1:xqueryTransform>
                          <con1:resource ref="ITEL/Core/Resources/XQueries/ejecutarReglasNegocio_Req_consultarDatosMines"/>
                          <con1:param name="inOrigen">
                            <con1:path>if($inOrigen!= "" and number($inOrigen) &lt; 50) then
$inOrigen
else ""</con1:path>
                          </con1:param>
                          <con1:param name="timeout">
                            <con1:path>$timeout</con1:path>
                          </con1:param>
                          <con1:param name="minOrigen">
                            <con1:path>if($inOrigen!= "" and number($inOrigen) &lt; 50) then
$minOrigen
else ""</con1:path>
                          </con1:param>
                          <con1:param name="minDestino">
                            <con1:path>if(number($body/ejec:Input_Parameters/IN_DESTINO) &lt; 50) then
data($body/ejec:Input_Parameters/MIN_DESTINO)
else ""</con1:path>
                          </con1:param>
                          <con1:param name="prefijo">
                            <con1:path>$prefijo</con1:path>
                          </con1:param>
                          <con1:param name="inDestino">
                            <con1:path>if(number($body/ejec:Input_Parameters/IN_DESTINO) &lt; 50) then
data($body/ejec:Input_Parameters/IN_DESTINO)
else ""</con1:path>
                          </con1:param>
                        </con1:xqueryTransform>
                      </con3:expr>
                    </con3:assign>
                  </con3:requestTransform>
                  <con3:responseTransform/>
                </con3:wsCallout>
                <con3:assign varName="tiempoInicioEtapa">
                  <con1:id>_ActionId-1785534810374007599--15529676.13d6447c397.-7f8f</con1:id>
                  <con3:expr>
                    <con1:xqueryText>fn:current-dateTime()</con1:xqueryText>
                  </con3:expr>
                </con3:assign>
                <con3:assign varName="duracionSuscriptor">
                  <con1:id>_ActionId-1785534810374007599--15529676.13d6447c397.-7f58</con1:id>
                  <con3:expr>
                    <con1:xqueryText>fn:seconds-from-duration(fn:current-dateTime() - xs:dateTime($tiempoTemp)) * 1000</con1:xqueryText>
                  </con3:expr>
                </con3:assign>
                <con3:insert varName="body">
                  <con1:id>_ActionId-9136876008661476161--4d26bcbf.13cf3e5ea0b.-7db4</con1:id>
                  <con3:location>
                    <con1:xpathText>./ejec:Input_Parameters/PARAMETROS_TRAMA</con1:xpathText>
                  </con3:location>
                  <con3:where>last-child</con3:where>
                  <con3:expr>
                    <con1:xqueryText><![CDATA[<PARAMETRO>
	<NOMBRE>PLAN</NOMBRE>
	<TIPO>string</TIPO>
	<VALOR>{data($respMines/MENSAJE/DatosDestino/*:Contract)}</VALOR>
</PARAMETRO>]]></con1:xqueryText>
                  </con3:expr>
                </con3:insert>
                <con3:insert varName="body">
                  <con1:id>_ActionId-9136876008661476161--4d26bcbf.13cf3e5ea0b.-7d89</con1:id>
                  <con3:location>
                    <con1:xpathText>./ejec:Input_Parameters/PARAMETROS_TRAMA</con1:xpathText>
                  </con3:location>
                  <con3:where>last-child</con3:where>
                  <con3:expr>
                    <con1:xqueryText><![CDATA[<PARAMETRO>
	<NOMBRE>PLANESNUEVOS</NOMBRE>
	<TIPO>string</TIPO>
	<VALOR>{data($body/ejec:Input_Parameters/CONTRATO)}</VALOR>
</PARAMETRO>]]></con1:xqueryText>
                  </con3:expr>
                </con3:insert>
                <con3:insert varName="body">
                  <con1:id>_ActionId-1785534810374007599--15529676.13d6447c397.-7f07</con1:id>
                  <con3:location>
                    <con1:xpathText>./ejec:Input_Parameters/PARAMETROS_TRAMA</con1:xpathText>
                  </con3:location>
                  <con3:where>last-child</con3:where>
                  <con3:expr>
                    <con1:xqueryText><![CDATA[<PARAMETRO>
	<NOMBRE>PLANESBONOADICIONAL</NOMBRE>
	<TIPO>string</TIPO>
	<VALOR>{data($body/ejec:Input_Parameters/CATEGORIA)}</VALOR>
</PARAMETRO>]]></con1:xqueryText>
                  </con3:expr>
                </con3:insert>
                <con3:insert varName="body">
                  <con1:id>_ActionId-1785534810374007599--15529676.13d6447c397.-7ef0</con1:id>
                  <con3:location>
                    <con1:xpathText>./ejec:Input_Parameters/PARAMETROS_TRAMA</con1:xpathText>
                  </con3:location>
                  <con3:where>last-child</con3:where>
                  <con3:expr>
                    <con1:xqueryText><![CDATA[<PARAMETRO>
	<NOMBRE>ELEGIDOSACTIVOS</NOMBRE>
	<TIPO>string</TIPO>
	<VALOR>{
		if(count($respMines/MENSAJE/DatosDestino/*:BestFnF_Numbers/*:Detail) > 0 and
		  xs:date(substring(data($respMines/MENSAJE/DatosDestino/*:BestFnF_ActivationEndTime), 1, 10)) >= current-date()  ) then
		  'true'
		else 'false' 
	}</VALOR>
</PARAMETRO>]]></con1:xqueryText>
                  </con3:expr>
                </con3:insert>
              </con3:actions>
            </con3:case>
            <con3:case>
              <con3:condition>
                <con1:xqueryText>$metodo = "601" or $metodo = "604" or $metodo = '208'</con1:xqueryText>
              </con3:condition>
              <con3:actions>
                <con3:ifThenElse>
                  <con1:id>_ActionId-1158617767404687255--5c13eac3.14a34bce876.-7d9e</con1:id>
                  <con3:case>
                    <con3:condition>
                      <con1:xqueryText>$metodo = '601','604'</con1:xqueryText>
                    </con3:condition>
                    <con3:actions>
                      <con3:insert varName="body">
                        <con1:id>_ActionId-1158617767404687255--5c13eac3.14a34bce876.-7d9c</con1:id>
                        <con3:location>
                          <con1:xpathText>./ejec:Input_Parameters/PARAMETROS_TRAMA</con1:xpathText>
                        </con3:location>
                        <con3:where>last-child</con3:where>
                        <con3:expr>
                          <con1:xqueryText><![CDATA[<PARAMETRO>
	<NOMBRE>CONTRATO</NOMBRE>
	<TIPO>string</TIPO>
	<VALOR>{$body/ejec:Input_Parameters/CONTRATO/text()}</VALOR>
</PARAMETRO>]]></con1:xqueryText>
                        </con3:expr>
                      </con3:insert>
                    </con3:actions>
                  </con3:case>
                  <con3:default/>
                </con3:ifThenElse>
                <con3:wsCallout>
                  <con1:id>_ActionId-5529297048782903076-2766d298.14909fb5c37.-7522</con1:id>
                  <con3:service xsi:type="ref:ProxyRef" ref="ITEL/Core/Proxies/consultarCantidadCambiosDePlanLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                  <con3:operation>bd_consultarCambiosDePlan</con3:operation>
                  <con3:request>
                    <con3:body>$consultasCambiosDePlanRequest</con3:body>
                  </con3:request>
                  <con3:response>
                    <con3:body>consultasCambiosDePlanResponse</con3:body>
                  </con3:response>
                  <con3:requestTransform>
                    <con3:assign varName="consultasCambiosDePlanRequest">
                      <con1:id>_ActionId-5529297048782903076-2766d298.14909fb5c37.-74e9</con1:id>
                      <con3:expr>
                        <con1:xqueryTransform>
                          <con1:resource ref="ITEL/Core/Resources/XQueries/ejecutarReglasNegocio_Req_consultarCambiosDePlan"/>
                          <con1:param name="min">
                            <con1:path>$body/ejec:Input_Parameters/MIN_DESTINO/text()</con1:path>
                          </con1:param>
                        </con1:xqueryTransform>
                      </con3:expr>
                    </con3:assign>
                  </con3:requestTransform>
                  <con3:responseTransform>
                    <con3:ifThenElse>
                      <con1:id>_ActionId-5529297048782903076-2766d298.14909fb5c37.-7473</con1:id>
                      <con3:case>
                        <con3:condition>
                          <con1:xqueryText>data($consultasCambiosDePlanResponse/CODIGO) != '1'</con1:xqueryText>
                        </con3:condition>
                        <con3:actions>
                          <con3:assign varName="codError">
                            <con1:id>_ActionId-5529297048782903076-2766d298.14909fb5c37.-7472</con1:id>
                            <con3:expr>
                              <con1:xqueryText>"909"</con1:xqueryText>
                            </con3:expr>
                          </con3:assign>
                        </con3:actions>
                      </con3:case>
                      <con3:default>
                        <con3:insert varName="body">
                          <con1:id>_ActionId-5529297048782903076-2766d298.14909fb5c37.-7471</con1:id>
                          <con3:location>
                            <con1:xpathText>./ejec:Input_Parameters/PARAMETROS_TRAMA</con1:xpathText>
                          </con3:location>
                          <con3:where>last-child</con3:where>
                          <con3:expr>
                            <con1:xqueryText><![CDATA[<PARAMETRO>
	<NOMBRE>CAMBIOSDEPLAN</NOMBRE>
	<TIPO>decimal</TIPO>
	<VALOR>{ $consultasCambiosDePlanResponse/*:MENSAJE/*:CANTIDAD_CAMBIOS_PLAN/text() }</VALOR>
</PARAMETRO>]]></con1:xqueryText>
                          </con3:expr>
                        </con3:insert>
                      </con3:default>
                    </con3:ifThenElse>
                  </con3:responseTransform>
                </con3:wsCallout>
              </con3:actions>
            </con3:case>
            <con3:case>
              <con3:condition>
                <con1:xqueryText>$metodo = '213'</con1:xqueryText>
              </con3:condition>
              <con3:actions>
                <con3:wsCallout>
                  <con1:id>_ActionId-1259675915633913103-52f096e5.15680daa81f.-7cb1</con1:id>
                  <con3:service xsi:type="ref:ProxyRef" ref="ITEL/Core/Proxies/consultarCantidadCambiosFNFLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                  <con3:operation>consultarCambiosFNF</con3:operation>
                  <con3:request>
                    <con3:body>$consultarCambiosFNFResquest</con3:body>
                  </con3:request>
                  <con3:response>
                    <con3:body>consultarCambiosFNFResponse</con3:body>
                  </con3:response>
                  <con3:requestTransform>
                    <con3:assign varName="consultarCambiosFNFResquest">
                      <con1:id>_ActionId-1259675915633913103-52f096e5.15680daa81f.-7c9c</con1:id>
                      <con3:expr>
                        <con1:xqueryTransform>
                          <con1:resource ref="ITEL/Core/Resources/XQueries/ejecutarReglasNegocio_Req_consultarCambiosFNF"/>
                          <con1:param name="min">
                            <con1:path>data($body/ejec:Input_Parameters/MIN_DESTINO)</con1:path>
                          </con1:param>
                        </con1:xqueryTransform>
                      </con3:expr>
                    </con3:assign>
                  </con3:requestTransform>
                  <con3:responseTransform>
                    <con3:ifThenElse>
                      <con1:id>_ActionId-1259675915633913103-52f096e5.15680daa81f.-7c81</con1:id>
                      <con3:case>
                        <con3:condition>
                          <con1:xqueryText>data($consultarCambiosFNFResponse/CODIGO) != '1'</con1:xqueryText>
                        </con3:condition>
                        <con3:actions>
                          <con3:assign varName="codError">
                            <con1:id>_ActionId-1259675915633913103-52f096e5.15680daa81f.-7c58</con1:id>
                            <con3:expr>
                              <con1:xqueryText>"909"</con1:xqueryText>
                            </con3:expr>
                          </con3:assign>
                        </con3:actions>
                      </con3:case>
                      <con3:default>
                        <con3:insert varName="body">
                          <con1:id>_ActionId-1259675915633913103-52f096e5.15680daa81f.-7c37</con1:id>
                          <con3:location>
                            <con1:xpathText>./ejec:Input_Parameters/PARAMETROS_TRAMA</con1:xpathText>
                          </con3:location>
                          <con3:where>last-child</con3:where>
                          <con3:expr>
                            <con1:xqueryText><![CDATA[<PARAMETRO>
	<NOMBRE>CAMBIOSDEFNF</NOMBRE>
	<TIPO>decimal</TIPO>
	<VALOR>{ $consultarCambiosFNFResponse/*:MENSAJE/*:CANTIDAD_CAMBIOS_FNF/text() }</VALOR>
</PARAMETRO>]]></con1:xqueryText>
                          </con3:expr>
                        </con3:insert>
                      </con3:default>
                    </con3:ifThenElse>
                  </con3:responseTransform>
                </con3:wsCallout>
              </con3:actions>
            </con3:case>
            <con3:case>
              <con3:condition>
                <con1:xqueryText>$metodo = '215'</con1:xqueryText>
              </con3:condition>
              <con3:actions>
                <con3:wsCallout>
                  <con1:id>_ActionId-3645351208375448940--14cfe84a.158f89cfacf.-4cfc</con1:id>
                  <con3:service xsi:type="ref:ProxyRef" ref="ITEL/Core/Proxies/consultarPaquetesDatosMinLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                  <con3:operation>consultarPaquetesDatosMin</con3:operation>
                  <con3:request>
                    <con3:body>$consultarPaquetesDatosRequest</con3:body>
                  </con3:request>
                  <con3:response>
                    <con3:body>consultarPaquetesDatosResponse</con3:body>
                  </con3:response>
                  <con3:requestTransform>
                    <con3:assign varName="consultarPaquetesDatosRequest">
                      <con1:id>_ActionId-3645351208375448940--14cfe84a.158f89cfacf.-4cea</con1:id>
                      <con3:expr>
                        <con1:xqueryTransform>
                          <con1:resource ref="ITEL/Core/Resources/XQueries/consultarPaquetesDatosMin_Req"/>
                          <con1:param name="string3">
                            <con1:path>data($body/*:Input_Parameters/PARAMETROS_TRAMA/PARAMETRO[NOMBRE='MONTORECARGA']/VALOR)</con1:path>
                          </con1:param>
                          <con1:param name="string1">
                            <con1:path>data($body/*:Input_Parameters/MIN_DESTINO)</con1:path>
                          </con1:param>
                          <con1:param name="string2">
                            <con1:path>data($body/*:Input_Parameters/PARAMETROS_TRAMA/PARAMETRO[NOMBRE='BONIFICAR']/VALOR)</con1:path>
                          </con1:param>
                        </con1:xqueryTransform>
                      </con3:expr>
                    </con3:assign>
                  </con3:requestTransform>
                  <con3:responseTransform/>
                </con3:wsCallout>
                <con3:ifThenElse>
                  <con1:id>_ActionId-3645351208375448940--14cfe84a.158f89cfacf.-4c67</con1:id>
                  <con3:case>
                    <con3:condition>
                      <con1:xqueryText>data($consultarPaquetesDatosResponse/CODIGO) != '1'</con1:xqueryText>
                    </con3:condition>
                    <con3:actions>
                      <con3:assign varName="codError">
                        <con1:id>_ActionId-3645351208375448940--14cfe84a.158f89cfacf.-4c23</con1:id>
                        <con3:expr>
                          <con1:xqueryText>"909"</con1:xqueryText>
                        </con3:expr>
                      </con3:assign>
                    </con3:actions>
                  </con3:case>
                  <con3:case>
                    <con3:condition>
                      <con1:xqueryText>data($consultarPaquetesDatosResponse/MENSAJE) = ""</con1:xqueryText>
                    </con3:condition>
                    <con3:actions>
                      <con3:assign varName="codError">
                        <con1:id>_ActionId-3645351208375448940--14cfe84a.158f89cfacf.-4c12</con1:id>
                        <con3:expr>
                          <con1:xqueryText>"41"</con1:xqueryText>
                        </con3:expr>
                      </con3:assign>
                    </con3:actions>
                  </con3:case>
                  <con3:default>
                    <con3:assign varName="reglasNegocioResponse">
                      <con1:id>_ActionId-3645351208375448940--14cfe84a.158f89cfacf.-4c05</con1:id>
                      <con3:expr>
                        <con1:xqueryText><![CDATA[<ns0:WS_Result xmlns:ns0="http://www.comcel.com.co/ConsultarReglas/">
	<CODIGO>1</CODIGO>
	<MENSAJE>
		<ERROR>1</ERROR>
		<ERRORDESC></ERRORDESC>
		<CONSULTASUSCRIPTOR>FALSE</CONSULTASUSCRIPTOR>
		<PARAMETROS>
			<PARAMETRO>
				<NOMBRE>PARAMETROS_PAQUETES</NOMBRE>
				<TIPO>string</TIPO>
				<VALOR>{$consultarPaquetesDatosResponse/MENSAJE/@*,$consultarPaquetesDatosResponse/MENSAJE/node()}</VALOR>
			</PARAMETRO>
		</PARAMETROS>
	</MENSAJE>
</ns0:WS_Result>]]></con1:xqueryText>
                      </con3:expr>
                    </con3:assign>
                  </con3:default>
                </con3:ifThenElse>
              </con3:actions>
            </con3:case>
            <con3:case>
              <con3:condition>
                <con1:xqueryText>$metodo = ("702","703")</con1:xqueryText>
              </con3:condition>
              <con3:actions>
                <con3:ifThenElse>
                  <con1:id>_ActionId-7619517632386627082-190dd107.139f9f9a39c.-79c4</con1:id>
                  <con3:case>
                    <con3:condition>
                      <con1:xqueryText>$esOCS = "true"</con1:xqueryText>
                    </con3:condition>
                    <con3:actions>
                      <con3:wsCallout>
                        <con1:id>_ActionId-7619517632386627082-190dd107.139f9f9a39c.-79a8</con1:id>
                        <con3:service xsi:type="ref:ProxyRef" ref="ITEL/Core/Proxies/consultarTipoFAFLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                        <con3:operation>consultarTipoFAF</con3:operation>
                        <con3:request>
                          <con3:body>$tipoFAFRequest</con3:body>
                        </con3:request>
                        <con3:response>
                          <con3:body>tipoFAFResponse</con3:body>
                        </con3:response>
                        <con3:requestTransform>
                          <con3:assign varName="tipoFAFRequest">
                            <con1:id>_ActionId-7619517632386627082-190dd107.139f9f9a39c.-79a9</con1:id>
                            <con3:expr>
                              <con1:xqueryTransform>
                                <con1:resource ref="ITEL/Core/Resources/XQueries/consultarTipoFAFPS_Req"/>
                                <con1:param name="tipo">
                                  <con1:path>let $cuenta := if($metodo = '702') then data($body/ejec:Input_Parameters/PARAMETROS_TRAMA/PARAMETRO[NOMBRE='BONIFICAR']/VALOR) 
					else data($body/ejec:Input_Parameters/PARAMETROS_TRAMA/PARAMETRO[NOMBRE='MONTORECARGA']/VALOR)
return					
if($cuenta = "0") then
"SMS ONNET"
else if($cuenta = "1") then
"SMS OFFNET"
else "SMS ANY"</con1:path>
                                </con1:param>
                              </con1:xqueryTransform>
                            </con3:expr>
                          </con3:assign>
                        </con3:requestTransform>
                        <con3:responseTransform/>
                      </con3:wsCallout>
                    </con3:actions>
                  </con3:case>
                  <con3:default>
                    <con3:wsCallout>
                      <con1:id>_ActionId-7619517632386627082-190dd107.139f9f9a39c.-79b6</con1:id>
                      <con3:service xsi:type="ref:ProxyRef" ref="ITEL/Core/Proxies/consultarVigenciaElegidoSMSLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                      <con3:operation>consultarVigenciaElegidoSMS</con3:operation>
                      <con3:request>
                        <con3:body>$vigenciaSMSRequest</con3:body>
                      </con3:request>
                      <con3:response>
                        <con3:body>vigenciaSMSResponse</con3:body>
                      </con3:response>
                      <con3:requestTransform>
                        <con3:assign varName="vigenciaSMSRequest">
                          <con1:id>_ActionId-7619517632386627082-190dd107.139f9f9a39c.-79ba</con1:id>
                          <con3:expr>
                            <con1:xqueryTransform>
                              <con1:resource ref="ITEL/Core/Resources/XQueries/consultarVigenciaElegidoSMSPS_Req"/>
                              <con1:param name="elegido">
                                <con1:path>"0"</con1:path>
                              </con1:param>
                              <con1:param name="min">
                                <con1:path>data($body/ejec:Input_Parameters/MIN_DESTINO)</con1:path>
                              </con1:param>
                            </con1:xqueryTransform>
                          </con3:expr>
                        </con3:assign>
                      </con3:requestTransform>
                      <con3:responseTransform>
                        <con3:ifThenElse>
                          <con1:id>_ActionId-7619517632386627082-190dd107.139f9f9a39c.-79b9</con1:id>
                          <con3:case>
                            <con3:condition>
                              <con1:xqueryText>data($vigenciaSMSResponse/CODIGO) != 'OK'</con1:xqueryText>
                            </con3:condition>
                            <con3:actions>
                              <con3:assign varName="codError">
                                <con1:id>_ActionId-7619517632386627082-190dd107.139f9f9a39c.-79b8</con1:id>
                                <con3:expr>
                                  <con1:xqueryText>"909"</con1:xqueryText>
                                </con3:expr>
                              </con3:assign>
                            </con3:actions>
                          </con3:case>
                          <con3:default>
                            <con3:assign varName="reglasNegocioResponse">
                              <con1:id>_ActionId-7619517632386627082-190dd107.139f9f9a39c.-79b7</con1:id>
                              <con3:expr>
                                <con1:xqueryText><![CDATA[<ns0:WS_Result xmlns:ns0="http://www.comcel.com.co/ConsultarReglas/">
	<CODIGO>{ data($consultarEstadoResponse/CODIGO) }</CODIGO>
	<MENSAJE>
		<ERROR>{ data($consultarEstadoResponse/CODIGO) }</ERROR>
		<ERRORDESC>{ data($consultarEstadoResponse/DESCRIPCION) }</ERRORDESC>
		<CONSULTASUSCRIPTOR>FALSE</CONSULTASUSCRIPTOR>
		<PARAMETROS>
			<PARAMETRO>
				<NOMBRE>TRAMA</NOMBRE>
				<TIPO>string</TIPO>
				<VALOR>{ data($consultarEstadoResponse/MENSAJE/RESPUESTA) }</VALOR>
			</PARAMETRO>
		</PARAMETROS>
	</MENSAJE>
</ns0:WS_Result>]]></con1:xqueryText>
                              </con3:expr>
                            </con3:assign>
                          </con3:default>
                        </con3:ifThenElse>
                      </con3:responseTransform>
                    </con3:wsCallout>
                    <con3:insert varName="body">
                      <con1:id>_ActionId-7619517632386627082-190dd107.139f9f9a39c.-79b4</con1:id>
                      <con3:location>
                        <con1:xpathText>./ejec:Input_Parameters/PARAMETROS_TRAMA</con1:xpathText>
                      </con3:location>
                      <con3:where>last-child</con3:where>
                      <con3:expr>
                        <con1:xqueryText><![CDATA[<PARAMETRO>
	<NOMBRE>VIGENCIA</NOMBRE>
	<TIPO>string</TIPO>
	<VALOR>{data($vigenciaSMSResponse/MENSAJE/VIGENCIA)}</VALOR>
</PARAMETRO>]]></con1:xqueryText>
                      </con3:expr>
                    </con3:insert>
                  </con3:default>
                </con3:ifThenElse>
              </con3:actions>
            </con3:case>
            <con3:case>
              <con3:condition>
                <con1:xqueryText>$metodo = "704"</con1:xqueryText>
              </con3:condition>
              <con3:actions>
                <con3:ifThenElse>
                  <con1:id>_ActionId-7619517632386627082-190dd107.139f9f9a39c.-798e</con1:id>
                  <con3:case>
                    <con3:condition>
                      <con1:xqueryText>$esOCS = "true"</con1:xqueryText>
                    </con3:condition>
                    <con3:actions>
                      <con3:wsCallout>
                        <con1:id>_ActionId-7619517632386627082-190dd107.139f9f9a39c.-7982</con1:id>
                        <con3:service xsi:type="ref:ProxyRef" ref="ITEL/Core/Proxies/consultarTipoFAFLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                        <con3:operation>consultarTipoFAF</con3:operation>
                        <con3:request>
                          <con3:body>$tipoFAFRequest</con3:body>
                        </con3:request>
                        <con3:response>
                          <con3:body>tipoFAFResponse</con3:body>
                        </con3:response>
                        <con3:requestTransform>
                          <con3:assign varName="tipoFAFRequest">
                            <con1:id>_ActionId-7619517632386627082-190dd107.139f9f9a39c.-7983</con1:id>
                            <con3:expr>
                              <con1:xqueryTransform>
                                <con1:resource ref="ITEL/Core/Resources/XQueries/consultarTipoFAFPS_Req"/>
                                <con1:param name="tipo">
                                  <con1:path>if(data($body/ejec:Input_Parameters/PARAMETROS_TRAMA/PARAMETRO[NOMBRE='MONTORECARGA']/VALOR) = "0") then
 "SMS ONNET"
else if(data($body/ejec:Input_Parameters/PARAMETROS_TRAMA/PARAMETRO[NOMBRE='MONTORECARGA']/VALOR) = "1") then
 "SMS OFFNET"
else "SMS ANY"</con1:path>
                                </con1:param>
                              </con1:xqueryTransform>
                            </con3:expr>
                          </con3:assign>
                        </con3:requestTransform>
                        <con3:responseTransform/>
                      </con3:wsCallout>
                    </con3:actions>
                  </con3:case>
                  <con3:default>
                    <con3:wsCallout>
                      <con1:id>_ActionId-7619517632386627082-190dd107.139f9f9a39c.-7978</con1:id>
                      <con3:service xsi:type="ref:ProxyRef" ref="ITEL/Core/Proxies/consultarVigenciaElegidoSMSLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                      <con3:operation>consultarVigenciaElegidoSMS</con3:operation>
                      <con3:request>
                        <con3:body>$vigenciaSMSRequest</con3:body>
                      </con3:request>
                      <con3:response>
                        <con3:body>vigenciaSMSResponse</con3:body>
                      </con3:response>
                      <con3:requestTransform>
                        <con3:assign varName="vigenciaSMSRequest">
                          <con1:id>_ActionId-7619517632386627082-190dd107.139f9f9a39c.-797c</con1:id>
                          <con3:expr>
                            <con1:xqueryTransform>
                              <con1:resource ref="ITEL/Core/Resources/XQueries/consultarVigenciaElegidoSMSPS_Req"/>
                              <con1:param name="elegido">
                                <con1:path>"0"</con1:path>
                              </con1:param>
                              <con1:param name="min">
                                <con1:path>data($body/ejec:Input_Parameters/MIN_DESTINO)</con1:path>
                              </con1:param>
                            </con1:xqueryTransform>
                          </con3:expr>
                        </con3:assign>
                      </con3:requestTransform>
                      <con3:responseTransform>
                        <con3:ifThenElse>
                          <con1:id>_ActionId-7619517632386627082-190dd107.139f9f9a39c.-797b</con1:id>
                          <con3:case>
                            <con3:condition>
                              <con1:xqueryText>data($vigenciaSMSResponse/CODIGO) != 'OK'</con1:xqueryText>
                            </con3:condition>
                            <con3:actions>
                              <con3:assign varName="codError">
                                <con1:id>_ActionId-7619517632386627082-190dd107.139f9f9a39c.-797a</con1:id>
                                <con3:expr>
                                  <con1:xqueryText>"909"</con1:xqueryText>
                                </con3:expr>
                              </con3:assign>
                            </con3:actions>
                          </con3:case>
                          <con3:default>
                            <con3:assign varName="reglasNegocioResponse">
                              <con1:id>_ActionId-7619517632386627082-190dd107.139f9f9a39c.-7979</con1:id>
                              <con3:expr>
                                <con1:xqueryText><![CDATA[<ns0:WS_Result xmlns:ns0="http://www.comcel.com.co/ConsultarReglas/">
	<CODIGO>{ data($consultarEstadoResponse/CODIGO) }</CODIGO>
	<MENSAJE>
		<ERROR>{ data($consultarEstadoResponse/CODIGO) }</ERROR>
		<ERRORDESC>{ data($consultarEstadoResponse/DESCRIPCION) }</ERRORDESC>
		<CONSULTASUSCRIPTOR>FALSE</CONSULTASUSCRIPTOR>
		<PARAMETROS>
			<PARAMETRO>
				<NOMBRE>TRAMA</NOMBRE>
				<TIPO>string</TIPO>
				<VALOR>{ data($consultarEstadoResponse/MENSAJE/RESPUESTA) }</VALOR>
			</PARAMETRO>
		</PARAMETROS>
	</MENSAJE>
</ns0:WS_Result>]]></con1:xqueryText>
                              </con3:expr>
                            </con3:assign>
                          </con3:default>
                        </con3:ifThenElse>
                      </con3:responseTransform>
                    </con3:wsCallout>
                    <con3:insert varName="body">
                      <con1:id>_ActionId-7619517632386627082-190dd107.139f9f9a39c.-7976</con1:id>
                      <con3:location>
                        <con1:xpathText>./ejec:Input_Parameters/PARAMETROS_TRAMA</con1:xpathText>
                      </con3:location>
                      <con3:where>last-child</con3:where>
                      <con3:expr>
                        <con1:xqueryText><![CDATA[<PARAMETRO>
	<NOMBRE>VIGENCIA</NOMBRE>
	<TIPO>string</TIPO>
	<VALOR>{$vigenciaSMSResponse/MENSAJE/VIGENCIA}</VALOR>
</PARAMETRO>]]></con1:xqueryText>
                      </con3:expr>
                    </con3:insert>
                  </con3:default>
                </con3:ifThenElse>
              </con3:actions>
            </con3:case>
            <con3:case>
              <con3:condition>
                <con1:xqueryText>$metodo = "705" and $esOCS = "true"</con1:xqueryText>
              </con3:condition>
              <con3:actions>
                <con3:wsCallout>
                  <con1:id>_ActionId-1274739634852955816-2e6f1a5c.13a27374074.-7faf</con1:id>
                  <con3:service xsi:type="ref:ProxyRef" ref="ITEL/Core/Proxies/consultarOLMOffersLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                  <con3:operation>consultarOLMOffers</con3:operation>
                  <con3:request>
                    <con3:body>$offerRequest</con3:body>
                  </con3:request>
                  <con3:response>
                    <con3:body>offerResponse</con3:body>
                  </con3:response>
                  <con3:requestTransform>
                    <con3:assign varName="offerRequest">
                      <con1:id>_ActionId-1274739634852955816-2e6f1a5c.13a27374074.-7fb0</con1:id>
                      <con3:expr>
                        <con1:xqueryTransform>
                          <con1:resource ref="ITEL/Core/Resources/XQueries/consultarOLMOffersPS_Req"/>
                          <con1:param name="cuenta">
                            <con1:path>'3'</con1:path>
                          </con1:param>
                          <con1:param name="vigencia">
                            <con1:path>data($body/ejec:Input_Parameters/PARAMETROS_TRAMA/PARAMETRO[NOMBRE='DIASVIGENCIA']/VALOR)</con1:path>
                          </con1:param>
                          <con1:param name="cantidad">
                            <con1:path>data($body/ejec:Input_Parameters/PARAMETROS_TRAMA/PARAMETRO[NOMBRE='MONTORECARGA']/VALOR)</con1:path>
                          </con1:param>
                        </con1:xqueryTransform>
                      </con3:expr>
                    </con3:assign>
                  </con3:requestTransform>
                  <con3:responseTransform/>
                </con3:wsCallout>
                <con3:ifThenElse>
                  <con1:id>_ActionId-1274739634852955816-2e6f1a5c.13a27374074.-7f79</con1:id>
                  <con3:case>
                    <con3:condition>
                      <con1:xqueryText>data($offerResponse/CODIGO) != "OK"</con1:xqueryText>
                    </con3:condition>
                    <con3:actions>
                      <con3:assign varName="codError">
                        <con1:id>_ActionId-1274739634852955816-2e6f1a5c.13a27374074.-7f64</con1:id>
                        <con3:expr>
                          <con1:xqueryText>"909"</con1:xqueryText>
                        </con3:expr>
                      </con3:assign>
                    </con3:actions>
                  </con3:case>
                  <con3:case>
                    <con3:condition>
                      <con1:xqueryText>data($offerResponse/MENSAJE/OFFERNAME) = ""</con1:xqueryText>
                    </con3:condition>
                    <con3:actions>
                      <con3:assign varName="codError">
                        <con1:id>_ActionId-1274739634852955816-2e6f1a5c.13a27374074.-7f43</con1:id>
                        <con3:expr>
                          <con1:xqueryText>"18"</con1:xqueryText>
                        </con3:expr>
                      </con3:assign>
                    </con3:actions>
                  </con3:case>
                  <con3:default>
                    <con6:assign varName="reglasNegocioResponse" xmlns:con6="http://www.bea.com/wli/sb/stages/transform/config">
                      <con1:id>_ActionId-1274739634852955816-2e6f1a5c.13a27374074.-7f41</con1:id>
                      <con6:expr>
                        <con1:xqueryText><![CDATA[<ns0:WS_Result xmlns:ns0="http://www.comcel.com.co/ConsultarReglas/">
	<CODIGO>1</CODIGO>
	<MENSAJE>
		<ERROR>1</ERROR>
		<ERRORDESC></ERRORDESC>
		<CONSULTASUSCRIPTOR>FALSE</CONSULTASUSCRIPTOR>
		<PARAMETROS>
			<PARAMETRO>
				<NOMBRE>OFFERID</NOMBRE>
				<TIPO>string</TIPO>
				<VALOR>{ data($offerResponse/MENSAJE/OFFERNAME) }</VALOR>
			</PARAMETRO>
		</PARAMETROS>
	</MENSAJE>
</ns0:WS_Result>]]></con1:xqueryText>
                      </con6:expr>
                    </con6:assign>
                  </con3:default>
                </con3:ifThenElse>
              </con3:actions>
            </con3:case>
            <con3:case>
              <con3:condition>
                <con1:xqueryText>$metodo = "409"</con1:xqueryText>
              </con3:condition>
              <con3:actions>
                <con3:wsCallout>
                  <con1:id>_ActionId-3738246199404536167--3fed7bd5.13f7be9077c.-669f</con1:id>
                  <con3:service xsi:type="ref:ProxyRef" ref="ITEL/Core/Proxies/consultarPaquetes_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                  <con3:operation>ConsultarPaquetes</con3:operation>
                  <con3:request>
                    <con3:body>$consultarPaquetesRequest</con3:body>
                  </con3:request>
                  <con3:response>
                    <con3:body>consultarPaquetesResponse</con3:body>
                  </con3:response>
                  <con3:requestTransform>
                    <con3:assign varName="consultarPaquetesRequest">
                      <con1:id>_ActionId-3738246199404536167--3fed7bd5.13f7be9077c.-6667</con1:id>
                      <con3:expr>
                        <con1:xqueryTransform>
                          <con1:resource ref="ITEL/Core/Resources/XQueries/consultarPaquetesPS_Req"/>
                          <con1:param name="codigo">
                            <con1:path>data($body/ejec:Input_Parameters/PARAMETROS_TRAMA/PARAMETRO[NOMBRE='COMENTARIO']/VALOR)</con1:path>
                          </con1:param>
                        </con1:xqueryTransform>
                      </con3:expr>
                    </con3:assign>
                  </con3:requestTransform>
                  <con3:responseTransform/>
                </con3:wsCallout>
                <con3:ifThenElse>
                  <con1:id>_ActionId-3738246199404536167--3fed7bd5.13f7be9077c.-662f</con1:id>
                  <con3:case>
                    <con3:condition>
                      <con1:xqueryText>data($consultarPaquetesResponse/CODIGO) != "OK"</con1:xqueryText>
                    </con3:condition>
                    <con3:actions>
                      <con3:assign varName="codError">
                        <con1:id>_ActionId-3738246199404536167--3fed7bd5.13f7be9077c.-6429</con1:id>
                        <con3:expr>
                          <con1:xqueryText>"909"</con1:xqueryText>
                        </con3:expr>
                      </con3:assign>
                    </con3:actions>
                  </con3:case>
                  <con3:case>
                    <con3:condition>
                      <con1:xqueryText>data($consultarPaquetesResponse/MENSAJE/OFFEROLM) = "NO DATA"</con1:xqueryText>
                    </con3:condition>
                    <con3:actions>
                      <con3:assign varName="codError">
                        <con1:id>_ActionId-3738246199404536167--3fed7bd5.13f7be9077c.-634d</con1:id>
                        <con3:expr>
                          <con1:xqueryText>"41"</con1:xqueryText>
                        </con3:expr>
                      </con3:assign>
                    </con3:actions>
                  </con3:case>
                  <con3:default>
                    <con6:assign varName="reglasNegocioResponse" xmlns:con6="http://www.bea.com/wli/sb/stages/transform/config">
                      <con1:id>_ActionId-3738246199404536167--3fed7bd5.13f7be9077c.-62f9</con1:id>
                      <con6:expr>
                        <con1:xqueryText><![CDATA[<ns0:WS_Result xmlns:ns0="http://www.comcel.com.co/ConsultarReglas/">
	<CODIGO>1</CODIGO>
	<MENSAJE>
		<ERROR>1</ERROR>
		<ERRORDESC></ERRORDESC>
		<CONSULTASUSCRIPTOR>FALSE</CONSULTASUSCRIPTOR>
		<PARAMETROS>
			<PARAMETRO>
				<NOMBRE>UNIDADES</NOMBRE>
				<TIPO>decimal</TIPO>
				<VALOR>{ data($consultarPaquetesResponse/MENSAJE/UNIDADES) }</VALOR>
			</PARAMETRO>
			<PARAMETRO>
				<NOMBRE>VIGENCIA</NOMBRE>
				<TIPO>decimal</TIPO>
				<VALOR>{ data($consultarPaquetesResponse/MENSAJE/VIGENCIA) }</VALOR>
			</PARAMETRO>
			<PARAMETRO>
				<NOMBRE>VALOR</NOMBRE>
				<TIPO>decimal</TIPO>
				<VALOR>{ data($consultarPaquetesResponse/MENSAJE/VALOR) }</VALOR>
			</PARAMETRO>
			<PARAMETRO>
				<NOMBRE>CUENTA</NOMBRE>
				<TIPO>decimal</TIPO>
				<VALOR>{ data($consultarPaquetesResponse/MENSAJE/CUENTA) }</VALOR>
			</PARAMETRO>
			<PARAMETRO>
				<NOMBRE>OFFEROLM</NOMBRE>
				<TIPO>string</TIPO>
				<VALOR>{ data($consultarPaquetesResponse/MENSAJE/OFFEROLM) }</VALOR>
			</PARAMETRO>
		</PARAMETROS>
	</MENSAJE>
</ns0:WS_Result>]]></con1:xqueryText>
                      </con6:expr>
                    </con6:assign>
                    <con3:assign varName="tipoCuenta">
                      <con1:id>_ActionId-3276135303993744801-2f482113.157e3b44c91.-7191</con1:id>
                      <con3:expr>
                        <con1:xqueryText>data($consultarPaquetesResponse/MENSAJE/CUENTA)</con1:xqueryText>
                      </con3:expr>
                    </con3:assign>
                  </con3:default>
                </con3:ifThenElse>
              </con3:actions>
            </con3:case>
            <con3:case>
              <con3:condition>
                <con1:xqueryText>$metodo = "414"</con1:xqueryText>
              </con3:condition>
              <con3:actions>
                <con3:wsCallout>
                  <con1:id>_ActionId-2253312439982545409-5f03a207.1531049037b.-640a</con1:id>
                  <con3:service xsi:type="ref:ProxyRef" ref="ITEL/Core/Proxies/consultarPaquetesTAT_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                  <con3:operation>ConsultarPaquetesTAT</con3:operation>
                  <con3:request>
                    <con3:body>$consultarPaquetesTATRequest</con3:body>
                  </con3:request>
                  <con3:response>
                    <con3:body>consultarPaquetesTATResponse</con3:body>
                  </con3:response>
                  <con3:requestTransform>
                    <con3:assign varName="consultarPaquetesTATRequest">
                      <con1:id>_ActionId-2253312439982545409-5f03a207.1531049037b.-640b</con1:id>
                      <con3:expr>
                        <con1:xqueryTransform>
                          <con1:resource ref="ITEL/Core/Resources/XQueries/consultarPaquetesTATPS_Req"/>
                          <con1:param name="codigo">
                            <con1:path>data($body/ejec:Input_Parameters/PARAMETROS_TRAMA/PARAMETRO[NOMBRE='MONTORECARGA']/VALOR)</con1:path>
                          </con1:param>
                        </con1:xqueryTransform>
                      </con3:expr>
                    </con3:assign>
                  </con3:requestTransform>
                  <con3:responseTransform/>
                </con3:wsCallout>
                <con3:ifThenElse>
                  <con1:id>_ActionId-2253312439982545409-5f03a207.1531049037b.-6409</con1:id>
                  <con3:case>
                    <con3:condition>
                      <con1:xqueryText>data($consultarPaquetesTATResponse/CODIGO) != "OK"</con1:xqueryText>
                    </con3:condition>
                    <con3:actions>
                      <con3:assign varName="codError">
                        <con1:id>_ActionId-2253312439982545409-5f03a207.1531049037b.-6408</con1:id>
                        <con3:expr>
                          <con1:xqueryText>"909"</con1:xqueryText>
                        </con3:expr>
                      </con3:assign>
                    </con3:actions>
                  </con3:case>
                  <con3:case>
                    <con3:condition>
                      <con1:xqueryText>data($consultarPaquetesTATResponse/MENSAJE/HOSTID) = "NO DATA"</con1:xqueryText>
                    </con3:condition>
                    <con3:actions>
                      <con3:assign varName="codError">
                        <con1:id>_ActionId-2253312439982545409-5f03a207.1531049037b.-6407</con1:id>
                        <con3:expr>
                          <con1:xqueryText>"41"</con1:xqueryText>
                        </con3:expr>
                      </con3:assign>
                    </con3:actions>
                  </con3:case>
                  <con3:default/>
                </con3:ifThenElse>
              </con3:actions>
            </con3:case>
            <con3:case>
              <con3:condition>
                <con1:xqueryText>$metodo = "415"</con1:xqueryText>
              </con3:condition>
              <con3:actions>
                <con3:wsCallout>
                  <con1:id>_ActionId-8044975483918427659-3220e920.15853e81890.-7e41</con1:id>
                  <con3:service xsi:type="ref:ProxyRef" ref="ITEL/Core/Proxies/consultarPaquetesDatos_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                  <con3:operation>ConsultarPaquetesDatos</con3:operation>
                  <con3:request>
                    <con3:body>$consultarPaquetesDatosRequest</con3:body>
                  </con3:request>
                  <con3:response>
                    <con3:body>consultarPaquetesDatosResponse</con3:body>
                  </con3:response>
                  <con3:requestTransform>
                    <con3:assign varName="consultarPaquetesDatosRequest">
                      <con1:id>_ActionId-8044975483918427659-3220e920.15853e81890.-7e02</con1:id>
                      <con3:expr>
                        <con1:xqueryTransform>
                          <con1:resource ref="ITEL/Core/Resources/XQueries/consultarPaquetesDatosPS_Req"/>
                          <con1:param name="codigo">
                            <con1:path>data($body/ejec:Input_Parameters/PARAMETROS_TRAMA/PARAMETRO[NOMBRE='COMENTARIO']/VALOR)</con1:path>
                          </con1:param>
                          <con1:param name="canal">
                            <con1:path>data($body/ejec:Input_Parameters/PARAMETROS_TRAMA/PARAMETRO[NOMBRE='MONTORECARGA']/VALOR)</con1:path>
                          </con1:param>
                        </con1:xqueryTransform>
                      </con3:expr>
                    </con3:assign>
                  </con3:requestTransform>
                  <con3:responseTransform/>
                </con3:wsCallout>
                <con3:ifThenElse>
                  <con1:id>_ActionId-8044975483918427659-3220e920.15853e81890.-7dd0</con1:id>
                  <con3:case>
                    <con3:condition>
                      <con1:xqueryText>data($consultarPaquetesDatosResponse/CODIGO) != "OK"</con1:xqueryText>
                    </con3:condition>
                    <con3:actions>
                      <con3:assign varName="codError">
                        <con1:id>_ActionId-8044975483918427659-3220e920.15853e81890.-7d77</con1:id>
                        <con3:expr>
                          <con1:xqueryText>"909"</con1:xqueryText>
                        </con3:expr>
                      </con3:assign>
                    </con3:actions>
                  </con3:case>
                  <con3:case>
                    <con3:condition>
                      <con1:xqueryText>data($consultarPaquetesDatosResponse/MENSAJE/ID_SM_BRMS) = "NO DATA"</con1:xqueryText>
                    </con3:condition>
                    <con3:actions>
                      <con3:assign varName="codError">
                        <con1:id>_ActionId-8044975483918427659-3220e920.15853e81890.-7d56</con1:id>
                        <con3:expr>
                          <con1:xqueryText>"41"</con1:xqueryText>
                        </con3:expr>
                      </con3:assign>
                    </con3:actions>
                  </con3:case>
                  <con3:default>
                    <con3:assign varName="reglasNegocioResponse">
                      <con1:id>_ActionId-8044975483918427659-3220e920.15853e81890.-7d3f</con1:id>
                      <con3:expr>
                        <con1:xqueryText><![CDATA[<ns0:WS_Result xmlns:ns0="http://www.comcel.com.co/ConsultarReglas/">
	<CODIGO>1</CODIGO>
	<MENSAJE>
		<ERROR>1</ERROR>
		<ERRORDESC></ERRORDESC>
		<CONSULTASUSCRIPTOR>FALSE</CONSULTASUSCRIPTOR>
		<PARAMETROS>
			<PARAMETRO>
				<NOMBRE>ID_SM_BRMS</NOMBRE>
				<TIPO>string</TIPO>
				<VALOR>{ data($consultarPaquetesDatosResponse/MENSAJE/ID_SM_BRMS) }</VALOR>
			</PARAMETRO>
			<PARAMETRO>
				<NOMBRE>COMENTARIO</NOMBRE>
				<TIPO>string</TIPO>
				<VALOR>{ data($consultarPaquetesDatosResponse/MENSAJE/COMENTARIO) }</VALOR>
			</PARAMETRO>
			<PARAMETRO>
				<NOMBRE>HOST_ID</NOMBRE>
				<TIPO>string</TIPO>
				<VALOR>{ data($consultarPaquetesDatosResponse/MENSAJE/HOST_ID) }</VALOR>
			</PARAMETRO>
			<PARAMETRO>
				<NOMBRE>PLATAFORMA</NOMBRE>
				<TIPO>string</TIPO>
				<VALOR>{ data($consultarPaquetesDatosResponse/MENSAJE/PLATAFORMA) }</VALOR>
			</PARAMETRO>
			<PARAMETRO>
				<NOMBRE>VALOR</NOMBRE>
				<TIPO>decimal</TIPO>
				<VALOR>{ data($consultarPaquetesDatosResponse/MENSAJE/VALOR) }</VALOR>
			</PARAMETRO>
			<PARAMETRO>
				<NOMBRE>NOTIFICACION</NOMBRE>
				<TIPO>string</TIPO>
				<VALOR>{ data($consultarPaquetesDatosResponse/MENSAJE/NOTIFICACION) }</VALOR>
			</PARAMETRO>
			<PARAMETRO>
				<NOMBRE>OFFER_ID</NOMBRE>
				<TIPO>string</TIPO>
				<VALOR>{ data($consultarPaquetesDatosResponse/MENSAJE/OFFER_ID) }</VALOR>
			</PARAMETRO>
		</PARAMETROS>
	</MENSAJE>
</ns0:WS_Result>]]></con1:xqueryText>
                      </con3:expr>
                    </con3:assign>
                  </con3:default>
                </con3:ifThenElse>
                <con3:ifThenElse>
                  <con1:id>_ActionId-726258470643459902--71798449.15903ffa8a4.-6828</con1:id>
                  <con3:case>
                    <con3:condition>
                      <con1:xqueryText>$codError = "1"</con1:xqueryText>
                    </con3:condition>
                    <con3:actions>
                      <con3:assign varName="plataformaOffer">
                        <con1:id>_ActionId-726258470643459902--71798449.15903ffa8a4.-66ef</con1:id>
                        <con3:expr>
                          <con1:xqueryText>data($consultarPaquetesDatosResponse/MENSAJE/PLATAFORMA)</con1:xqueryText>
                        </con3:expr>
                      </con3:assign>
                      <con3:ifThenElse>
                        <con1:id>_ActionId-726258470643459902--71798449.15903ffa8a4.-6787</con1:id>
                        <con3:case>
                          <con3:condition>
                            <con1:xqueryText>$plataformaOffer = "BB"</con1:xqueryText>
                          </con3:condition>
                          <con3:actions>
                            <con3:insert varName="reglasNegocioResponse">
                              <con1:id>_ActionId-726258470643459902--71798449.15903ffa8a4.-662a</con1:id>
                              <con3:location>
                                <con1:xpathText>./MENSAJE/PARAMETROS</con1:xpathText>
                              </con3:location>
                              <con3:where>last-child</con3:where>
                              <con3:expr>
                                <con1:xqueryText><![CDATA[<PARAMETRO>
	<NOMBRE>PLATAFORMA_PAQUETE</NOMBRE>
	<TIPO>string</TIPO>
	<VALOR>{ $plataformaOffer }</VALOR>
</PARAMETRO>]]></con1:xqueryText>
                              </con3:expr>
                            </con3:insert>
                            <con3:insert varName="body">
                              <con1:id>_ActionId-726258470643459902--71798449.15903ffa8a4.-6785</con1:id>
                              <con3:location>
                                <con1:xpathText>./ejec:Input_Parameters/PARAMETROS_TRAMA</con1:xpathText>
                              </con3:location>
                              <con3:where>last-child</con3:where>
                              <con3:expr>
                                <con1:xqueryText><![CDATA[<PARAMETRO>
	<NOMBRE>PLATAFORMA_PAQUETE</NOMBRE>
	<TIPO>string</TIPO>
	<VALOR>{ $plataformaOffer }</VALOR>
</PARAMETRO>]]></con1:xqueryText>
                              </con3:expr>
                            </con3:insert>
                            <con3:wsCallout>
                              <con1:id>_ActionId-726258470643459902--71798449.15903ffa8a4.-6781</con1:id>
                              <con3:service xsi:type="ref:ProxyRef" ref="ITEL/Core/Proxies/consultarParametrosBBLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                              <con3:operation>consultarParametrosBB</con3:operation>
                              <con3:request>
                                <con3:body>$consultarParametrosBBRequest</con3:body>
                              </con3:request>
                              <con3:response>
                                <con3:body>consultarParametrosBBResponse</con3:body>
                              </con3:response>
                              <con3:requestTransform>
                                <con3:assign varName="consultarParametrosBBRequest">
                                  <con1:id>_ActionId-726258470643459902--71798449.15903ffa8a4.-6784</con1:id>
                                  <con3:expr>
                                    <con1:xqueryTransform>
                                      <con1:resource ref="ITEL/Core/Resources/XQueries/consultarParametrosBBPS_Req"/>
                                      <con1:param name="offerBB">
                                        <con1:path>data($body/ejec:Input_Parameters/PARAMETROS_TRAMA/PARAMETRO[NOMBRE='COMENTARIO']/VALOR)</con1:path>
                                      </con1:param>
                                    </con1:xqueryTransform>
                                  </con3:expr>
                                </con3:assign>
                              </con3:requestTransform>
                              <con3:responseTransform>
                                <con3:insert varName="reglasNegocioResponse">
                                  <con1:id>_ActionId-726258470643459902--71798449.15903ffa8a4.-6783</con1:id>
                                  <con3:location>
                                    <con1:xpathText>./MENSAJE/PARAMETROS</con1:xpathText>
                                  </con3:location>
                                  <con3:where>last-child</con3:where>
                                  <con3:expr>
                                    <con1:xqueryText><![CDATA[<PARAMETRO>
	<NOMBRE>PARAMETROS_BB</NOMBRE>
	<TIPO>string</TIPO>
	<VALOR>{ 
       $consultarParametrosBBResponse//*:MENSAJE/@*,$consultarParametrosBBResponse//*:MENSAJE/node()
    }</VALOR>
</PARAMETRO>]]></con1:xqueryText>
                                  </con3:expr>
                                </con3:insert>
                                <con3:insert varName="body">
                                  <con1:id>_ActionId-726258470643459902--71798449.15903ffa8a4.-6782</con1:id>
                                  <con3:location>
                                    <con1:xpathText>./ejec:Input_Parameters/PARAMETROS_TRAMA</con1:xpathText>
                                  </con3:location>
                                  <con3:where>last-child</con3:where>
                                  <con3:expr>
                                    <con1:xqueryText><![CDATA[<PARAMETRO>
	<NOMBRE>PARAMETROS_BB</NOMBRE>
	<TIPO>string</TIPO>
	<VALOR>{ 
      $consultarParametrosBBResponse//*:MENSAJE/@*,$consultarParametrosBBResponse//*:MENSAJE/node()
    }</VALOR>
</PARAMETRO>]]></con1:xqueryText>
                                  </con3:expr>
                                </con3:insert>
                              </con3:responseTransform>
                            </con3:wsCallout>
                            <con3:wsCallout>
                              <con1:id>_ActionId-726258470643459902--71798449.15903ffa8a4.-677d</con1:id>
                              <con3:service xsi:type="ref:ProxyRef" ref="ITEL/Core/Proxies/consultarPaquetesAddBBLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                              <con3:operation>consultarPaquetesAddBB</con3:operation>
                              <con3:request>
                                <con3:body>$consultarPaquetesAddBBRequest</con3:body>
                              </con3:request>
                              <con3:response>
                                <con3:body>consultarPaquetesAddBBResponse</con3:body>
                              </con3:response>
                              <con3:requestTransform>
                                <con3:assign varName="consultarPaquetesAddBBRequest">
                                  <con1:id>_ActionId-726258470643459902--71798449.15903ffa8a4.-6780</con1:id>
                                  <con3:expr>
                                    <con1:xqueryTransform>
                                      <con1:resource ref="ITEL/Core/Resources/XQueries/consultarPaquetesAddBBPS_Req"/>
                                      <con1:param name="min">
                                        <con1:path>data($body/ejec:Input_Parameters/MIN_DESTINO)</con1:path>
                                      </con1:param>
                                    </con1:xqueryTransform>
                                  </con3:expr>
                                </con3:assign>
                              </con3:requestTransform>
                              <con3:responseTransform>
                                <con3:insert varName="body">
                                  <con1:id>_ActionId-726258470643459902--71798449.15903ffa8a4.-677f</con1:id>
                                  <con3:location>
                                    <con1:xpathText>./ejec:Input_Parameters/PARAMETROS_TRAMA</con1:xpathText>
                                  </con3:location>
                                  <con3:where>last-child</con3:where>
                                  <con3:expr>
                                    <con1:xqueryText><![CDATA[<PARAMETRO>
	<NOMBRE>PAQUETES_ACTIVOS</NOMBRE>
	<TIPO>string</TIPO>
	<VALOR>{ 
      $consultarPaquetesAddBBResponse//*:MENSAJE/@*, $consultarPaquetesAddBBResponse//*:MENSAJE/node()
    }</VALOR>
</PARAMETRO>]]></con1:xqueryText>
                                  </con3:expr>
                                </con3:insert>
                                <con3:insert varName="reglasNegocioResponse">
                                  <con1:id>_ActionId-726258470643459902--71798449.15903ffa8a4.-677e</con1:id>
                                  <con3:location>
                                    <con1:xpathText>./MENSAJE/PARAMETROS</con1:xpathText>
                                  </con3:location>
                                  <con3:where>last-child</con3:where>
                                  <con3:expr>
                                    <con1:xqueryText><![CDATA[<PARAMETRO>
	<NOMBRE>PAQUETES_ACTIVOS</NOMBRE>
	<TIPO>string</TIPO>
	<VALOR>{ 
	$consultarPaquetesAddBBResponse//*:MENSAJE/@*, $consultarPaquetesAddBBResponse//*:MENSAJE/node()
	}</VALOR>
</PARAMETRO>]]></con1:xqueryText>
                                  </con3:expr>
                                </con3:insert>
                              </con3:responseTransform>
                            </con3:wsCallout>
                          </con3:actions>
                        </con3:case>
                        <con3:default>
                          <con3:insert varName="reglasNegocioResponse">
                            <con1:id>_ActionId-726258470643459902--71798449.15903ffa8a4.-6680</con1:id>
                            <con3:location>
                              <con1:xpathText>./MENSAJE/PARAMETROS</con1:xpathText>
                            </con3:location>
                            <con3:where>last-child</con3:where>
                            <con3:expr>
                              <con1:xqueryText><![CDATA[<PARAMETRO>
	<NOMBRE>PLATAFORMA_PAQUETE</NOMBRE>
	<TIPO>string</TIPO>
	<VALOR>{ $plataformaOffer }</VALOR>
</PARAMETRO>]]></con1:xqueryText>
                            </con3:expr>
                          </con3:insert>
                          <con3:insert varName="body">
                            <con1:id>_ActionId-726258470643459902--71798449.15903ffa8a4.-677b</con1:id>
                            <con3:location>
                              <con1:xpathText>./ejec:Input_Parameters/PARAMETROS_TRAMA</con1:xpathText>
                            </con3:location>
                            <con3:where>last-child</con3:where>
                            <con3:expr>
                              <con1:xqueryText><![CDATA[<PARAMETRO>
	<NOMBRE>PLATAFORMA_PAQUETE</NOMBRE>
	<TIPO>string</TIPO>
	<VALOR>{ $plataformaOffer }</VALOR>
</PARAMETRO>]]></con1:xqueryText>
                            </con3:expr>
                          </con3:insert>
                        </con3:default>
                      </con3:ifThenElse>
                    </con3:actions>
                  </con3:case>
                  <con3:default/>
                </con3:ifThenElse>
              </con3:actions>
            </con3:case>
            <con3:case>
              <con3:condition>
                <con1:xqueryText>$metodo = "211"</con1:xqueryText>
              </con3:condition>
              <con3:actions>
                <con3:wsCallout>
                  <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-7f87</con1:id>
                  <con3:service xsi:type="ref:ProxyRef" ref="ITEL/Core/Proxies/consultarListaPaquetesTAT_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                  <con3:operation>ConsultarListaPaquetesTAT</con3:operation>
                  <con3:request>
                    <con3:body>$consultarPaquetesTATRequest</con3:body>
                  </con3:request>
                  <con3:response>
                    <con3:body>consultarPaquetesTATResponse</con3:body>
                  </con3:response>
                  <con3:requestTransform>
                    <con3:assign varName="consultarPaquetesTATRequest">
                      <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-7d86</con1:id>
                      <con3:expr>
                        <con1:xqueryText>&lt;con:Input_Parameters xmlns:con="http://www.comcel.com.co/ConsultarListaPaquetesTAT/"/></con1:xqueryText>
                      </con3:expr>
                    </con3:assign>
                  </con3:requestTransform>
                  <con3:responseTransform/>
                </con3:wsCallout>
                <con3:ifThenElse>
                  <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-7f86</con1:id>
                  <con3:case>
                    <con3:condition>
                      <con1:xqueryText>data($consultarPaquetesTATResponse/CODIGO) != "OK"</con1:xqueryText>
                    </con3:condition>
                    <con3:actions>
                      <con3:assign varName="codError">
                        <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-7f85</con1:id>
                        <con3:expr>
                          <con1:xqueryText>"909"</con1:xqueryText>
                        </con3:expr>
                      </con3:assign>
                    </con3:actions>
                  </con3:case>
                  <con3:case>
                    <con3:condition>
                      <con1:xqueryText>data($consultarPaquetesTATResponse/MENSAJE/PAQUETES) = ""</con1:xqueryText>
                    </con3:condition>
                    <con3:actions>
                      <con3:assign varName="codError">
                        <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-7f84</con1:id>
                        <con3:expr>
                          <con1:xqueryText>"41"</con1:xqueryText>
                        </con3:expr>
                      </con3:assign>
                    </con3:actions>
                  </con3:case>
                  <con3:default>
                    <con6:assign varName="reglasNegocioResponse" xmlns:con6="http://www.bea.com/wli/sb/stages/transform/config">
                      <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-76e6</con1:id>
                      <con6:expr>
                        <con1:xqueryText><![CDATA[<ns0:WS_Result xmlns:ns0="http://www.comcel.com.co/ConsultarReglas/">
	<CODIGO>1</CODIGO>
	<MENSAJE>
		<ERROR>1</ERROR>
		<ERRORDESC></ERRORDESC>
		<CONSULTASUSCRIPTOR>FALSE</CONSULTASUSCRIPTOR>
		<PARAMETROS>			
			<PARAMETRO>
				<NOMBRE>PAQUETES</NOMBRE>
				<TIPO>string</TIPO>
				<VALOR>{
                        for $PAQUETE in $consultarPaquetesTATResponse/MENSAJE/PAQUETES/PAQUETE
                        return
                            <PAQUETE>
                                <CODIGO_PAQUETE>{ data($PAQUETE/CODIGO_PAQUETE) }</CODIGO_PAQUETE>
                                <VALOR>{ data($PAQUETE/VALOR) }</VALOR>
                                <DESC_CORTA>{ data($PAQUETE/DESC_CORTA) }</DESC_CORTA>
                                <VIGENCIA>{ data($PAQUETE/VIGENCIA) }</VIGENCIA>
                                <CANTIDAD>{ data($PAQUETE/CANTIDAD) }</CANTIDAD>
                                <TIPO>{ data($PAQUETE/TIPO) }</TIPO>
                                <DESC_LARGA>{ data($PAQUETE/DESC_LARGA) }</DESC_LARGA>
                            </PAQUETE>
                    }</VALOR>
			</PARAMETRO>
		</PARAMETROS>
	</MENSAJE>
</ns0:WS_Result>]]></con1:xqueryText>
                      </con6:expr>
                    </con6:assign>
                  </con3:default>
                </con3:ifThenElse>
              </con3:actions>
            </con3:case>
            <con3:case>
              <con3:condition>
                <con1:xqueryText>$metodo = "212"</con1:xqueryText>
              </con3:condition>
              <con3:actions>
                <con3:wsCallout>
                  <con1:id>_ActionId-5137152675429647803-6d9de9cf.1568020a2ea.-7e3d</con1:id>
                  <con3:service xsi:type="ref:ProxyRef" ref="ITEL/OCS/AIR/Proxies/consultarUCyUTLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                  <con3:operation>consultarUCyUT</con3:operation>
                  <con3:request>
                    <con3:body>$consultarUCyUTOCSRequest</con3:body>
                  </con3:request>
                  <con3:response>
                    <con3:body>consultarUCyUTOCSResponse</con3:body>
                  </con3:response>
                  <con3:requestTransform>
                    <con3:assign varName="consultarUCyUTOCSRequest">
                      <con1:id>_ActionId-5137152675429647803-6d9de9cf.1568020a2ea.-7e3e</con1:id>
                      <con3:expr>
                        <con1:xqueryTransform>
                          <con1:resource ref="ITEL/Core/Resources/XQueries/consultarUCyUTPS_Req"/>
                          <con1:param name="min">
                            <con1:path>data($body/ejec:Input_Parameters/MIN_DESTINO)</con1:path>
                          </con1:param>
                        </con1:xqueryTransform>
                      </con3:expr>
                    </con3:assign>
                  </con3:requestTransform>
                  <con3:responseTransform/>
                </con3:wsCallout>
                <con3:ifThenElse>
                  <con1:id>_ActionId-5137152675429647803-6d9de9cf.1568020a2ea.-7d8e</con1:id>
                  <con3:case>
                    <con3:condition>
                      <con1:xqueryText>data($consultarUCyUTOCSResponse//CODIGO) != "1"</con1:xqueryText>
                    </con3:condition>
                    <con3:actions>
                      <con3:assign varName="codError">
                        <con1:id>_ActionId-5137152675429647803-6d9de9cf.1568020a2ea.-7d8d</con1:id>
                        <con3:expr>
                          <con1:xqueryText>"20"</con1:xqueryText>
                        </con3:expr>
                      </con3:assign>
                    </con3:actions>
                  </con3:case>
                  <con3:default>
                    <con6:assign varName="reglasNegocioResponse" xmlns:con6="http://www.bea.com/wli/sb/stages/transform/config">
                      <con1:id>_ActionId-5137152675429647803-6d9de9cf.1568020a2ea.-7d8c</con1:id>
                      <con6:expr>
                        <con1:xqueryText><![CDATA[<ns0:WS_Result xmlns:ns0="http://www.comcel.com.co/ConsultarReglas/">
	<CODIGO>1</CODIGO>
	<MENSAJE>
		<ERROR>1</ERROR>
		<ERRORDESC></ERRORDESC>
		<CONSULTASUSCRIPTOR>FALSE</CONSULTASUSCRIPTOR>
		<PARAMETROS>
			<PARAMETRO>
				<NOMBRE>CONSULTAR_UCyUT</NOMBRE>
				<TIPO>string</TIPO>
				<VALOR>{ $consultarUCyUTOCSResponse//CONSULTAR_UCyUT }</VALOR>
			</PARAMETRO>
		</PARAMETROS>
	</MENSAJE>
</ns0:WS_Result>]]></con1:xqueryText>
                      </con6:expr>
                    </con6:assign>
                  </con3:default>
                </con3:ifThenElse>
              </con3:actions>
            </con3:case>
            <con3:case>
              <con3:condition>
                <con1:xqueryText>$metodo = "406" and $esOCS = "true" and data($body/ejec:Input_Parameters/PARAMETROS_TRAMA/PARAMETRO[NOMBRE='BONIFICAR']/VALOR) = ('3','7','8','9')</con1:xqueryText>
              </con3:condition>
              <con3:actions>
                <con3:wsCallout>
                  <con1:id>_ActionId-9015714680426829760-1442772d.13b49235484.-7f4b</con1:id>
                  <con3:service xsi:type="ref:ProxyRef" ref="ITEL/Core/Proxies/consultarOLMOffersLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                  <con3:operation>consultarOLMOffers</con3:operation>
                  <con3:request>
                    <con3:body>$offerRequest</con3:body>
                  </con3:request>
                  <con3:response>
                    <con3:body>offerResponse</con3:body>
                  </con3:response>
                  <con3:requestTransform>
                    <con3:assign varName="offerRequest">
                      <con1:id>_ActionId-9015714680426829760-1442772d.13b49235484.-7f4c</con1:id>
                      <con3:expr>
                        <con1:xqueryTransform>
                          <con1:resource ref="ITEL/Core/Resources/XQueries/consultarOLMOffersPS_Req"/>
                          <con1:param name="cuenta">
                            <con1:path>data($body/ejec:Input_Parameters/PARAMETROS_TRAMA/PARAMETRO[NOMBRE='BONIFICAR']/VALOR)</con1:path>
                          </con1:param>
                          <con1:param name="vigencia">
                            <con1:path>data($body/ejec:Input_Parameters/PARAMETROS_TRAMA/PARAMETRO[NOMBRE='DIASVIGENCIA']/VALOR)</con1:path>
                          </con1:param>
                          <con1:param name="cantidad">
                            <con1:path>data($body/ejec:Input_Parameters/PARAMETROS_TRAMA/PARAMETRO[NOMBRE='MONTORECARGA']/VALOR)</con1:path>
                          </con1:param>
                        </con1:xqueryTransform>
                      </con3:expr>
                    </con3:assign>
                  </con3:requestTransform>
                  <con3:responseTransform/>
                </con3:wsCallout>
                <con3:ifThenElse>
                  <con1:id>_ActionId-9015714680426829760-1442772d.13b49235484.-7f4a</con1:id>
                  <con3:case>
                    <con3:condition>
                      <con1:xqueryText>data($offerResponse/CODIGO) != "OK"</con1:xqueryText>
                    </con3:condition>
                    <con3:actions>
                      <con3:assign varName="codError">
                        <con1:id>_ActionId-9015714680426829760-1442772d.13b49235484.-7f49</con1:id>
                        <con3:expr>
                          <con1:xqueryText>"909"</con1:xqueryText>
                        </con3:expr>
                      </con3:assign>
                    </con3:actions>
                  </con3:case>
                  <con3:case>
                    <con3:condition>
                      <con1:xqueryText>data($offerResponse/MENSAJE/OFFERNAME) = ""</con1:xqueryText>
                    </con3:condition>
                    <con3:actions>
                      <con3:assign varName="codError">
                        <con1:id>_ActionId-9015714680426829760-1442772d.13b49235484.-7f48</con1:id>
                        <con3:expr>
                          <con1:xqueryText>"18"</con1:xqueryText>
                        </con3:expr>
                      </con3:assign>
                    </con3:actions>
                  </con3:case>
                  <con3:default>
                    <con6:assign varName="reglasNegocioResponse" xmlns:con6="http://www.bea.com/wli/sb/stages/transform/config">
                      <con1:id>_ActionId-9015714680426829760-1442772d.13b49235484.-7f47</con1:id>
                      <con6:expr>
                        <con1:xqueryText><![CDATA[<ns0:WS_Result xmlns:ns0="http://www.comcel.com.co/ConsultarReglas/">
	<CODIGO>1</CODIGO>
	<MENSAJE>
		<ERROR>1</ERROR>
		<ERRORDESC></ERRORDESC>
		<CONSULTASUSCRIPTOR>FALSE</CONSULTASUSCRIPTOR>
		<PARAMETROS>
			<PARAMETRO>
				<NOMBRE>OFFERID</NOMBRE>
				<TIPO>string</TIPO>
				<VALOR>{ data($offerResponse/MENSAJE/OFFERNAME) }</VALOR>
			</PARAMETRO>
		</PARAMETROS>
	</MENSAJE>
</ns0:WS_Result>]]></con1:xqueryText>
                      </con6:expr>
                    </con6:assign>
                  </con3:default>
                </con3:ifThenElse>
              </con3:actions>
            </con3:case>
            <con3:case>
              <con3:condition>
                <con1:xqueryText>$metodo = "503"</con1:xqueryText>
              </con3:condition>
              <con3:actions>
                <con3:wsCallout>
                  <con1:id>_ActionId-726258470643459902--71798449.15903ffa8a4.-6c6c</con1:id>
                  <con3:service xsi:type="ref:ProxyRef" ref="ITEL/Core/Proxies/consultarPlataformaOfferLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                  <con3:operation>consultarPlataformaOffer</con3:operation>
                  <con3:request>
                    <con3:body>$consultarPlataformaOfferRequest</con3:body>
                  </con3:request>
                  <con3:response>
                    <con3:body>consultarPlataformaOfferResponse</con3:body>
                  </con3:response>
                  <con3:requestTransform>
                    <con3:assign varName="consultarPlataformaOfferRequest">
                      <con1:id>_ActionId-726258470643459902--71798449.15903ffa8a4.-6c46</con1:id>
                      <con3:expr>
                        <con1:xqueryTransform>
                          <con1:resource ref="ITEL/Core/Resources/XQueries/consultarPlataformaOfferPS_Req"/>
                          <con1:param name="offerID">
                            <con1:path>data($body/ejec:Input_Parameters/PARAMETROS_TRAMA/PARAMETRO[NOMBRE='COMENTARIO']/VALOR)</con1:path>
                          </con1:param>
                        </con1:xqueryTransform>
                      </con3:expr>
                    </con3:assign>
                  </con3:requestTransform>
                  <con3:responseTransform/>
                </con3:wsCallout>
                <con3:assign varName="plataformaOffer">
                  <con1:id>_ActionId-726258470643459902--71798449.15903ffa8a4.-6b2f</con1:id>
                  <con3:expr>
                    <con1:xqueryText>data($consultarPlataformaOfferResponse//*:PLATAFORMA)</con1:xqueryText>
                  </con3:expr>
                </con3:assign>
                <con3:ifThenElse>
                  <con1:id>_ActionId-726258470643459902--71798449.15903ffa8a4.-6bcb</con1:id>
                  <con3:case>
                    <con3:condition>
                      <con1:xqueryText>$plataformaOffer = "BB"</con1:xqueryText>
                    </con3:condition>
                    <con3:actions>
                      <con6:assign varName="reglasNegocioResponse" xmlns:con6="http://www.bea.com/wli/sb/stages/transform/config">
                        <con1:id>_ActionId-726258470643459902--71798449.15903ffa8a4.-6b5d</con1:id>
                        <con6:expr>
                          <con1:xqueryText><![CDATA[<ns0:WS_Result xmlns:ns0="http://www.comcel.com.co/ConsultarReglas/">
	<CODIGO>1</CODIGO>
	<MENSAJE>
		<ERROR>1</ERROR>
		<ERRORDESC></ERRORDESC>
		<CONSULTASUSCRIPTOR>FALSE</CONSULTASUSCRIPTOR>
		<PARAMETROS>
			<PARAMETRO>
				<NOMBRE>PLATAFORMA_PAQUETE</NOMBRE>
				<TIPO>string</TIPO>
				<VALOR>{ $plataformaOffer }</VALOR>
			</PARAMETRO>			 
		</PARAMETROS>
	</MENSAJE>
</ns0:WS_Result>]]></con1:xqueryText>
                        </con6:expr>
                      </con6:assign>
                      <con3:insert varName="body">
                        <con1:id>_ActionId-726258470643459902--71798449.15903ffa8a4.-6a34</con1:id>
                        <con3:location>
                          <con1:xpathText>./ejec:Input_Parameters/PARAMETROS_TRAMA</con1:xpathText>
                        </con3:location>
                        <con3:where>last-child</con3:where>
                        <con3:expr>
                          <con1:xqueryText><![CDATA[<PARAMETRO>
	<NOMBRE>PLATAFORMA_PAQUETE</NOMBRE>
	<TIPO>string</TIPO>
	<VALOR>{ $plataformaOffer }</VALOR>
</PARAMETRO>]]></con1:xqueryText>
                        </con3:expr>
                      </con3:insert>
                      <con3:wsCallout>
                        <con1:id>_ActionId-726258470643459902--71798449.15903ffa8a4.-6bc7</con1:id>
                        <con3:service xsi:type="ref:ProxyRef" ref="ITEL/Core/Proxies/consultarParametrosBBLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                        <con3:operation>consultarParametrosBB</con3:operation>
                        <con3:request>
                          <con3:body>$consultarParametrosBBRequest</con3:body>
                        </con3:request>
                        <con3:response>
                          <con3:body>consultarParametrosBBResponse</con3:body>
                        </con3:response>
                        <con3:requestTransform>
                          <con3:assign varName="consultarParametrosBBRequest">
                            <con1:id>_ActionId-726258470643459902--71798449.15903ffa8a4.-6bc8</con1:id>
                            <con3:expr>
                              <con1:xqueryTransform>
                                <con1:resource ref="ITEL/Core/Resources/XQueries/consultarParametrosBBPS_Req"/>
                                <con1:param name="offerBB">
                                  <con1:path>data($body/ejec:Input_Parameters/PARAMETROS_TRAMA/PARAMETRO[NOMBRE='COMENTARIO']/VALOR)</con1:path>
                                </con1:param>
                              </con1:xqueryTransform>
                            </con3:expr>
                          </con3:assign>
                        </con3:requestTransform>
                        <con3:responseTransform>
                          <con3:insert varName="reglasNegocioResponse">
                            <con1:id>_ActionId-726258470643459902--71798449.15903ffa8a4.-68ff</con1:id>
                            <con3:location>
                              <con1:xpathText>./MENSAJE/PARAMETROS</con1:xpathText>
                            </con3:location>
                            <con3:where>last-child</con3:where>
                            <con3:expr>
                              <con1:xqueryText><![CDATA[<PARAMETRO>
	<NOMBRE>PARAMETROS_BB</NOMBRE>
	<TIPO>string</TIPO>
	<VALOR>{ 
       $consultarParametrosBBResponse//*:MENSAJE/@*,$consultarParametrosBBResponse//*:MENSAJE/node()
    }</VALOR>
</PARAMETRO>]]></con1:xqueryText>
                            </con3:expr>
                          </con3:insert>
                          <con3:insert varName="body">
                            <con1:id>_ActionId-726258470643459902--71798449.15903ffa8a4.-68a8</con1:id>
                            <con3:location>
                              <con1:xpathText>./ejec:Input_Parameters/PARAMETROS_TRAMA</con1:xpathText>
                            </con3:location>
                            <con3:where>last-child</con3:where>
                            <con3:expr>
                              <con1:xqueryText><![CDATA[<PARAMETRO>
	<NOMBRE>PARAMETROS_BB</NOMBRE>
	<TIPO>string</TIPO>
	<VALOR>{ 
      $consultarParametrosBBResponse//*:MENSAJE/@*,$consultarParametrosBBResponse//*:MENSAJE/node()
    }</VALOR>
</PARAMETRO>]]></con1:xqueryText>
                            </con3:expr>
                          </con3:insert>
                        </con3:responseTransform>
                      </con3:wsCallout>
                      <con3:wsCallout>
                        <con1:id>_ActionId-726258470643459902--71798449.15903ffa8a4.-6bc3</con1:id>
                        <con3:service xsi:type="ref:ProxyRef" ref="ITEL/Core/Proxies/consultarPaquetesCanBBLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                        <con3:operation>consultarPaquetesCanBB</con3:operation>
                        <con3:request>
                          <con3:body>$consultarPaquetesCanBBRequest</con3:body>
                        </con3:request>
                        <con3:response>
                          <con3:body>consultarPaquetesCanBBResponse</con3:body>
                        </con3:response>
                        <con3:requestTransform>
                          <con3:assign varName="consultarPaquetesCanBBRequest">
                            <con1:id>_ActionId-726258470643459902--71798449.15903ffa8a4.-6bc4</con1:id>
                            <con3:expr>
                              <con1:xqueryTransform>
                                <con1:resource ref="ITEL/Core/Resources/XQueries/consultarPaquetesCanBBPS_Req"/>
                                <con1:param name="offerID">
                                  <con1:path>data($body/ejec:Input_Parameters/PARAMETROS_TRAMA/PARAMETRO[NOMBRE='COMENTARIO']/VALOR)</con1:path>
                                </con1:param>
                                <con1:param name="min">
                                  <con1:path>data($body/ejec:Input_Parameters/MIN_DESTINO)</con1:path>
                                </con1:param>
                              </con1:xqueryTransform>
                            </con3:expr>
                          </con3:assign>
                        </con3:requestTransform>
                        <con3:responseTransform>
                          <con3:insert varName="body">
                            <con1:id>_ActionId-726258470643459902--71798449.15903ffa8a4.-6854</con1:id>
                            <con3:location>
                              <con1:xpathText>./ejec:Input_Parameters/PARAMETROS_TRAMA</con1:xpathText>
                            </con3:location>
                            <con3:where>last-child</con3:where>
                            <con3:expr>
                              <con1:xqueryText><![CDATA[<PARAMETRO>
	<NOMBRE>PAQUETES_ACTIVOS</NOMBRE>
	<TIPO>string</TIPO>
	<VALOR>{ 
      $consultarPaquetesCanBBResponse//*:MENSAJE/@*, $consultarPaquetesCanBBResponse//*:MENSAJE/node()
    }</VALOR>
</PARAMETRO>]]></con1:xqueryText>
                            </con3:expr>
                          </con3:insert>
                          <con3:insert varName="reglasNegocioResponse">
                            <con1:id>_ActionId-726258470643459902--71798449.15903ffa8a4.-68c5</con1:id>
                            <con3:location>
                              <con1:xpathText>./MENSAJE/PARAMETROS</con1:xpathText>
                            </con3:location>
                            <con3:where>last-child</con3:where>
                            <con3:expr>
                              <con1:xqueryText><![CDATA[<PARAMETRO>
	<NOMBRE>PAQUETES_ACTIVOS</NOMBRE>
	<TIPO>string</TIPO>
	<VALOR>{ 
	$consultarPaquetesCanBBResponse//*:MENSAJE/@*, $consultarPaquetesCanBBResponse//*:MENSAJE/node()
	}</VALOR>
</PARAMETRO>]]></con1:xqueryText>
                            </con3:expr>
                          </con3:insert>
                        </con3:responseTransform>
                      </con3:wsCallout>
                    </con3:actions>
                  </con3:case>
                  <con3:default>
                    <con6:assign varName="reglasNegocioResponse" xmlns:con6="http://www.bea.com/wli/sb/stages/transform/config">
                      <con1:id>_ActionId-726258470643459902--71798449.15903ffa8a4.-69fa</con1:id>
                      <con6:expr>
                        <con1:xqueryText><![CDATA[<ns0:WS_Result xmlns:ns0="http://www.comcel.com.co/ConsultarReglas/">
	<CODIGO>1</CODIGO>
	<MENSAJE>
		<ERROR>1</ERROR>
		<ERRORDESC></ERRORDESC>
		<CONSULTASUSCRIPTOR>FALSE</CONSULTASUSCRIPTOR>
		<PARAMETROS>
			<PARAMETRO>
				<NOMBRE>PLATAFORMA_PAQUETE</NOMBRE>
				<TIPO>string</TIPO>
				<VALOR>{ $plataformaOffer }</VALOR>
			</PARAMETRO>			 
		</PARAMETROS>
	</MENSAJE>
</ns0:WS_Result>]]></con1:xqueryText>
                      </con6:expr>
                    </con6:assign>
                    <con3:insert varName="body">
                      <con1:id>_ActionId-726258470643459902--71798449.15903ffa8a4.-69fc</con1:id>
                      <con3:location>
                        <con1:xpathText>./ejec:Input_Parameters/PARAMETROS_TRAMA</con1:xpathText>
                      </con3:location>
                      <con3:where>last-child</con3:where>
                      <con3:expr>
                        <con1:xqueryText><![CDATA[<PARAMETRO>
	<NOMBRE>PLATAFORMA_PAQUETE</NOMBRE>
	<TIPO>string</TIPO>
	<VALOR>{ $plataformaOffer }</VALOR>
</PARAMETRO>]]></con1:xqueryText>
                      </con3:expr>
                    </con3:insert>
                  </con3:default>
                </con3:ifThenElse>
              </con3:actions>
            </con3:case>
            <con3:default/>
          </con3:ifThenElse>
        </con:actions>
      </con:stage>
      <con:stage name="ejecutarReglas" errorHandler="_onErrorHandler-6072017332753721301-6568e233.12f8f27409e.-7e16">
        <con:context>
          <con1:userNsDecl namespace="http://www.functx.com" prefix="functx"/>
          <con1:varNsDecl namespace="http://www.comcel.com.co/EjecutarReglasNegocio/" prefix="ejec"/>
          <con1:varNsDecl namespace="http://www.comcel.com.co/ConsultarReglas/" prefix="con"/>
          <con1:varNsDecl namespace="http://www.comcel.com.co/ConsultarDatosIn/" prefix="con1"/>
          <con1:varNsDecl namespace="http://www.comcel.com.co/ConsultarDatosSuscriptorIN/" prefix="con2"/>
          <con1:varNsDecl namespace="http://www.comcel.com.co/ConsultarParametroGeneral/" prefix="con3"/>
          <con1:varNsDecl namespace="http://www.comcel.com.co/ValidarContratoMetodo/" prefix="val"/>
          <con1:varNsDecl namespace="http://www.comcel.com.co/ConsultarParametrosEjecucion/" prefix="con4"/>
          <con1:varNsDecl namespace="http://www.comcel.com.co/ConsultarDatosMines/" prefix="con5"/>
          <con1:varNsDecl namespace="http://www.comcel.com.co/IN/OperacionCorba" prefix="oper"/>
          <con2:variable name="respParametros" path="$respParametros" asChild="false">
            <con2:schema ref="ITEL/Core/Resources/Schemas/PS_ITEL_CONSULTARPARAMETROSEJECUCION" element="WS_Result"/>
          </con2:variable>
          <con2:variable name="respMines" path="$respMines" asChild="false">
            <con2:schema ref="ITEL/Core/Resources/Schemas/PS_ITEL_CONSULTARDATOSMINES" element="WS_Result"/>
          </con2:variable>
        </con:context>
        <con:actions>
          <con3:ifThenElse>
            <con1:id>_ActionId-5985043086313793460-3dcd6be3.1374b9d51ec.-6f69</con1:id>
            <con3:case>
              <con3:condition>
                <con1:xqueryText>$codError = "1"</con1:xqueryText>
              </con3:condition>
              <con3:actions>
                <con3:ifThenElse>
                  <con1:comment>Llamado a la consulta de reglas de negocio</con1:comment>
                  <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-7a0b</con1:id>
                  <con3:case>
                    <con3:condition>
                      <con1:xqueryText>($esOCS="false" and  not($metodo = ('201','202','203','204','206','304','312','407','409','500','501','600','602','603','700','704','314','315')))
	or
($esOCS="true" and $metodo = ('401','402','403','601', '604'))</con1:xqueryText>
                    </con3:condition>
                    <con3:actions>
                      <con3:wsCallout>
                        <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-7a08</con1:id>
                        <con3:service xsi:type="ref:ProxyRef" ref="ITEL/Core/Proxies/consultarReglasLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                        <con3:operation>consultarReglas</con3:operation>
                        <con3:request>
                          <con3:body>$reglasNegocioRequest</con3:body>
                        </con3:request>
                        <con3:response>
                          <con3:body>reglasNegocioResponse</con3:body>
                        </con3:response>
                        <con3:requestTransform>
                          <con3:assign varName="reglasNegocioRequest">
                            <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-7a0a</con1:id>
                            <con3:expr>
                              <con1:xqueryTransform>
                                <con1:resource ref="ITEL/Core/Resources/XQueries/ejecutarReglasNegocio_Req_ConsultarReglasLocal"/>
                                <con1:param name="input_Parameters1">
                                  <con1:path>$body/ejec:Input_Parameters</con1:path>
                                </con1:param>
                              </con1:xqueryTransform>
                            </con3:expr>
                          </con3:assign>
                        </con3:requestTransform>
                        <con3:responseTransform>
                          <con3:assign varName="codError">
                            <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-7a09</con1:id>
                            <con3:expr>
                              <con1:xqueryText>$reglasNegocioResponse/CODIGO/text()</con1:xqueryText>
                            </con3:expr>
                          </con3:assign>
                        </con3:responseTransform>
                      </con3:wsCallout>
                      <con3:ifThenElse>
                        <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-7a07</con1:id>
                        <con3:case>
                          <con3:condition>
                            <con1:xqueryText>$metodo = '601','604'</con1:xqueryText>
                          </con3:condition>
                          <con3:actions>
                            <con3:replace contents-only="true" varName="reglasNegocioResponse">
                              <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-7a06</con1:id>
                              <con3:location>
                                <con1:xpathText>./*:MENSAJE/*:PARAMETROS/PARAMETRO[NOMBRE='ACREDITACUENTA']/VALOR</con1:xpathText>
                              </con3:location>
                              <con3:expr>
                                <con1:xqueryText>if(data($body/ejec:Input_Parameters/PARAMETROS_TRAMA/PARAMETRO[NOMBRE='HOSTID']/VALOR)
= '1') then 'TRUE' else 'FALSE'</con1:xqueryText>
                              </con3:expr>
                            </con3:replace>
                            <con3:insert varName="reglasNegocioResponse">
                              <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-7a05</con1:id>
                              <con3:location>
                                <con1:xpathText>./*:MENSAJE/*:PARAMETROS</con1:xpathText>
                              </con3:location>
                              <con3:where>last-child</con3:where>
                              <con3:expr>
                                <con1:xqueryText><![CDATA[<PARAMETRO>
	<NOMBRE>CAMBIOSDEPLAN</NOMBRE>
	<TIPO>decimal</TIPO>
	<VALOR>{ $body/ejec:Input_Parameters/PARAMETROS_TRAMA/PARAMETRO[NOMBRE='CAMBIOSDEPLAN']/VALOR/text() }</VALOR>
</PARAMETRO>]]></con1:xqueryText>
                              </con3:expr>
                            </con3:insert>
                          </con3:actions>
                        </con3:case>
                        <con3:default/>
                      </con3:ifThenElse>
                    </con3:actions>
                  </con3:case>
                  <con3:default>
                    <con3:assign varName="sinReglas">
                      <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-7a04</con1:id>
                      <con3:expr>
                        <con1:xqueryText>fn:true()</con1:xqueryText>
                      </con3:expr>
                    </con3:assign>
                  </con3:default>
                </con3:ifThenElse>
                <con3:assign varName="tiempoReglas">
                  <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-7a03</con1:id>
                  <con3:expr>
                    <con1:xqueryText>fn:current-dateTime()</con1:xqueryText>
                  </con3:expr>
                </con3:assign>
                <con3:assign varName="duracionReglas">
                  <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-7a02</con1:id>
                  <con3:expr>
                    <con1:xqueryText>fn:seconds-from-duration(xs:dateTime($tiempoReglas) - xs:dateTime($tiempoInicioEtapa)) * 1000</con1:xqueryText>
                  </con3:expr>
                </con3:assign>
                <con3:ifThenElse>
                  <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-7a01</con1:id>
                  <con3:case>
                    <con3:condition>
                      <con1:xqueryText>$codError = "1" and $reglasNegocioResponse/MENSAJE/ERROR/text() = "1" or $sinReglas="true"</con1:xqueryText>
                    </con3:condition>
                    <con3:actions>
                      <con3:ifThenElse>
                        <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-7a00</con1:id>
                        <con3:case>
                          <con3:condition>
                            <con1:xqueryText>$reglasNegocioResponse/MENSAJE/CONSULTASUSCRIPTOR/text() = "TRUE" or $sinReglas="true"</con1:xqueryText>
                          </con3:condition>
                          <con3:actions>
                            <con3:ifThenElse>
                              <con1:comment>Si se requiere hacer un debito a un min en OCS se debe consultar la fecha expiracion para validar la vigencia</con1:comment>
                              <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-79ff</con1:id>
                              <con3:case>
                                <con3:condition>
                                  <con1:xqueryText>$esOCS = "true"</con1:xqueryText>
                                </con3:condition>
                                <con3:actions>
                                  <con3:ifThenElse>
                                    <con1:comment>Valida source plan</con1:comment>
                                    <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-79fe</con1:id>
                                    <con3:case>
                                      <con3:condition>
                                        <con1:xqueryText>not($metodo = ("403","405","406","407"))</con1:xqueryText>
                                      </con3:condition>
                                      <con3:actions>
                                        <con3:wsCallout>
                                          <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-79fc</con1:id>
                                          <con3:service xsi:type="ref:ProxyRef" ref="ITEL/OCS/SOI/Proxies/consultarSuscriptorOCSLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                          <con3:operation>consultarSuscriptorOCS</con3:operation>
                                          <con3:request>
                                            <con3:body>$suscriptorOCSRequest</con3:body>
                                          </con3:request>
                                          <con3:response>
                                            <con3:body>suscriptorOCSResponse</con3:body>
                                          </con3:response>
                                          <con3:requestTransform>
                                            <con3:assign varName="suscriptorOCSRequest">
                                              <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-79fd</con1:id>
                                              <con3:expr>
                                                <con1:xqueryTransform>
                                                  <con1:resource ref="ITEL/Core/Resources/XQueries/consultarSuscriptorOCSPS_Req"/>
                                                  <con1:param name="timeout">
                                                    <con1:path>2000</con1:path>
                                                  </con1:param>
                                                  <con1:param name="min">
                                                    <con1:path>data($body/ejec:Input_Parameters/MIN_DESTINO)</con1:path>
                                                  </con1:param>
                                                  <con1:param name="in">
                                                    <con1:path>data($body/ejec:Input_Parameters/IN_DESTINO)</con1:path>
                                                  </con1:param>
                                                </con1:xqueryTransform>
                                              </con3:expr>
                                            </con3:assign>
                                          </con3:requestTransform>
                                          <con3:responseTransform/>
                                        </con3:wsCallout>
                                        <con3:ifThenElse>
                                          <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-79fb</con1:id>
                                          <con3:case>
                                            <con3:condition>
                                              <con1:xqueryText>data($suscriptorOCSResponse/CODIGO) = '1'</con1:xqueryText>
                                            </con3:condition>
                                            <con3:actions>
                                              <con3:assign varName="serviceClass">
                                                <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-79fa</con1:id>
                                                <con3:expr>
                                                  <con1:xqueryText>data($suscriptorOCSResponse/MENSAJE/CONSULTAR_SUSCRIPTOR/*:suscriptor/*:PublicRatePlanCode)</con1:xqueryText>
                                                </con3:expr>
                                              </con3:assign>
                                              <con3:ifThenElse>
                                                <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-79f9</con1:id>
                                                <con3:case>
                                                  <con3:condition>
                                                    <con1:xqueryText>not($metodo = ("401","402"))</con1:xqueryText>
                                                  </con3:condition>
                                                  <con3:actions>
                                                    <con1:wsCallout xmlns:con3="http://www.bea.com/wli/sb/typesystem/config" xmlns:con2="http://www.bea.com/wli/sb/stages/config" xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
                                                      <con6:id xmlns:con6="http://www.bea.com/wli/sb/stages/config">_ActionId-8096952212429106120-1bbaa577.15405e544f1.-79f5</con6:id>
                                                      <con1:service xsi:type="ref:ProxyRef" ref="ITEL/Core/Proxies/validarServiceClassMetodoLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                                      <con1:operation>ValidarServClassMetodo</con1:operation>
                                                      <con1:request>
                                                        <con1:body>$validarSCMetodoRequest</con1:body>
                                                      </con1:request>
                                                      <con1:response>
                                                        <con1:body>validarSCMetodoResponse</con1:body>
                                                      </con1:response>
                                                      <con1:requestTransform>
                                                        <con1:assign varName="validarSCMetodoRequest">
                                                          <con6:id xmlns:con6="http://www.bea.com/wli/sb/stages/config">_ActionId-8096952212429106120-1bbaa577.15405e544f1.-79f8</con6:id>
                                                          <con1:expr>
                                                            <con6:xqueryTransform xmlns:con6="http://www.bea.com/wli/sb/stages/config">
                                                              <con6:resource ref="ITEL/Core/Resources/XQueries/validar_Req_SCMetodo"/>
                                                              <con6:param name="serviceClass">
                                                                <con6:path>number(data($suscriptorOCSResponse/MENSAJE/CONSULTAR_SUSCRIPTOR/*:suscriptor/*:PublicRatePlanCode))</con6:path>
                                                              </con6:param>
                                                              <con6:param name="metodo">
                                                                <con6:path>$metodo</con6:path>
                                                              </con6:param>
                                                            </con6:xqueryTransform>
                                                          </con1:expr>
                                                        </con1:assign>
                                                      </con1:requestTransform>
                                                      <con1:responseTransform>
                                                        <con1:ifThenElse>
                                                          <con6:id xmlns:con6="http://www.bea.com/wli/sb/stages/config">_ActionId-8096952212429106120-1bbaa577.15405e544f1.-79f7</con6:id>
                                                          <con1:case>
                                                            <con1:condition>
                                                              <con6:xqueryText xmlns:con6="http://www.bea.com/wli/sb/stages/config">data($validarSCMetodoResponse/MENSAJE) != "TRUE"</con6:xqueryText>
                                                            </con1:condition>
                                                            <con1:actions>
                                                              <con1:assign varName="codError">
                                                                <con6:id xmlns:con6="http://www.bea.com/wli/sb/stages/config">_ActionId-8096952212429106120-1bbaa577.15405e544f1.-79f6</con6:id>
                                                                <con1:expr>
                                                                  <con6:xqueryText xmlns:con6="http://www.bea.com/wli/sb/stages/config">"917"</con6:xqueryText>
                                                                </con1:expr>
                                                              </con1:assign>
                                                            </con1:actions>
                                                          </con1:case>
                                                          <con1:default/>
                                                        </con1:ifThenElse>
                                                      </con1:responseTransform>
                                                    </con1:wsCallout>
                                                  </con3:actions>
                                                </con3:case>
                                                <con3:default/>
                                              </con3:ifThenElse>
                                              <con3:ifThenElse>
                                                <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-79f4</con1:id>
                                                <con3:case>
                                                  <con3:condition>
                                                    <con1:xqueryText>$metodo = "410" and $codError = "1"</con1:xqueryText>
                                                  </con3:condition>
                                                  <con3:actions>
                                                    <con3:wsCallout>
                                                      <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-79ee</con1:id>
                                                      <con3:service xsi:type="ref:ProxyRef" ref="ITEL/Core/Proxies/consultarUnitTypeLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                                      <con3:operation>consultarUnitType</con3:operation>
                                                      <con3:request>
                                                        <con3:body>$consultarUnitTypeRequest</con3:body>
                                                      </con3:request>
                                                      <con3:response>
                                                        <con3:body>consultarUnitTypeResponse</con3:body>
                                                      </con3:response>
                                                      <con3:requestTransform>
                                                        <con3:replace varName="consultarUnitTypeRequest">
                                                          <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-79f3</con1:id>
                                                          <con3:expr>
                                                            <con1:xqueryTransform>
                                                              <con1:resource ref="ITEL/Core/Resources/XQueries/consultarUnitType_Req_ejecutarReglasNegocio"/>
                                                              <con1:param name="cuentaID">
                                                                <con1:path>xs:decimal(data($body/ejec:Input_Parameters/PARAMETROS_TRAMA/PARAMETRO[NOMBRE="BONIFICAR"]/VALOR))</con1:path>
                                                              </con1:param>
                                                            </con1:xqueryTransform>
                                                          </con3:expr>
                                                        </con3:replace>
                                                      </con3:requestTransform>
                                                      <con3:responseTransform>
                                                        <con3:assign varName="reglasNegocioResponse">
                                                          <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-79f2</con1:id>
                                                          <con3:expr>
                                                            <con1:xqueryText><![CDATA[<ns0:WS_Result xmlns:ns0="http://www.comcel.com.co/ConsultarReglas/">
	<CODIGO>1</CODIGO>
	<MENSAJE>
		<ERROR>1</ERROR>
		<ERRORDESC></ERRORDESC>
		<CONSULTASUSCRIPTOR>FALSE</CONSULTASUSCRIPTOR>
		<PARAMETROS>
		</PARAMETROS>
	</MENSAJE>
</ns0:WS_Result>]]></con1:xqueryText>
                                                          </con3:expr>
                                                        </con3:assign>
                                                        <con3:ifThenElse>
                                                          <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-79f1</con1:id>
                                                          <con3:case>
                                                            <con3:condition>
                                                              <con1:xqueryText>data($consultarUnitTypeResponse/CODIGO) = 'ERROR' or
data($consultarUnitTypeResponse/MENSAJE/UNITTYPE) = -1</con1:xqueryText>
                                                            </con3:condition>
                                                            <con3:actions>
                                                              <con3:assign varName="codError">
                                                                <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-79f0</con1:id>
                                                                <con3:expr>
                                                                  <con1:xqueryText>"936"</con1:xqueryText>
                                                                </con3:expr>
                                                              </con3:assign>
                                                            </con3:actions>
                                                          </con3:case>
                                                          <con3:default>
                                                            <con3:insert varName="reglasNegocioResponse">
                                                              <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-79ef</con1:id>
                                                              <con3:location>
                                                                <con1:xpathText>./MENSAJE/PARAMETROS</con1:xpathText>
                                                              </con3:location>
                                                              <con3:where>last-child</con3:where>
                                                              <con3:expr>
                                                                <con1:xqueryText><![CDATA[<PARAMETRO>
	<NOMBRE>UNITTYPE</NOMBRE>
	<TIPO>string</TIPO>
	<VALOR>{data($consultarUnitTypeResponse/MENSAJE/UNITTYPE)}</VALOR>
</PARAMETRO>]]></con1:xqueryText>
                                                              </con3:expr>
                                                            </con3:insert>
                                                          </con3:default>
                                                        </con3:ifThenElse>
                                                      </con3:responseTransform>
                                                    </con3:wsCallout>
                                                  </con3:actions>
                                                </con3:case>
                                                <con3:default/>
                                              </con3:ifThenElse>
                                              <con3:ifThenElse>
                                                <con1:id>_ActionId-4121053732405088544-7ebba738.158cfb81d2a.-761a</con1:id>
                                                <con3:case>
                                                  <con3:condition>
                                                    <con1:xqueryText>$metodo = ('503') and $plataformaOffer = "AIR"</con1:xqueryText>
                                                  </con3:condition>
                                                  <con3:actions>
                                                    <con3:wsCallout>
                                                      <con1:id>_ActionId-4121053732405088544-7ebba738.158cfb81d2a.-7614</con1:id>
                                                      <con3:service xsi:type="ref:ProxyRef" ref="ITEL/OCS/AIR/Proxies/consultarOfferOCSODMLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                                      <con3:operation>consultarOffer</con3:operation>
                                                      <con3:request>
                                                        <con3:body>$consultarOfferRequest</con3:body>
                                                      </con3:request>
                                                      <con3:response>
                                                        <con3:body>consultarOfferResponse</con3:body>
                                                      </con3:response>
                                                      <con3:requestTransform>
                                                        <con3:assign varName="consultarOfferRequest">
                                                          <con1:id>_ActionId-4121053732405088544-7ebba738.158cfb81d2a.-75fd</con1:id>
                                                          <con3:expr>
                                                            <con1:xqueryTransform>
                                                              <con1:resource ref="ITEL/Core/Resources/XQueries/ejecutarReglasNegocio_Req_consultarOfertasODM"/>
                                                              <con1:param name="input_Parameters1">
                                                                <con1:path>$body/ejec:Input_Parameters</con1:path>
                                                              </con1:param>
                                                            </con1:xqueryTransform>
                                                          </con3:expr>
                                                        </con3:assign>
                                                      </con3:requestTransform>
                                                      <con3:responseTransform>
                                                        <con3:assign varName="codError">
                                                          <con1:id>_ActionId-4121053732405088544-7ebba738.158cfb81d2a.-7565</con1:id>
                                                          <con3:expr>
                                                            <con1:xqueryText>data($consultarOfferResponse/CODIGO)</con1:xqueryText>
                                                          </con3:expr>
                                                        </con3:assign>
                                                        <con3:ifThenElse>
                                                          <con1:id>_ActionId-4121053732405088544-7ebba738.158cfb81d2a.-75bb</con1:id>
                                                          <con3:case>
                                                            <con3:condition>
                                                              <con1:xqueryText>$codError = '1'</con1:xqueryText>
                                                            </con3:condition>
                                                            <con3:actions>
                                                              <con3:assign varName=" prodID">
                                                                <con1:id>_ActionId-4121053732405088544-7ebba738.158cfb81d2a.-72c2</con1:id>
                                                                <con3:expr>
                                                                  <con1:xqueryTransform>
                                                                    <con1:resource ref="ITEL/Core/Resources/XQueries/consultaProductID"/>
                                                                    <con1:param name="offerID">
                                                                      <con1:path>data($body/*:Input_Parameters/PARAMETROS_TRAMA/PARAMETRO[NOMBRE='COMENTARIO']/VALOR)</con1:path>
                                                                    </con1:param>
                                                                    <con1:param name="consultaOffer">
                                                                      <con1:path>$consultarOfferResponse</con1:path>
                                                                    </con1:param>
                                                                  </con1:xqueryTransform>
                                                                </con3:expr>
                                                              </con3:assign>
                                                              <con3:insert varName="reglasNegocioResponse">
                                                                <con1:id>_ActionId-4121053732405088544-7ebba738.158cfb81d2a.-72eb</con1:id>
                                                                <con3:location>
                                                                  <con1:xpathText>./MENSAJE/PARAMETROS</con1:xpathText>
                                                                </con3:location>
                                                                <con3:where>last-child</con3:where>
                                                                <con3:expr>
                                                                  <con1:xqueryText><![CDATA[<PARAMETRO>
	<NOMBRE>PRODUCT_ID</NOMBRE>
	<TIPO>string</TIPO>
	<VALOR>{ data($prodID) }</VALOR>
</PARAMETRO>]]></con1:xqueryText>
                                                                </con3:expr>
                                                              </con3:insert>
                                                              <con3:insert varName="body">
                                                                <con1:id>_ActionId-4121053732405088544-7ebba738.158cfb81d2a.-73e8</con1:id>
                                                                <con3:location>
                                                                  <con1:xpathText>./ejec:Input_Parameters/PARAMETROS_TRAMA</con1:xpathText>
                                                                </con3:location>
                                                                <con3:where>last-child</con3:where>
                                                                <con3:expr>
                                                                  <con1:xqueryText><![CDATA[<PARAMETRO>
	<NOMBRE>PRODUCT_ID</NOMBRE>
	<TIPO>string</TIPO>
	<VALOR>{ data($prodID) }</VALOR>
</PARAMETRO>]]></con1:xqueryText>
                                                                </con3:expr>
                                                              </con3:insert>
                                                            </con3:actions>
                                                          </con3:case>
                                                          <con3:default/>
                                                        </con3:ifThenElse>
                                                      </con3:responseTransform>
                                                    </con3:wsCallout>
                                                  </con3:actions>
                                                </con3:case>
                                                <con3:default/>
                                              </con3:ifThenElse>
                                              <con3:ifThenElse>
                                                <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-79ed</con1:id>
                                                <con3:case>
                                                  <con3:condition>
                                                    <con1:xqueryText>$metodo = ('401','402','700','600','202', '204','205','206') and $codError = "1" and data($suscriptorOCSResponse/MENSAJE/CONSULTAR_SUSCRIPTOR/*:suscriptor/*:ContractStatus) = "3"</con1:xqueryText>
                                                  </con3:condition>
                                                  <con3:actions>
                                                    <con3:assign varName="codError">
                                                      <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-79ec</con1:id>
                                                      <con3:expr>
                                                        <con1:xqueryText>"902"</con1:xqueryText>
                                                      </con3:expr>
                                                    </con3:assign>
                                                  </con3:actions>
                                                </con3:case>
                                                <con3:case>
                                                  <con3:condition>
                                                    <con1:xqueryText>$metodo = ('401','402','700','600','202','204') and $codError = "1" and data($suscriptorOCSResponse/MENSAJE/CONSULTAR_SUSCRIPTOR/*:suscriptor/*:RefillBarredUntil) != ""</con1:xqueryText>
                                                  </con3:condition>
                                                  <con3:actions>
                                                    <con3:assign varName="codError">
                                                      <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-79eb</con1:id>
                                                      <con3:expr>
                                                        <con1:xqueryText>"910"</con1:xqueryText>
                                                      </con3:expr>
                                                    </con3:assign>
                                                  </con3:actions>
                                                </con3:case>
                                                <con3:default/>
                                              </con3:ifThenElse>
                                              <con3:assign varName="esCobro">
                                                <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-79ea</con1:id>
                                                <con3:expr>
                                                  <con1:xqueryText>($metodo = ('306','307','310','313') and number($body/ejec:Input_Parameters/PARAMETROS_TRAMA/PARAMETRO[NOMBRE="BONIFICAR"]/VALOR) > 0)
or
($metodo = ('601') and number($body/ejec:Input_Parameters/PARAMETROS_TRAMA/PARAMETRO[NOMBRE="HOSTID"]/VALOR) > 0)
or
($metodo = ('314') and number($body/ejec:Input_Parameters/PARAMETROS_TRAMA/PARAMETRO[NOMBRE="CONSECUTIVO"]/VALOR) > 0)
or
($metodo = ('301','302','303','305','308','309','311') and number($body/ejec:Input_Parameters/PARAMETROS_TRAMA/PARAMETRO[NOMBRE="MONTORECARGA"]/VALOR) > 0)

(: 
Distribucin del parmetro CODIGOCOBRO 
'301' --> Monto
'302' --> Monto
'303' --> Monto
'305' --> NA
'306' --> Bonificar
'307' --> Bonificar
'308' --> Monto
'309' --> Monto
'310' --> Bonificar
'311' --> Monto
'313' --> Bonificar
'314' --> Consecutivo
'601' --> Hostid
:)</con1:xqueryText>
                                                </con3:expr>
                                              </con3:assign>
                                              <con3:ifThenElse>
                                                <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-79e9</con1:id>
                                                <con3:case>
                                                  <con3:condition>
                                                    <con1:xqueryText>$metodo = ('301','302','303','305','306','307','308','309','310','311','313','314','601')
and $esCobro = 'true'</con1:xqueryText>
                                                  </con3:condition>
                                                  <con3:actions>
                                                    <con3:wsCallout>
                                                      <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-79e7</con1:id>
                                                      <con3:service xsi:type="ref:ProxyRef" ref="ITEL/OCS/AIR/Proxies/consultarBalancesOCSLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                                      <con3:operation>consultarBalances</con3:operation>
                                                      <con3:request>
                                                        <con3:body>$balancesRequest</con3:body>
                                                      </con3:request>
                                                      <con3:response>
                                                        <con3:body>balancesResponse</con3:body>
                                                      </con3:response>
                                                      <con3:requestTransform>
                                                        <con3:assign varName="balancesRequest">
                                                          <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-79e8</con1:id>
                                                          <con3:expr>
                                                            <con1:xqueryTransform>
                                                              <con1:resource ref="ITEL/Core/Resources/XQueries/consultarBalancesPS_Req"/>
                                                              <con1:param name="min">
                                                                <con1:path>data($body/ejec:Input_Parameters/MIN_DESTINO)</con1:path>
                                                              </con1:param>
                                                            </con1:xqueryTransform>
                                                          </con3:expr>
                                                        </con3:assign>
                                                      </con3:requestTransform>
                                                      <con3:responseTransform/>
                                                    </con3:wsCallout>
                                                    <con3:ifThenElse>
                                                      <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-79e6</con1:id>
                                                      <con3:case>
                                                        <con3:condition>
                                                          <con1:xqueryText>data($balancesResponse/CODIGO) = '1' 
and
data($balancesResponse/MENSAJE/CONSULTAR_BALANCES/MethodResponse/expiryDate) != ''</con1:xqueryText>
                                                        </con3:condition>
                                                        <con3:actions>
                                                          <con3:assign varName="balanceBono">
                                                            <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-79e5</con1:id>
                                                            <con3:expr>
                                                              <con1:xqueryText>if(exists($balancesResponse/MENSAJE/CONSULTAR_BALANCES/MethodResponse/DedicatedAccounts/Detail[Name='7000']))
then
data($balancesResponse/MENSAJE/CONSULTAR_BALANCES/MethodResponse/DedicatedAccounts/Detail[Name='7000']/Balance)
else
'0'</con1:xqueryText>
                                                            </con3:expr>
                                                          </con3:assign>
                                                          <con3:ifThenElse>
                                                            <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-79e4</con1:id>
                                                            <con3:case>
                                                              <con3:condition>
                                                                <con1:xqueryText>fn-bea:dateTime-from-string-with-format("yyyyMMdd'T'HH:mm:ss+SSSS",
data($balancesResponse/MENSAJE/CONSULTAR_BALANCES/MethodResponse/expiryDate)) &lt; current-dateTime()</con1:xqueryText>
                                                              </con3:condition>
                                                              <con3:actions>
                                                                <con3:assign varName="codError">
                                                                  <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-79e3</con1:id>
                                                                  <con3:expr>
                                                                    <con1:xqueryText>"944"</con1:xqueryText>
                                                                  </con3:expr>
                                                                </con3:assign>
                                                              </con3:actions>
                                                            </con3:case>
                                                            <con3:case>
                                                              <con3:condition>
                                                                <con1:xqueryText>$metodo = ('301','303','306','307','309','310','311','313') and data($balancesResponse/MENSAJE/CONSULTAR_BALANCES/MethodResponse/accountValue) &lt;= 0</con1:xqueryText>
                                                              </con3:condition>
                                                              <con3:actions>
                                                                <con3:assign varName="codError">
                                                                  <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-79e2</con1:id>
                                                                  <con3:expr>
                                                                    <con1:xqueryText>"919"</con1:xqueryText>
                                                                  </con3:expr>
                                                                </con3:assign>
                                                              </con3:actions>
                                                            </con3:case>
                                                            <con3:case>
                                                              <con3:condition>
                                                                <con1:xqueryText>$metodo = ('601') and data($balancesResponse/MENSAJE/CONSULTAR_BALANCES/MethodResponse/accountValue) &lt; 0</con1:xqueryText>
                                                              </con3:condition>
                                                              <con3:actions>
                                                                <con3:assign varName="codError">
                                                                  <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-79e1</con1:id>
                                                                  <con3:expr>
                                                                    <con1:xqueryText>"919"</con1:xqueryText>
                                                                  </con3:expr>
                                                                </con3:assign>
                                                              </con3:actions>
                                                            </con3:case>
                                                            <con3:default/>
                                                          </con3:ifThenElse>
                                                        </con3:actions>
                                                      </con3:case>
                                                      <con3:case>
                                                        <con3:condition>
                                                          <con1:xqueryText>data($balancesResponse/CODIGO) != '1' 
or
data($balancesResponse/MENSAJE/CONSULTAR_BALANCES/MethodResponse/accountValue) &lt;= 0</con1:xqueryText>
                                                        </con3:condition>
                                                        <con3:actions>
                                                          <con3:assign varName="codError">
                                                            <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-79df</con1:id>
                                                            <con3:expr>
                                                              <con1:xqueryText>"919"</con1:xqueryText>
                                                            </con3:expr>
                                                          </con3:assign>
                                                        </con3:actions>
                                                      </con3:case>
                                                      <con3:default/>
                                                    </con3:ifThenElse>
                                                  </con3:actions>
                                                </con3:case>
                                                <con3:case>
                                                  <con3:condition>
                                                    <con1:xqueryText>$metodo = ('306','311','314') and  
number(data($reglasNegocioResponse//PARAMETROS/PARAMETRO[NOMBRE='CAMBIOS_FNF']/VALOR)) >= number(data($body/ejec:Input_Parameters/PARAMETROS_TRAMA/PARAMETRO[NOMBRE='CAMBIOS_GRATIS']/VALOR))</con1:xqueryText>
                                                  </con3:condition>
                                                  <con3:actions>
                                                    <con3:wsCallout>
                                                      <con1:id>_ActionId-808564638867856459--b4140d8.1575241f0f0.-789c</con1:id>
                                                      <con3:service xsi:type="ref:ProxyRef" ref="ITEL/OCS/AIR/Proxies/consultarBalancesOCSLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                                      <con3:operation>consultarBalances</con3:operation>
                                                      <con3:request>
                                                        <con3:body>$balancesRequest</con3:body>
                                                      </con3:request>
                                                      <con3:response>
                                                        <con3:body>balancesResponse</con3:body>
                                                      </con3:response>
                                                      <con3:requestTransform>
                                                        <con3:assign varName="balancesRequest">
                                                          <con1:id>_ActionId-808564638867856459--b4140d8.1575241f0f0.-789d</con1:id>
                                                          <con3:expr>
                                                            <con1:xqueryTransform>
                                                              <con1:resource ref="ITEL/Core/Resources/XQueries/consultarBalancesPS_Req"/>
                                                              <con1:param name="min">
                                                                <con1:path>data($body/ejec:Input_Parameters/MIN_DESTINO)</con1:path>
                                                              </con1:param>
                                                            </con1:xqueryTransform>
                                                          </con3:expr>
                                                        </con3:assign>
                                                      </con3:requestTransform>
                                                      <con3:responseTransform/>
                                                    </con3:wsCallout>
                                                    <con3:ifThenElse>
                                                      <con1:id>_ActionId-808564638867856459--b4140d8.1575241f0f0.-781b</con1:id>
                                                      <con3:case>
                                                        <con3:condition>
                                                          <con1:xqueryText>data($balancesResponse/CODIGO) = '1'
and
data($balancesResponse/MENSAJE/CONSULTAR_BALANCES/MethodResponse/expiryDate) != ''</con1:xqueryText>
                                                        </con3:condition>
                                                        <con3:actions>
                                                          <con3:ifThenElse>
                                                            <con1:id>_ActionId-808564638867856459--b4140d8.1575241f0f0.-781a</con1:id>
                                                            <con3:case>
                                                              <con3:condition>
                                                                <con1:xqueryText>fn-bea:dateTime-from-string-with-format("yyyyMMdd'T'HH:mm:ss+SSSS",
data($balancesResponse/MENSAJE/CONSULTAR_BALANCES/MethodResponse/expiryDate)) &lt; current-dateTime()</con1:xqueryText>
                                                              </con3:condition>
                                                              <con3:actions>
                                                                <con3:assign varName="codError">
                                                                  <con1:id>_ActionId-808564638867856459--b4140d8.1575241f0f0.-7819</con1:id>
                                                                  <con3:expr>
                                                                    <con1:xqueryText>"944"</con1:xqueryText>
                                                                  </con3:expr>
                                                                </con3:assign>
                                                              </con3:actions>
                                                            </con3:case>
                                                            <con3:default>
                                                              <con3:assign varName="codError">
                                                                <con1:id>_ActionId-808564638867856459--b4140d8.1575241f0f0.-7818</con1:id>
                                                                <con3:expr>
                                                                  <con1:xqueryText>"1"</con1:xqueryText>
                                                                </con3:expr>
                                                              </con3:assign>
                                                            </con3:default>
                                                          </con3:ifThenElse>
                                                        </con3:actions>
                                                      </con3:case>
                                                      <con3:case>
                                                        <con3:condition>
                                                          <con1:xqueryText>data($balancesResponse/CODIGO) = '900'</con1:xqueryText>
                                                        </con3:condition>
                                                        <con3:actions>
                                                          <con3:assign varName="codError">
                                                            <con1:id>_ActionId-808564638867856459--b4140d8.1575241f0f0.-7817</con1:id>
                                                            <con3:expr>
                                                              <con1:xqueryText>"944"</con1:xqueryText>
                                                            </con3:expr>
                                                          </con3:assign>
                                                        </con3:actions>
                                                      </con3:case>
                                                      <con3:default/>
                                                    </con3:ifThenElse>
                                                  </con3:actions>
                                                </con3:case>
                                                <con3:default/>
                                              </con3:ifThenElse>
                                            </con3:actions>
                                          </con3:case>
                                          <con3:default>
                                            <con3:assign varName="codError">
                                              <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-79de</con1:id>
                                              <con3:expr>
                                                <con1:xqueryText>data($suscriptorOCSResponse/CODIGO)</con1:xqueryText>
                                              </con3:expr>
                                            </con3:assign>
                                          </con3:default>
                                        </con3:ifThenElse>
                                      </con3:actions>
                                    </con3:case>
                                    <con3:case>
                                      <con3:condition>
                                        <con1:xqueryText>not($metodo = ("400","401","402","403","405","406","407"))</con1:xqueryText>
                                      </con3:condition>
                                      <con3:actions/>
                                    </con3:case>
                                    <con3:default/>
                                  </con3:ifThenElse>
                                  <con3:ifThenElse>
                                    <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-79dd</con1:id>
                                    <con3:case>
                                      <con3:condition>
                                        <con1:xqueryText>$codError = "1"</con1:xqueryText>
                                      </con3:condition>
                                      <con3:actions>
                                        <con3:ifThenElse>
                                          <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-79dc</con1:id>
                                          <con3:case>
                                            <con3:condition>
                                              <con1:xqueryText>$metodo = '415'</con1:xqueryText>
                                            </con3:condition>
                                            <con3:actions>
                                              <con3:ifThenElse>
                                                <con1:id>_ActionId-4489625380589970335-74ff277e.158d60ec101.-7fbc</con1:id>
                                                <con3:case>
                                                  <con3:condition>
                                                    <con1:xqueryText>data($consultarPaquetesDatosResponse/MENSAJE/PLATAFORMA)='BB'</con1:xqueryText>
                                                  </con3:condition>
                                                  <con3:actions/>
                                                </con3:case>
                                                <con3:default/>
                                              </con3:ifThenElse>
                                              <con3:ifThenElse>
                                                <con1:id>_ActionId-8395962515205387199--3bb18e3.158c11a3c15.-6e01</con1:id>
                                                <con3:case>
                                                  <con3:condition>
                                                    <con1:xqueryText>data($body/ejec:Input_Parameters/PARAMETROS_TRAMA/PARAMETRO[NOMBRE='BONIFICAR']/VALOR) = '1'</con1:xqueryText>
                                                  </con3:condition>
                                                  <con3:actions>
                                                    <con3:wsCallout>
                                                      <con1:id>_ActionId-8395962515205387199--3bb18e3.158c11a3c15.-6dff</con1:id>
                                                      <con3:service xsi:type="ref:ProxyRef" ref="ITEL/OCS/AIR/Proxies/consultarBalancesOCSLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                                      <con3:operation>consultarBalances</con3:operation>
                                                      <con3:request>
                                                        <con3:body>$balancesRequest</con3:body>
                                                      </con3:request>
                                                      <con3:response>
                                                        <con3:body>balancesResponse</con3:body>
                                                      </con3:response>
                                                      <con3:requestTransform>
                                                        <con3:assign varName="balancesRequest">
                                                          <con1:id>_ActionId-8395962515205387199--3bb18e3.158c11a3c15.-6e00</con1:id>
                                                          <con3:expr>
                                                            <con1:xqueryTransform>
                                                              <con1:resource ref="ITEL/Core/Resources/XQueries/consultarBalancesPS_Req"/>
                                                              <con1:param name="min">
                                                                <con1:path>data($body/ejec:Input_Parameters/MIN_DESTINO)</con1:path>
                                                              </con1:param>
                                                            </con1:xqueryTransform>
                                                          </con3:expr>
                                                        </con3:assign>
                                                      </con3:requestTransform>
                                                      <con3:responseTransform/>
                                                    </con3:wsCallout>
                                                    <con3:ifThenElse>
                                                      <con1:id>_ActionId-8395962515205387199--3bb18e3.158c11a3c15.-6bf4</con1:id>
                                                      <con3:case>
                                                        <con3:condition>
                                                          <con1:xqueryText>data($balancesResponse/CODIGO) = '1'
and
data($balancesResponse/MENSAJE/CONSULTAR_BALANCES/MethodResponse/expiryDate) != ''</con1:xqueryText>
                                                        </con3:condition>
                                                        <con3:actions>
                                                          <con3:ifThenElse>
                                                            <con1:id>_ActionId-8395962515205387199--3bb18e3.158c11a3c15.-6bf3</con1:id>
                                                            <con3:case>
                                                              <con3:condition>
                                                                <con1:xqueryText>fn-bea:dateTime-from-string-with-format("yyyyMMdd'T'HH:mm:ss+SSSS",
data($balancesResponse/MENSAJE/CONSULTAR_BALANCES/MethodResponse/expiryDate)) &lt; current-dateTime()</con1:xqueryText>
                                                              </con3:condition>
                                                              <con3:actions>
                                                                <con3:assign varName="codError">
                                                                  <con1:id>_ActionId-8395962515205387199--3bb18e3.158c11a3c15.-6bf2</con1:id>
                                                                  <con3:expr>
                                                                    <con1:xqueryText>"944"</con1:xqueryText>
                                                                  </con3:expr>
                                                                </con3:assign>
                                                              </con3:actions>
                                                            </con3:case>
                                                            <con3:default>
                                                              <con3:assign varName="codError">
                                                                <con1:id>_ActionId-8395962515205387199--3bb18e3.158c11a3c15.-6bf1</con1:id>
                                                                <con3:expr>
                                                                  <con1:xqueryText>"1"</con1:xqueryText>
                                                                </con3:expr>
                                                              </con3:assign>
                                                            </con3:default>
                                                          </con3:ifThenElse>
                                                        </con3:actions>
                                                      </con3:case>
                                                      <con3:case>
                                                        <con3:condition>
                                                          <con1:xqueryText>data($balancesResponse/CODIGO) = '900'</con1:xqueryText>
                                                        </con3:condition>
                                                        <con3:actions>
                                                          <con3:assign varName="codError">
                                                            <con1:id>_ActionId-8395962515205387199--3bb18e3.158c11a3c15.-6bf0</con1:id>
                                                            <con3:expr>
                                                              <con1:xqueryText>"944"</con1:xqueryText>
                                                            </con3:expr>
                                                          </con3:assign>
                                                        </con3:actions>
                                                      </con3:case>
                                                      <con3:default/>
                                                    </con3:ifThenElse>
                                                  </con3:actions>
                                                </con3:case>
                                                <con3:default/>
                                              </con3:ifThenElse>
                                            </con3:actions>
                                          </con3:case>
                                          <con3:case>
                                            <con3:condition>
                                              <con1:xqueryText>$metodo = ('200','201','207','205','212','601','604','402','403','407','600','400','401','408','411','410','409','705') 
	or	($metodo = '406' and data($body/ejec:Input_Parameters/PARAMETROS_TRAMA/PARAMETRO[NOMBRE='DIASVIGENCIA']/VALOR) > 0 )
	or	($metodo = '405' and data($body/ejec:Input_Parameters/PARAMETROS_TRAMA/PARAMETRO[NOMBRE='MONTORECARGA']/VALOR) > 0 )</con1:xqueryText>
                                            </con3:condition>
                                            <con3:actions>
                                              <con3:wsCallout>
                                                <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-79da</con1:id>
                                                <con3:service xsi:type="ref:ProxyRef" ref="ITEL/OCS/AIR/Proxies/consultarBalancesOCSLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                                <con3:operation>consultarBalances</con3:operation>
                                                <con3:request>
                                                  <con3:body>$balancesRequest</con3:body>
                                                </con3:request>
                                                <con3:response>
                                                  <con3:body>balancesResponse</con3:body>
                                                </con3:response>
                                                <con3:requestTransform>
                                                  <con3:assign varName="balancesRequest">
                                                    <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-79db</con1:id>
                                                    <con3:expr>
                                                      <con1:xqueryTransform>
                                                        <con1:resource ref="ITEL/Core/Resources/XQueries/consultarBalancesPS_Req"/>
                                                        <con1:param name="min">
                                                          <con1:path>if($body/ejec:Input_Parameters/METODO = ('401','402')) then 
data($body/ejec:Input_Parameters/MIN_ORIGEN)
else
data($body/ejec:Input_Parameters/MIN_DESTINO)</con1:path>
                                                        </con1:param>
                                                      </con1:xqueryTransform>
                                                    </con3:expr>
                                                  </con3:assign>
                                                </con3:requestTransform>
                                                <con3:responseTransform/>
                                              </con3:wsCallout>
                                              <con3:ifThenElse>
                                                <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-79d9</con1:id>
                                                <con3:case>
                                                  <con3:condition>
                                                    <con1:xqueryText>let $fechaActual := xs:date(fn:substring(string(fn:current-date()), 1, 10)),
    $exp := data($balancesResponse/MENSAJE/CONSULTAR_BALANCES/MethodResponse/expiryDate),
    $expiracion := concat(substring($exp, 1, 4), '-',substring($exp, 5, 2), '-',substring($exp, 7, 2)),
    $dias := days-from-duration(xs:date($expiracion) - $fechaActual)
return    
data($balancesResponse/CODIGO) = '1' and $metodo = '400' and $dias &lt; 0</con1:xqueryText>
                                                  </con3:condition>
                                                  <con3:actions>
                                                    <con3:assign varName="codError">
                                                      <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-79d8</con1:id>
                                                      <con3:expr>
                                                        <con1:xqueryText>"944"</con1:xqueryText>
                                                      </con3:expr>
                                                    </con3:assign>
                                                  </con3:actions>
                                                </con3:case>
                                                <con3:case>
                                                  <con3:condition>
                                                    <con1:xqueryText>$metodo = '402' and number($body/ejec:Input_Parameters/IN_ORIGEN) &lt; 50</con1:xqueryText>
                                                  </con3:condition>
                                                  <con3:actions>
                                                    <con3:wsCallout>
                                                      <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-79d1</con1:id>
                                                      <con3:service xsi:type="ref:ProxyRef" ref="ITEL/Core/Proxies/consultarDatosMinesLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                                      <con3:operation>consultarDatosMines</con3:operation>
                                                      <con3:request>
                                                        <con3:body>$datos</con3:body>
                                                      </con3:request>
                                                      <con3:response>
                                                        <con3:body>respMines</con3:body>
                                                      </con3:response>
                                                      <con3:requestTransform>
                                                        <con3:assign varName="datos">
                                                          <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-79d7</con1:id>
                                                          <con3:expr>
                                                            <con1:xqueryTransform>
                                                              <con1:resource ref="ITEL/Core/Resources/XQueries/ejecutarReglasNegocio_Req_consultarDatosMines"/>
                                                              <con1:param name="inOrigen">
                                                                <con1:path>$inOrigen</con1:path>
                                                              </con1:param>
                                                              <con1:param name="timeout">
                                                                <con1:path>$timeout</con1:path>
                                                              </con1:param>
                                                              <con1:param name="minOrigen">
                                                                <con1:path>$minOrigen</con1:path>
                                                              </con1:param>
                                                              <con1:param name="minDestino">
                                                                <con1:path>""</con1:path>
                                                              </con1:param>
                                                              <con1:param name="prefijo">
                                                                <con1:path>$prefijo</con1:path>
                                                              </con1:param>
                                                              <con1:param name="inDestino">
                                                                <con1:path>""</con1:path>
                                                              </con1:param>
                                                            </con1:xqueryTransform>
                                                          </con3:expr>
                                                        </con3:assign>
                                                      </con3:requestTransform>
                                                      <con3:responseTransform>
                                                        <con3:ifThenElse>
                                                          <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-79d6</con1:id>
                                                          <con3:case>
                                                            <con3:condition>
                                                              <con1:xqueryText>data($respMines/CODIGO) != "1"</con1:xqueryText>
                                                            </con3:condition>
                                                            <con3:actions>
                                                              <con3:assign varName="codError">
                                                                <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-79d5</con1:id>
                                                                <con3:expr>
                                                                  <con1:xqueryText>data($respMines/CODIGO)</con1:xqueryText>
                                                                </con3:expr>
                                                              </con3:assign>
                                                            </con3:actions>
                                                          </con3:case>
                                                          <con3:default>
                                                            <con3:ifThenElse>
                                                              <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-79d4</con1:id>
                                                              <con3:case>
                                                                <con3:condition>
                                                                  <con1:xqueryText>$respMines/MENSAJE/DatosOrigen/*:IsFraudLocked/text() = "TRUE"</con1:xqueryText>
                                                                </con3:condition>
                                                                <con3:actions>
                                                                  <con3:assign varName="codError">
                                                                    <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-79d3</con1:id>
                                                                    <con3:expr>
                                                                      <con1:xqueryText>"910"</con1:xqueryText>
                                                                    </con3:expr>
                                                                  </con3:assign>
                                                                </con3:actions>
                                                              </con3:case>
                                                              <con3:case>
                                                                <con3:condition>
                                                                  <con1:xqueryText>$respMines/MENSAJE/DatosOrigen/*:IsLocked/text() = "TRUE"</con1:xqueryText>
                                                                </con3:condition>
                                                                <con3:actions>
                                                                  <con3:assign varName="codError">
                                                                    <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-79d2</con1:id>
                                                                    <con3:expr>
                                                                      <con1:xqueryText>"902"</con1:xqueryText>
                                                                    </con3:expr>
                                                                  </con3:assign>
                                                                </con3:actions>
                                                              </con3:case>
                                                              <con3:default/>
                                                            </con3:ifThenElse>
                                                          </con3:default>
                                                        </con3:ifThenElse>
                                                      </con3:responseTransform>
                                                    </con3:wsCallout>
                                                  </con3:actions>
                                                </con3:case>
                                                <con3:case>
                                                  <con3:condition>
                                                    <con1:xqueryText>$metodo = '201' and (data($balancesResponse/CODIGO) = '1' or data($balancesResponse/CODIGO) = '959')</con1:xqueryText>
                                                  </con3:condition>
                                                  <con3:actions>
                                                    <con3:wsCallout>
                                                      <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-79ce</con1:id>
                                                      <con3:service xsi:type="ref:ProxyRef" ref="ITEL/OCS/OLM/Proxies/consultarSuscripcionOCSLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                                      <con3:operation>consultarSuscripcionOCS</con3:operation>
                                                      <con3:request>
                                                        <con3:body>$consultarSuscripcionOCSRequest</con3:body>
                                                      </con3:request>
                                                      <con3:response>
                                                        <con3:body>consultarSuscripcionOCSResponse</con3:body>
                                                      </con3:response>
                                                      <con3:requestTransform>
                                                        <con3:assign varName="consultarSuscripcionOCSRequest">
                                                          <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-79d0</con1:id>
                                                          <con3:expr>
                                                            <con1:xqueryTransform>
                                                              <con1:resource ref="ITEL/Core/Resources/XQueries/consultarSuscripcionOCSPS_Req"/>
                                                              <con1:param name="min">
                                                                <con1:path>data($body/ejec:Input_Parameters/MIN_DESTINO)</con1:path>
                                                              </con1:param>
                                                            </con1:xqueryTransform>
                                                          </con3:expr>
                                                        </con3:assign>
                                                      </con3:requestTransform>
                                                      <con3:responseTransform>
                                                        <con3:replace varName="balancesResponse" contents-only="false">
                                                          <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-79cf</con1:id>
                                                          <con3:expr>
                                                            <con1:xqueryTransform>
                                                              <con1:resource ref="ITEL/Core/Resources/XQueries/adaptarFechaExpiracionBalancesOCS"/>
                                                              <con1:param name="wS_Result2">
                                                                <con1:path>$consultarSuscripcionOCSResponse</con1:path>
                                                              </con1:param>
                                                              <con1:param name="cuentasDA">
                                                                <con1:path>data($body/ejec:Input_Parameters/PARAMETROS_TRAMA/PARAMETRO[NOMBRE='CUENTASDA']/VALOR)</con1:path>
                                                              </con1:param>
                                                              <con1:param name="wS_Result1">
                                                                <con1:path>$balancesResponse</con1:path>
                                                              </con1:param>
                                                            </con1:xqueryTransform>
                                                          </con3:expr>
                                                        </con3:replace>
                                                      </con3:responseTransform>
                                                    </con3:wsCallout>
                                                    <con1:wsCallout xmlns:con3="http://www.bea.com/wli/sb/typesystem/config" xmlns:con2="http://www.bea.com/wli/sb/stages/config" xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
                                                      <con6:id xmlns:con6="http://www.bea.com/wli/sb/stages/config">_ActionId-8096952212429106120-1bbaa577.15405e544f1.-79ca</con6:id>
                                                      <con1:service xsi:type="ref:ProxyRef" ref="ITEL/OCS/AIR/Proxies/consultarFaFListOCSLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                                      <con1:operation>consultarFaFList</con1:operation>
                                                      <con1:request>
                                                        <con1:body>$consultarFaFListRequest</con1:body>
                                                      </con1:request>
                                                      <con1:response>
                                                        <con1:body>consultarFaFListResponse</con1:body>
                                                      </con1:response>
                                                      <con1:requestTransform>
                                                        <con1:assign varName="consultarFaFListRequest">
                                                          <con6:id xmlns:con6="http://www.bea.com/wli/sb/stages/config">_ActionId-8096952212429106120-1bbaa577.15405e544f1.-79cd</con6:id>
                                                          <con1:expr>
                                                            <con6:xqueryTransform xmlns:con6="http://www.bea.com/wli/sb/stages/config">
                                                              <con6:resource ref="ITEL/Core/Resources/XQueries/consultarFaFListPS_Req"/>
                                                              <con6:param name="min">
                                                                <con6:path>data($body/ejec:Input_Parameters/MIN_DESTINO)</con6:path>
                                                              </con6:param>
                                                            </con6:xqueryTransform>
                                                          </con1:expr>
                                                        </con1:assign>
                                                      </con1:requestTransform>
                                                      <con1:responseTransform>
                                                        <con1:ifThenElse>
                                                          <con6:id xmlns:con6="http://www.bea.com/wli/sb/stages/config">_ActionId-8096952212429106120-1bbaa577.15405e544f1.-79cc</con6:id>
                                                          <con1:case>
                                                            <con1:condition>
                                                              <con6:xqueryText xmlns:con6="http://www.bea.com/wli/sb/stages/config">data($consultarFaFListResponse/CODIGO) != '1'</con6:xqueryText>
                                                            </con1:condition>
                                                            <con1:actions>
                                                              <con6:assign varName="codError" xmlns:con3="http://www.bea.com/wli/sb/stages/transform/config" xmlns:con2="http://www.bea.com/wli/sb/typesystem/config" xmlns:con1="http://www.bea.com/wli/sb/stages/config" xmlns:con6="http://www.bea.com/wli/sb/stages/transform/config">
                                                                <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-79cb</con1:id>
                                                                <con6:expr>
                                                                  <con1:xqueryText>data($consultarFaFListResponse/CODIGO)</con1:xqueryText>
                                                                </con6:expr>
                                                              </con6:assign>
                                                            </con1:actions>
                                                          </con1:case>
                                                          <con1:default/>
                                                        </con1:ifThenElse>
                                                      </con1:responseTransform>
                                                    </con1:wsCallout>
                                                    <con3:ifThenElse>
                                                      <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-79c9</con1:id>
                                                      <con3:case>
                                                        <con3:condition>
                                                          <con1:xqueryText>$codError = "1" and 
fn:exists($consultarFaFListResponse/MENSAJE/CONSULTAR_FAFLIST/fafInformationList/Detail/fafIndicator)</con1:xqueryText>
                                                        </con3:condition>
                                                        <con3:actions>
                                                          <con3:wsCallout>
                                                            <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-79c4</con1:id>
                                                            <con3:service xsi:type="ref:ProxyRef" ref="ITEL/Core/Proxies/consultarFAFTipoLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                                            <con3:operation>consultarFAFTipo</con3:operation>
                                                            <con3:request>
                                                              <con3:body>$consultarFAFTipoRequest</con3:body>
                                                            </con3:request>
                                                            <con3:response>
                                                              <con3:body>consultarFAFTipoResponse</con3:body>
                                                            </con3:response>
                                                            <con3:requestTransform>
                                                              <con3:assign varName="consultarFAFTipoRequest">
                                                                <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-79c8</con1:id>
                                                                <con3:expr>
                                                                  <con1:xqueryTransform>
                                                                    <con1:resource ref="ITEL/Core/Resources/XQueries/consultarFAFTipoPS_Req"/>
                                                                    <con1:param name="wS_Result1">
                                                                      <con1:path>$consultarFaFListResponse</con1:path>
                                                                    </con1:param>
                                                                  </con1:xqueryTransform>
                                                                </con3:expr>
                                                              </con3:assign>
                                                            </con3:requestTransform>
                                                            <con3:responseTransform>
                                                              <con1:ifThenElse xmlns:con3="http://www.bea.com/wli/sb/typesystem/config" xmlns:con2="http://www.bea.com/wli/sb/stages/config" xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
                                                                <con6:id xmlns:con6="http://www.bea.com/wli/sb/stages/config">_ActionId-8096952212429106120-1bbaa577.15405e544f1.-79c7</con6:id>
                                                                <con1:case>
                                                                  <con1:condition>
                                                                    <con6:xqueryText xmlns:con6="http://www.bea.com/wli/sb/stages/config">data($consultarFAFTipoResponse/CODIGO) != 'OK'</con6:xqueryText>
                                                                  </con1:condition>
                                                                  <con1:actions>
                                                                    <con6:assign varName="codError" xmlns:con3="http://www.bea.com/wli/sb/stages/transform/config" xmlns:con2="http://www.bea.com/wli/sb/typesystem/config" xmlns:con1="http://www.bea.com/wli/sb/stages/config" xmlns:con6="http://www.bea.com/wli/sb/stages/transform/config">
                                                                      <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-79c6</con1:id>
                                                                      <con6:expr>
                                                                        <con1:xqueryText>"909"</con1:xqueryText>
                                                                      </con6:expr>
                                                                    </con6:assign>
                                                                  </con1:actions>
                                                                </con1:case>
                                                                <con1:default>
                                                                  <con1:replace varName="consultarFaFListResponse" contents-only="false">
                                                                    <con6:id xmlns:con6="http://www.bea.com/wli/sb/stages/config">_ActionId-8096952212429106120-1bbaa577.15405e544f1.-79c5</con6:id>
                                                                    <con1:expr>
                                                                      <con6:xqueryTransform xmlns:con6="http://www.bea.com/wli/sb/stages/config">
                                                                        <con6:resource ref="ITEL/Core/Resources/XQueries/ejecutarReglasNegocio_Res_consultarFaFList"/>
                                                                        <con6:param name="wS_Result2">
                                                                          <con6:path>$consultarFaFListResponse</con6:path>
                                                                        </con6:param>
                                                                        <con6:param name="wS_Result1">
                                                                          <con6:path>$consultarFAFTipoResponse</con6:path>
                                                                        </con6:param>
                                                                      </con6:xqueryTransform>
                                                                    </con1:expr>
                                                                  </con1:replace>
                                                                </con1:default>
                                                              </con1:ifThenElse>
                                                            </con3:responseTransform>
                                                          </con3:wsCallout>
                                                        </con3:actions>
                                                      </con3:case>
                                                      <con3:default/>
                                                    </con3:ifThenElse>
                                                    <con3:ifThenElse>
                                                      <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-79c3</con1:id>
                                                      <con3:case>
                                                        <con3:condition>
                                                          <con1:xqueryText>$codError = "1"</con1:xqueryText>
                                                        </con3:condition>
                                                        <con3:actions>
                                                          <con3:wsCallout>
                                                            <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-79bf</con1:id>
                                                            <con3:service xsi:type="ref:ProxyRef" ref="ITEL/Core/Proxies/consultarContractProviderTariffLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                                            <con3:operation>ConsultarContProvTar</con3:operation>
                                                            <con3:request>
                                                              <con3:body>$consultarContProvTarRequest</con3:body>
                                                            </con3:request>
                                                            <con3:response>
                                                              <con3:body>consultarContProvTarResponse</con3:body>
                                                            </con3:response>
                                                            <con3:requestTransform>
                                                              <con3:assign varName="consultarContProvTarRequest">
                                                                <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-79c2</con1:id>
                                                                <con3:expr>
                                                                  <con1:xqueryTransform>
                                                                    <con1:resource ref="ITEL/Core/Resources/XQueries/consultarContProvTarPS_Req"/>
                                                                    <con1:param name="serviceClass">
                                                                      <con1:path>data($suscriptorOCSResponse/MENSAJE/CONSULTAR_SUSCRIPTOR/*:suscriptor/*:PublicRatePlanCode)</con1:path>
                                                                    </con1:param>
                                                                    <con1:param name="fafIdGroup">
                                                                      <con1:path>data($suscriptorOCSResponse/MENSAJE/CONSULTAR_SUSCRIPTOR/*:suscriptor/*:AccountGroupID)</con1:path>
                                                                    </con1:param>
                                                                  </con1:xqueryTransform>
                                                                </con3:expr>
                                                              </con3:assign>
                                                            </con3:requestTransform>
                                                            <con3:responseTransform>
                                                              <con3:ifThenElse>
                                                                <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-79c1</con1:id>
                                                                <con3:case>
                                                                  <con3:condition>
                                                                    <con1:xqueryText>data($consultarContProvTarResponse/CODIGO) != 'OK'</con1:xqueryText>
                                                                  </con3:condition>
                                                                  <con3:actions>
                                                                    <con3:assign varName="codError">
                                                                      <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-79c0</con1:id>
                                                                      <con3:expr>
                                                                        <con1:xqueryText>"909"</con1:xqueryText>
                                                                      </con3:expr>
                                                                    </con3:assign>
                                                                  </con3:actions>
                                                                </con3:case>
                                                                <con3:default/>
                                                              </con3:ifThenElse>
                                                            </con3:responseTransform>
                                                          </con3:wsCallout>
                                                        </con3:actions>
                                                      </con3:case>
                                                      <con3:default/>
                                                    </con3:ifThenElse>
                                                  </con3:actions>
                                                </con3:case>
                                                <con3:case>
                                                  <con3:condition>
                                                    <con1:xqueryText>$metodo = '212' and (data($balancesResponse/CODIGO) = '1' or data($balancesResponse/CODIGO) = '959')</con1:xqueryText>
                                                  </con3:condition>
                                                  <con3:actions>
                                                    <con3:assign varName="balancesResponse9">
                                                      <con1:id>_ActionId-1436506239495519043-28043796.1575797a24f.-7637</con1:id>
                                                      <con3:expr>
                                                        <con1:xqueryText>""</con1:xqueryText>
                                                      </con3:expr>
                                                    </con3:assign>
                                                    <con3:wsCallout>
                                                      <con1:id>_ActionId-1436506239495519043-28043796.1575797a24f.-764f</con1:id>
                                                      <con3:service xsi:type="ref:ProxyRef" ref="ITEL/OCS/AIR/Proxies/consultarOfferOCSLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                                      <con3:operation>consultarOffer</con3:operation>
                                                      <con3:request>
                                                        <con3:body>$consultarOfferRequest</con3:body>
                                                      </con3:request>
                                                      <con3:response>
                                                        <con3:body>consultarOfferResponse</con3:body>
                                                      </con3:response>
                                                      <con3:requestTransform>
                                                        <con3:assign varName="consultarOfferRequest">
                                                          <con1:id>_ActionId-1436506239495519043-28043796.1575797a24f.-7652</con1:id>
                                                          <con3:expr>
                                                            <con1:xqueryTransform>
                                                              <con1:resource ref="ITEL/Core/Resources/XQueries/consultarOfferPaquetesPS_Req"/>
                                                              <con1:param name="min">
                                                                <con1:path>data($body/ejec:Input_Parameters/MIN_DESTINO)</con1:path>
                                                              </con1:param>
                                                              <con1:param name="offerFirst">
                                                                <con1:path>"1"</con1:path>
                                                              </con1:param>
                                                            </con1:xqueryTransform>
                                                          </con3:expr>
                                                        </con3:assign>
                                                      </con3:requestTransform>
                                                      <con3:responseTransform/>
                                                    </con3:wsCallout>
                                                    <con3:ifThenElse>
                                                      <con1:id>_ActionId-1436506239495519043-28043796.1575797a24f.-7587</con1:id>
                                                      <con3:case>
                                                        <con3:condition>
                                                          <con1:xqueryText>data($consultarOfferResponse/CODIGO) = '1'</con1:xqueryText>
                                                        </con3:condition>
                                                        <con3:actions>
                                                          <con3:wsCallout>
                                                            <con1:id>_ActionId-1436506239495519043-28043796.1575797a24f.-7531</con1:id>
                                                            <con3:service xsi:type="ref:ProxyRef" ref="ITEL/OCS/AIR/Proxies/consultarBalancesAllOCSLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                                            <con3:operation>consultarBalances</con3:operation>
                                                            <con3:request>
                                                              <con3:body>$balancesRequest</con3:body>
                                                            </con3:request>
                                                            <con3:response>
                                                              <con3:body>balancesResponse</con3:body>
                                                            </con3:response>
                                                            <con3:requestTransform>
                                                              <con3:assign varName="balancesRequest">
                                                                <con1:id>_ActionId-1436506239495519043-28043796.1575797a24f.-7532</con1:id>
                                                                <con3:expr>
                                                                  <con1:xqueryTransform>
                                                                    <con1:resource ref="ITEL/Core/Resources/XQueries/consultarBalancesPS_Req"/>
                                                                    <con1:param name="min">
                                                                      <con1:path>if($body/ejec:Input_Parameters/METODO = ('401','402')) then 
data($body/ejec:Input_Parameters/MIN_ORIGEN)
else
data($body/ejec:Input_Parameters/MIN_DESTINO)</con1:path>
                                                                    </con1:param>
                                                                  </con1:xqueryTransform>
                                                                </con3:expr>
                                                              </con3:assign>
                                                            </con3:requestTransform>
                                                            <con3:responseTransform>
                                                              <con3:insert varName="balancesResponse">
                                                                <con1:id>_ActionId-1436506239495519043-28043796.1575797a24f.-74c7</con1:id>
                                                                <con3:location>
                                                                  <con1:xpathText>./MENSAJE/CONSULTAR_BALANCES/MethodResponse/OfferInformationList</con1:xpathText>
                                                                </con3:location>
                                                                <con3:where>last-child</con3:where>
                                                                <con3:expr>
                                                                  <con1:xqueryText>$consultarOfferResponse//CONSULTAR_OFFER/offerInformationList/Detail</con1:xqueryText>
                                                                </con3:expr>
                                                              </con3:insert>
                                                            </con3:responseTransform>
                                                          </con3:wsCallout>
                                                          <con3:assign varName="balancesResponse1">
                                                            <con1:id>_ActionId-1436506239495519043-28043796.1575797a24f.-752f</con1:id>
                                                            <con3:expr>
                                                              <con1:xqueryText>""</con1:xqueryText>
                                                            </con3:expr>
                                                          </con3:assign>
                                                          <con3:wsCallout>
                                                            <con1:id>_ActionId-1436506239495519043-28043796.1575797a24f.-7527</con1:id>
                                                            <con3:service xsi:type="ref:ProxyRef" ref="ITEL/OCS/OLM/Proxies/consultarSuscripcionOCSLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                                            <con3:operation>consultarSuscripcionOCS</con3:operation>
                                                            <con3:request>
                                                              <con3:body>$consultarSuscripcionOCSRequest</con3:body>
                                                            </con3:request>
                                                            <con3:response>
                                                              <con3:body>consultarSuscripcionOCSResponse</con3:body>
                                                            </con3:response>
                                                            <con3:requestTransform>
                                                              <con3:assign varName="consultarSuscripcionOCSRequest">
                                                                <con1:id>_ActionId-1436506239495519043-28043796.1575797a24f.-752a</con1:id>
                                                                <con3:expr>
                                                                  <con1:xqueryTransform>
                                                                    <con1:resource ref="ITEL/Core/Resources/XQueries/consultarSuscripcionOCSPS_Req"/>
                                                                    <con1:param name="min">
                                                                      <con1:path>data($body/ejec:Input_Parameters/MIN_DESTINO)</con1:path>
                                                                    </con1:param>
                                                                  </con1:xqueryTransform>
                                                                </con3:expr>
                                                              </con3:assign>
                                                            </con3:requestTransform>
                                                            <con3:responseTransform>
                                                              <con3:replace contents-only="false" varName="balancesResponse">
                                                                <con1:id>_ActionId-1436506239495519043-28043796.1575797a24f.-7529</con1:id>
                                                                <con3:expr>
                                                                  <con1:xqueryTransform>
                                                                    <con1:resource ref="ITEL/Core/Resources/XQueries/adaptarFechaExpiracionBalancesAllOCS"/>
                                                                    <con1:param name="wS_Result1">
                                                                      <con1:path>$balancesResponse</con1:path>
                                                                    </con1:param>
                                                                    <con1:param name="cuentasDA">
                                                                      <con1:path>data($body/ejec:Input_Parameters/PARAMETROS_TRAMA/PARAMETRO[NOMBRE='CUENTASDA']/VALOR)</con1:path>
                                                                    </con1:param>
                                                                    <con1:param name="wS_Result2">
                                                                      <con1:path>$consultarSuscripcionOCSResponse</con1:path>
                                                                    </con1:param>
                                                                  </con1:xqueryTransform>
                                                                </con3:expr>
                                                              </con3:replace>
                                                              <con3:replace varName="balancesResponse1" contents-only="false">
                                                                <con1:id>_ActionId-1436506239495519043-28043796.1575797a24f.-7528</con1:id>
                                                                <con3:expr>
                                                                  <con1:xqueryTransform>
                                                                    <con1:resource ref="ITEL/Core/Resources/XQueries/adaptarFechaExpiracionBalancesOCS"/>
                                                                    <con1:param name="wS_Result2">
                                                                      <con1:path>$consultarSuscripcionOCSResponse</con1:path>
                                                                    </con1:param>
                                                                    <con1:param name="cuentasDA">
                                                                      <con1:path>data($body/ejec:Input_Parameters/PARAMETROS_TRAMA/PARAMETRO[NOMBRE='CUENTASDA']/VALOR)</con1:path>
                                                                    </con1:param>
                                                                    <con1:param name="wS_Result1">
                                                                      <con1:path>$balancesResponse</con1:path>
                                                                    </con1:param>
                                                                  </con1:xqueryTransform>
                                                                </con3:expr>
                                                              </con3:replace>
                                                            </con3:responseTransform>
                                                          </con3:wsCallout>
                                                          <con3:ifThenElse>
                                                            <con1:id>_ActionId-1436506239495519043-28043796.1575797a24f.-7521</con1:id>
                                                            <con3:case>
                                                              <con3:condition>
                                                                <con1:xqueryText>empty($balancesResponse//*:OfferInformationList/Detail)</con1:xqueryText>
                                                              </con3:condition>
                                                              <con3:actions>
                                                                <con3:assign varName="productosSM">
                                                                  <con1:id>_ActionId-1436506239495519043-28043796.1575797a24f.-7520</con1:id>
                                                                  <con3:expr>
                                                                    <con1:xqueryText>""</con1:xqueryText>
                                                                  </con3:expr>
                                                                </con3:assign>
                                                              </con3:actions>
                                                            </con3:case>
                                                            <con3:default>
                                                              <con3:wsCallout>
                                                                <con1:id>_ActionId-1436506239495519043-28043796.1575797a24f.-751e</con1:id>
                                                                <con3:service xsi:type="ref:BusinessServiceRef" ref="ITEL/SM/Business Services/consultaCatalogo_BS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                                                <con3:operation>subscriptionManager</con3:operation>
                                                                <con3:request>
                                                                  <con3:body>$subscriptionManager_Req</con3:body>
                                                                </con3:request>
                                                                <con3:response>
                                                                  <con3:body>productosSM</con3:body>
                                                                </con3:response>
                                                                <con3:requestTransform>
                                                                  <con3:assign varName="subscriptionManager_Req">
                                                                    <con1:id>_ActionId-1436506239495519043-28043796.1575797a24f.-751f</con1:id>
                                                                    <con3:expr>
                                                                      <con1:xqueryTransform>
                                                                        <con1:resource ref="ITEL/Core/Resources/XQueries/ejecutarReglasNegocio_Req_SM"/>
                                                                        <con1:param name="operacion">
                                                                          <con1:path>'products/retrieve'</con1:path>
                                                                        </con1:param>
                                                                        <con1:param name="consultaSM">
                                                                          <con1:path>'"findBy":"GROUP","parameter":[{"name":"group","value":"PG.Prepago.Datos"}]'</con1:path>
                                                                        </con1:param>
                                                                      </con1:xqueryTransform>
                                                                    </con3:expr>
                                                                  </con3:assign>
                                                                </con3:requestTransform>
                                                                <con3:responseTransform/>
                                                              </con3:wsCallout>
                                                              <con3:insert varName="reglasNegocioResponse">
                                                                <con1:id>_ActionId-1436506239495519043-28043796.1575797a24f.-751d</con1:id>
                                                                <con3:location>
                                                                  <con1:xpathText>./MENSAJE/PARAMETROS</con1:xpathText>
                                                                </con3:location>
                                                                <con3:where>last-child</con3:where>
                                                                <con3:expr>
                                                                  <con1:xqueryText><![CDATA[<PARAMETRO>
	<NOMBRE>CATALOGO_SM</NOMBRE>
	<TIPO>string</TIPO>
	<VALOR>{$productosSM}</VALOR>
</PARAMETRO>]]></con1:xqueryText>
                                                                </con3:expr>
                                                              </con3:insert>
                                                            </con3:default>
                                                          </con3:ifThenElse>
                                                        </con3:actions>
                                                      </con3:case>
                                                      <con3:default/>
                                                    </con3:ifThenElse>
                                                  </con3:actions>
                                                </con3:case>
                                                <con3:case>
                                                  <con3:condition>
                                                    <con1:xqueryText>$metodo = '207' and (data($balancesResponse/CODIGO) = '1' or data($balancesResponse/CODIGO) = '959')</con1:xqueryText>
                                                  </con3:condition>
                                                  <con3:actions>
                                                    <con3:wsCallout>
                                                      <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-79bb</con1:id>
                                                      <con3:service xsi:type="ref:ProxyRef" ref="ITEL/Core/Proxies/consultarContractProviderTariffLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                                      <con3:operation>ConsultarContProvTar</con3:operation>
                                                      <con3:request>
                                                        <con3:body>$consultarContProvTarRequest</con3:body>
                                                      </con3:request>
                                                      <con3:response>
                                                        <con3:body>consultarContProvTarResponse</con3:body>
                                                      </con3:response>
                                                      <con3:requestTransform>
                                                        <con3:assign varName="consultarContProvTarRequest">
                                                          <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-79be</con1:id>
                                                          <con3:expr>
                                                            <con1:xqueryTransform>
                                                              <con1:resource ref="ITEL/Core/Resources/XQueries/consultarContProvTarPS_Req"/>
                                                              <con1:param name="serviceClass">
                                                                <con1:path>data($suscriptorOCSResponse/MENSAJE/CONSULTAR_SUSCRIPTOR/*:suscriptor/*:PublicRatePlanCode)</con1:path>
                                                              </con1:param>
                                                              <con1:param name="fafIdGroup">
                                                                <con1:path>data($suscriptorOCSResponse/MENSAJE/CONSULTAR_SUSCRIPTOR/*:suscriptor/*:AccountGroupID)</con1:path>
                                                              </con1:param>
                                                            </con1:xqueryTransform>
                                                          </con3:expr>
                                                        </con3:assign>
                                                      </con3:requestTransform>
                                                      <con3:responseTransform>
                                                        <con3:ifThenElse>
                                                          <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-79bd</con1:id>
                                                          <con3:case>
                                                            <con3:condition>
                                                              <con1:xqueryText>data($consultarContProvTarResponse/CODIGO) != 'OK'</con1:xqueryText>
                                                            </con3:condition>
                                                            <con3:actions>
                                                              <con3:assign varName="codError">
                                                                <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-79bc</con1:id>
                                                                <con3:expr>
                                                                  <con1:xqueryText>"909"</con1:xqueryText>
                                                                </con3:expr>
                                                              </con3:assign>
                                                            </con3:actions>
                                                          </con3:case>
                                                          <con3:default/>
                                                        </con3:ifThenElse>
                                                      </con3:responseTransform>
                                                    </con3:wsCallout>
                                                  </con3:actions>
                                                </con3:case>
                                                <con3:case>
                                                  <con3:condition>
                                                    <con1:xqueryText>$metodo = '600' and (data($balancesResponse/CODIGO) = '1' or data($balancesResponse/CODIGO) = '959')</con1:xqueryText>
                                                  </con3:condition>
                                                  <con3:actions>
                                                    <con3:ifThenElse>
                                                      <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-79ba</con1:id>
                                                      <con3:case>
                                                        <con3:condition>
                                                          <con1:xqueryText>number($body/ejec:Input_Parameters/IN_ORIGEN) &lt; 50</con1:xqueryText>
                                                        </con3:condition>
                                                        <con3:actions>
                                                          <con3:wsCallout>
                                                            <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-79b4</con1:id>
                                                            <con3:service xsi:type="ref:ProxyRef" ref="ITEL/Core/Proxies/consultarDatosMinesLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                                            <con3:operation>consultarDatosMines</con3:operation>
                                                            <con3:request>
                                                              <con3:body>$datos</con3:body>
                                                            </con3:request>
                                                            <con3:response>
                                                              <con3:body>respMines</con3:body>
                                                            </con3:response>
                                                            <con3:requestTransform>
                                                              <con3:assign varName="datos">
                                                                <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-79b9</con1:id>
                                                                <con3:expr>
                                                                  <con1:xqueryTransform>
                                                                    <con1:resource ref="ITEL/Core/Resources/XQueries/ejecutarReglasNegocio_Req_consultarDatosMines"/>
                                                                    <con1:param name="inOrigen">
                                                                      <con1:path>if($inOrigen!= "" and number($inOrigen) &lt; 50) then
$inOrigen
else ""</con1:path>
                                                                    </con1:param>
                                                                    <con1:param name="timeout">
                                                                      <con1:path>$timeout</con1:path>
                                                                    </con1:param>
                                                                    <con1:param name="minOrigen">
                                                                      <con1:path>if($inOrigen!= "" and number($inOrigen) &lt; 50) then
$minOrigen
else ""</con1:path>
                                                                    </con1:param>
                                                                    <con1:param name="minDestino">
                                                                      <con1:path>if(number($body/ejec:Input_Parameters/IN_DESTINO) &lt; 50) then
data($body/ejec:Input_Parameters/MIN_DESTINO)
else ""</con1:path>
                                                                    </con1:param>
                                                                    <con1:param name="prefijo">
                                                                      <con1:path>$prefijo</con1:path>
                                                                    </con1:param>
                                                                    <con1:param name="inDestino">
                                                                      <con1:path>if(number($body/ejec:Input_Parameters/IN_DESTINO) &lt; 50) then
data($body/ejec:Input_Parameters/IN_DESTINO)
else ""</con1:path>
                                                                    </con1:param>
                                                                  </con1:xqueryTransform>
                                                                </con3:expr>
                                                              </con3:assign>
                                                            </con3:requestTransform>
                                                            <con3:responseTransform>
                                                              <con3:ifThenElse>
                                                                <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-79b8</con1:id>
                                                                <con3:case>
                                                                  <con3:condition>
                                                                    <con1:xqueryText>$respMines/CODIGO/text() = "1"</con1:xqueryText>
                                                                  </con3:condition>
                                                                  <con3:actions>
                                                                    <con3:assign varName="codError">
                                                                      <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-79b7</con1:id>
                                                                      <con3:expr>
                                                                        <con1:xqueryText>"922"</con1:xqueryText>
                                                                      </con3:expr>
                                                                    </con3:assign>
                                                                  </con3:actions>
                                                                </con3:case>
                                                                <con3:case>
                                                                  <con3:condition>
                                                                    <con1:xqueryText>$respMines/CODIGO/text() = '900'</con1:xqueryText>
                                                                  </con3:condition>
                                                                  <con3:actions>
                                                                    <con3:assign varName="codError">
                                                                      <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-79b6</con1:id>
                                                                      <con3:expr>
                                                                        <con1:xqueryText>"1"</con1:xqueryText>
                                                                      </con3:expr>
                                                                    </con3:assign>
                                                                  </con3:actions>
                                                                </con3:case>
                                                                <con3:default>
                                                                  <con3:assign varName="codError">
                                                                    <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-79b5</con1:id>
                                                                    <con3:expr>
                                                                      <con1:xqueryText>$respMines/CODIGO/text()</con1:xqueryText>
                                                                    </con3:expr>
                                                                  </con3:assign>
                                                                </con3:default>
                                                              </con3:ifThenElse>
                                                            </con3:responseTransform>
                                                          </con3:wsCallout>
                                                        </con3:actions>
                                                      </con3:case>
                                                      <con3:default>
                                                        <con3:wsCallout>
                                                          <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-79ae</con1:id>
                                                          <con3:service xsi:type="ref:ProxyRef" ref="ITEL/OCS/SOI/Proxies/consultarSuscriptorOCSLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                                          <con3:operation>consultarSuscriptorOCS</con3:operation>
                                                          <con3:request>
                                                            <con3:body>$suscriptorOrigenOCSRequest</con3:body>
                                                          </con3:request>
                                                          <con3:response>
                                                            <con3:body>suscriptorOrigenOCSResponse</con3:body>
                                                          </con3:response>
                                                          <con3:requestTransform>
                                                            <con3:assign varName="suscriptorOrigenOCSRequest">
                                                              <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-79b3</con1:id>
                                                              <con3:expr>
                                                                <con1:xqueryTransform>
                                                                  <con1:resource ref="ITEL/Core/Resources/XQueries/consultarSuscriptorOCSPS_Req"/>
                                                                  <con1:param name="timeout">
                                                                    <con1:path>2000</con1:path>
                                                                  </con1:param>
                                                                  <con1:param name="min">
                                                                    <con1:path>data($body/ejec:Input_Parameters/MIN_ORIGEN)</con1:path>
                                                                  </con1:param>
                                                                  <con1:param name="in">
                                                                    <con1:path>data($body/ejec:Input_Parameters/IN_ORIGEN)</con1:path>
                                                                  </con1:param>
                                                                </con1:xqueryTransform>
                                                              </con3:expr>
                                                            </con3:assign>
                                                          </con3:requestTransform>
                                                          <con3:responseTransform>
                                                            <con3:ifThenElse>
                                                              <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-79b2</con1:id>
                                                              <con3:case>
                                                                <con3:condition>
                                                                  <con1:xqueryText>data($suscriptorOrigenOCSResponse/CODIGO)= '1'</con1:xqueryText>
                                                                </con3:condition>
                                                                <con3:actions>
                                                                  <con3:assign varName="codError">
                                                                    <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-79b1</con1:id>
                                                                    <con3:expr>
                                                                      <con1:xqueryText>"922"</con1:xqueryText>
                                                                    </con3:expr>
                                                                  </con3:assign>
                                                                </con3:actions>
                                                              </con3:case>
                                                              <con3:case>
                                                                <con3:condition>
                                                                  <con1:xqueryText>data($suscriptorOrigenOCSResponse/CODIGO)= '900'</con1:xqueryText>
                                                                </con3:condition>
                                                                <con3:actions>
                                                                  <con3:assign varName="codError">
                                                                    <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-79b0</con1:id>
                                                                    <con3:expr>
                                                                      <con1:xqueryText>"1"</con1:xqueryText>
                                                                    </con3:expr>
                                                                  </con3:assign>
                                                                </con3:actions>
                                                              </con3:case>
                                                              <con3:default>
                                                                <con3:assign varName="codError">
                                                                  <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-79af</con1:id>
                                                                  <con3:expr>
                                                                    <con1:xqueryText>data($suscriptorOCSResponse/CODIGO)</con1:xqueryText>
                                                                  </con3:expr>
                                                                </con3:assign>
                                                              </con3:default>
                                                            </con3:ifThenElse>
                                                          </con3:responseTransform>
                                                        </con3:wsCallout>
                                                      </con3:default>
                                                    </con3:ifThenElse>
                                                    <con3:ifThenElse>
                                                      <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-79ad</con1:id>
                                                      <con3:case>
                                                        <con3:condition>
                                                          <con1:xqueryText>$codError = '1'</con1:xqueryText>
                                                        </con3:condition>
                                                        <con3:actions>
                                                          <con1:wsCallout xmlns:con3="http://www.bea.com/wli/sb/typesystem/config" xmlns:con2="http://www.bea.com/wli/sb/stages/config" xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
                                                            <con6:id xmlns:con6="http://www.bea.com/wli/sb/stages/config">_ActionId-8096952212429106120-1bbaa577.15405e544f1.-79a9</con6:id>
                                                            <con1:service xsi:type="ref:ProxyRef" ref="ITEL/OCS/AIR/Proxies/consultarFaFListOCSLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                                            <con1:operation>consultarFaFList</con1:operation>
                                                            <con1:request>
                                                              <con1:body>$consultarFaFListRequest</con1:body>
                                                            </con1:request>
                                                            <con1:response>
                                                              <con1:body>consultarFaFListResponse</con1:body>
                                                            </con1:response>
                                                            <con1:requestTransform>
                                                              <con1:assign varName="consultarFaFListRequest">
                                                                <con6:id xmlns:con6="http://www.bea.com/wli/sb/stages/config">_ActionId-8096952212429106120-1bbaa577.15405e544f1.-79ac</con6:id>
                                                                <con1:expr>
                                                                  <con6:xqueryTransform xmlns:con6="http://www.bea.com/wli/sb/stages/config">
                                                                    <con6:resource ref="ITEL/Core/Resources/XQueries/consultarFaFListPS_Req"/>
                                                                    <con6:param name="min">
                                                                      <con6:path>data($body/ejec:Input_Parameters/MIN_DESTINO)</con6:path>
                                                                    </con6:param>
                                                                  </con6:xqueryTransform>
                                                                </con1:expr>
                                                              </con1:assign>
                                                            </con1:requestTransform>
                                                            <con1:responseTransform>
                                                              <con1:ifThenElse>
                                                                <con6:id xmlns:con6="http://www.bea.com/wli/sb/stages/config">_ActionId-8096952212429106120-1bbaa577.15405e544f1.-79ab</con6:id>
                                                                <con1:case>
                                                                  <con1:condition>
                                                                    <con6:xqueryText xmlns:con6="http://www.bea.com/wli/sb/stages/config">data($consultarFaFListResponse/CODIGO) != '1'</con6:xqueryText>
                                                                  </con1:condition>
                                                                  <con1:actions>
                                                                    <con6:assign varName="codError" xmlns:con3="http://www.bea.com/wli/sb/stages/transform/config" xmlns:con2="http://www.bea.com/wli/sb/typesystem/config" xmlns:con1="http://www.bea.com/wli/sb/stages/config" xmlns:con6="http://www.bea.com/wli/sb/stages/transform/config">
                                                                      <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-79aa</con1:id>
                                                                      <con6:expr>
                                                                        <con1:xqueryText>data($consultarFaFListResponse/CODIGO)</con1:xqueryText>
                                                                      </con6:expr>
                                                                    </con6:assign>
                                                                  </con1:actions>
                                                                </con1:case>
                                                                <con1:default/>
                                                              </con1:ifThenElse>
                                                            </con1:responseTransform>
                                                          </con1:wsCallout>
                                                        </con3:actions>
                                                      </con3:case>
                                                      <con3:default/>
                                                    </con3:ifThenElse>
                                                    <con3:ifThenElse>
                                                      <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-79a8</con1:id>
                                                      <con3:case>
                                                        <con3:condition>
                                                          <con1:xqueryText>$codError = "1" and 
fn:exists($consultarFaFListResponse/MENSAJE/CONSULTAR_FAFLIST/fafInformationList/Detail/fafIndicator)</con1:xqueryText>
                                                        </con3:condition>
                                                        <con3:actions>
                                                          <con3:wsCallout>
                                                            <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-79a4</con1:id>
                                                            <con3:service xsi:type="ref:ProxyRef" ref="ITEL/Core/Proxies/consultarFAFTipoLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                                            <con3:operation>consultarFAFTipo</con3:operation>
                                                            <con3:request>
                                                              <con3:body>$consultarFAFTipoRequest</con3:body>
                                                            </con3:request>
                                                            <con3:response>
                                                              <con3:body>consultarFAFTipoResponse</con3:body>
                                                            </con3:response>
                                                            <con3:requestTransform>
                                                              <con3:assign varName="consultarFAFTipoRequest">
                                                                <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-79a7</con1:id>
                                                                <con3:expr>
                                                                  <con1:xqueryTransform>
                                                                    <con1:resource ref="ITEL/Core/Resources/XQueries/consultarFAFTipoPS_Req"/>
                                                                    <con1:param name="wS_Result1">
                                                                      <con1:path>$consultarFaFListResponse</con1:path>
                                                                    </con1:param>
                                                                  </con1:xqueryTransform>
                                                                </con3:expr>
                                                              </con3:assign>
                                                            </con3:requestTransform>
                                                            <con3:responseTransform>
                                                              <con1:ifThenElse xmlns:con3="http://www.bea.com/wli/sb/typesystem/config" xmlns:con2="http://www.bea.com/wli/sb/stages/config" xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
                                                                <con6:id xmlns:con6="http://www.bea.com/wli/sb/stages/config">_ActionId-8096952212429106120-1bbaa577.15405e544f1.-79a6</con6:id>
                                                                <con1:case>
                                                                  <con1:condition>
                                                                    <con6:xqueryText xmlns:con6="http://www.bea.com/wli/sb/stages/config">data($consultarFAFTipoResponse/CODIGO) != 'OK'</con6:xqueryText>
                                                                  </con1:condition>
                                                                  <con1:actions>
                                                                    <con6:assign varName="codError" xmlns:con3="http://www.bea.com/wli/sb/stages/transform/config" xmlns:con2="http://www.bea.com/wli/sb/typesystem/config" xmlns:con1="http://www.bea.com/wli/sb/stages/config" xmlns:con6="http://www.bea.com/wli/sb/stages/transform/config">
                                                                      <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-79a5</con1:id>
                                                                      <con6:expr>
                                                                        <con1:xqueryText>"909"</con1:xqueryText>
                                                                      </con6:expr>
                                                                    </con6:assign>
                                                                  </con1:actions>
                                                                </con1:case>
                                                                <con1:default/>
                                                              </con1:ifThenElse>
                                                            </con3:responseTransform>
                                                          </con3:wsCallout>
                                                        </con3:actions>
                                                      </con3:case>
                                                      <con3:default/>
                                                    </con3:ifThenElse>
                                                    <con3:ifThenElse>
                                                      <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-79a3</con1:id>
                                                      <con3:case>
                                                        <con3:condition>
                                                          <con1:xqueryText>$codError = "1"</con1:xqueryText>
                                                        </con3:condition>
                                                        <con3:actions>
                                                          <con3:wsCallout>
                                                            <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-799b</con1:id>
                                                            <con3:service xsi:type="ref:ProxyRef" ref="ITEL/Core/Proxies/consultarContractTemp_ContractLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                                            <con3:operation>consultarContractTemp_Contract</con3:operation>
                                                            <con3:request>
                                                              <con3:body>$consultarContractTempContractRequest</con3:body>
                                                            </con3:request>
                                                            <con3:response>
                                                              <con3:body>consultarContractTempContractResponse</con3:body>
                                                            </con3:response>
                                                            <con3:requestTransform>
                                                              <con3:assign varName="consultarContractTempContractRequest">
                                                                <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-79a2</con1:id>
                                                                <con3:expr>
                                                                  <con1:xqueryTransform>
                                                                    <con1:resource ref="ITEL/Core/Resources/XQueries/consultarContractTempContractPS_Req"/>
                                                                    <con1:param name="serviceClass">
                                                                      <con1:path>data($suscriptorOCSResponse/MENSAJE/CONSULTAR_SUSCRIPTOR/*:suscriptor/*:PublicRatePlanCode)</con1:path>
                                                                    </con1:param>
                                                                    <con1:param name="contract">
                                                                      <con1:path>""</con1:path>
                                                                    </con1:param>
                                                                    <con1:param name="fafidgroup">
                                                                      <con1:path>data($suscriptorOCSResponse/MENSAJE/CONSULTAR_SUSCRIPTOR/*:suscriptor/*:AccountGroupID)</con1:path>
                                                                    </con1:param>
                                                                  </con1:xqueryTransform>
                                                                </con3:expr>
                                                              </con3:assign>
                                                            </con3:requestTransform>
                                                            <con3:responseTransform>
                                                              <con3:ifThenElse>
                                                                <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-79a1</con1:id>
                                                                <con3:case>
                                                                  <con3:condition>
                                                                    <con1:xqueryText>data($consultarContractTempContractResponse/CODIGO) = "OK"</con1:xqueryText>
                                                                  </con3:condition>
                                                                  <con3:actions>
                                                                    <con3:insert varName="suscriptorOCSResponse">
                                                                      <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-79a0</con1:id>
                                                                      <con3:location>
                                                                        <con1:xpathText>./MENSAJE/CONSULTAR_SUSCRIPTOR/*:suscriptor</con1:xpathText>
                                                                      </con3:location>
                                                                      <con3:where>last-child</con3:where>
                                                                      <con3:expr>
                                                                        <con1:xqueryText>&lt;CONTRACT_TEMPLATE>{data($consultarContractTempContractResponse/MENSAJE/CONTRACT_TEMPLATE)}&lt;/CONTRACT_TEMPLATE></con1:xqueryText>
                                                                      </con3:expr>
                                                                    </con3:insert>
                                                                    <con3:insert varName="suscriptorOCSResponse">
                                                                      <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-799f</con1:id>
                                                                      <con3:location>
                                                                        <con1:xpathText>./MENSAJE/CONSULTAR_SUSCRIPTOR/*:suscriptor</con1:xpathText>
                                                                      </con3:location>
                                                                      <con3:where>last-child</con3:where>
                                                                      <con3:expr>
                                                                        <con1:xqueryText>&lt;CONTRACT>{data($consultarContractTempContractResponse/MENSAJE/CONTRACT)}&lt;/CONTRACT></con1:xqueryText>
                                                                      </con3:expr>
                                                                    </con3:insert>
                                                                    <con3:insert varName="suscriptorOCSResponse">
                                                                      <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-799e</con1:id>
                                                                      <con3:location>
                                                                        <con1:xpathText>./MENSAJE/CONSULTAR_SUSCRIPTOR/*:suscriptor</con1:xpathText>
                                                                      </con3:location>
                                                                      <con3:where>last-child</con3:where>
                                                                      <con3:expr>
                                                                        <con1:xqueryText>&lt;FAFIDGROUP>{data($consultarContractTempContractResponse/MENSAJE/FAFIDGROUP)}&lt;/FAFIDGROUP></con1:xqueryText>
                                                                      </con3:expr>
                                                                    </con3:insert>
                                                                    <con3:insert varName="suscriptorOCSResponse">
                                                                      <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-799d</con1:id>
                                                                      <con3:location>
                                                                        <con1:xpathText>./MENSAJE/CONSULTAR_SUSCRIPTOR/*:suscriptor</con1:xpathText>
                                                                      </con3:location>
                                                                      <con3:where>last-child</con3:where>
                                                                      <con3:expr>
                                                                        <con1:xqueryText>&lt;FAFIDS>{fn:string-join(data($consultarContractTempContractResponse/MENSAJE/FAFIDS/FAFID),";")}&lt;/FAFIDS></con1:xqueryText>
                                                                      </con3:expr>
                                                                    </con3:insert>
                                                                  </con3:actions>
                                                                </con3:case>
                                                                <con3:default>
                                                                  <con3:assign varName="codError">
                                                                    <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-799c</con1:id>
                                                                    <con3:expr>
                                                                      <con1:xqueryText>"909"</con1:xqueryText>
                                                                    </con3:expr>
                                                                  </con3:assign>
                                                                </con3:default>
                                                              </con3:ifThenElse>
                                                            </con3:responseTransform>
                                                          </con3:wsCallout>
                                                        </con3:actions>
                                                      </con3:case>
                                                      <con3:default/>
                                                    </con3:ifThenElse>
                                                    <con3:ifThenElse>
                                                      <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-799a</con1:id>
                                                      <con3:case>
                                                        <con3:condition>
                                                          <con1:xqueryText>$metodo = '600' and $codError = '1'</con1:xqueryText>
                                                        </con3:condition>
                                                        <con3:actions>
                                                          <con3:wsCallout>
                                                            <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-7993</con1:id>
                                                            <con3:service xsi:type="ref:ProxyRef" ref="ITEL/OCS/OLM/Proxies/consultarSuscripcionOCSLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                                            <con3:operation>consultarSuscripcionOCS</con3:operation>
                                                            <con3:request>
                                                              <con3:body>$consultarSuscripcionOCSRequest</con3:body>
                                                            </con3:request>
                                                            <con3:response>
                                                              <con3:body>consultarSuscripcionOCSResponse</con3:body>
                                                            </con3:response>
                                                            <con3:requestTransform>
                                                              <con3:assign varName="consultarSuscripcionOCSRequest">
                                                                <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-7999</con1:id>
                                                                <con3:expr>
                                                                  <con1:xqueryTransform>
                                                                    <con1:resource ref="ITEL/Core/Resources/XQueries/consultarSuscripcionOCSPS_Req"/>
                                                                    <con1:param name="min">
                                                                      <con1:path>data($body/ejec:Input_Parameters/MIN_DESTINO)</con1:path>
                                                                    </con1:param>
                                                                  </con1:xqueryTransform>
                                                                </con3:expr>
                                                              </con3:assign>
                                                            </con3:requestTransform>
                                                            <con3:responseTransform>
                                                              <con3:ifThenElse>
                                                                <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-7998</con1:id>
                                                                <con3:case>
                                                                  <con3:condition>
                                                                    <con1:xqueryText>data($consultarSuscripcionOCSResponse/CODIGO) != '1' and  data($consultarSuscripcionOCSResponse/CODIGO) != '900'</con1:xqueryText>
                                                                  </con3:condition>
                                                                  <con3:actions>
                                                                    <con3:assign varName="codError">
                                                                      <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-7997</con1:id>
                                                                      <con3:expr>
                                                                        <con1:xqueryText>"901"</con1:xqueryText>
                                                                      </con3:expr>
                                                                    </con3:assign>
                                                                  </con3:actions>
                                                                </con3:case>
                                                                <con3:default>
                                                                  <con1:ifThenElse xmlns:con3="http://www.bea.com/wli/sb/typesystem/config" xmlns:con2="http://www.bea.com/wli/sb/stages/config" xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
                                                                    <con6:id xmlns:con6="http://www.bea.com/wli/sb/stages/config">_ActionId-8096952212429106120-1bbaa577.15405e544f1.-7996</con6:id>
                                                                    <con1:case>
                                                                      <con1:condition>
                                                                        <con6:xqueryText xmlns:con6="http://www.bea.com/wli/sb/stages/config">number($body/ejec:Input_Parameters/IN_ORIGEN) &lt; 50</con6:xqueryText>
                                                                      </con1:condition>
                                                                      <con1:actions>
                                                                        <con1:replace varName="consultarFaFListResponse" contents-only="false">
                                                                          <con6:id xmlns:con6="http://www.bea.com/wli/sb/stages/config">_ActionId-8096952212429106120-1bbaa577.15405e544f1.-7995</con6:id>
                                                                          <con1:expr>
                                                                            <con6:xqueryTransform xmlns:con6="http://www.bea.com/wli/sb/stages/config">
                                                                              <con6:resource ref="ITEL/Core/Resources/XQueries/ejecutarReglasNegocio_Res_consultarFaFList_700"/>
                                                                              <con6:param name="wS_Result3">
                                                                                <con6:path>$consultarSuscripcionOCSResponse</con6:path>
                                                                              </con6:param>
                                                                              <con6:param name="wS_Result2">
                                                                                <con6:path>$consultarFaFListResponse</con6:path>
                                                                              </con6:param>
                                                                              <con6:param name="wS_Result1">
                                                                                <con6:path>$consultarFAFTipoResponse</con6:path>
                                                                              </con6:param>
                                                                            </con6:xqueryTransform>
                                                                          </con1:expr>
                                                                        </con1:replace>
                                                                      </con1:actions>
                                                                    </con1:case>
                                                                    <con1:default>
                                                                      <con1:replace varName="consultarFaFListResponse" contents-only="false">
                                                                        <con6:id xmlns:con6="http://www.bea.com/wli/sb/stages/config">_ActionId-8096952212429106120-1bbaa577.15405e544f1.-7994</con6:id>
                                                                        <con1:expr>
                                                                          <con6:xqueryTransform xmlns:con6="http://www.bea.com/wli/sb/stages/config">
                                                                            <con6:resource ref="ITEL/Core/Resources/XQueries/ejecutarReglasNegocio_Res_consultarFaFList_600"/>
                                                                            <con6:param name="wS_Result3">
                                                                              <con6:path>$consultarSuscripcionOCSResponse</con6:path>
                                                                            </con6:param>
                                                                            <con6:param name="wS_Result2">
                                                                              <con6:path>$consultarFaFListResponse</con6:path>
                                                                            </con6:param>
                                                                            <con6:param name="wS_Result1">
                                                                              <con6:path>$consultarFAFTipoResponse</con6:path>
                                                                            </con6:param>
                                                                          </con6:xqueryTransform>
                                                                        </con1:expr>
                                                                      </con1:replace>
                                                                    </con1:default>
                                                                  </con1:ifThenElse>
                                                                </con3:default>
                                                              </con3:ifThenElse>
                                                            </con3:responseTransform>
                                                          </con3:wsCallout>
                                                        </con3:actions>
                                                      </con3:case>
                                                      <con3:default/>
                                                    </con3:ifThenElse>
                                                  </con3:actions>
                                                </con3:case>
                                                <con3:case>
                                                  <con3:condition>
                                                    <con1:xqueryText>$metodo = '601' or $metodo = '604' and (data($balancesResponse/CODIGO) = '1' or data($balancesResponse/CODIGO) = '959')</con1:xqueryText>
                                                  </con3:condition>
                                                  <con3:actions>
                                                    <con1:wsCallout xmlns:con3="http://www.bea.com/wli/sb/typesystem/config" xmlns:con2="http://www.bea.com/wli/sb/stages/config" xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
                                                      <con6:id xmlns:con6="http://www.bea.com/wli/sb/stages/config">_ActionId-8096952212429106120-1bbaa577.15405e544f1.-798f</con6:id>
                                                      <con1:service xsi:type="ref:ProxyRef" ref="ITEL/OCS/AIR/Proxies/consultarFaFListOCSLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                                      <con1:operation>consultarFaFList</con1:operation>
                                                      <con1:request>
                                                        <con1:body>$consultarFaFListRequest</con1:body>
                                                      </con1:request>
                                                      <con1:response>
                                                        <con1:body>consultarFaFListResponse</con1:body>
                                                      </con1:response>
                                                      <con1:requestTransform>
                                                        <con1:assign varName="consultarFaFListRequest">
                                                          <con6:id xmlns:con6="http://www.bea.com/wli/sb/stages/config">_ActionId-8096952212429106120-1bbaa577.15405e544f1.-7992</con6:id>
                                                          <con1:expr>
                                                            <con6:xqueryTransform xmlns:con6="http://www.bea.com/wli/sb/stages/config">
                                                              <con6:resource ref="ITEL/Core/Resources/XQueries/consultarFaFListPS_Req"/>
                                                              <con6:param name="min">
                                                                <con6:path>data($body/ejec:Input_Parameters/MIN_DESTINO)</con6:path>
                                                              </con6:param>
                                                            </con6:xqueryTransform>
                                                          </con1:expr>
                                                        </con1:assign>
                                                      </con1:requestTransform>
                                                      <con1:responseTransform>
                                                        <con1:ifThenElse>
                                                          <con6:id xmlns:con6="http://www.bea.com/wli/sb/stages/config">_ActionId-8096952212429106120-1bbaa577.15405e544f1.-7991</con6:id>
                                                          <con1:case>
                                                            <con1:condition>
                                                              <con6:xqueryText xmlns:con6="http://www.bea.com/wli/sb/stages/config">data($consultarFaFListResponse/CODIGO) != '1'</con6:xqueryText>
                                                            </con1:condition>
                                                            <con1:actions>
                                                              <con6:assign varName="codError" xmlns:con3="http://www.bea.com/wli/sb/stages/transform/config" xmlns:con2="http://www.bea.com/wli/sb/typesystem/config" xmlns:con1="http://www.bea.com/wli/sb/stages/config" xmlns:con6="http://www.bea.com/wli/sb/stages/transform/config">
                                                                <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-7990</con1:id>
                                                                <con6:expr>
                                                                  <con1:xqueryText>data($consultarFaFListResponse/CODIGO)</con1:xqueryText>
                                                                </con6:expr>
                                                              </con6:assign>
                                                            </con1:actions>
                                                          </con1:case>
                                                          <con1:default/>
                                                        </con1:ifThenElse>
                                                      </con1:responseTransform>
                                                    </con1:wsCallout>
                                                    <con3:ifThenElse>
                                                      <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-798e</con1:id>
                                                      <con3:case>
                                                        <con3:condition>
                                                          <con1:xqueryText>$codError = "1" and 
fn:exists($consultarFaFListResponse/MENSAJE/CONSULTAR_FAFLIST/fafInformationList/Detail/fafIndicator)</con1:xqueryText>
                                                        </con3:condition>
                                                        <con3:actions>
                                                          <con3:wsCallout>
                                                            <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-7989</con1:id>
                                                            <con3:service xsi:type="ref:ProxyRef" ref="ITEL/Core/Proxies/consultarFAFTipoLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                                            <con3:operation>consultarFAFTipo</con3:operation>
                                                            <con3:request>
                                                              <con3:body>$consultarFAFTipoRequest</con3:body>
                                                            </con3:request>
                                                            <con3:response>
                                                              <con3:body>consultarFAFTipoResponse</con3:body>
                                                            </con3:response>
                                                            <con3:requestTransform>
                                                              <con3:assign varName="consultarFAFTipoRequest">
                                                                <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-798d</con1:id>
                                                                <con3:expr>
                                                                  <con1:xqueryTransform>
                                                                    <con1:resource ref="ITEL/Core/Resources/XQueries/consultarFAFTipoPS_Req"/>
                                                                    <con1:param name="wS_Result1">
                                                                      <con1:path>$consultarFaFListResponse</con1:path>
                                                                    </con1:param>
                                                                  </con1:xqueryTransform>
                                                                </con3:expr>
                                                              </con3:assign>
                                                            </con3:requestTransform>
                                                            <con3:responseTransform>
                                                              <con1:ifThenElse xmlns:con3="http://www.bea.com/wli/sb/typesystem/config" xmlns:con2="http://www.bea.com/wli/sb/stages/config" xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
                                                                <con6:id xmlns:con6="http://www.bea.com/wli/sb/stages/config">_ActionId-8096952212429106120-1bbaa577.15405e544f1.-798c</con6:id>
                                                                <con1:case>
                                                                  <con1:condition>
                                                                    <con6:xqueryText xmlns:con6="http://www.bea.com/wli/sb/stages/config">data($consultarFAFTipoResponse/CODIGO) != 'OK'</con6:xqueryText>
                                                                  </con1:condition>
                                                                  <con1:actions>
                                                                    <con6:assign varName="codError" xmlns:con3="http://www.bea.com/wli/sb/stages/transform/config" xmlns:con2="http://www.bea.com/wli/sb/typesystem/config" xmlns:con1="http://www.bea.com/wli/sb/stages/config" xmlns:con6="http://www.bea.com/wli/sb/stages/transform/config">
                                                                      <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-798b</con1:id>
                                                                      <con6:expr>
                                                                        <con1:xqueryText>"909"</con1:xqueryText>
                                                                      </con6:expr>
                                                                    </con6:assign>
                                                                  </con1:actions>
                                                                </con1:case>
                                                                <con1:default>
                                                                  <con1:replace varName="consultarFaFListResponse" contents-only="false">
                                                                    <con6:id xmlns:con6="http://www.bea.com/wli/sb/stages/config">_ActionId-8096952212429106120-1bbaa577.15405e544f1.-798a</con6:id>
                                                                    <con1:expr>
                                                                      <con6:xqueryTransform xmlns:con6="http://www.bea.com/wli/sb/stages/config">
                                                                        <con6:resource ref="ITEL/Core/Resources/XQueries/ejecutarReglasNegocio_Res_consultarFaFList"/>
                                                                        <con6:param name="wS_Result2">
                                                                          <con6:path>$consultarFaFListResponse</con6:path>
                                                                        </con6:param>
                                                                        <con6:param name="wS_Result1">
                                                                          <con6:path>$consultarFAFTipoResponse</con6:path>
                                                                        </con6:param>
                                                                      </con6:xqueryTransform>
                                                                    </con1:expr>
                                                                  </con1:replace>
                                                                </con1:default>
                                                              </con1:ifThenElse>
                                                            </con3:responseTransform>
                                                          </con3:wsCallout>
                                                        </con3:actions>
                                                      </con3:case>
                                                      <con3:default/>
                                                    </con3:ifThenElse>
                                                    <con3:ifThenElse>
                                                      <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-7988</con1:id>
                                                      <con3:case>
                                                        <con3:condition>
                                                          <con1:xqueryText>$codError = "1"</con1:xqueryText>
                                                        </con3:condition>
                                                        <con3:actions>
                                                          <con3:wsCallout>
                                                            <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-7986</con1:id>
                                                            <con3:service xsi:type="ref:ProxyRef" ref="ITEL/Core/Proxies/consultarContratoEsPostpagoLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                                            <con3:operation>consultarContratoEsPostpago</con3:operation>
                                                            <con3:request>
                                                              <con3:body>$consultarContratoEsPospagoRequest</con3:body>
                                                            </con3:request>
                                                            <con3:response>
                                                              <con3:body>consultarContratoEsPospagoResponse</con3:body>
                                                            </con3:response>
                                                            <con3:requestTransform>
                                                              <con3:assign varName="consultarContratoEsPospagoRequest">
                                                                <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-7987</con1:id>
                                                                <con3:expr>
                                                                  <con1:xqueryText>&lt;con:Input_Parameters xmlns:con="http://www.comcel.com.co/ConsultarContractEsPostPago">
    &lt;con:CONTRACT>{ data($suscriptorOCSResponse/MENSAJE/CONSULTAR_SUSCRIPTOR/*:suscriptor/*:PublicRatePlanCode) }&lt;/con:CONTRACT>
&lt;/con:Input_Parameters></con1:xqueryText>
                                                                </con3:expr>
                                                              </con3:assign>
                                                            </con3:requestTransform>
                                                            <con3:responseTransform/>
                                                          </con3:wsCallout>
                                                          <con3:insert varName="reglasNegocioResponse">
                                                            <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-7985</con1:id>
                                                            <con3:location>
                                                              <con1:xpathText>./*:MENSAJE/*:PARAMETROS</con1:xpathText>
                                                            </con3:location>
                                                            <con3:where>last-child</con3:where>
                                                            <con3:expr>
                                                              <con1:xqueryText><![CDATA[<PARAMETRO>
	<NOMBRE>ESPOSTPAGO</NOMBRE>
	<TIPO>string</TIPO>
	<VALOR>{ data($consultarContratoEsPospagoResponse/*:MENSAJE/*:ESPOSTPAGO) }</VALOR>
</PARAMETRO>]]></con1:xqueryText>
                                                            </con3:expr>
                                                          </con3:insert>
                                                          <con3:ifThenElse>
                                                            <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-7984</con1:id>
                                                            <con3:case>
                                                              <con3:condition>
                                                                <con1:xqueryText>(data($consultarContratoEsPospagoResponse/*:MENSAJE/*:ESPOSTPAGO) = 'TRUE'
 and data($body/ejec:Input_Parameters/CONTRATOESPOSTPAGO) = 'FALSE')
 or
  (data($consultarContratoEsPospagoResponse/*:MENSAJE/*:ESPOSTPAGO) = 'FALSE'
 and data($body/ejec:Input_Parameters/CONTRATOESPOSTPAGO) = 'TRUE')</con1:xqueryText>
                                                              </con3:condition>
                                                              <con3:actions>
                                                                <con3:insert varName="reglasNegocioResponse">
                                                                  <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-7983</con1:id>
                                                                  <con3:location>
                                                                    <con1:xpathText>./*:MENSAJE/*:PARAMETROS</con1:xpathText>
                                                                  </con3:location>
                                                                  <con3:where>last-child</con3:where>
                                                                  <con3:expr>
                                                                    <con1:xqueryText><![CDATA[<PARAMETRO>
	<NOMBRE>ESUPDOWN</NOMBRE>
	<TIPO>string</TIPO>
	<VALOR>TRUE</VALOR>
</PARAMETRO>]]></con1:xqueryText>
                                                                  </con3:expr>
                                                                </con3:insert>
                                                              </con3:actions>
                                                            </con3:case>
                                                            <con3:default>
                                                              <con3:insert varName="reglasNegocioResponse">
                                                                <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-7982</con1:id>
                                                                <con3:location>
                                                                  <con1:xpathText>./*:MENSAJE/*:PARAMETROS</con1:xpathText>
                                                                </con3:location>
                                                                <con3:where>last-child</con3:where>
                                                                <con3:expr>
                                                                  <con1:xqueryText><![CDATA[<PARAMETRO>
	<NOMBRE>ESUPDOWN</NOMBRE>
	<TIPO>string</TIPO>
	<VALOR>FALSE</VALOR>
</PARAMETRO>]]></con1:xqueryText>
                                                                </con3:expr>
                                                              </con3:insert>
                                                            </con3:default>
                                                          </con3:ifThenElse>
                                                        </con3:actions>
                                                      </con3:case>
                                                      <con3:default/>
                                                    </con3:ifThenElse>
                                                  </con3:actions>
                                                </con3:case>
                                                <con3:case>
                                                  <con3:condition>
                                                    <con1:xqueryText>($metodo = ('200','407')) and (data($balancesResponse/CODIGO) = '1' or data($balancesResponse/CODIGO) = '959')</con1:xqueryText>
                                                  </con3:condition>
                                                  <con3:actions>
                                                    <con3:ifThenElse>
                                                      <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-7981</con1:id>
                                                      <con3:case>
                                                        <con3:condition>
                                                          <con1:xqueryText>number($body/ejec:Input_Parameters/IN_ORIGEN) &lt; 50</con1:xqueryText>
                                                        </con3:condition>
                                                        <con3:actions/>
                                                      </con3:case>
                                                      <con3:default>
                                                        <con3:wsCallout>
                                                          <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-797f</con1:id>
                                                          <con3:service xsi:type="ref:ProxyRef" ref="ITEL/OCS/SOI/Proxies/consultarSuscriptorOCSLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                                          <con3:operation>consultarSuscriptorOCS</con3:operation>
                                                          <con3:request>
                                                            <con3:body>$suscriptorOCSRequest</con3:body>
                                                          </con3:request>
                                                          <con3:response>
                                                            <con3:body>suscriptorOCSResponse</con3:body>
                                                          </con3:response>
                                                          <con3:requestTransform>
                                                            <con3:assign varName="suscriptorOCSRequest">
                                                              <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-7980</con1:id>
                                                              <con3:expr>
                                                                <con1:xqueryTransform>
                                                                  <con1:resource ref="ITEL/Core/Resources/XQueries/consultarSuscriptorOCSPS_Req"/>
                                                                  <con1:param name="timeout">
                                                                    <con1:path>2000</con1:path>
                                                                  </con1:param>
                                                                  <con1:param name="min">
                                                                    <con1:path>data($body/ejec:Input_Parameters/MIN_DESTINO)</con1:path>
                                                                  </con1:param>
                                                                  <con1:param name="in">
                                                                    <con1:path>data($body/ejec:Input_Parameters/IN_DESTINO)</con1:path>
                                                                  </con1:param>
                                                                </con1:xqueryTransform>
                                                              </con3:expr>
                                                            </con3:assign>
                                                          </con3:requestTransform>
                                                          <con3:responseTransform/>
                                                        </con3:wsCallout>
                                                      </con3:default>
                                                    </con3:ifThenElse>
                                                    <con3:ifThenElse>
                                                      <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-797e</con1:id>
                                                      <con3:case>
                                                        <con3:condition>
                                                          <con1:xqueryText>$codError = "1"</con1:xqueryText>
                                                        </con3:condition>
                                                        <con3:actions>
                                                          <con3:wsCallout>
                                                            <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-7976</con1:id>
                                                            <con3:service xsi:type="ref:ProxyRef" ref="ITEL/Core/Proxies/consultarContractTemp_ContractLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                                            <con3:operation>consultarContractTemp_Contract</con3:operation>
                                                            <con3:request>
                                                              <con3:body>$consultarContractTempContractRequest</con3:body>
                                                            </con3:request>
                                                            <con3:response>
                                                              <con3:body>consultarContractTempContractResponse</con3:body>
                                                            </con3:response>
                                                            <con3:requestTransform>
                                                              <con3:assign varName="consultarContractTempContractRequest">
                                                                <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-797d</con1:id>
                                                                <con3:expr>
                                                                  <con1:xqueryTransform>
                                                                    <con1:resource ref="ITEL/Core/Resources/XQueries/consultarContractTempContractPS_Req"/>
                                                                    <con1:param name="serviceClass">
                                                                      <con1:path>data($suscriptorOCSResponse/MENSAJE/CONSULTAR_SUSCRIPTOR/*:suscriptor/*:PublicRatePlanCode)</con1:path>
                                                                    </con1:param>
                                                                    <con1:param name="contract">
                                                                      <con1:path>""</con1:path>
                                                                    </con1:param>
                                                                    <con1:param name="fafidgroup">
                                                                      <con1:path>data($suscriptorOCSResponse/MENSAJE/CONSULTAR_SUSCRIPTOR/*:suscriptor/*:AccountGroupID)</con1:path>
                                                                    </con1:param>
                                                                  </con1:xqueryTransform>
                                                                </con3:expr>
                                                              </con3:assign>
                                                            </con3:requestTransform>
                                                            <con3:responseTransform>
                                                              <con3:ifThenElse>
                                                                <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-797c</con1:id>
                                                                <con3:case>
                                                                  <con3:condition>
                                                                    <con1:xqueryText>data($consultarContractTempContractResponse/CODIGO) = "OK"</con1:xqueryText>
                                                                  </con3:condition>
                                                                  <con3:actions>
                                                                    <con3:insert varName="suscriptorOCSResponse">
                                                                      <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-797b</con1:id>
                                                                      <con3:location>
                                                                        <con1:xpathText>./MENSAJE/CONSULTAR_SUSCRIPTOR/*:suscriptor</con1:xpathText>
                                                                      </con3:location>
                                                                      <con3:where>last-child</con3:where>
                                                                      <con3:expr>
                                                                        <con1:xqueryText>&lt;CONTRACT_TEMPLATE>{data($consultarContractTempContractResponse/MENSAJE/CONTRACT_TEMPLATE)}&lt;/CONTRACT_TEMPLATE></con1:xqueryText>
                                                                      </con3:expr>
                                                                    </con3:insert>
                                                                    <con3:insert varName="suscriptorOCSResponse">
                                                                      <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-797a</con1:id>
                                                                      <con3:location>
                                                                        <con1:xpathText>./MENSAJE/CONSULTAR_SUSCRIPTOR/*:suscriptor</con1:xpathText>
                                                                      </con3:location>
                                                                      <con3:where>last-child</con3:where>
                                                                      <con3:expr>
                                                                        <con1:xqueryText>&lt;CONTRACT>{data($consultarContractTempContractResponse/MENSAJE/CONTRACT)}&lt;/CONTRACT></con1:xqueryText>
                                                                      </con3:expr>
                                                                    </con3:insert>
                                                                    <con3:insert varName="suscriptorOCSResponse">
                                                                      <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-7979</con1:id>
                                                                      <con3:location>
                                                                        <con1:xpathText>./MENSAJE/CONSULTAR_SUSCRIPTOR/*:suscriptor</con1:xpathText>
                                                                      </con3:location>
                                                                      <con3:where>last-child</con3:where>
                                                                      <con3:expr>
                                                                        <con1:xqueryText>&lt;FAFIDGROUP>{data($consultarContractTempContractResponse/MENSAJE/FAFIDGROUP)}&lt;/FAFIDGROUP></con1:xqueryText>
                                                                      </con3:expr>
                                                                    </con3:insert>
                                                                    <con3:insert varName="suscriptorOCSResponse">
                                                                      <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-7978</con1:id>
                                                                      <con3:location>
                                                                        <con1:xpathText>./MENSAJE/CONSULTAR_SUSCRIPTOR/*:suscriptor</con1:xpathText>
                                                                      </con3:location>
                                                                      <con3:where>last-child</con3:where>
                                                                      <con3:expr>
                                                                        <con1:xqueryText>&lt;FAFIDS>{fn:string-join(data($consultarContractTempContractResponse/MENSAJE/FAFIDS/FAFID),";")}&lt;/FAFIDS></con1:xqueryText>
                                                                      </con3:expr>
                                                                    </con3:insert>
                                                                  </con3:actions>
                                                                </con3:case>
                                                                <con3:default>
                                                                  <con3:assign varName="codError">
                                                                    <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-7977</con1:id>
                                                                    <con3:expr>
                                                                      <con1:xqueryText>"909"</con1:xqueryText>
                                                                    </con3:expr>
                                                                  </con3:assign>
                                                                </con3:default>
                                                              </con3:ifThenElse>
                                                            </con3:responseTransform>
                                                          </con3:wsCallout>
                                                        </con3:actions>
                                                      </con3:case>
                                                      <con3:default/>
                                                    </con3:ifThenElse>
                                                    <con6:assign varName="reglasNegocioResponse" xmlns:con6="http://www.bea.com/wli/sb/stages/transform/config">
                                                      <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-7975</con1:id>
                                                      <con6:expr>
                                                        <con1:xqueryText><![CDATA[<ns0:WS_Result xmlns:ns0="http://www.comcel.com.co/ConsultarReglas/">
	<CODIGO>1</CODIGO>
	<MENSAJE>
		<ERROR>1</ERROR>
		<ERRORDESC></ERRORDESC>
		<CONSULTASUSCRIPTOR>FALSE</CONSULTASUSCRIPTOR>
		<PARAMETROS>
			<PARAMETRO>
				<NOMBRE>CONSULTASDIA</NOMBRE>
				<TIPO>string</TIPO>
				<VALOR>{ data($body/ejec:Input_Parameters/PARAMETROS_TRAMA/PARAMETRO[NOMBRE="CONSULTASDIA"]/VALOR) }</VALOR>
			</PARAMETRO>
			<PARAMETRO>
				<NOMBRE>CONSULTASREALIZADAS</NOMBRE>
				<TIPO>string</TIPO>
				<VALOR>{ data($body/ejec:Input_Parameters/PARAMETROS_TRAMA/PARAMETRO[NOMBRE="CONSULTASREALIZADAS"]/VALOR) }</VALOR>
			</PARAMETRO>
			<PARAMETRO>
				<NOMBRE>ACREDITACUENTA</NOMBRE>
				<TIPO>string</TIPO>
				<VALOR>{ if(data($body/ejec:Input_Parameters/PARAMETROS_TRAMA/PARAMETRO[NOMBRE="BONIFICAR"]/VALOR) = "0") then "FALSE" else "FALSE" }</VALOR>
			</PARAMETRO>
			<PARAMETRO>
				<NOMBRE>MONTOCUENTA</NOMBRE>
				<TIPO>string</TIPO>
				<VALOR>0</VALOR>
			</PARAMETRO>
			<PARAMETRO>
				<NOMBRE>TIPOCONSULTA</NOMBRE>
				<TIPO>string</TIPO>
				<VALOR>{ data($body/ejec:Input_Parameters/PARAMETROS_TRAMA/PARAMETRO[NOMBRE="MONTORECARGA"]/VALOR) }</VALOR>
			</PARAMETRO>			
		</PARAMETROS>
	</MENSAJE>
</ns0:WS_Result>]]></con1:xqueryText>
                                                      </con6:expr>
                                                    </con6:assign>
                                                  </con3:actions>
                                                </con3:case>
                                                <con3:case>
                                                  <con3:condition>
                                                    <con1:xqueryText>($metodo = ('205')) and (data($balancesResponse/CODIGO) = '1' or data($balancesResponse/CODIGO) = '959')</con1:xqueryText>
                                                  </con3:condition>
                                                  <con3:actions>
                                                    <con3:ifThenElse>
                                                      <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-7974</con1:id>
                                                      <con3:case>
                                                        <con3:condition>
                                                          <con1:xqueryText>$codError = "1"</con1:xqueryText>
                                                        </con3:condition>
                                                        <con3:actions>
                                                          <con3:wsCallout>
                                                            <con1:id>_ActionId-6335838997708241637-5f072de9.15463783bea.-7d8d</con1:id>
                                                            <con3:service xsi:type="ref:ProxyRef" ref="ITEL/OCS/AIR/Proxies/consultarOfferOCSLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                                            <con3:operation>consultarOffer</con3:operation>
                                                            <con3:request>
                                                              <con3:body>$consultarOfferRequest</con3:body>
                                                            </con3:request>
                                                            <con3:response>
                                                              <con3:body>consultarOfferResponse</con3:body>
                                                            </con3:response>
                                                            <con3:requestTransform>
                                                              <con3:assign varName="consultarOfferRequest">
                                                                <con1:id>_ActionId-6335838997708241637-5f072de9.15463783bea.-7d55</con1:id>
                                                                <con3:expr>
                                                                  <con1:xqueryTransform>
                                                                    <con1:resource ref="ITEL/Core/Resources/XQueries/consultarOfferPS_Req"/>
                                                                    <con1:param name="min">
                                                                      <con1:path>data($body/ejec:Input_Parameters/MIN_DESTINO)</con1:path>
                                                                    </con1:param>
                                                                  </con1:xqueryTransform>
                                                                </con3:expr>
                                                              </con3:assign>
                                                            </con3:requestTransform>
                                                            <con3:responseTransform>
                                                              <con3:ifThenElse>
                                                                <con1:id>_ActionId-6335838997708241637-5f072de9.15463783bea.-7d1c</con1:id>
                                                                <con3:case>
                                                                  <con3:condition>
                                                                    <con1:xqueryText>data($consultarOfferResponse/CODIGO) = '1'</con1:xqueryText>
                                                                  </con3:condition>
                                                                  <con3:actions>
                                                                    <con3:replace varName="balancesResponse">
                                                                      <con1:id>_ActionId-6335838997708241637-5f072de9.15463783bea.-7cae</con1:id>
                                                                      <con3:expr>
                                                                        <con1:xqueryTransform>
                                                                          <con1:resource ref="ITEL/Core/Resources/XQueries/transformarOfferAIRtoDA"/>
                                                                          <con1:param name="consultarOfferResult">
                                                                            <con1:path>$consultarOfferResponse</con1:path>
                                                                          </con1:param>
                                                                          <con1:param name="consultarBalancesResult">
                                                                            <con1:path>$balancesResponse</con1:path>
                                                                          </con1:param>
                                                                        </con1:xqueryTransform>
                                                                      </con3:expr>
                                                                    </con3:replace>
                                                                  </con3:actions>
                                                                </con3:case>
                                                                <con3:default/>
                                                              </con3:ifThenElse>
                                                            </con3:responseTransform>
                                                          </con3:wsCallout>
                                                        </con3:actions>
                                                      </con3:case>
                                                      <con3:default/>
                                                    </con3:ifThenElse>
                                                  </con3:actions>
                                                </con3:case>
                                                <con3:case>
                                                  <con3:condition>
                                                    <con1:xqueryText>$metodo = ('409', '415', '705')</con1:xqueryText>
                                                  </con3:condition>
                                                  <con3:actions>
                                                    <con3:ifThenElse>
                                                      <con1:id>_ActionId-5808684983193976206-2b8435b5.154ac1b5105.-7d11</con1:id>
                                                      <con3:case>
                                                        <con3:condition>
                                                          <con1:xqueryText>$codError = "1" and $metodo = ('409','415') and data($consultarPaquetesResponse/MENSAJE/CUENTA)= '10'</con1:xqueryText>
                                                        </con3:condition>
                                                        <con3:actions>
                                                          <con3:wsCallout>
                                                            <con1:id>_ActionId-5808684983193976206-2b8435b5.154ac1b5105.-7d0d</con1:id>
                                                            <con3:service xsi:type="ref:ProxyRef" ref="ITEL/OCS/AIR/Proxies/consultarOfferOCSLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                                            <con3:operation>consultarOffer</con3:operation>
                                                            <con3:request>
                                                              <con3:body>$consultarOfferRequest</con3:body>
                                                            </con3:request>
                                                            <con3:response>
                                                              <con3:body>consultarOfferResponse</con3:body>
                                                            </con3:response>
                                                            <con3:requestTransform>
                                                              <con3:assign varName="consultarOfferRequest">
                                                                <con1:id>_ActionId-5808684983193976206-2b8435b5.154ac1b5105.-7d10</con1:id>
                                                                <con3:expr>
                                                                  <con1:xqueryTransform>
                                                                    <con1:resource ref="ITEL/Core/Resources/XQueries/consultarOfferPS_Req"/>
                                                                    <con1:param name="min">
                                                                      <con1:path>data($body/ejec:Input_Parameters/MIN_DESTINO)</con1:path>
                                                                    </con1:param>
                                                                  </con1:xqueryTransform>
                                                                </con3:expr>
                                                              </con3:assign>
                                                            </con3:requestTransform>
                                                            <con3:responseTransform>
                                                              <con3:ifThenElse>
                                                                <con1:id>_ActionId-5808684983193976206-2b8435b5.154ac1b5105.-7d0f</con1:id>
                                                                <con3:case>
                                                                  <con3:condition>
                                                                    <con1:xqueryText>data($consultarOfferResponse/CODIGO) = '1'
and contains($consultarOfferResponse/MENSAJE/CONSULTAR_OFFER/offerInformationList, data(fn:tokenize($consultarPaquetesResponse/MENSAJE/OFFEROLM,'\|')[1]))</con1:xqueryText>
                                                                  </con3:condition>
                                                                  <con3:actions>
                                                                    <con3:assign varName="codError">
                                                                      <con1:id>_ActionId-5808684983193976206-2b8435b5.154ac1b5105.-7d0e</con1:id>
                                                                      <con3:expr>
                                                                        <con1:xqueryText>"962"</con1:xqueryText>
                                                                      </con3:expr>
                                                                    </con3:assign>
                                                                  </con3:actions>
                                                                </con3:case>
                                                                <con3:default/>
                                                              </con3:ifThenElse>
                                                            </con3:responseTransform>
                                                          </con3:wsCallout>
                                                          <con3:ifThenElse>
                                                            <con1:id>_ActionId-3276135303993744801-2f482113.157e3b44c91.-70bc</con1:id>
                                                            <con3:case>
                                                              <con3:condition>
                                                                <con1:xqueryText>$tipoCuenta="10"</con1:xqueryText>
                                                              </con3:condition>
                                                              <con3:actions>
                                                                <con3:foreach>
                                                                  <con1:id>_ActionId-3276135303993744801-2f482113.157e3b44c91.-6e8c</con1:id>
                                                                  <con3:variable>consultarOfferResponse</con3:variable>
                                                                  <con3:expression>
                                                                    <con1:xpathText>./MENSAJE/CONSULTAR_OFFER/offerInformationList/Detail</con1:xpathText>
                                                                  </con3:expression>
                                                                  <con3:value-variable>tipoOferta</con3:value-variable>
                                                                  <con3:index-variable>v_indice</con3:index-variable>
                                                                  <con3:total-variable>v_total</con3:total-variable>
                                                                  <con3:actions>
                                                                    <con3:ifThenElse>
                                                                      <con1:id>_ActionId-3276135303993744801-2f482113.157e3b44c91.-6e8f</con1:id>
                                                                      <con3:case>
                                                                        <con3:condition>
                                                                          <con1:xqueryText>data($tipoOferta/offerType) = ("30125", "30171")</con1:xqueryText>
                                                                        </con3:condition>
                                                                        <con3:actions>
                                                                          <con3:assign varName="paqueteActual">
                                                                            <con1:id>_ActionId-3276135303993744801-2f482113.157e3b44c91.-6e8e</con1:id>
                                                                            <con3:expr>
                                                                              <con1:xqueryText>data($tipoOferta/offerType)</con1:xqueryText>
                                                                            </con3:expr>
                                                                          </con3:assign>
                                                                          <con3:insert varName="reglasNegocioResponse">
                                                                            <con1:id>_ActionId-3276135303993744801-2f482113.157e3b44c91.-6e8d</con1:id>
                                                                            <con3:location>
                                                                              <con1:xpathText>./MENSAJE/PARAMETROS</con1:xpathText>
                                                                            </con3:location>
                                                                            <con3:where>last-child</con3:where>
                                                                            <con3:expr>
                                                                              <con1:xqueryText><![CDATA[<PARAMETRO>
	<NOMBRE>PAQUETEACTUAL</NOMBRE>
	<TIPO>string</TIPO>
	<VALOR>{ data($tipoOferta/offerType) }</VALOR>
</PARAMETRO>]]></con1:xqueryText>
                                                                            </con3:expr>
                                                                          </con3:insert>
                                                                        </con3:actions>
                                                                      </con3:case>
                                                                      <con3:default/>
                                                                    </con3:ifThenElse>
                                                                  </con3:actions>
                                                                </con3:foreach>
                                                                <con3:ifThenElse>
                                                                  <con1:id>_ActionId-3276135303993744801-2f482113.157e3b44c91.-6f28</con1:id>
                                                                  <con3:case>
                                                                    <con3:condition>
                                                                      <con1:xqueryText>empty($paqueteActual)</con1:xqueryText>
                                                                    </con3:condition>
                                                                    <con3:actions>
                                                                      <con3:insert varName="reglasNegocioResponse">
                                                                        <con1:id>_ActionId-3276135303993744801-2f482113.157e3b44c91.-6e8a</con1:id>
                                                                        <con3:location>
                                                                          <con1:xpathText>./MENSAJE/PARAMETROS</con1:xpathText>
                                                                        </con3:location>
                                                                        <con3:where>last-child</con3:where>
                                                                        <con3:expr>
                                                                          <con1:xqueryText><![CDATA[<PARAMETRO>
	<NOMBRE>PAQUETEACTUAL</NOMBRE>
	<TIPO>string</TIPO>
	<VALOR>0</VALOR>
</PARAMETRO>]]></con1:xqueryText>
                                                                        </con3:expr>
                                                                      </con3:insert>
                                                                    </con3:actions>
                                                                  </con3:case>
                                                                  <con3:default/>
                                                                </con3:ifThenElse>
                                                              </con3:actions>
                                                            </con3:case>
                                                            <con3:default>
                                                              <con3:assign varName="miElse">
                                                                <con1:id>_ActionId-3276135303993744801-2f482113.157e3b44c91.-709d</con1:id>
                                                                <con3:expr>
                                                                  <con1:xqueryText>"se fue por el else"</con1:xqueryText>
                                                                </con3:expr>
                                                              </con3:assign>
                                                            </con3:default>
                                                          </con3:ifThenElse>
                                                        </con3:actions>
                                                      </con3:case>
                                                      <con3:default/>
                                                    </con3:ifThenElse>
                                                    <con3:ifThenElse>
                                                      <con1:id>_ActionId-5808684983193976206-2b8435b5.154ac1b5105.-7cd5</con1:id>
                                                      <con3:case>
                                                        <con3:condition>
                                                          <con1:xqueryText>$codError = '1' and data($balancesResponse/CODIGO) = '1' and
data($body/ejec:Input_Parameters/PARAMETROS_TRAMA/PARAMETRO[NOMBRE="BONIFICAR"]/VALOR) = '1'</con1:xqueryText>
                                                        </con3:condition>
                                                        <con3:actions>
                                                          <con3:ifThenElse>
                                                            <con1:id>_ActionId-5808684983193976206-2b8435b5.154ac1b5105.-7cd1</con1:id>
                                                            <con3:case>
                                                              <con3:condition>
                                                                <con1:xqueryText>fn-bea:dateTime-from-string-with-format("yyyyMMdd'T'HH:mm:ss+SSSS",
data($balancesResponse/MENSAJE/CONSULTAR_BALANCES/MethodResponse/expiryDate)) &lt; current-dateTime()</con1:xqueryText>
                                                              </con3:condition>
                                                              <con3:actions>
                                                                <con3:assign varName="codError">
                                                                  <con1:id>_ActionId-5808684983193976206-2b8435b5.154ac1b5105.-7cd0</con1:id>
                                                                  <con3:expr>
                                                                    <con1:xqueryText>"944"</con1:xqueryText>
                                                                  </con3:expr>
                                                                </con3:assign>
                                                              </con3:actions>
                                                            </con3:case>
                                                            <con3:default>
                                                              <con3:assign varName="codError">
                                                                <con1:id>_ActionId-5808684983193976206-2b8435b5.154ac1b5105.-7ccf</con1:id>
                                                                <con3:expr>
                                                                  <con1:xqueryText>"1"</con1:xqueryText>
                                                                </con3:expr>
                                                              </con3:assign>
                                                            </con3:default>
                                                          </con3:ifThenElse>
                                                        </con3:actions>
                                                      </con3:case>
                                                      <con3:default/>
                                                    </con3:ifThenElse>
                                                  </con3:actions>
                                                </con3:case>
                                                <con3:case>
                                                  <con3:condition>
                                                    <con1:xqueryText>$metodo = ('400','401','402','408','410','411') and (data($balancesResponse/CODIGO) = '1' or data($balancesResponse/CODIGO) = '959' )</con1:xqueryText>
                                                  </con3:condition>
                                                  <con3:actions>
                                                    <con3:ifThenElse>
                                                      <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-7967</con1:id>
                                                      <con3:case>
                                                        <con3:condition>
                                                          <con1:xqueryText>data($balancesResponse/CODIGO) = '1' 
and
data($balancesResponse/MENSAJE/CONSULTAR_BALANCES/MethodResponse/expiryDate) != ''
and 
not($metodo = '410')</con1:xqueryText>
                                                        </con3:condition>
                                                        <con3:actions>
                                                          <con3:ifThenElse>
                                                            <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-7966</con1:id>
                                                            <con3:case>
                                                              <con3:condition>
                                                                <con1:xqueryText>fn-bea:dateTime-from-string-with-format("yyyyMMdd'T'HH:mm:ss+SSSS",
data($balancesResponse/MENSAJE/CONSULTAR_BALANCES/MethodResponse/expiryDate)) &lt; current-dateTime()</con1:xqueryText>
                                                              </con3:condition>
                                                              <con3:actions>
                                                                <con3:assign varName="codError">
                                                                  <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-7965</con1:id>
                                                                  <con3:expr>
                                                                    <con1:xqueryText>"944"</con1:xqueryText>
                                                                  </con3:expr>
                                                                </con3:assign>
                                                              </con3:actions>
                                                            </con3:case>
                                                            <con3:default>
                                                              <con3:assign varName="codError">
                                                                <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-7964</con1:id>
                                                                <con3:expr>
                                                                  <con1:xqueryText>"1"</con1:xqueryText>
                                                                </con3:expr>
                                                              </con3:assign>
                                                            </con3:default>
                                                          </con3:ifThenElse>
                                                        </con3:actions>
                                                      </con3:case>
                                                      <con3:case>
                                                        <con3:condition>
                                                          <con1:xqueryText>data($body/ejec:Input_Parameters/PARAMETROS_TRAMA/PARAMETRO[NOMBRE='MONTORECARGA']/VALOR) &lt; 0 
and
data($balancesResponse/CODIGO) = '1' 
and
data($balancesResponse/MENSAJE/CONSULTAR_BALANCES/MethodResponse/expiryDate) != ''
and 
$metodo = '410'</con1:xqueryText>
                                                        </con3:condition>
                                                        <con3:actions>
                                                          <con3:ifThenElse>
                                                            <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-7963</con1:id>
                                                            <con3:case>
                                                              <con3:condition>
                                                                <con1:xqueryText>let $cuenta :=data($body/ejec:Input_Parameters/PARAMETROS_TRAMA/PARAMETRO[NOMBRE='BONIFICAR']/VALOR)
return
not(exists($balancesResponse/MENSAJE/CONSULTAR_BALANCES/MethodResponse/DedicatedAccounts/Detail[Name=$cuenta]/ExpiryDate)) 
or 
data($balancesResponse/MENSAJE/CONSULTAR_BALANCES/MethodResponse/DedicatedAccounts/Detail[Name=$cuenta]/ExpiryDate)=""</con1:xqueryText>
                                                              </con3:condition>
                                                              <con3:actions>
                                                                <con3:assign varName="codError">
                                                                  <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-7962</con1:id>
                                                                  <con3:expr>
                                                                    <con1:xqueryText>"959"</con1:xqueryText>
                                                                  </con3:expr>
                                                                </con3:assign>
                                                              </con3:actions>
                                                            </con3:case>
                                                            <con3:case>
                                                              <con3:condition>
                                                                <con1:xqueryText>let $cuenta :=data($body/ejec:Input_Parameters/PARAMETROS_TRAMA/PARAMETRO[NOMBRE='BONIFICAR']/VALOR)
return
fn-bea:dateTime-from-string-with-format("yyyyMMdd'T'HH:mm:ss+SSSS",
data($balancesResponse/MENSAJE/CONSULTAR_BALANCES/MethodResponse/DedicatedAccounts/Detail[Name=$cuenta]/ExpiryDate)) &lt; current-dateTime()</con1:xqueryText>
                                                              </con3:condition>
                                                              <con3:actions>
                                                                <con3:assign varName="codError">
                                                                  <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-7961</con1:id>
                                                                  <con3:expr>
                                                                    <con1:xqueryText>"944"</con1:xqueryText>
                                                                  </con3:expr>
                                                                </con3:assign>
                                                              </con3:actions>
                                                            </con3:case>
                                                            <con3:default/>
                                                          </con3:ifThenElse>
                                                        </con3:actions>
                                                      </con3:case>
                                                      <con3:default/>
                                                    </con3:ifThenElse>
                                                  </con3:actions>
                                                </con3:case>
                                                <con3:default>
                                                  <con3:assign varName="codError">
                                                    <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-7960</con1:id>
                                                    <con3:expr>
                                                      <con1:xqueryText>data($balancesResponse/CODIGO)</con1:xqueryText>
                                                    </con3:expr>
                                                  </con3:assign>
                                                </con3:default>
                                              </con3:ifThenElse>
                                            </con3:actions>
                                          </con3:case>
                                          <con3:case>
                                            <con3:condition>
                                              <con1:xqueryText>$metodo = '210'</con1:xqueryText>
                                            </con3:condition>
                                            <con3:actions>
                                              <con3:wsCallout>
                                                <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-795b</con1:id>
                                                <con3:service xsi:type="ref:ProxyRef" ref="ITEL/RTC/Proxies/consultarPaqueteDatosRTCLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                                <con3:operation>consultarPaqueteDatosRTC</con3:operation>
                                                <con3:request>
                                                  <con3:body>$consultarPaqueteDatosRTCRequest</con3:body>
                                                </con3:request>
                                                <con3:response>
                                                  <con3:body>consultarPaqueteDatosRTCResponse</con3:body>
                                                </con3:response>
                                                <con3:requestTransform>
                                                  <con3:assign varName="consultarPaqueteDatosRTCRequest">
                                                    <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-795f</con1:id>
                                                    <con3:expr>
                                                      <con1:xqueryTransform>
                                                        <con1:resource ref="ITEL/Core/Resources/XQueries/ejecutarReglasNegocio_Req_consultarPaqueteDatosRTC"/>
                                                        <con1:param name="mIN_DESTINO1">
                                                          <con1:path>data($body/ejec:Input_Parameters/MIN_DESTINO)</con1:path>
                                                        </con1:param>
                                                      </con1:xqueryTransform>
                                                    </con3:expr>
                                                  </con3:assign>
                                                </con3:requestTransform>
                                                <con3:responseTransform>
                                                  <con3:ifThenElse>
                                                    <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-795e</con1:id>
                                                    <con3:case>
                                                      <con3:condition>
                                                        <con1:xqueryText>data($consultarPaqueteDatosRTCResponse/CODIGO) = "1"</con1:xqueryText>
                                                      </con3:condition>
                                                      <con3:actions>
                                                        <con3:insert varName="suscriptorOCSResponse">
                                                          <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-795d</con1:id>
                                                          <con3:location>
                                                            <con1:xpathText>./MENSAJE/CONSULTAR_SUSCRIPTOR/*:suscriptor</con1:xpathText>
                                                          </con3:location>
                                                          <con3:where>last-child</con3:where>
                                                          <con3:expr>
                                                            <con1:xqueryText>&lt;PAQUETES_DATOS>{$consultarPaqueteDatosRTCResponse/MENSAJE/node()}&lt;/PAQUETES_DATOS></con1:xqueryText>
                                                          </con3:expr>
                                                        </con3:insert>
                                                      </con3:actions>
                                                    </con3:case>
                                                    <con3:default>
                                                      <con3:assign varName="codError">
                                                        <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-795c</con1:id>
                                                        <con3:expr>
                                                          <con1:xqueryText>"62"</con1:xqueryText>
                                                        </con3:expr>
                                                      </con3:assign>
                                                    </con3:default>
                                                  </con3:ifThenElse>
                                                </con3:responseTransform>
                                              </con3:wsCallout>
                                            </con3:actions>
                                          </con3:case>
                                          <con3:case>
                                            <con3:condition>
                                              <con1:xqueryText>$metodo = '208'</con1:xqueryText>
                                            </con3:condition>
                                            <con3:actions>
                                              <con3:assign varName="reglasNegocioResponse">
                                                <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-795a</con1:id>
                                                <con3:expr>
                                                  <con1:xqueryText><![CDATA[<ns0:WS_Result xmlns:ns0="http://www.comcel.com.co/ConsultarReglas/">
    <CODIGO>1</CODIGO>
    <MENSAJE>
        <PARAMETROS>
            <PARAMETRO>
                <NOMBRE>CAMBIOSDEPLAN</NOMBRE>
                <TIPO>decimal</TIPO>
                <VALOR>{ data($body/ejec:Input_Parameters/PARAMETROS_TRAMA/PARAMETRO[NOMBRE='CAMBIOSDEPLAN']/VALOR) }</VALOR>
            </PARAMETRO>
        </PARAMETROS>
    </MENSAJE>
    <DESCRIPCION>Consulta Exitosa</DESCRIPCION>
</ns0:WS_Result>]]></con1:xqueryText>
                                                </con3:expr>
                                              </con3:assign>
                                            </con3:actions>
                                          </con3:case>
                                          <con3:case>
                                            <con3:condition>
                                              <con1:xqueryText>$metodo = '213'</con1:xqueryText>
                                            </con3:condition>
                                            <con3:actions>
                                              <con3:assign varName="reglasNegocioResponse">
                                                <con1:id>_ActionId-1259675915633913103-52f096e5.15680daa81f.-7c15</con1:id>
                                                <con3:expr>
                                                  <con1:xqueryText><![CDATA[<ns0:WS_Result xmlns:ns0="http://www.comcel.com.co/ConsultarReglas/">
    <CODIGO>1</CODIGO>
    <MENSAJE>
        <PARAMETROS>
            <PARAMETRO>
                <NOMBRE>CAMBIOSDEFNF</NOMBRE>
                <TIPO>decimal</TIPO>
                <VALOR>{ data($body/ejec:Input_Parameters/PARAMETROS_TRAMA/PARAMETRO[NOMBRE='CAMBIOSDEFNF']/VALOR) }</VALOR>
            </PARAMETRO>
        </PARAMETROS>
    </MENSAJE>
    <DESCRIPCION>Consulta Exitosa</DESCRIPCION>
</ns0:WS_Result>]]></con1:xqueryText>
                                                </con3:expr>
                                              </con3:assign>
                                            </con3:actions>
                                          </con3:case>
                                          <con3:case>
                                            <con3:condition>
                                              <con1:xqueryText>$metodo = '414'</con1:xqueryText>
                                            </con3:condition>
                                            <con3:actions>
                                              <con3:ifThenElse>
                                                <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-7959</con1:id>
                                                <con3:case>
                                                  <con3:condition>
                                                    <con1:xqueryText>data($consultarPaquetesTATResponse/MENSAJE/TIPO) = 'MIXTO'
and
data($body/ejec:Input_Parameters/PARAMETROS_TRAMA/PARAMETRO[NOMBRE='DIASVIGENCIA']/VALOR) = '1'</con1:xqueryText>
                                                  </con3:condition>
                                                  <con3:actions>
                                                    <con3:wsCallout>
                                                      <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-7957</con1:id>
                                                      <con3:service xsi:type="ref:ProxyRef" ref="ITEL/OCS/AIR/Proxies/consultarBalancesOCSLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                                      <con3:operation>consultarBalances</con3:operation>
                                                      <con3:request>
                                                        <con3:body>$balancesRequest</con3:body>
                                                      </con3:request>
                                                      <con3:response>
                                                        <con3:body>balancesResponse</con3:body>
                                                      </con3:response>
                                                      <con3:requestTransform>
                                                        <con3:assign varName="balancesRequest">
                                                          <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-7958</con1:id>
                                                          <con3:expr>
                                                            <con1:xqueryTransform>
                                                              <con1:resource ref="ITEL/Core/Resources/XQueries/consultarBalancesPS_Req"/>
                                                              <con1:param name="min">
                                                                <con1:path>data($body/ejec:Input_Parameters/MIN_DESTINO)</con1:path>
                                                              </con1:param>
                                                            </con1:xqueryTransform>
                                                          </con3:expr>
                                                        </con3:assign>
                                                      </con3:requestTransform>
                                                      <con3:responseTransform/>
                                                    </con3:wsCallout>
                                                    <con3:ifThenElse>
                                                      <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-7956</con1:id>
                                                      <con3:case>
                                                        <con3:condition>
                                                          <con1:xqueryText>data($balancesResponse/CODIGO) = '1'
and
data($balancesResponse/MENSAJE/CONSULTAR_BALANCES/MethodResponse/expiryDate) != ''</con1:xqueryText>
                                                        </con3:condition>
                                                        <con3:actions>
                                                          <con3:ifThenElse>
                                                            <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-7955</con1:id>
                                                            <con3:case>
                                                              <con3:condition>
                                                                <con1:xqueryText>fn-bea:dateTime-from-string-with-format("yyyyMMdd'T'HH:mm:ss+SSSS",
data($balancesResponse/MENSAJE/CONSULTAR_BALANCES/MethodResponse/expiryDate)) &lt; current-dateTime()</con1:xqueryText>
                                                              </con3:condition>
                                                              <con3:actions>
                                                                <con3:assign varName="codError">
                                                                  <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-7954</con1:id>
                                                                  <con3:expr>
                                                                    <con1:xqueryText>"944"</con1:xqueryText>
                                                                  </con3:expr>
                                                                </con3:assign>
                                                              </con3:actions>
                                                            </con3:case>
                                                            <con3:default>
                                                              <con3:assign varName="codError">
                                                                <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-7953</con1:id>
                                                                <con3:expr>
                                                                  <con1:xqueryText>"1"</con1:xqueryText>
                                                                </con3:expr>
                                                              </con3:assign>
                                                            </con3:default>
                                                          </con3:ifThenElse>
                                                        </con3:actions>
                                                      </con3:case>
                                                      <con3:case>
                                                        <con3:condition>
                                                          <con1:xqueryText>data($balancesResponse/CODIGO) = '900'</con1:xqueryText>
                                                        </con3:condition>
                                                        <con3:actions>
                                                          <con3:assign varName="codError">
                                                            <con1:id>_ActionId-7896611820126716487--18118bbb.156ec848598.-7e9d</con1:id>
                                                            <con3:expr>
                                                              <con1:xqueryText>"944"</con1:xqueryText>
                                                            </con3:expr>
                                                          </con3:assign>
                                                        </con3:actions>
                                                      </con3:case>
                                                      <con3:default/>
                                                    </con3:ifThenElse>
                                                  </con3:actions>
                                                </con3:case>
                                                <con3:default/>
                                              </con3:ifThenElse>
                                              <con3:ifThenElse>
                                                <con1:id>_ActionId-7896611820126716487--18118bbb.156ec848598.-7e65</con1:id>
                                                <con3:case>
                                                  <con3:condition>
                                                    <con1:xqueryText>$codError = '1'
and contains(data($consultarPaquetesTATResponse/MENSAJE/PAQUETES), 'AIR')</con1:xqueryText>
                                                  </con3:condition>
                                                  <con3:actions>
                                                    <con3:wsCallout>
                                                      <con1:id>_ActionId-7896611820126716487--18118bbb.156ec848598.-7e2d</con1:id>
                                                      <con3:service xsi:type="ref:ProxyRef" ref="ITEL/OCS/AIR/Proxies/consultarOfferOCSLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                                      <con3:operation>consultarOffer</con3:operation>
                                                      <con3:request>
                                                        <con3:body>$consultarOfferRequest</con3:body>
                                                      </con3:request>
                                                      <con3:response>
                                                        <con3:body>consultarOfferResponse</con3:body>
                                                      </con3:response>
                                                      <con3:requestTransform>
                                                        <con3:assign varName="consultarOfferRequest">
                                                          <con1:id>_ActionId-7896611820126716487--18118bbb.156ec848598.-7dbf</con1:id>
                                                          <con3:expr>
                                                            <con1:xqueryTransform>
                                                              <con1:resource ref="ITEL/Core/Resources/XQueries/ejecutarReglasNegocio_Req_consultarOfertas"/>
                                                              <con1:param name="input_Parameters1">
                                                                <con1:path>$body/ejec:Input_Parameters</con1:path>
                                                              </con1:param>
                                                            </con1:xqueryTransform>
                                                          </con3:expr>
                                                        </con3:assign>
                                                      </con3:requestTransform>
                                                      <con3:responseTransform>
                                                        <con3:assign varName="codError">
                                                          <con1:id>_ActionId-7896611820126716487--18118bbb.156ec848598.-7d2e</con1:id>
                                                          <con3:expr>
                                                            <con1:xqueryText>data($consultarOfferResponse/CODIGO)</con1:xqueryText>
                                                          </con3:expr>
                                                        </con3:assign>
                                                      </con3:responseTransform>
                                                    </con3:wsCallout>
                                                    <con3:ifThenElse>
                                                      <con1:id>_ActionId-7896611820126716487--18118bbb.156ec848598.-7d2c</con1:id>
                                                      <con3:case>
                                                        <con3:condition>
                                                          <con1:xqueryText>$codError = '1'</con1:xqueryText>
                                                        </con3:condition>
                                                        <con3:actions>
                                                          <con3:wsCallout>
                                                            <con1:id>_ActionId-7896611820126716487--18118bbb.156ec848598.-7cbb</con1:id>
                                                            <con3:service xsi:type="ref:ProxyRef" ref="ITEL/OCS/AIR/Proxies/consultarUCyUTLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                                            <con3:operation>consultarUCyUT</con3:operation>
                                                            <con3:request>
                                                              <con3:body>$consultarUCyUTRequest</con3:body>
                                                            </con3:request>
                                                            <con3:response>
                                                              <con3:body>consultarUCyUTResponse</con3:body>
                                                            </con3:response>
                                                            <con3:requestTransform>
                                                              <con3:assign varName="consultarUCyUTRequest">
                                                                <con1:id>_ActionId-7896611820126716487--18118bbb.156ec848598.-7c83</con1:id>
                                                                <con3:expr>
                                                                  <con1:xqueryTransform>
                                                                    <con1:resource ref="ITEL/Core/Resources/XQueries/ejecutarReglasNegocio_Req_consultarUTyC"/>
                                                                    <con1:param name="input_Parameters1">
                                                                      <con1:path>$body/ejec:Input_Parameters</con1:path>
                                                                    </con1:param>
                                                                  </con1:xqueryTransform>
                                                                </con3:expr>
                                                              </con3:assign>
                                                            </con3:requestTransform>
                                                            <con3:responseTransform>
                                                              <con3:assign varName="codError">
                                                                <con1:id>_ActionId-7896611820126716487--18118bbb.156ec848598.-7bf1</con1:id>
                                                                <con3:expr>
                                                                  <con1:xqueryText>data($consultarUCyUTResponse/CODIGO)</con1:xqueryText>
                                                                </con3:expr>
                                                              </con3:assign>
                                                            </con3:responseTransform>
                                                          </con3:wsCallout>
                                                          <con3:ifThenElse>
                                                            <con1:id>_ActionId-7896611820126716487--18118bbb.156ec848598.-7b83</con1:id>
                                                            <con3:case>
                                                              <con3:condition>
                                                                <con1:xqueryText>$codError = '1'</con1:xqueryText>
                                                              </con3:condition>
                                                              <con3:actions>
                                                                <con3:assign varName="consultarPaquetesTATResponse">
                                                                  <con1:id>_ActionId-7896611820126716487--18118bbb.156ec848598.-7b4a</con1:id>
                                                                  <con3:expr>
                                                                    <con1:xqueryTransform>
                                                                      <con1:resource ref="ITEL/Core/Resources/XQueries/calcularThresholdCounter"/>
                                                                      <con1:param name="ThresholdCounter">
                                                                        <con1:path>$consultarUCyUTResponse</con1:path>
                                                                      </con1:param>
                                                                      <con1:param name="Ofertas">
                                                                        <con1:path>$consultarOfferResponse</con1:path>
                                                                      </con1:param>
                                                                      <con1:param name="Paquetes">
                                                                        <con1:path>$consultarPaquetesTATResponse</con1:path>
                                                                      </con1:param>
                                                                    </con1:xqueryTransform>
                                                                  </con3:expr>
                                                                </con3:assign>
                                                              </con3:actions>
                                                            </con3:case>
                                                            <con3:default/>
                                                          </con3:ifThenElse>
                                                        </con3:actions>
                                                      </con3:case>
                                                      <con3:default/>
                                                    </con3:ifThenElse>
                                                  </con3:actions>
                                                </con3:case>
                                                <con3:default/>
                                              </con3:ifThenElse>
                                              <con6:assign varName="reglasNegocioResponse" xmlns:con6="http://www.bea.com/wli/sb/stages/transform/config">
                                                <con1:id>_ActionId-1622658894617833341-184acab6.156ed37301e.-7f1e</con1:id>
                                                <con6:expr>
                                                  <con1:xqueryText><![CDATA[<ns0:WS_Result xmlns:ns0="http://www.comcel.com.co/ConsultarReglas/">
	<CODIGO>1</CODIGO>
	<MENSAJE>
		<ERROR>1</ERROR>
		<ERRORDESC></ERRORDESC>
		<CONSULTASUSCRIPTOR>FALSE</CONSULTASUSCRIPTOR>
		<PARAMETROS>
			<PARAMETRO>
				<NOMBRE>VALOR</NOMBRE>
				<TIPO>decimal</TIPO>
				<VALOR>{ data($consultarPaquetesTATResponse/MENSAJE/VALOR) }</VALOR>
			</PARAMETRO>
			<PARAMETRO>
				<NOMBRE>HOSTID</NOMBRE>
				<TIPO>string</TIPO>
				<VALOR>{ data($consultarPaquetesTATResponse/MENSAJE/HOSTID) }</VALOR>
			</PARAMETRO>
			<PARAMETRO>
				<NOMBRE>COMENTARIO</NOMBRE>
				<TIPO>string</TIPO>
				<VALOR>{ data($consultarPaquetesTATResponse/MENSAJE/COMENTARIO) }</VALOR>
			</PARAMETRO>
			<PARAMETRO>
				<NOMBRE>TIPO_PAQUETE</NOMBRE>
				<TIPO>string</TIPO>
				<VALOR>{ data($consultarPaquetesTATResponse/MENSAJE/TIPO) }</VALOR>
			</PARAMETRO>
			<PARAMETRO>
				<NOMBRE>NOTIFICACION</NOMBRE>
				<TIPO>string</TIPO>
				<VALOR>{ data($consultarPaquetesTATResponse/MENSAJE/NOTIFICACION) }</VALOR>
			</PARAMETRO>
			<PARAMETRO>
				<NOMBRE>PAQUETES</NOMBRE>
				<TIPO>string</TIPO>
				<VALOR>{
                        for $PAQUETE in $consultarPaquetesTATResponse/MENSAJE/PAQUETES/PAQUETE
                        return
                            <PAQUETE>
                                <CODIGO_PAQUETE>{ data($PAQUETE/CODIGO_PAQUETE) }</CODIGO_PAQUETE>
                                <PLATAFORMA>{ data($PAQUETE/PLATAFORMA) }</PLATAFORMA>
                            </PAQUETE>
                    }</VALOR>
			</PARAMETRO>
		</PARAMETROS>
	</MENSAJE>
</ns0:WS_Result>]]></con1:xqueryText>
                                                </con6:expr>
                                              </con6:assign>
                                            </con3:actions>
                                          </con3:case>
                                          <con3:case>
                                            <con3:condition>
                                              <con1:xqueryText>$metodo = '401' and number($body/ejec:Input_Parameters/IN_ORIGEN) &lt; 50</con1:xqueryText>
                                            </con3:condition>
                                            <con3:actions>
                                              <con3:wsCallout>
                                                <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-794f</con1:id>
                                                <con3:service xsi:type="ref:ProxyRef" ref="ITEL/Core/Proxies/consultarDatosMinesLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                                <con3:operation>consultarDatosMines</con3:operation>
                                                <con3:request>
                                                  <con3:body>$datos</con3:body>
                                                </con3:request>
                                                <con3:response>
                                                  <con3:body>respMines</con3:body>
                                                </con3:response>
                                                <con3:requestTransform>
                                                  <con3:assign varName="datos">
                                                    <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-7952</con1:id>
                                                    <con3:expr>
                                                      <con1:xqueryTransform>
                                                        <con1:resource ref="ITEL/Core/Resources/XQueries/ejecutarReglasNegocio_Req_consultarDatosMines"/>
                                                        <con1:param name="inOrigen">
                                                          <con1:path>$inOrigen</con1:path>
                                                        </con1:param>
                                                        <con1:param name="timeout">
                                                          <con1:path>$timeout</con1:path>
                                                        </con1:param>
                                                        <con1:param name="minOrigen">
                                                          <con1:path>$minOrigen</con1:path>
                                                        </con1:param>
                                                        <con1:param name="minDestino">
                                                          <con1:path>""</con1:path>
                                                        </con1:param>
                                                        <con1:param name="prefijo">
                                                          <con1:path>$prefijo</con1:path>
                                                        </con1:param>
                                                        <con1:param name="inDestino">
                                                          <con1:path>""</con1:path>
                                                        </con1:param>
                                                      </con1:xqueryTransform>
                                                    </con3:expr>
                                                  </con3:assign>
                                                </con3:requestTransform>
                                                <con3:responseTransform>
                                                  <con3:ifThenElse>
                                                    <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-7951</con1:id>
                                                    <con3:case>
                                                      <con3:condition>
                                                        <con1:xqueryText>data($respMines/CODIGO) != "1"</con1:xqueryText>
                                                      </con3:condition>
                                                      <con3:actions>
                                                        <con3:assign varName="codError">
                                                          <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-7950</con1:id>
                                                          <con3:expr>
                                                            <con1:xqueryText>data($respMines/CODIGO)</con1:xqueryText>
                                                          </con3:expr>
                                                        </con3:assign>
                                                      </con3:actions>
                                                    </con3:case>
                                                    <con3:default/>
                                                  </con3:ifThenElse>
                                                </con3:responseTransform>
                                              </con3:wsCallout>
                                            </con3:actions>
                                          </con3:case>
                                          <con3:case>
                                            <con3:condition>
                                              <con1:xqueryText>$metodo = ('202','203','204','700')</con1:xqueryText>
                                            </con3:condition>
                                            <con3:actions>
                                              <con3:ifThenElse>
                                                <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-794e</con1:id>
                                                <con3:case>
                                                  <con3:condition>
                                                    <con1:xqueryText>data($validarSCMetodoResponse/MENSAJE) = "TRUE"</con1:xqueryText>
                                                  </con3:condition>
                                                  <con3:actions>
                                                    <con1:wsCallout xmlns:con3="http://www.bea.com/wli/sb/typesystem/config" xmlns:con2="http://www.bea.com/wli/sb/stages/config" xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
                                                      <con6:id xmlns:con6="http://www.bea.com/wli/sb/stages/config">_ActionId-8096952212429106120-1bbaa577.15405e544f1.-794a</con6:id>
                                                      <con1:service xsi:type="ref:ProxyRef" ref="ITEL/OCS/AIR/Proxies/consultarFaFListOCSLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                                      <con1:operation>consultarFaFList</con1:operation>
                                                      <con1:request>
                                                        <con1:body>$consultarFaFListRequest</con1:body>
                                                      </con1:request>
                                                      <con1:response>
                                                        <con1:body>consultarFaFListResponse</con1:body>
                                                      </con1:response>
                                                      <con1:requestTransform>
                                                        <con1:assign varName="consultarFaFListRequest">
                                                          <con6:id xmlns:con6="http://www.bea.com/wli/sb/stages/config">_ActionId-8096952212429106120-1bbaa577.15405e544f1.-794d</con6:id>
                                                          <con1:expr>
                                                            <con6:xqueryTransform xmlns:con6="http://www.bea.com/wli/sb/stages/config">
                                                              <con6:resource ref="ITEL/Core/Resources/XQueries/consultarFaFListPS_Req"/>
                                                              <con6:param name="min">
                                                                <con6:path>data($body/ejec:Input_Parameters/MIN_DESTINO)</con6:path>
                                                              </con6:param>
                                                            </con6:xqueryTransform>
                                                          </con1:expr>
                                                        </con1:assign>
                                                      </con1:requestTransform>
                                                      <con1:responseTransform>
                                                        <con1:ifThenElse>
                                                          <con6:id xmlns:con6="http://www.bea.com/wli/sb/stages/config">_ActionId-8096952212429106120-1bbaa577.15405e544f1.-794c</con6:id>
                                                          <con1:case>
                                                            <con1:condition>
                                                              <con6:xqueryText xmlns:con6="http://www.bea.com/wli/sb/stages/config">data($consultarFaFListResponse/CODIGO) != '1'</con6:xqueryText>
                                                            </con1:condition>
                                                            <con1:actions>
                                                              <con6:assign varName="codError" xmlns:con3="http://www.bea.com/wli/sb/stages/transform/config" xmlns:con2="http://www.bea.com/wli/sb/typesystem/config" xmlns:con1="http://www.bea.com/wli/sb/stages/config" xmlns:con6="http://www.bea.com/wli/sb/stages/transform/config">
                                                                <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-794b</con1:id>
                                                                <con6:expr>
                                                                  <con1:xqueryText>data($consultarFaFListResponse/CODIGO)</con1:xqueryText>
                                                                </con6:expr>
                                                              </con6:assign>
                                                            </con1:actions>
                                                          </con1:case>
                                                          <con1:default/>
                                                        </con1:ifThenElse>
                                                      </con1:responseTransform>
                                                    </con1:wsCallout>
                                                    <con3:ifThenElse>
                                                      <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-7949</con1:id>
                                                      <con3:case>
                                                        <con3:condition>
                                                          <con1:xqueryText>$codError = "1" and $metodo = "204"</con1:xqueryText>
                                                        </con3:condition>
                                                        <con3:actions>
                                                          <con3:wsCallout>
                                                            <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-7945</con1:id>
                                                            <con3:service xsi:type="ref:ProxyRef" ref="ITEL/OCS/AIR/Proxies/consultarOfferOCSLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                                            <con3:operation>consultarOffer</con3:operation>
                                                            <con3:request>
                                                              <con3:body>$consultarOfferRequest</con3:body>
                                                            </con3:request>
                                                            <con3:response>
                                                              <con3:body>consultarOfferResponse</con3:body>
                                                            </con3:response>
                                                            <con3:requestTransform>
                                                              <con3:assign varName="consultarOfferRequest">
                                                                <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-7948</con1:id>
                                                                <con3:expr>
                                                                  <con1:xqueryTransform>
                                                                    <con1:resource ref="ITEL/Core/Resources/XQueries/consultarOfferPS_Req"/>
                                                                    <con1:param name="min">
                                                                      <con1:path>data($body/ejec:Input_Parameters/MIN_DESTINO)</con1:path>
                                                                    </con1:param>
                                                                  </con1:xqueryTransform>
                                                                </con3:expr>
                                                              </con3:assign>
                                                            </con3:requestTransform>
                                                            <con3:responseTransform>
                                                              <con1:ifThenElse xmlns:con3="http://www.bea.com/wli/sb/typesystem/config" xmlns:con2="http://www.bea.com/wli/sb/stages/config" xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
                                                                <con6:id xmlns:con6="http://www.bea.com/wli/sb/stages/config">_ActionId-8096952212429106120-1bbaa577.15405e544f1.-7947</con6:id>
                                                                <con1:case>
                                                                  <con1:condition>
                                                                    <con6:xqueryText xmlns:con6="http://www.bea.com/wli/sb/stages/config">data($consultarOfferResponse/CODIGO) != '1'</con6:xqueryText>
                                                                  </con1:condition>
                                                                  <con1:actions>
                                                                    <con6:assign varName="codError" xmlns:con3="http://www.bea.com/wli/sb/stages/transform/config" xmlns:con2="http://www.bea.com/wli/sb/typesystem/config" xmlns:con1="http://www.bea.com/wli/sb/stages/config" xmlns:con6="http://www.bea.com/wli/sb/stages/transform/config">
                                                                      <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-7946</con1:id>
                                                                      <con6:expr>
                                                                        <con1:xqueryText>data($consultarOfferResponse/CODIGO)</con1:xqueryText>
                                                                      </con6:expr>
                                                                    </con6:assign>
                                                                  </con1:actions>
                                                                </con1:case>
                                                                <con1:default/>
                                                              </con1:ifThenElse>
                                                            </con3:responseTransform>
                                                          </con3:wsCallout>
                                                        </con3:actions>
                                                      </con3:case>
                                                      <con3:default/>
                                                    </con3:ifThenElse>
                                                  </con3:actions>
                                                </con3:case>
                                                <con3:default>
                                                  <con1:assign varName="codError" xmlns:con3="http://www.bea.com/wli/sb/typesystem/config" xmlns:con2="http://www.bea.com/wli/sb/stages/config" xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
                                                    <con6:id xmlns:con6="http://www.bea.com/wli/sb/stages/config">_ActionId-8096952212429106120-1bbaa577.15405e544f1.-7944</con6:id>
                                                    <con1:expr>
                                                      <con6:xqueryText xmlns:con6="http://www.bea.com/wli/sb/stages/config">"917"</con6:xqueryText>
                                                    </con1:expr>
                                                  </con1:assign>
                                                </con3:default>
                                              </con3:ifThenElse>
                                              <con3:ifThenElse>
                                                <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-7943</con1:id>
                                                <con3:case>
                                                  <con3:condition>
                                                    <con1:xqueryText>$codError = "1" and 
fn:exists($consultarFaFListResponse/MENSAJE/CONSULTAR_FAFLIST/fafInformationList/Detail/fafIndicator)</con1:xqueryText>
                                                  </con3:condition>
                                                  <con3:actions>
                                                    <con3:wsCallout>
                                                      <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-793f</con1:id>
                                                      <con3:service xsi:type="ref:ProxyRef" ref="ITEL/Core/Proxies/consultarFAFTipoLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                                      <con3:operation>consultarFAFTipo</con3:operation>
                                                      <con3:request>
                                                        <con3:body>$consultarFAFTipoRequest</con3:body>
                                                      </con3:request>
                                                      <con3:response>
                                                        <con3:body>consultarFAFTipoResponse</con3:body>
                                                      </con3:response>
                                                      <con3:requestTransform>
                                                        <con3:assign varName="consultarFAFTipoRequest">
                                                          <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-7942</con1:id>
                                                          <con3:expr>
                                                            <con1:xqueryTransform>
                                                              <con1:resource ref="ITEL/Core/Resources/XQueries/consultarFAFTipoPS_Req"/>
                                                              <con1:param name="wS_Result1">
                                                                <con1:path>$consultarFaFListResponse</con1:path>
                                                              </con1:param>
                                                            </con1:xqueryTransform>
                                                          </con3:expr>
                                                        </con3:assign>
                                                      </con3:requestTransform>
                                                      <con3:responseTransform>
                                                        <con1:ifThenElse xmlns:con3="http://www.bea.com/wli/sb/typesystem/config" xmlns:con2="http://www.bea.com/wli/sb/stages/config" xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
                                                          <con6:id xmlns:con6="http://www.bea.com/wli/sb/stages/config">_ActionId-8096952212429106120-1bbaa577.15405e544f1.-7941</con6:id>
                                                          <con1:case>
                                                            <con1:condition>
                                                              <con6:xqueryText xmlns:con6="http://www.bea.com/wli/sb/stages/config">data($consultarFAFTipoResponse/CODIGO) != 'OK'</con6:xqueryText>
                                                            </con1:condition>
                                                            <con1:actions>
                                                              <con6:assign varName="codError" xmlns:con3="http://www.bea.com/wli/sb/stages/transform/config" xmlns:con2="http://www.bea.com/wli/sb/typesystem/config" xmlns:con1="http://www.bea.com/wli/sb/stages/config" xmlns:con6="http://www.bea.com/wli/sb/stages/transform/config">
                                                                <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-7940</con1:id>
                                                                <con6:expr>
                                                                  <con1:xqueryText>"909"</con1:xqueryText>
                                                                </con6:expr>
                                                              </con6:assign>
                                                            </con1:actions>
                                                          </con1:case>
                                                          <con1:default/>
                                                        </con1:ifThenElse>
                                                      </con3:responseTransform>
                                                    </con3:wsCallout>
                                                  </con3:actions>
                                                </con3:case>
                                                <con3:default/>
                                              </con3:ifThenElse>
                                              <con3:ifThenElse>
                                                <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-793e</con1:id>
                                                <con3:case>
                                                  <con3:condition>
                                                    <con1:xqueryText>$codError = "1" and $metodo = "700" and 
fn:exists($consultarFaFListResponse/MENSAJE/CONSULTAR_FAFLIST/fafInformationList/Detail/fafIndicator)</con1:xqueryText>
                                                  </con3:condition>
                                                  <con3:actions>
                                                    <con3:wsCallout>
                                                      <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-7939</con1:id>
                                                      <con3:service xsi:type="ref:ProxyRef" ref="ITEL/OCS/OLM/Proxies/consultarSuscripcionOCSLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                                      <con3:operation>consultarSuscripcionOCS</con3:operation>
                                                      <con3:request>
                                                        <con3:body>$consultarSuscripcionOCSRequest</con3:body>
                                                      </con3:request>
                                                      <con3:response>
                                                        <con3:body>consultarSuscripcionOCSResponse</con3:body>
                                                      </con3:response>
                                                      <con3:requestTransform>
                                                        <con3:assign varName="consultarSuscripcionOCSRequest">
                                                          <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-793d</con1:id>
                                                          <con3:expr>
                                                            <con1:xqueryTransform>
                                                              <con1:resource ref="ITEL/Core/Resources/XQueries/consultarSuscripcionOCSPS_Req"/>
                                                              <con1:param name="min">
                                                                <con1:path>data($body/ejec:Input_Parameters/MIN_DESTINO)</con1:path>
                                                              </con1:param>
                                                            </con1:xqueryTransform>
                                                          </con3:expr>
                                                        </con3:assign>
                                                      </con3:requestTransform>
                                                      <con3:responseTransform>
                                                        <con3:ifThenElse>
                                                          <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-793c</con1:id>
                                                          <con3:case>
                                                            <con3:condition>
                                                              <con1:xqueryText>data($consultarSuscripcionOCSResponse/CODIGO) != '1' and  data($consultarSuscripcionOCSResponse/CODIGO) != '900'</con1:xqueryText>
                                                            </con3:condition>
                                                            <con3:actions>
                                                              <con3:assign varName="codError">
                                                                <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-793b</con1:id>
                                                                <con3:expr>
                                                                  <con1:xqueryText>"901"</con1:xqueryText>
                                                                </con3:expr>
                                                              </con3:assign>
                                                            </con3:actions>
                                                          </con3:case>
                                                          <con3:default>
                                                            <con1:replace varName="consultarFaFListResponse" contents-only="false" xmlns:con3="http://www.bea.com/wli/sb/typesystem/config" xmlns:con2="http://www.bea.com/wli/sb/stages/config" xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
                                                              <con6:id xmlns:con6="http://www.bea.com/wli/sb/stages/config">_ActionId-8096952212429106120-1bbaa577.15405e544f1.-793a</con6:id>
                                                              <con1:expr>
                                                                <con6:xqueryTransform xmlns:con6="http://www.bea.com/wli/sb/stages/config">
                                                                  <con6:resource ref="ITEL/Core/Resources/XQueries/ejecutarReglasNegocio_Res_consultarFaFList_700"/>
                                                                  <con6:param name="wS_Result3">
                                                                    <con6:path>$consultarSuscripcionOCSResponse</con6:path>
                                                                  </con6:param>
                                                                  <con6:param name="wS_Result2">
                                                                    <con6:path>$consultarFaFListResponse</con6:path>
                                                                  </con6:param>
                                                                  <con6:param name="wS_Result1">
                                                                    <con6:path>$consultarFAFTipoResponse</con6:path>
                                                                  </con6:param>
                                                                </con6:xqueryTransform>
                                                              </con1:expr>
                                                            </con1:replace>
                                                          </con3:default>
                                                        </con3:ifThenElse>
                                                      </con3:responseTransform>
                                                    </con3:wsCallout>
                                                  </con3:actions>
                                                </con3:case>
                                                <con3:case>
                                                  <con3:condition>
                                                    <con1:xqueryText>$codError = "1" and 
fn:exists($consultarFaFListResponse/MENSAJE/CONSULTAR_FAFLIST/fafInformationList/Detail/fafIndicator)</con1:xqueryText>
                                                  </con3:condition>
                                                  <con3:actions>
                                                    <con1:replace varName="consultarFaFListResponse" contents-only="false" xmlns:con3="http://www.bea.com/wli/sb/typesystem/config" xmlns:con2="http://www.bea.com/wli/sb/stages/config" xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
                                                      <con6:id xmlns:con6="http://www.bea.com/wli/sb/stages/config">_ActionId-8096952212429106120-1bbaa577.15405e544f1.-7938</con6:id>
                                                      <con1:expr>
                                                        <con6:xqueryTransform xmlns:con6="http://www.bea.com/wli/sb/stages/config">
                                                          <con6:resource ref="ITEL/Core/Resources/XQueries/ejecutarReglasNegocio_Res_consultarFaFList"/>
                                                          <con6:param name="wS_Result2">
                                                            <con6:path>$consultarFaFListResponse</con6:path>
                                                          </con6:param>
                                                          <con6:param name="wS_Result1">
                                                            <con6:path>$consultarFAFTipoResponse</con6:path>
                                                          </con6:param>
                                                        </con6:xqueryTransform>
                                                      </con1:expr>
                                                    </con1:replace>
                                                    <con3:ifThenElse>
                                                      <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-7937</con1:id>
                                                      <con3:case>
                                                        <con3:condition>
                                                          <con1:xqueryText>$metodo = "204"</con1:xqueryText>
                                                        </con3:condition>
                                                        <con3:actions>
                                                          <con3:replace varName="consultarFaFListResponse">
                                                            <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-7936</con1:id>
                                                            <con3:expr>
                                                              <con1:xqueryTransform>
                                                                <con1:resource ref="ITEL/Core/Resources/XQueries/ejecutarReglasNegocio_Res_consultarFaFListOffers"/>
                                                                <con1:param name="wS_Result2">
                                                                  <con1:path>$consultarFaFListResponse</con1:path>
                                                                </con1:param>
                                                                <con1:param name="wS_Result1">
                                                                  <con1:path>$consultarOfferResponse</con1:path>
                                                                </con1:param>
                                                              </con1:xqueryTransform>
                                                            </con3:expr>
                                                          </con3:replace>
                                                        </con3:actions>
                                                      </con3:case>
                                                      <con3:default/>
                                                    </con3:ifThenElse>
                                                  </con3:actions>
                                                </con3:case>
                                                <con3:default/>
                                              </con3:ifThenElse>
                                            </con3:actions>
                                          </con3:case>
                                          <con3:case>
                                            <con3:condition>
                                              <con1:xqueryText>$metodo = '206'</con1:xqueryText>
                                            </con3:condition>
                                            <con3:actions>
                                              <con3:ifThenElse>
                                                <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-7935</con1:id>
                                                <con3:case>
                                                  <con3:condition>
                                                    <con1:xqueryText>data($validarSCMetodoResponse/MENSAJE) = "TRUE"</con1:xqueryText>
                                                  </con3:condition>
                                                  <con3:actions>
                                                    <con1:wsCallout xmlns:con3="http://www.bea.com/wli/sb/typesystem/config" xmlns:con2="http://www.bea.com/wli/sb/stages/config" xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
                                                      <con6:id xmlns:con6="http://www.bea.com/wli/sb/stages/config">_ActionId-8096952212429106120-1bbaa577.15405e544f1.-7931</con6:id>
                                                      <con1:service xsi:type="ref:ProxyRef" ref="ITEL/OCS/AIR/Proxies/consultarFaFListOCSLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                                      <con1:operation>consultarFaFList</con1:operation>
                                                      <con1:request>
                                                        <con1:body>$consultarFaFListRequest</con1:body>
                                                      </con1:request>
                                                      <con1:response>
                                                        <con1:body>consultarFaFListResponse</con1:body>
                                                      </con1:response>
                                                      <con1:requestTransform>
                                                        <con1:assign varName="consultarFaFListRequest">
                                                          <con6:id xmlns:con6="http://www.bea.com/wli/sb/stages/config">_ActionId-8096952212429106120-1bbaa577.15405e544f1.-7934</con6:id>
                                                          <con1:expr>
                                                            <con6:xqueryTransform xmlns:con6="http://www.bea.com/wli/sb/stages/config">
                                                              <con6:resource ref="ITEL/Core/Resources/XQueries/consultarFaFListPS_Req"/>
                                                              <con6:param name="min">
                                                                <con6:path>data($body/ejec:Input_Parameters/MIN_DESTINO)</con6:path>
                                                              </con6:param>
                                                            </con6:xqueryTransform>
                                                          </con1:expr>
                                                        </con1:assign>
                                                      </con1:requestTransform>
                                                      <con1:responseTransform>
                                                        <con1:ifThenElse>
                                                          <con6:id xmlns:con6="http://www.bea.com/wli/sb/stages/config">_ActionId-8096952212429106120-1bbaa577.15405e544f1.-7933</con6:id>
                                                          <con1:case>
                                                            <con1:condition>
                                                              <con6:xqueryText xmlns:con6="http://www.bea.com/wli/sb/stages/config">data($consultarFaFListResponse/CODIGO) != '1'</con6:xqueryText>
                                                            </con1:condition>
                                                            <con1:actions>
                                                              <con6:assign varName="codError" xmlns:con3="http://www.bea.com/wli/sb/stages/transform/config" xmlns:con2="http://www.bea.com/wli/sb/typesystem/config" xmlns:con1="http://www.bea.com/wli/sb/stages/config" xmlns:con6="http://www.bea.com/wli/sb/stages/transform/config">
                                                                <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-7932</con1:id>
                                                                <con6:expr>
                                                                  <con1:xqueryText>data($consultarFaFListResponse/CODIGO)</con1:xqueryText>
                                                                </con6:expr>
                                                              </con6:assign>
                                                            </con1:actions>
                                                          </con1:case>
                                                          <con1:default/>
                                                        </con1:ifThenElse>
                                                      </con1:responseTransform>
                                                    </con1:wsCallout>
                                                    <con3:ifThenElse>
                                                      <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-7930</con1:id>
                                                      <con3:case>
                                                        <con3:condition>
                                                          <con1:xqueryText>$codError = "1"</con1:xqueryText>
                                                        </con3:condition>
                                                        <con3:actions>
                                                          <con3:wsCallout>
                                                            <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-792c</con1:id>
                                                            <con3:service xsi:type="ref:ProxyRef" ref="ITEL/OCS/AIR/Proxies/consultarOfferOCSLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                                            <con3:operation>consultarOffer</con3:operation>
                                                            <con3:request>
                                                              <con3:body>$consultarOfferRequest</con3:body>
                                                            </con3:request>
                                                            <con3:response>
                                                              <con3:body>consultarOfferResponse</con3:body>
                                                            </con3:response>
                                                            <con3:requestTransform>
                                                              <con3:assign varName="consultarOfferRequest">
                                                                <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-792f</con1:id>
                                                                <con3:expr>
                                                                  <con1:xqueryTransform>
                                                                    <con1:resource ref="ITEL/Core/Resources/XQueries/consultarOfferPS_Req"/>
                                                                    <con1:param name="min">
                                                                      <con1:path>data($body/ejec:Input_Parameters/MIN_DESTINO)</con1:path>
                                                                    </con1:param>
                                                                  </con1:xqueryTransform>
                                                                </con3:expr>
                                                              </con3:assign>
                                                            </con3:requestTransform>
                                                            <con3:responseTransform>
                                                              <con1:ifThenElse xmlns:con3="http://www.bea.com/wli/sb/typesystem/config" xmlns:con2="http://www.bea.com/wli/sb/stages/config" xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
                                                                <con6:id xmlns:con6="http://www.bea.com/wli/sb/stages/config">_ActionId-8096952212429106120-1bbaa577.15405e544f1.-792e</con6:id>
                                                                <con1:case>
                                                                  <con1:condition>
                                                                    <con6:xqueryText xmlns:con6="http://www.bea.com/wli/sb/stages/config">data($consultarOfferResponse/CODIGO) != '1'</con6:xqueryText>
                                                                  </con1:condition>
                                                                  <con1:actions>
                                                                    <con6:assign varName="codError" xmlns:con3="http://www.bea.com/wli/sb/stages/transform/config" xmlns:con2="http://www.bea.com/wli/sb/typesystem/config" xmlns:con1="http://www.bea.com/wli/sb/stages/config" xmlns:con6="http://www.bea.com/wli/sb/stages/transform/config">
                                                                      <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-792d</con1:id>
                                                                      <con6:expr>
                                                                        <con1:xqueryText>data($consultarOfferResponse/CODIGO)</con1:xqueryText>
                                                                      </con6:expr>
                                                                    </con6:assign>
                                                                  </con1:actions>
                                                                </con1:case>
                                                                <con1:default/>
                                                              </con1:ifThenElse>
                                                            </con3:responseTransform>
                                                          </con3:wsCallout>
                                                        </con3:actions>
                                                      </con3:case>
                                                      <con3:default/>
                                                    </con3:ifThenElse>
                                                  </con3:actions>
                                                </con3:case>
                                                <con3:default>
                                                  <con1:assign varName="codError" xmlns:con3="http://www.bea.com/wli/sb/typesystem/config" xmlns:con2="http://www.bea.com/wli/sb/stages/config" xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
                                                    <con6:id xmlns:con6="http://www.bea.com/wli/sb/stages/config">_ActionId-8096952212429106120-1bbaa577.15405e544f1.-792b</con6:id>
                                                    <con1:expr>
                                                      <con6:xqueryText xmlns:con6="http://www.bea.com/wli/sb/stages/config">"917"</con6:xqueryText>
                                                    </con1:expr>
                                                  </con1:assign>
                                                </con3:default>
                                              </con3:ifThenElse>
                                              <con3:ifThenElse>
                                                <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-792a</con1:id>
                                                <con3:case>
                                                  <con3:condition>
                                                    <con1:xqueryText>$codError = "1" and 
fn:exists($consultarFaFListResponse/MENSAJE/CONSULTAR_FAFLIST/fafInformationList/Detail/fafIndicator)</con1:xqueryText>
                                                  </con3:condition>
                                                  <con3:actions>
                                                    <con3:wsCallout>
                                                      <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-7926</con1:id>
                                                      <con3:service xsi:type="ref:ProxyRef" ref="ITEL/Core/Proxies/consultarFAFTipoLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                                      <con3:operation>consultarFAFTipo</con3:operation>
                                                      <con3:request>
                                                        <con3:body>$consultarFAFTipoRequest</con3:body>
                                                      </con3:request>
                                                      <con3:response>
                                                        <con3:body>consultarFAFTipoResponse</con3:body>
                                                      </con3:response>
                                                      <con3:requestTransform>
                                                        <con3:assign varName="consultarFAFTipoRequest">
                                                          <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-7929</con1:id>
                                                          <con3:expr>
                                                            <con1:xqueryTransform>
                                                              <con1:resource ref="ITEL/Core/Resources/XQueries/consultarFAFTipoPS_Req"/>
                                                              <con1:param name="wS_Result1">
                                                                <con1:path>$consultarFaFListResponse</con1:path>
                                                              </con1:param>
                                                            </con1:xqueryTransform>
                                                          </con3:expr>
                                                        </con3:assign>
                                                      </con3:requestTransform>
                                                      <con3:responseTransform>
                                                        <con1:ifThenElse xmlns:con3="http://www.bea.com/wli/sb/typesystem/config" xmlns:con2="http://www.bea.com/wli/sb/stages/config" xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
                                                          <con6:id xmlns:con6="http://www.bea.com/wli/sb/stages/config">_ActionId-8096952212429106120-1bbaa577.15405e544f1.-7928</con6:id>
                                                          <con1:case>
                                                            <con1:condition>
                                                              <con6:xqueryText xmlns:con6="http://www.bea.com/wli/sb/stages/config">data($consultarFAFTipoResponse/CODIGO) != 'OK'</con6:xqueryText>
                                                            </con1:condition>
                                                            <con1:actions>
                                                              <con6:assign varName="codError" xmlns:con3="http://www.bea.com/wli/sb/stages/transform/config" xmlns:con2="http://www.bea.com/wli/sb/typesystem/config" xmlns:con1="http://www.bea.com/wli/sb/stages/config" xmlns:con6="http://www.bea.com/wli/sb/stages/transform/config">
                                                                <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-7927</con1:id>
                                                                <con6:expr>
                                                                  <con1:xqueryText>"909"</con1:xqueryText>
                                                                </con6:expr>
                                                              </con6:assign>
                                                            </con1:actions>
                                                          </con1:case>
                                                          <con1:default/>
                                                        </con1:ifThenElse>
                                                      </con3:responseTransform>
                                                    </con3:wsCallout>
                                                  </con3:actions>
                                                </con3:case>
                                                <con3:default/>
                                              </con3:ifThenElse>
                                              <con3:ifThenElse>
                                                <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-7925</con1:id>
                                                <con3:case>
                                                  <con3:condition>
                                                    <con1:xqueryText>$codError = "1" and 
fn:exists($consultarFaFListResponse/MENSAJE/CONSULTAR_FAFLIST/fafInformationList/Detail/fafIndicator)</con1:xqueryText>
                                                  </con3:condition>
                                                  <con3:actions>
                                                    <con1:replace varName="consultarFaFListResponse" contents-only="false" xmlns:con3="http://www.bea.com/wli/sb/typesystem/config" xmlns:con2="http://www.bea.com/wli/sb/stages/config" xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
                                                      <con6:id xmlns:con6="http://www.bea.com/wli/sb/stages/config">_ActionId-8096952212429106120-1bbaa577.15405e544f1.-7924</con6:id>
                                                      <con1:expr>
                                                        <con6:xqueryTransform xmlns:con6="http://www.bea.com/wli/sb/stages/config">
                                                          <con6:resource ref="ITEL/Core/Resources/XQueries/ejecutarReglasNegocio_Res_consultarFaFList"/>
                                                          <con6:param name="wS_Result2">
                                                            <con6:path>$consultarFaFListResponse</con6:path>
                                                          </con6:param>
                                                          <con6:param name="wS_Result1">
                                                            <con6:path>$consultarFAFTipoResponse</con6:path>
                                                          </con6:param>
                                                        </con6:xqueryTransform>
                                                      </con1:expr>
                                                    </con1:replace>
                                                    <con3:replace varName="consultarFaFListResponse">
                                                      <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-7923</con1:id>
                                                      <con3:expr>
                                                        <con1:xqueryTransform>
                                                          <con1:resource ref="ITEL/Core/Resources/XQueries/ejecutarReglasNegocio_Res_consultarFaFListOffers"/>
                                                          <con1:param name="wS_Result2">
                                                            <con1:path>$consultarFaFListResponse</con1:path>
                                                          </con1:param>
                                                          <con1:param name="wS_Result1">
                                                            <con1:path>$consultarOfferResponse</con1:path>
                                                          </con1:param>
                                                        </con1:xqueryTransform>
                                                      </con3:expr>
                                                    </con3:replace>
                                                  </con3:actions>
                                                </con3:case>
                                                <con3:default/>
                                              </con3:ifThenElse>
                                            </con3:actions>
                                          </con3:case>
                                          <con3:case>
                                            <con3:condition>
                                              <con1:xqueryText>$metodo = ('301','307','309')</con1:xqueryText>
                                            </con3:condition>
                                            <con3:actions>
                                              <con3:assign varName="fafID">
                                                <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-7922</con1:id>
                                                <con3:expr>
                                                  <con1:xqueryText>if($metodo = '301') then
	data($body/ejec:Input_Parameters/PARAMETROS_TRAMA/PARAMETRO[NOMBRE='COMENTARIO']/VALOR)
else
""</con1:xqueryText>
                                                </con3:expr>
                                              </con3:assign>
                                              <con1:ifThenElse xmlns:con3="http://www.bea.com/wli/sb/typesystem/config" xmlns:con2="http://www.bea.com/wli/sb/stages/config" xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
                                                <con6:comment xmlns:con6="http://www.bea.com/wli/sb/stages/config">Obtencion faf id</con6:comment>
                                                <con6:id xmlns:con6="http://www.bea.com/wli/sb/stages/config">_ActionId-8096952212429106120-1bbaa577.15405e544f1.-7921</con6:id>
                                                <con1:case>
                                                  <con1:condition>
                                                    <con6:xqueryText xmlns:con6="http://www.bea.com/wli/sb/stages/config">not(exists($fafID)) or $fafID=""</con6:xqueryText>
                                                  </con1:condition>
                                                  <con1:actions>
                                                    <con1:wsCallout>
                                                      <con6:id xmlns:con6="http://www.bea.com/wli/sb/stages/config">_ActionId-8096952212429106120-1bbaa577.15405e544f1.-791b</con6:id>
                                                      <con1:service xsi:type="ref:ProxyRef" ref="ITEL/Core/Proxies/consultarFAFIDVigenciaLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                                      <con1:operation>consultarFAFIDVigencia</con1:operation>
                                                      <con1:request>
                                                        <con1:body>$fafIdVigenciaRequest</con1:body>
                                                      </con1:request>
                                                      <con1:response>
                                                        <con1:body>fafIdVigenciaResponse</con1:body>
                                                      </con1:response>
                                                      <con1:requestTransform>
                                                        <con1:assign varName="fafIdVigenciaRequest">
                                                          <con6:id xmlns:con6="http://www.bea.com/wli/sb/stages/config">_ActionId-8096952212429106120-1bbaa577.15405e544f1.-7920</con6:id>
                                                          <con1:expr>
                                                            <con6:xqueryTransform xmlns:con6="http://www.bea.com/wli/sb/stages/config">
                                                              <con6:resource ref="ITEL/Core/Resources/XQueries/consultarFAFIDVigenciaPS_Req"/>
                                                              <con6:param name="serviceClass">
                                                                <con6:path>number(data($suscriptorOCSResponse/MENSAJE/CONSULTAR_SUSCRIPTOR/*:suscriptor/*:PublicRatePlanCode))</con6:path>
                                                              </con6:param>
                                                              <con6:param name="tipo">
                                                                <con6:path>"ILIMITADO"</con6:path>
                                                              </con6:param>
                                                              <con6:param name="fafIdGroup">
                                                                <con6:path>data($suscriptorOCSResponse/MENSAJE/CONSULTAR_SUSCRIPTOR/*:suscriptor/*:AccountGroupID)</con6:path>
                                                              </con6:param>
                                                              <con6:param name="vigencia">
                                                                <con6:path>if(data($body/ejec:Input_Parameters/PARAMETROS_TRAMA/PARAMETRO[NOMBRE='DIASVIGENCIA']/VALOR)="") then 
data($body/ejec:Input_Parameters/VIGENCIA)
else
data($body/ejec:Input_Parameters/PARAMETROS_TRAMA/PARAMETRO[NOMBRE='DIASVIGENCIA']/VALOR)</con6:path>
                                                              </con6:param>
                                                            </con6:xqueryTransform>
                                                          </con1:expr>
                                                        </con1:assign>
                                                      </con1:requestTransform>
                                                      <con1:responseTransform>
                                                        <con1:ifThenElse>
                                                          <con6:id xmlns:con6="http://www.bea.com/wli/sb/stages/config">_ActionId-8096952212429106120-1bbaa577.15405e544f1.-791f</con6:id>
                                                          <con1:case>
                                                            <con1:condition>
                                                              <con6:xqueryText xmlns:con6="http://www.bea.com/wli/sb/stages/config">$fafIdVigenciaResponse/CODIGO = "OK" and data($fafIdVigenciaResponse/MENSAJE/FAFID)!=""</con6:xqueryText>
                                                            </con1:condition>
                                                            <con1:actions>
                                                              <con6:assign varName="reglasNegocioResponse" xmlns:con3="http://www.bea.com/wli/sb/stages/transform/config" xmlns:con2="http://www.bea.com/wli/sb/typesystem/config" xmlns:con1="http://www.bea.com/wli/sb/stages/config" xmlns:con6="http://www.bea.com/wli/sb/stages/transform/config">
                                                                <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-791e</con1:id>
                                                                <con6:expr>
                                                                  <con1:xqueryText><![CDATA[<ns0:WS_Result xmlns:ns0="http://www.comcel.com.co/ConsultarReglas/">
	<CODIGO>1</CODIGO>
	<MENSAJE>
		<ERROR>1</ERROR>
		<ERRORDESC></ERRORDESC>
		<CONSULTASUSCRIPTOR>FALSE</CONSULTASUSCRIPTOR>
		<PARAMETROS>
			<PARAMETRO>
				<NOMBRE>FAFID</NOMBRE>
				<TIPO>string</TIPO>
				<VALOR>{ data($fafIdVigenciaResponse/MENSAJE/FAFID) }</VALOR>
			</PARAMETRO>
			<PARAMETRO>
				<NOMBRE>VIGENCIA_DEFECTO</NOMBRE>
				<TIPO>string</TIPO>
				<VALOR>{ data($body/ejec:Input_Parameters/VIGENCIA) }</VALOR>
			</PARAMETRO>
		</PARAMETROS>
	</MENSAJE>
</ns0:WS_Result>]]></con1:xqueryText>
                                                                </con6:expr>
                                                              </con6:assign>
                                                            </con1:actions>
                                                          </con1:case>
                                                          <con1:case>
                                                            <con1:condition>
                                                              <con6:xqueryText xmlns:con6="http://www.bea.com/wli/sb/stages/config">$fafIdVigenciaResponse/CODIGO = "OK" and data($fafIdVigenciaResponse/MENSAJE/FAFID)=""</con6:xqueryText>
                                                            </con1:condition>
                                                            <con1:actions>
                                                              <con1:assign varName="codError">
                                                                <con6:id xmlns:con6="http://www.bea.com/wli/sb/stages/config">_ActionId-8096952212429106120-1bbaa577.15405e544f1.-791d</con6:id>
                                                                <con1:expr>
                                                                  <con6:xqueryText xmlns:con6="http://www.bea.com/wli/sb/stages/config">"19"</con6:xqueryText>
                                                                </con1:expr>
                                                              </con1:assign>
                                                            </con1:actions>
                                                          </con1:case>
                                                          <con1:default>
                                                            <con1:assign varName="codError">
                                                              <con6:id xmlns:con6="http://www.bea.com/wli/sb/stages/config">_ActionId-8096952212429106120-1bbaa577.15405e544f1.-791c</con6:id>
                                                              <con1:expr>
                                                                <con6:xqueryText xmlns:con6="http://www.bea.com/wli/sb/stages/config">"909"</con6:xqueryText>
                                                              </con1:expr>
                                                            </con1:assign>
                                                          </con1:default>
                                                        </con1:ifThenElse>
                                                      </con1:responseTransform>
                                                    </con1:wsCallout>
                                                  </con1:actions>
                                                </con1:case>
                                                <con1:default>
                                                  <con6:assign varName="reglasNegocioResponse" xmlns:con3="http://www.bea.com/wli/sb/stages/transform/config" xmlns:con2="http://www.bea.com/wli/sb/typesystem/config" xmlns:con1="http://www.bea.com/wli/sb/stages/config" xmlns:con6="http://www.bea.com/wli/sb/stages/transform/config">
                                                    <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-791a</con1:id>
                                                    <con6:expr>
                                                      <con1:xqueryText><![CDATA[<ns0:WS_Result xmlns:ns0="http://www.comcel.com.co/ConsultarReglas/">
	<CODIGO>1</CODIGO>
	<MENSAJE>
		<ERROR>1</ERROR>
		<ERRORDESC></ERRORDESC>
		<CONSULTASUSCRIPTOR>FALSE</CONSULTASUSCRIPTOR>
		<PARAMETROS>
			<PARAMETRO>
				<NOMBRE>FAFID</NOMBRE>
				<TIPO>string</TIPO>
				<VALOR>{ $fafID }</VALOR>
			</PARAMETRO>
			<PARAMETRO>
				<NOMBRE>VIGENCIA_DEFECTO</NOMBRE>
				<TIPO>string</TIPO>
				<VALOR>{ data($body/ejec:Input_Parameters/VIGENCIA) }</VALOR>
			</PARAMETRO>
		</PARAMETROS>
	</MENSAJE>
</ns0:WS_Result>]]></con1:xqueryText>
                                                    </con6:expr>
                                                  </con6:assign>
                                                </con1:default>
                                              </con1:ifThenElse>
                                              <con3:ifThenElse>
                                                <con1:comment>309</con1:comment>
                                                <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-7919</con1:id>
                                                <con3:case>
                                                  <con3:condition>
                                                    <con1:xqueryText>$codError = "1" and $metodo = "309"</con1:xqueryText>
                                                  </con3:condition>
                                                  <con3:actions>
                                                    <con1:wsCallout xmlns:con3="http://www.bea.com/wli/sb/typesystem/config" xmlns:con2="http://www.bea.com/wli/sb/stages/config" xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
                                                      <con6:id xmlns:con6="http://www.bea.com/wli/sb/stages/config">_ActionId-8096952212429106120-1bbaa577.15405e544f1.-7917</con6:id>
                                                      <con1:service xsi:type="ref:ProxyRef" ref="ITEL/OCS/AIR/Proxies/consultarFaFListOCSLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                                      <con1:operation>consultarFaFList</con1:operation>
                                                      <con1:request>
                                                        <con1:body>$consultarFaFListRequest</con1:body>
                                                      </con1:request>
                                                      <con1:response>
                                                        <con1:body>consultarFaFListResponse</con1:body>
                                                      </con1:response>
                                                      <con1:requestTransform>
                                                        <con1:assign varName="consultarFaFListRequest">
                                                          <con6:id xmlns:con6="http://www.bea.com/wli/sb/stages/config">_ActionId-8096952212429106120-1bbaa577.15405e544f1.-7918</con6:id>
                                                          <con1:expr>
                                                            <con6:xqueryTransform xmlns:con6="http://www.bea.com/wli/sb/stages/config">
                                                              <con6:resource ref="ITEL/Core/Resources/XQueries/consultarFaFListPS_Req"/>
                                                              <con6:param name="min">
                                                                <con6:path>data($body/ejec:Input_Parameters/MIN_DESTINO)</con6:path>
                                                              </con6:param>
                                                            </con6:xqueryTransform>
                                                          </con1:expr>
                                                        </con1:assign>
                                                      </con1:requestTransform>
                                                      <con1:responseTransform/>
                                                    </con1:wsCallout>
                                                    <con3:wsCallout>
                                                      <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-7913</con1:id>
                                                      <con3:service xsi:type="ref:ProxyRef" ref="ITEL/OCS/AIR/Proxies/consultarOfferOCSLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                                      <con3:operation>consultarOffer</con3:operation>
                                                      <con3:request>
                                                        <con3:body>$consultarOfferRequest</con3:body>
                                                      </con3:request>
                                                      <con3:response>
                                                        <con3:body>consultarOfferResponse</con3:body>
                                                      </con3:response>
                                                      <con3:requestTransform>
                                                        <con3:assign varName="consultarOfferRequest">
                                                          <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-7916</con1:id>
                                                          <con3:expr>
                                                            <con1:xqueryTransform>
                                                              <con1:resource ref="ITEL/Core/Resources/XQueries/consultarOfferPS_Req"/>
                                                              <con1:param name="min">
                                                                <con1:path>data($body/ejec:Input_Parameters/MIN_DESTINO)</con1:path>
                                                              </con1:param>
                                                            </con1:xqueryTransform>
                                                          </con3:expr>
                                                        </con3:assign>
                                                      </con3:requestTransform>
                                                      <con3:responseTransform>
                                                        <con1:ifThenElse xmlns:con3="http://www.bea.com/wli/sb/typesystem/config" xmlns:con2="http://www.bea.com/wli/sb/stages/config" xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
                                                          <con6:id xmlns:con6="http://www.bea.com/wli/sb/stages/config">_ActionId-8096952212429106120-1bbaa577.15405e544f1.-7915</con6:id>
                                                          <con1:case>
                                                            <con1:condition>
                                                              <con6:xqueryText xmlns:con6="http://www.bea.com/wli/sb/stages/config">data($consultarOfferResponse/CODIGO) != '1'</con6:xqueryText>
                                                            </con1:condition>
                                                            <con1:actions>
                                                              <con6:assign varName="codError" xmlns:con3="http://www.bea.com/wli/sb/stages/transform/config" xmlns:con2="http://www.bea.com/wli/sb/typesystem/config" xmlns:con1="http://www.bea.com/wli/sb/stages/config" xmlns:con6="http://www.bea.com/wli/sb/stages/transform/config">
                                                                <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-7914</con1:id>
                                                                <con6:expr>
                                                                  <con1:xqueryText>data($consultarOfferResponse/CODIGO)</con1:xqueryText>
                                                                </con6:expr>
                                                              </con6:assign>
                                                            </con1:actions>
                                                          </con1:case>
                                                          <con1:default/>
                                                        </con1:ifThenElse>
                                                      </con3:responseTransform>
                                                    </con3:wsCallout>
                                                    <con3:ifThenElse>
                                                      <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-7912</con1:id>
                                                      <con3:case>
                                                        <con3:condition>
                                                          <con1:xqueryText>$codError = "1" and 
fn:exists($consultarFaFListResponse/MENSAJE/CONSULTAR_FAFLIST/fafInformationList/Detail/fafIndicator)</con1:xqueryText>
                                                        </con3:condition>
                                                        <con3:actions>
                                                          <con3:wsCallout>
                                                            <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-790e</con1:id>
                                                            <con3:service xsi:type="ref:ProxyRef" ref="ITEL/Core/Proxies/consultarFAFTipoLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                                            <con3:operation>consultarFAFTipo</con3:operation>
                                                            <con3:request>
                                                              <con3:body>$consultarFAFTipoRequest</con3:body>
                                                            </con3:request>
                                                            <con3:response>
                                                              <con3:body>consultarFAFTipoResponse</con3:body>
                                                            </con3:response>
                                                            <con3:requestTransform>
                                                              <con3:assign varName="consultarFAFTipoRequest">
                                                                <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-7911</con1:id>
                                                                <con3:expr>
                                                                  <con1:xqueryTransform>
                                                                    <con1:resource ref="ITEL/Core/Resources/XQueries/consultarFAFTipoPS_Req"/>
                                                                    <con1:param name="wS_Result1">
                                                                      <con1:path>$consultarFaFListResponse</con1:path>
                                                                    </con1:param>
                                                                  </con1:xqueryTransform>
                                                                </con3:expr>
                                                              </con3:assign>
                                                            </con3:requestTransform>
                                                            <con3:responseTransform>
                                                              <con1:ifThenElse xmlns:con3="http://www.bea.com/wli/sb/typesystem/config" xmlns:con2="http://www.bea.com/wli/sb/stages/config" xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
                                                                <con6:id xmlns:con6="http://www.bea.com/wli/sb/stages/config">_ActionId-8096952212429106120-1bbaa577.15405e544f1.-7910</con6:id>
                                                                <con1:case>
                                                                  <con1:condition>
                                                                    <con6:xqueryText xmlns:con6="http://www.bea.com/wli/sb/stages/config">data($consultarFAFTipoResponse/CODIGO) != 'OK'</con6:xqueryText>
                                                                  </con1:condition>
                                                                  <con1:actions>
                                                                    <con6:assign varName="codError" xmlns:con3="http://www.bea.com/wli/sb/stages/transform/config" xmlns:con2="http://www.bea.com/wli/sb/typesystem/config" xmlns:con1="http://www.bea.com/wli/sb/stages/config" xmlns:con6="http://www.bea.com/wli/sb/stages/transform/config">
                                                                      <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-790f</con1:id>
                                                                      <con6:expr>
                                                                        <con1:xqueryText>"909"</con1:xqueryText>
                                                                      </con6:expr>
                                                                    </con6:assign>
                                                                  </con1:actions>
                                                                </con1:case>
                                                                <con1:default/>
                                                              </con1:ifThenElse>
                                                            </con3:responseTransform>
                                                          </con3:wsCallout>
                                                        </con3:actions>
                                                      </con3:case>
                                                      <con3:default/>
                                                    </con3:ifThenElse>
                                                    <con3:ifThenElse>
                                                      <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-790d</con1:id>
                                                      <con3:case>
                                                        <con3:condition>
                                                          <con1:xqueryText>$codError = "1" and 
fn:exists($consultarFaFListResponse/MENSAJE/CONSULTAR_FAFLIST/fafInformationList/Detail/fafIndicator)</con1:xqueryText>
                                                        </con3:condition>
                                                        <con3:actions>
                                                          <con3:replace varName="consultarFaFListResponse">
                                                            <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-790c</con1:id>
                                                            <con3:expr>
                                                              <con1:xqueryTransform>
                                                                <con1:resource ref="ITEL/Core/Resources/XQueries/ejecutarReglasNegocio_Res_consultarFaFList"/>
                                                                <con1:param name="wS_Result2">
                                                                  <con1:path>$consultarFaFListResponse</con1:path>
                                                                </con1:param>
                                                                <con1:param name="wS_Result1">
                                                                  <con1:path>$consultarFAFTipoResponse</con1:path>
                                                                </con1:param>
                                                              </con1:xqueryTransform>
                                                            </con3:expr>
                                                          </con3:replace>
                                                        </con3:actions>
                                                      </con3:case>
                                                      <con3:default>
                                                        <con3:replace varName="consultarFaFListResponse">
                                                          <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-790b</con1:id>
                                                          <con3:expr>
                                                            <con1:xqueryTransform>
                                                              <con1:resource ref="ITEL/Core/Resources/XQueries/ejecutarReglasNegocio_Res_consultarFaFListOffers"/>
                                                              <con1:param name="wS_Result2">
                                                                <con1:path>$consultarFaFListResponse</con1:path>
                                                              </con1:param>
                                                              <con1:param name="wS_Result1">
                                                                <con1:path>$consultarOfferResponse</con1:path>
                                                              </con1:param>
                                                            </con1:xqueryTransform>
                                                          </con3:expr>
                                                        </con3:replace>
                                                      </con3:default>
                                                    </con3:ifThenElse>
                                                  </con3:actions>
                                                </con3:case>
                                                <con3:case>
                                                  <con3:condition>
                                                    <con1:xqueryText>$metodo = "307"</con1:xqueryText>
                                                  </con3:condition>
                                                  <con3:actions>
                                                    <con3:wsCallout>
                                                      <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-7907</con1:id>
                                                      <con3:service xsi:type="ref:ProxyRef" ref="ITEL/OCS/AIR/Proxies/consultarFaFListOCSLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                                      <con3:operation>consultarFaFList</con3:operation>
                                                      <con3:request>
                                                        <con3:body>$consultarFaFListRequest</con3:body>
                                                      </con3:request>
                                                      <con3:response>
                                                        <con3:body>consultarFaFListResponse</con3:body>
                                                      </con3:response>
                                                      <con3:requestTransform>
                                                        <con1:assign varName="consultarFaFListRequest" xmlns:con3="http://www.bea.com/wli/sb/typesystem/config" xmlns:con2="http://www.bea.com/wli/sb/stages/config" xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
                                                          <con6:id xmlns:con6="http://www.bea.com/wli/sb/stages/config">_ActionId-8096952212429106120-1bbaa577.15405e544f1.-790a</con6:id>
                                                          <con1:expr>
                                                            <con6:xqueryTransform xmlns:con6="http://www.bea.com/wli/sb/stages/config">
                                                              <con6:resource ref="ITEL/Core/Resources/XQueries/consultarFaFListPS_Req"/>
                                                              <con6:param name="min">
                                                                <con6:path>data($body/ejec:Input_Parameters/MIN_DESTINO)</con6:path>
                                                              </con6:param>
                                                            </con6:xqueryTransform>
                                                          </con1:expr>
                                                        </con1:assign>
                                                      </con3:requestTransform>
                                                      <con3:responseTransform>
                                                        <con1:ifThenElse xmlns:con3="http://www.bea.com/wli/sb/typesystem/config" xmlns:con2="http://www.bea.com/wli/sb/stages/config" xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
                                                          <con6:id xmlns:con6="http://www.bea.com/wli/sb/stages/config">_ActionId-8096952212429106120-1bbaa577.15405e544f1.-7909</con6:id>
                                                          <con1:case>
                                                            <con1:condition>
                                                              <con6:xqueryText xmlns:con6="http://www.bea.com/wli/sb/stages/config">data($consultarFaFListResponse/CODIGO) != '1'</con6:xqueryText>
                                                            </con1:condition>
                                                            <con1:actions>
                                                              <con6:assign varName="codError" xmlns:con3="http://www.bea.com/wli/sb/stages/transform/config" xmlns:con2="http://www.bea.com/wli/sb/typesystem/config" xmlns:con1="http://www.bea.com/wli/sb/stages/config" xmlns:con6="http://www.bea.com/wli/sb/stages/transform/config">
                                                                <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-7908</con1:id>
                                                                <con6:expr>
                                                                  <con1:xqueryText>data($consultarFaFListResponse/CODIGO)</con1:xqueryText>
                                                                </con6:expr>
                                                              </con6:assign>
                                                            </con1:actions>
                                                          </con1:case>
                                                          <con1:default/>
                                                        </con1:ifThenElse>
                                                      </con3:responseTransform>
                                                    </con3:wsCallout>
                                                    <con3:wsCallout>
                                                      <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-7903</con1:id>
                                                      <con3:service xsi:type="ref:ProxyRef" ref="ITEL/OCS/AIR/Proxies/consultarOfferOCSLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                                      <con3:operation>consultarOffer</con3:operation>
                                                      <con3:request>
                                                        <con3:body>$consultarOfferRequest</con3:body>
                                                      </con3:request>
                                                      <con3:response>
                                                        <con3:body>consultarOfferResponse</con3:body>
                                                      </con3:response>
                                                      <con3:requestTransform>
                                                        <con3:assign varName="consultarOfferRequest">
                                                          <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-7906</con1:id>
                                                          <con3:expr>
                                                            <con1:xqueryTransform>
                                                              <con1:resource ref="ITEL/Core/Resources/XQueries/consultarOfferPS_Req"/>
                                                              <con1:param name="min">
                                                                <con1:path>data($body/ejec:Input_Parameters/MIN_DESTINO)</con1:path>
                                                              </con1:param>
                                                            </con1:xqueryTransform>
                                                          </con3:expr>
                                                        </con3:assign>
                                                      </con3:requestTransform>
                                                      <con3:responseTransform>
                                                        <con1:ifThenElse xmlns:con3="http://www.bea.com/wli/sb/typesystem/config" xmlns:con2="http://www.bea.com/wli/sb/stages/config" xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
                                                          <con6:id xmlns:con6="http://www.bea.com/wli/sb/stages/config">_ActionId-8096952212429106120-1bbaa577.15405e544f1.-7905</con6:id>
                                                          <con1:case>
                                                            <con1:condition>
                                                              <con6:xqueryText xmlns:con6="http://www.bea.com/wli/sb/stages/config">data($consultarOfferResponse/CODIGO) != '1'</con6:xqueryText>
                                                            </con1:condition>
                                                            <con1:actions>
                                                              <con6:assign varName="codError" xmlns:con3="http://www.bea.com/wli/sb/stages/transform/config" xmlns:con2="http://www.bea.com/wli/sb/typesystem/config" xmlns:con1="http://www.bea.com/wli/sb/stages/config" xmlns:con6="http://www.bea.com/wli/sb/stages/transform/config">
                                                                <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-7904</con1:id>
                                                                <con6:expr>
                                                                  <con1:xqueryText>data($consultarOfferResponse/CODIGO)</con1:xqueryText>
                                                                </con6:expr>
                                                              </con6:assign>
                                                            </con1:actions>
                                                          </con1:case>
                                                          <con1:default/>
                                                        </con1:ifThenElse>
                                                      </con3:responseTransform>
                                                    </con3:wsCallout>
                                                    <con3:ifThenElse>
                                                      <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-7902</con1:id>
                                                      <con3:case>
                                                        <con3:condition>
                                                          <con1:xqueryText>$codError = "1" and 
fn:exists($consultarFaFListResponse/MENSAJE/CONSULTAR_FAFLIST/fafInformationList/Detail/fafIndicator)</con1:xqueryText>
                                                        </con3:condition>
                                                        <con3:actions>
                                                          <con3:wsCallout>
                                                            <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-78fe</con1:id>
                                                            <con3:service xsi:type="ref:ProxyRef" ref="ITEL/Core/Proxies/consultarFAFTipoLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                                            <con3:operation>consultarFAFTipo</con3:operation>
                                                            <con3:request>
                                                              <con3:body>$consultarFAFTipoRequest</con3:body>
                                                            </con3:request>
                                                            <con3:response>
                                                              <con3:body>consultarFAFTipoResponse</con3:body>
                                                            </con3:response>
                                                            <con3:requestTransform>
                                                              <con3:assign varName="consultarFAFTipoRequest">
                                                                <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-7901</con1:id>
                                                                <con3:expr>
                                                                  <con1:xqueryTransform>
                                                                    <con1:resource ref="ITEL/Core/Resources/XQueries/consultarFAFTipoPS_Req"/>
                                                                    <con1:param name="wS_Result1">
                                                                      <con1:path>$consultarFaFListResponse</con1:path>
                                                                    </con1:param>
                                                                  </con1:xqueryTransform>
                                                                </con3:expr>
                                                              </con3:assign>
                                                            </con3:requestTransform>
                                                            <con3:responseTransform>
                                                              <con1:ifThenElse xmlns:con3="http://www.bea.com/wli/sb/typesystem/config" xmlns:con2="http://www.bea.com/wli/sb/stages/config" xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
                                                                <con6:id xmlns:con6="http://www.bea.com/wli/sb/stages/config">_ActionId-8096952212429106120-1bbaa577.15405e544f1.-7900</con6:id>
                                                                <con1:case>
                                                                  <con1:condition>
                                                                    <con6:xqueryText xmlns:con6="http://www.bea.com/wli/sb/stages/config">data($consultarFAFTipoResponse/CODIGO) != 'OK'</con6:xqueryText>
                                                                  </con1:condition>
                                                                  <con1:actions>
                                                                    <con6:assign varName="codError" xmlns:con3="http://www.bea.com/wli/sb/stages/transform/config" xmlns:con2="http://www.bea.com/wli/sb/typesystem/config" xmlns:con1="http://www.bea.com/wli/sb/stages/config" xmlns:con6="http://www.bea.com/wli/sb/stages/transform/config">
                                                                      <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-78ff</con1:id>
                                                                      <con6:expr>
                                                                        <con1:xqueryText>"909"</con1:xqueryText>
                                                                      </con6:expr>
                                                                    </con6:assign>
                                                                  </con1:actions>
                                                                </con1:case>
                                                                <con1:default/>
                                                              </con1:ifThenElse>
                                                            </con3:responseTransform>
                                                          </con3:wsCallout>
                                                        </con3:actions>
                                                      </con3:case>
                                                      <con3:default/>
                                                    </con3:ifThenElse>
                                                    <con3:ifThenElse>
                                                      <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-78fd</con1:id>
                                                      <con3:case>
                                                        <con3:condition>
                                                          <con1:xqueryText>$codError = "1" and 
fn:exists($consultarFaFListResponse/MENSAJE/CONSULTAR_FAFLIST/fafInformationList/Detail/fafIndicator)</con1:xqueryText>
                                                        </con3:condition>
                                                        <con3:actions>
                                                          <con3:replace varName="consultarFaFListRes">
                                                            <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-78fc</con1:id>
                                                            <con3:expr>
                                                              <con1:xqueryTransform>
                                                                <con1:resource ref="ITEL/Core/Resources/XQueries/ejecutarReglasNegocio_Res_consultarFaFList"/>
                                                                <con1:param name="wS_Result2">
                                                                  <con1:path>$consultarFaFListResponse</con1:path>
                                                                </con1:param>
                                                                <con1:param name="wS_Result1">
                                                                  <con1:path>$consultarFAFTipoResponse</con1:path>
                                                                </con1:param>
                                                              </con1:xqueryTransform>
                                                            </con3:expr>
                                                          </con3:replace>
                                                        </con3:actions>
                                                      </con3:case>
                                                      <con3:default>
                                                        <con3:replace varName="consultarFaFListRes">
                                                          <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-78fb</con1:id>
                                                          <con3:expr>
                                                            <con1:xqueryTransform>
                                                              <con1:resource ref="ITEL/Core/Resources/XQueries/ejecutarReglasNegocio_Res_consultarFaFListOffers"/>
                                                              <con1:param name="wS_Result2">
                                                                <con1:path>$consultarFaFListResponse</con1:path>
                                                              </con1:param>
                                                              <con1:param name="wS_Result1">
                                                                <con1:path>$consultarOfferResponse</con1:path>
                                                              </con1:param>
                                                            </con1:xqueryTransform>
                                                          </con3:expr>
                                                        </con3:replace>
                                                      </con3:default>
                                                    </con3:ifThenElse>
                                                  </con3:actions>
                                                </con3:case>
                                                <con3:default/>
                                              </con3:ifThenElse>
                                              <con3:ifThenElse>
                                                <con1:comment>301</con1:comment>
                                                <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-78fa</con1:id>
                                                <con3:case>
                                                  <con3:condition>
                                                    <con1:xqueryText>$metodo = "301"</con1:xqueryText>
                                                  </con3:condition>
                                                  <con3:actions>
                                                    <con3:wsCallout>
                                                      <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-78f6</con1:id>
                                                      <con3:service xsi:type="ref:ProxyRef" ref="ITEL/OCS/AIR/Proxies/consultarFaFListOCSLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                                      <con3:operation>consultarFaFList</con3:operation>
                                                      <con3:request>
                                                        <con3:body>$consultarFaFListRequest</con3:body>
                                                      </con3:request>
                                                      <con3:response>
                                                        <con3:body>consultarFaFListResponse</con3:body>
                                                      </con3:response>
                                                      <con3:requestTransform>
                                                        <con1:assign varName="consultarFaFListRequest" xmlns:con3="http://www.bea.com/wli/sb/typesystem/config" xmlns:con2="http://www.bea.com/wli/sb/stages/config" xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
                                                          <con6:id xmlns:con6="http://www.bea.com/wli/sb/stages/config">_ActionId-8096952212429106120-1bbaa577.15405e544f1.-78f9</con6:id>
                                                          <con1:expr>
                                                            <con6:xqueryTransform xmlns:con6="http://www.bea.com/wli/sb/stages/config">
                                                              <con6:resource ref="ITEL/Core/Resources/XQueries/consultarFaFListPS_Req"/>
                                                              <con6:param name="min">
                                                                <con6:path>data($body/ejec:Input_Parameters/MIN_DESTINO)</con6:path>
                                                              </con6:param>
                                                            </con6:xqueryTransform>
                                                          </con1:expr>
                                                        </con1:assign>
                                                      </con3:requestTransform>
                                                      <con3:responseTransform>
                                                        <con1:ifThenElse xmlns:con3="http://www.bea.com/wli/sb/typesystem/config" xmlns:con2="http://www.bea.com/wli/sb/stages/config" xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
                                                          <con6:id xmlns:con6="http://www.bea.com/wli/sb/stages/config">_ActionId-8096952212429106120-1bbaa577.15405e544f1.-78f8</con6:id>
                                                          <con1:case>
                                                            <con1:condition>
                                                              <con6:xqueryText xmlns:con6="http://www.bea.com/wli/sb/stages/config">data($consultarFaFListResponse/CODIGO) != '1'</con6:xqueryText>
                                                            </con1:condition>
                                                            <con1:actions>
                                                              <con6:assign varName="codError" xmlns:con3="http://www.bea.com/wli/sb/stages/transform/config" xmlns:con2="http://www.bea.com/wli/sb/typesystem/config" xmlns:con1="http://www.bea.com/wli/sb/stages/config" xmlns:con6="http://www.bea.com/wli/sb/stages/transform/config">
                                                                <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-78f7</con1:id>
                                                                <con6:expr>
                                                                  <con1:xqueryText>data($consultarFaFListResponse/CODIGO)</con1:xqueryText>
                                                                </con6:expr>
                                                              </con6:assign>
                                                            </con1:actions>
                                                          </con1:case>
                                                          <con1:default/>
                                                        </con1:ifThenElse>
                                                      </con3:responseTransform>
                                                    </con3:wsCallout>
                                                    <con3:wsCallout>
                                                      <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-78f2</con1:id>
                                                      <con3:service xsi:type="ref:ProxyRef" ref="ITEL/OCS/AIR/Proxies/consultarOfferOCSLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                                      <con3:operation>consultarOffer</con3:operation>
                                                      <con3:request>
                                                        <con3:body>$consultarOfferRequest</con3:body>
                                                      </con3:request>
                                                      <con3:response>
                                                        <con3:body>consultarOfferResponse</con3:body>
                                                      </con3:response>
                                                      <con3:requestTransform>
                                                        <con3:assign varName="consultarOfferRequest">
                                                          <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-78f5</con1:id>
                                                          <con3:expr>
                                                            <con1:xqueryTransform>
                                                              <con1:resource ref="ITEL/Core/Resources/XQueries/consultarOfferPS_Req"/>
                                                              <con1:param name="min">
                                                                <con1:path>data($body/ejec:Input_Parameters/MIN_DESTINO)</con1:path>
                                                              </con1:param>
                                                            </con1:xqueryTransform>
                                                          </con3:expr>
                                                        </con3:assign>
                                                      </con3:requestTransform>
                                                      <con3:responseTransform>
                                                        <con1:ifThenElse xmlns:con3="http://www.bea.com/wli/sb/typesystem/config" xmlns:con2="http://www.bea.com/wli/sb/stages/config" xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
                                                          <con6:id xmlns:con6="http://www.bea.com/wli/sb/stages/config">_ActionId-8096952212429106120-1bbaa577.15405e544f1.-78f4</con6:id>
                                                          <con1:case>
                                                            <con1:condition>
                                                              <con6:xqueryText xmlns:con6="http://www.bea.com/wli/sb/stages/config">data($consultarOfferResponse/CODIGO) != '1'</con6:xqueryText>
                                                            </con1:condition>
                                                            <con1:actions>
                                                              <con6:assign varName="codError" xmlns:con3="http://www.bea.com/wli/sb/stages/transform/config" xmlns:con2="http://www.bea.com/wli/sb/typesystem/config" xmlns:con1="http://www.bea.com/wli/sb/stages/config" xmlns:con6="http://www.bea.com/wli/sb/stages/transform/config">
                                                                <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-78f3</con1:id>
                                                                <con6:expr>
                                                                  <con1:xqueryText>data($consultarOfferResponse/CODIGO)</con1:xqueryText>
                                                                </con6:expr>
                                                              </con6:assign>
                                                            </con1:actions>
                                                          </con1:case>
                                                          <con1:default/>
                                                        </con1:ifThenElse>
                                                      </con3:responseTransform>
                                                    </con3:wsCallout>
                                                    <con3:ifThenElse>
                                                      <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-78f1</con1:id>
                                                      <con3:case>
                                                        <con3:condition>
                                                          <con1:xqueryText>$codError = "1" and 
fn:exists($consultarFaFListResponse/MENSAJE/CONSULTAR_FAFLIST/fafInformationList/Detail/fafIndicator)</con1:xqueryText>
                                                        </con3:condition>
                                                        <con3:actions>
                                                          <con3:wsCallout>
                                                            <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-78ed</con1:id>
                                                            <con3:service xsi:type="ref:ProxyRef" ref="ITEL/Core/Proxies/consultarFAFTipoLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                                            <con3:operation>consultarFAFTipo</con3:operation>
                                                            <con3:request>
                                                              <con3:body>$consultarFAFTipoRequest</con3:body>
                                                            </con3:request>
                                                            <con3:response>
                                                              <con3:body>consultarFAFTipoResponse</con3:body>
                                                            </con3:response>
                                                            <con3:requestTransform>
                                                              <con3:assign varName="consultarFAFTipoRequest">
                                                                <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-78f0</con1:id>
                                                                <con3:expr>
                                                                  <con1:xqueryTransform>
                                                                    <con1:resource ref="ITEL/Core/Resources/XQueries/consultarFAFTipoPS_Req"/>
                                                                    <con1:param name="wS_Result1">
                                                                      <con1:path>$consultarFaFListResponse</con1:path>
                                                                    </con1:param>
                                                                  </con1:xqueryTransform>
                                                                </con3:expr>
                                                              </con3:assign>
                                                            </con3:requestTransform>
                                                            <con3:responseTransform>
                                                              <con1:ifThenElse xmlns:con3="http://www.bea.com/wli/sb/typesystem/config" xmlns:con2="http://www.bea.com/wli/sb/stages/config" xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
                                                                <con6:id xmlns:con6="http://www.bea.com/wli/sb/stages/config">_ActionId-8096952212429106120-1bbaa577.15405e544f1.-78ef</con6:id>
                                                                <con1:case>
                                                                  <con1:condition>
                                                                    <con6:xqueryText xmlns:con6="http://www.bea.com/wli/sb/stages/config">data($consultarFAFTipoResponse/CODIGO) != 'OK'</con6:xqueryText>
                                                                  </con1:condition>
                                                                  <con1:actions>
                                                                    <con6:assign varName="codError" xmlns:con3="http://www.bea.com/wli/sb/stages/transform/config" xmlns:con2="http://www.bea.com/wli/sb/typesystem/config" xmlns:con1="http://www.bea.com/wli/sb/stages/config" xmlns:con6="http://www.bea.com/wli/sb/stages/transform/config">
                                                                      <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-78ee</con1:id>
                                                                      <con6:expr>
                                                                        <con1:xqueryText>"909"</con1:xqueryText>
                                                                      </con6:expr>
                                                                    </con6:assign>
                                                                  </con1:actions>
                                                                </con1:case>
                                                                <con1:default/>
                                                              </con1:ifThenElse>
                                                            </con3:responseTransform>
                                                          </con3:wsCallout>
                                                        </con3:actions>
                                                      </con3:case>
                                                      <con3:default/>
                                                    </con3:ifThenElse>
                                                    <con3:ifThenElse>
                                                      <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-78ec</con1:id>
                                                      <con3:case>
                                                        <con3:condition>
                                                          <con1:xqueryText>$codError = "1" and 
fn:exists($consultarFaFListResponse/MENSAJE/CONSULTAR_FAFLIST/fafInformationList/Detail/fafIndicator)</con1:xqueryText>
                                                        </con3:condition>
                                                        <con3:actions>
                                                          <con3:replace varName="consultarFaFListResponse">
                                                            <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-78eb</con1:id>
                                                            <con3:expr>
                                                              <con1:xqueryTransform>
                                                                <con1:resource ref="ITEL/Core/Resources/XQueries/ejecutarReglasNegocio_Res_consultarFaFList"/>
                                                                <con1:param name="wS_Result2">
                                                                  <con1:path>$consultarFaFListResponse</con1:path>
                                                                </con1:param>
                                                                <con1:param name="wS_Result1">
                                                                  <con1:path>$consultarFAFTipoResponse</con1:path>
                                                                </con1:param>
                                                              </con1:xqueryTransform>
                                                            </con3:expr>
                                                          </con3:replace>
                                                        </con3:actions>
                                                      </con3:case>
                                                      <con3:default>
                                                        <con3:replace varName="consultarFaFListResponse">
                                                          <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-78ea</con1:id>
                                                          <con3:expr>
                                                            <con1:xqueryTransform>
                                                              <con1:resource ref="ITEL/Core/Resources/XQueries/ejecutarReglasNegocio_Res_consultarFaFListOffers"/>
                                                              <con1:param name="wS_Result2">
                                                                <con1:path>$consultarFaFListResponse</con1:path>
                                                              </con1:param>
                                                              <con1:param name="wS_Result1">
                                                                <con1:path>$consultarOfferResponse</con1:path>
                                                              </con1:param>
                                                            </con1:xqueryTransform>
                                                          </con3:expr>
                                                        </con3:replace>
                                                      </con3:default>
                                                    </con3:ifThenElse>
                                                    <con3:ifThenElse>
                                                      <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-78e9</con1:id>
                                                      <con3:case>
                                                        <con3:condition>
                                                          <con1:xqueryText>$codError = "1" and 
fn:exists($consultarFaFListResponse/MENSAJE/CONSULTAR_FAFLIST/fafInformationList/Detail)</con1:xqueryText>
                                                          <con1:xqueryText>$codError = "1" and 
fn:exists($consultarFaFListResponse/MENSAJE/CONSULTAR_FAFLIST/fafInformationList/Detail/DetailNumber/fafNumber)</con1:xqueryText>
                                                        </con3:condition>
                                                        <con3:actions>
                                                          <con3:assign varName="fafIndi">
                                                            <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-78e8</con1:id>
                                                            <con3:expr>
                                                              <con1:xqueryText>&lt;fafIndicadors>
{
	let $fafIndicador := $consultarFaFListResponse/MENSAJE/CONSULTAR_FAFLIST/fafInformationList/Detail
	for $faf in $fafIndicador
	return 
	&lt;fafIndicador>{$faf/fafIndicator}&lt;/fafIndicador>	
	}
&lt;/fafIndicadors></con1:xqueryText>
                                                            </con3:expr>
                                                          </con3:assign>
                                                          <con3:foreach>
                                                            <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-78e4</con1:id>
                                                            <con3:variable>fafIndi</con3:variable>
                                                            <con3:expression>
                                                              <con1:xpathText>./fafIndicador</con1:xpathText>
                                                            </con3:expression>
                                                            <con3:value-variable>control</con3:value-variable>
                                                            <con3:index-variable>indice</con3:index-variable>
                                                            <con3:total-variable>total</con3:total-variable>
                                                            <con3:actions>
                                                              <con3:ifThenElse>
                                                                <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-78e7</con1:id>
                                                                <con3:case>
                                                                  <con3:condition>
                                                                    <con1:xqueryText>contains($control, "ILIMITADO")</con1:xqueryText>
                                                                  </con3:condition>
                                                                  <con3:actions>
                                                                    <con3:assign varName="codError">
                                                                      <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-78e6</con1:id>
                                                                      <con3:expr>
                                                                        <con1:xqueryText>"923"</con1:xqueryText>
                                                                      </con3:expr>
                                                                    </con3:assign>
                                                                    <con1:skip>
                                                                      <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-78e5</con1:id>
                                                                    </con1:skip>
                                                                  </con3:actions>
                                                                </con3:case>
                                                                <con3:default/>
                                                              </con3:ifThenElse>
                                                            </con3:actions>
                                                          </con3:foreach>
                                                        </con3:actions>
                                                      </con3:case>
                                                      <con3:default/>
                                                    </con3:ifThenElse>
                                                  </con3:actions>
                                                </con3:case>
                                                <con3:default/>
                                              </con3:ifThenElse>
                                              <con3:ifThenElse>
                                                <con1:comment>consultaNRN</con1:comment>
                                                <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-78e3</con1:id>
                                                <con3:case>
                                                  <con3:condition>
                                                    <con1:xqueryText>$codError = "1"</con1:xqueryText>
                                                  </con3:condition>
                                                  <con3:actions>
                                                    <con3:assign varName="elegidosNRN">
                                                      <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-78e2</con1:id>
                                                      <con3:expr>
                                                        <con1:xqueryText>if($metodo = "307") then
 	data($body/ejec:Input_Parameters/PARAMETROS_TRAMA/PARAMETRO[NOMBRE='MONTORECARGA']/VALOR)
else
	data($body/ejec:Input_Parameters/PARAMETROS_TRAMA/PARAMETRO[NOMBRE='HOSTID']/VALOR)</con1:xqueryText>
                                                      </con3:expr>
                                                    </con3:assign>
                                                    <con3:insert varName="reglasNegocioResponse">
                                                      <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-78e1</con1:id>
                                                      <con3:location>
                                                        <con1:xpathText>./MENSAJE/PARAMETROS</con1:xpathText>
                                                      </con3:location>
                                                      <con3:where>last-child</con3:where>
                                                      <con3:expr>
                                                        <con1:xqueryText><![CDATA[<PARAMETRO>
	<NOMBRE>ELEGIDOSNRN</NOMBRE>
	<TIPO>string</TIPO>
	<VALOR>{$elegidosNRN}</VALOR>
</PARAMETRO>]]></con1:xqueryText>
                                                      </con3:expr>
                                                    </con3:insert>
                                                  </con3:actions>
                                                </con3:case>
                                                <con3:default/>
                                              </con3:ifThenElse>
                                            </con3:actions>
                                          </con3:case>
                                          <con3:case>
                                            <con3:condition>
                                              <con1:xqueryText>$metodo = '306'</con1:xqueryText>
                                            </con3:condition>
                                            <con3:actions>
                                              <con3:ifThenElse>
                                                <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7d33</con1:id>
                                                <con3:case>
                                                  <con3:condition>
                                                    <con1:xqueryText>$codError = '1'</con1:xqueryText>
                                                  </con3:condition>
                                                  <con3:actions>
                                                    <con1:wsCallout xmlns:con3="http://www.bea.com/wli/sb/typesystem/config" xmlns:con2="http://www.bea.com/wli/sb/stages/config" xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
                                                      <con6:id xmlns:con6="http://www.bea.com/wli/sb/stages/config">_ActionId-2215439518611274108-740768fe.1574d206712.-7d1d</con6:id>
                                                      <con1:service xsi:type="ref:ProxyRef" ref="ITEL/Core/Proxies/consultarFAFIDVigenciaLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                                      <con1:operation>consultarFAFIDVigencia</con1:operation>
                                                      <con1:request>
                                                        <con1:body>$fafIdVigenciaRequest</con1:body>
                                                      </con1:request>
                                                      <con1:response>
                                                        <con1:body>fafIdVigenciaResponse</con1:body>
                                                      </con1:response>
                                                      <con1:requestTransform>
                                                        <con1:assign varName="fafIdVigenciaRequest">
                                                          <con6:id xmlns:con6="http://www.bea.com/wli/sb/stages/config">_ActionId-2215439518611274108-740768fe.1574d206712.-7d27</con6:id>
                                                          <con1:expr>
                                                            <con6:xqueryTransform xmlns:con6="http://www.bea.com/wli/sb/stages/config">
                                                              <con6:resource ref="ITEL/Core/Resources/XQueries/consultarFAFIDVigenciaPS_Req"/>
                                                              <con6:param name="serviceClass">
                                                                <con6:path>number(data($suscriptorOCSResponse/MENSAJE/CONSULTAR_SUSCRIPTOR/*:suscriptor/*:PublicRatePlanCode))</con6:path>
                                                              </con6:param>
                                                              <con6:param name="tipo">
                                                                <con6:path>"FNF"</con6:path>
                                                              </con6:param>
                                                              <con6:param name="fafIdGroup">
                                                                <con6:path>data($suscriptorOCSResponse/MENSAJE/CONSULTAR_SUSCRIPTOR/*:suscriptor/*:AccountGroupID)</con6:path>
                                                              </con6:param>
                                                              <con6:param name="vigencia">
                                                                <con6:path>"0"</con6:path>
                                                              </con6:param>
                                                            </con6:xqueryTransform>
                                                          </con1:expr>
                                                        </con1:assign>
                                                      </con1:requestTransform>
                                                      <con1:responseTransform>
                                                        <con1:ifThenElse>
                                                          <con6:id xmlns:con6="http://www.bea.com/wli/sb/stages/config">_ActionId-2215439518611274108-740768fe.1574d206712.-7d26</con6:id>
                                                          <con1:case>
                                                            <con1:condition>
                                                              <con6:xqueryText xmlns:con6="http://www.bea.com/wli/sb/stages/config">$fafIdVigenciaResponse/CODIGO = "OK" and data($fafIdVigenciaResponse/MENSAJE/FAFID)!=""</con6:xqueryText>
                                                            </con1:condition>
                                                            <con1:actions>
                                                              <con6:assign varName="reglasNegocioResponse1" xmlns:con3="http://www.bea.com/wli/sb/stages/transform/config" xmlns:con2="http://www.bea.com/wli/sb/typesystem/config" xmlns:con1="http://www.bea.com/wli/sb/stages/config" xmlns:con6="http://www.bea.com/wli/sb/stages/transform/config">
                                                                <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7d25</con1:id>
                                                                <con6:expr>
                                                                  <con1:xqueryText><![CDATA[let $fafids := tokenize(data($fafIdVigenciaResponse/MENSAJE/FAFID), ";")
return
<ns0:WS_Result xmlns:ns0="http://www.comcel.com.co/ConsultarReglas/">
	<CODIGO>1</CODIGO>
	<MENSAJE>
		<ERROR>1</ERROR>
		<ERRORDESC></ERRORDESC>
		<CONSULTASUSCRIPTOR>FALSE</CONSULTASUSCRIPTOR>
		<PARAMETROS>
			<PARAMETRO>
				<NOMBRE>FAFID_FNF</NOMBRE>
				<TIPO>string</TIPO>
				<VALOR>{ $fafids[1] }</VALOR>
			</PARAMETRO>
			{
			if( exists($fafids[2]) and $fafids[2]!="") then
				<PARAMETRO>
					<NOMBRE>FAFID_FA</NOMBRE>
					<TIPO>string</TIPO>
					<VALOR>{ $fafids[2] }</VALOR>
				</PARAMETRO>
			else ()
			}
		</PARAMETROS>
	</MENSAJE>
</ns0:WS_Result>]]></con1:xqueryText>
                                                                </con6:expr>
                                                              </con6:assign>
                                                              <con1:assign varName="fafID_fnf">
                                                                <con6:id xmlns:con6="http://www.bea.com/wli/sb/stages/config">_ActionId-2215439518611274108-740768fe.1574d206712.-7d24</con6:id>
                                                                <con1:expr>
                                                                  <con6:xqueryText xmlns:con6="http://www.bea.com/wli/sb/stages/config"><![CDATA[let $fafids := tokenize(data($fafIdVigenciaResponse/MENSAJE/FAFID), ";")
return
	 <PARAMETRO>
		 <NOMBRE>FAFID_FNF</NOMBRE>
		 <TIPO>string</TIPO>
		 <VALOR>{ $fafids[1] }</VALOR>
	 </PARAMETRO>]]></con6:xqueryText>
                                                                </con1:expr>
                                                              </con1:assign>
                                                              <con1:assign varName="fafID_fa">
                                                                <con6:id xmlns:con6="http://www.bea.com/wli/sb/stages/config">_ActionId-2215439518611274108-740768fe.1574d206712.-7d23</con6:id>
                                                                <con1:expr>
                                                                  <con6:xqueryText xmlns:con6="http://www.bea.com/wli/sb/stages/config"><![CDATA[let $fafids := tokenize(data($fafIdVigenciaResponse/MENSAJE/FAFID), ";")
return
 if( exists($fafids[2]) and $fafids[2]!="") then
		 <PARAMETRO>
			 <NOMBRE>FAFID_FA</NOMBRE>
			 <TIPO>string</TIPO>
			 <VALOR>{ $fafids[2] }</VALOR>
		 </PARAMETRO>
 else ()]]></con6:xqueryText>
                                                                </con1:expr>
                                                              </con1:assign>
                                                              <con1:ifThenElse>
                                                                <con6:id xmlns:con6="http://www.bea.com/wli/sb/stages/config">_ActionId-2215439518611274108-740768fe.1574d206712.-7d22</con6:id>
                                                                <con1:case>
                                                                  <con1:condition>
                                                                    <con6:xqueryText xmlns:con6="http://www.bea.com/wli/sb/stages/config">exists($fafID_fa)</con6:xqueryText>
                                                                  </con1:condition>
                                                                  <con1:actions>
                                                                    <con3:insert varName="reglasNegocioResponse" xmlns:con1="http://www.bea.com/wli/sb/stages/config" xmlns:con2="http://www.bea.com/wli/sb/typesystem/config" xmlns:con3="http://www.bea.com/wli/sb/stages/transform/config">
                                                                      <con6:id xmlns:con6="http://www.bea.com/wli/sb/stages/config">_ActionId-2215439518611274108-740768fe.1574d206712.-7d21</con6:id>
                                                                      <con3:location>
                                                                        <con6:xpathText xmlns:con6="http://www.bea.com/wli/sb/stages/config">./MENSAJE/PARAMETROS</con6:xpathText>
                                                                      </con3:location>
                                                                      <con3:where>last-child</con3:where>
                                                                      <con3:expr>
                                                                        <con6:xqueryText xmlns:con6="http://www.bea.com/wli/sb/stages/config">$fafID_fa</con6:xqueryText>
                                                                      </con3:expr>
                                                                    </con3:insert>
                                                                  </con1:actions>
                                                                </con1:case>
                                                                <con1:default/>
                                                              </con1:ifThenElse>
                                                              <con3:insert varName="reglasNegocioResponse" xmlns:con1="http://www.bea.com/wli/sb/stages/config" xmlns:con2="http://www.bea.com/wli/sb/typesystem/config" xmlns:con3="http://www.bea.com/wli/sb/stages/transform/config">
                                                                <con6:id xmlns:con6="http://www.bea.com/wli/sb/stages/config">_ActionId-2215439518611274108-740768fe.1574d206712.-7d20</con6:id>
                                                                <con3:location>
                                                                  <con6:xpathText xmlns:con6="http://www.bea.com/wli/sb/stages/config">./MENSAJE/PARAMETROS</con6:xpathText>
                                                                </con3:location>
                                                                <con3:where>last-child</con3:where>
                                                                <con3:expr>
                                                                  <con6:xqueryText xmlns:con6="http://www.bea.com/wli/sb/stages/config">$fafID_fnf</con6:xqueryText>
                                                                </con3:expr>
                                                              </con3:insert>
                                                            </con1:actions>
                                                          </con1:case>
                                                          <con1:case>
                                                            <con1:condition>
                                                              <con6:xqueryText xmlns:con6="http://www.bea.com/wli/sb/stages/config">$fafIdVigenciaResponse/CODIGO = "OK" and data($fafIdVigenciaResponse/MENSAJE/FAFID)=""</con6:xqueryText>
                                                            </con1:condition>
                                                            <con1:actions>
                                                              <con1:assign varName="codError">
                                                                <con6:id xmlns:con6="http://www.bea.com/wli/sb/stages/config">_ActionId-2215439518611274108-740768fe.1574d206712.-7d1f</con6:id>
                                                                <con1:expr>
                                                                  <con6:xqueryText xmlns:con6="http://www.bea.com/wli/sb/stages/config">"912"</con6:xqueryText>
                                                                </con1:expr>
                                                              </con1:assign>
                                                            </con1:actions>
                                                          </con1:case>
                                                          <con1:default>
                                                            <con1:assign varName="codError">
                                                              <con6:id xmlns:con6="http://www.bea.com/wli/sb/stages/config">_ActionId-2215439518611274108-740768fe.1574d206712.-7d1e</con6:id>
                                                              <con1:expr>
                                                                <con6:xqueryText xmlns:con6="http://www.bea.com/wli/sb/stages/config">"909"</con6:xqueryText>
                                                              </con1:expr>
                                                            </con1:assign>
                                                          </con1:default>
                                                        </con1:ifThenElse>
                                                      </con1:responseTransform>
                                                    </con1:wsCallout>
                                                    <con3:ifThenElse>
                                                      <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7d09</con1:id>
                                                      <con3:case>
                                                        <con3:condition>
                                                          <con1:xqueryText>$codError = "1"</con1:xqueryText>
                                                        </con3:condition>
                                                        <con3:actions>
                                                          <con3:wsCallout>
                                                            <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7d07</con1:id>
                                                            <con3:service xsi:type="ref:ProxyRef" ref="ITEL/OCS/OLM/Proxies/consultarSuscripcionOCSLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                                            <con3:operation>consultarSuscripcionOCS</con3:operation>
                                                            <con3:request>
                                                              <con3:body>$consultarSuscripcionOCSRequest</con3:body>
                                                            </con3:request>
                                                            <con3:response>
                                                              <con3:body>consultarSuscripcionOCSResponse</con3:body>
                                                            </con3:response>
                                                            <con3:requestTransform>
                                                              <con3:assign varName="consultarSuscripcionOCSRequest">
                                                                <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7d08</con1:id>
                                                                <con3:expr>
                                                                  <con1:xqueryTransform>
                                                                    <con1:resource ref="ITEL/Core/Resources/XQueries/consultarSuscripcionOCSPS_Req"/>
                                                                    <con1:param name="min">
                                                                      <con1:path>data($body/ejec:Input_Parameters/MIN_DESTINO)</con1:path>
                                                                    </con1:param>
                                                                  </con1:xqueryTransform>
                                                                </con3:expr>
                                                              </con3:assign>
                                                            </con3:requestTransform>
                                                            <con3:responseTransform/>
                                                          </con3:wsCallout>
                                                          <con1:wsCallout xmlns:con3="http://www.bea.com/wli/sb/typesystem/config" xmlns:con2="http://www.bea.com/wli/sb/stages/config" xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
                                                            <con6:id xmlns:con6="http://www.bea.com/wli/sb/stages/config">_ActionId-2215439518611274108-740768fe.1574d206712.-7d03</con6:id>
                                                            <con1:service xsi:type="ref:ProxyRef" ref="ITEL/OCS/AIR/Proxies/consultarFaFListOCSLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                                            <con1:operation>consultarFaFList</con1:operation>
                                                            <con1:request>
                                                              <con1:body>$consultarFaFListRequest</con1:body>
                                                            </con1:request>
                                                            <con1:response>
                                                              <con1:body>consultarFaFListResponse</con1:body>
                                                            </con1:response>
                                                            <con1:requestTransform>
                                                              <con1:assign varName="consultarFaFListRequest">
                                                                <con6:id xmlns:con6="http://www.bea.com/wli/sb/stages/config">_ActionId-2215439518611274108-740768fe.1574d206712.-7d06</con6:id>
                                                                <con1:expr>
                                                                  <con6:xqueryTransform xmlns:con6="http://www.bea.com/wli/sb/stages/config">
                                                                    <con6:resource ref="ITEL/Core/Resources/XQueries/consultarFaFListPS_Req"/>
                                                                    <con6:param name="min">
                                                                      <con6:path>data($body/ejec:Input_Parameters/MIN_DESTINO)</con6:path>
                                                                    </con6:param>
                                                                  </con6:xqueryTransform>
                                                                </con1:expr>
                                                              </con1:assign>
                                                            </con1:requestTransform>
                                                            <con1:responseTransform>
                                                              <con1:ifThenElse>
                                                                <con6:id xmlns:con6="http://www.bea.com/wli/sb/stages/config">_ActionId-2215439518611274108-740768fe.1574d206712.-7d05</con6:id>
                                                                <con1:case>
                                                                  <con1:condition>
                                                                    <con6:xqueryText xmlns:con6="http://www.bea.com/wli/sb/stages/config">data($consultarFaFListResponse/CODIGO) != '1'</con6:xqueryText>
                                                                  </con1:condition>
                                                                  <con1:actions>
                                                                    <con6:assign varName="codError" xmlns:con3="http://www.bea.com/wli/sb/stages/transform/config" xmlns:con2="http://www.bea.com/wli/sb/typesystem/config" xmlns:con1="http://www.bea.com/wli/sb/stages/config" xmlns:con6="http://www.bea.com/wli/sb/stages/transform/config">
                                                                      <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7d04</con1:id>
                                                                      <con6:expr>
                                                                        <con1:xqueryText>data($consultarFaFListResponse/CODIGO)</con1:xqueryText>
                                                                      </con6:expr>
                                                                    </con6:assign>
                                                                  </con1:actions>
                                                                </con1:case>
                                                                <con1:default/>
                                                              </con1:ifThenElse>
                                                            </con1:responseTransform>
                                                          </con1:wsCallout>
                                                          <con3:wsCallout>
                                                            <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7cff</con1:id>
                                                            <con3:service xsi:type="ref:ProxyRef" ref="ITEL/OCS/AIR/Proxies/consultarOfferOCSLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                                            <con3:operation>consultarOffer</con3:operation>
                                                            <con3:request>
                                                              <con3:body>$consultarOfferRequest</con3:body>
                                                            </con3:request>
                                                            <con3:response>
                                                              <con3:body>consultarOfferResponse</con3:body>
                                                            </con3:response>
                                                            <con3:requestTransform>
                                                              <con3:assign varName="consultarOfferRequest">
                                                                <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7d02</con1:id>
                                                                <con3:expr>
                                                                  <con1:xqueryTransform>
                                                                    <con1:resource ref="ITEL/Core/Resources/XQueries/consultarOfferPS_Req"/>
                                                                    <con1:param name="min">
                                                                      <con1:path>data($body/ejec:Input_Parameters/MIN_DESTINO)</con1:path>
                                                                    </con1:param>
                                                                  </con1:xqueryTransform>
                                                                </con3:expr>
                                                              </con3:assign>
                                                            </con3:requestTransform>
                                                            <con3:responseTransform>
                                                              <con1:ifThenElse xmlns:con3="http://www.bea.com/wli/sb/typesystem/config" xmlns:con2="http://www.bea.com/wli/sb/stages/config" xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
                                                                <con6:id xmlns:con6="http://www.bea.com/wli/sb/stages/config">_ActionId-2215439518611274108-740768fe.1574d206712.-7d01</con6:id>
                                                                <con1:case>
                                                                  <con1:condition>
                                                                    <con6:xqueryText xmlns:con6="http://www.bea.com/wli/sb/stages/config">data($consultarOfferResponse/CODIGO) != '1'</con6:xqueryText>
                                                                  </con1:condition>
                                                                  <con1:actions>
                                                                    <con6:assign varName="codError" xmlns:con3="http://www.bea.com/wli/sb/stages/transform/config" xmlns:con2="http://www.bea.com/wli/sb/typesystem/config" xmlns:con1="http://www.bea.com/wli/sb/stages/config" xmlns:con6="http://www.bea.com/wli/sb/stages/transform/config">
                                                                      <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7d00</con1:id>
                                                                      <con6:expr>
                                                                        <con1:xqueryText>data($consultarOfferResponse/CODIGO)</con1:xqueryText>
                                                                      </con6:expr>
                                                                    </con6:assign>
                                                                  </con1:actions>
                                                                </con1:case>
                                                                <con1:default/>
                                                              </con1:ifThenElse>
                                                            </con3:responseTransform>
                                                          </con3:wsCallout>
                                                          <con3:ifThenElse>
                                                            <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7cfe</con1:id>
                                                            <con3:case>
                                                              <con3:condition>
                                                                <con1:xqueryText>$codError = "1" and 
fn:exists($consultarFaFListResponse/MENSAJE/CONSULTAR_FAFLIST/fafInformationList/Detail/fafIndicator)</con1:xqueryText>
                                                              </con3:condition>
                                                              <con3:actions>
                                                                <con3:wsCallout>
                                                                  <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7cfa</con1:id>
                                                                  <con3:service xsi:type="ref:ProxyRef" ref="ITEL/Core/Proxies/consultarFAFTipoLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                                                  <con3:operation>consultarFAFTipo</con3:operation>
                                                                  <con3:request>
                                                                    <con3:body>$consultarFAFTipoRequest</con3:body>
                                                                  </con3:request>
                                                                  <con3:response>
                                                                    <con3:body>consultarFAFTipoResponse</con3:body>
                                                                  </con3:response>
                                                                  <con3:requestTransform>
                                                                    <con3:assign varName="consultarFAFTipoRequest">
                                                                      <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7cfd</con1:id>
                                                                      <con3:expr>
                                                                        <con1:xqueryTransform>
                                                                          <con1:resource ref="ITEL/Core/Resources/XQueries/consultarFAFTipoPS_Req"/>
                                                                          <con1:param name="wS_Result1">
                                                                            <con1:path>$consultarFaFListResponse</con1:path>
                                                                          </con1:param>
                                                                        </con1:xqueryTransform>
                                                                      </con3:expr>
                                                                    </con3:assign>
                                                                  </con3:requestTransform>
                                                                  <con3:responseTransform>
                                                                    <con1:ifThenElse xmlns:con3="http://www.bea.com/wli/sb/typesystem/config" xmlns:con2="http://www.bea.com/wli/sb/stages/config" xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
                                                                      <con6:id xmlns:con6="http://www.bea.com/wli/sb/stages/config">_ActionId-2215439518611274108-740768fe.1574d206712.-7cfc</con6:id>
                                                                      <con1:case>
                                                                        <con1:condition>
                                                                          <con6:xqueryText xmlns:con6="http://www.bea.com/wli/sb/stages/config">data($consultarFAFTipoResponse/CODIGO) != 'OK'</con6:xqueryText>
                                                                        </con1:condition>
                                                                        <con1:actions>
                                                                          <con6:assign varName="codError" xmlns:con3="http://www.bea.com/wli/sb/stages/transform/config" xmlns:con2="http://www.bea.com/wli/sb/typesystem/config" xmlns:con1="http://www.bea.com/wli/sb/stages/config" xmlns:con6="http://www.bea.com/wli/sb/stages/transform/config">
                                                                            <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7cfb</con1:id>
                                                                            <con6:expr>
                                                                              <con1:xqueryText>"909"</con1:xqueryText>
                                                                            </con6:expr>
                                                                          </con6:assign>
                                                                        </con1:actions>
                                                                      </con1:case>
                                                                      <con1:default/>
                                                                    </con1:ifThenElse>
                                                                  </con3:responseTransform>
                                                                </con3:wsCallout>
                                                              </con3:actions>
                                                            </con3:case>
                                                            <con3:default/>
                                                          </con3:ifThenElse>
                                                          <con3:ifThenElse>
                                                            <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7cf9</con1:id>
                                                            <con3:case>
                                                              <con3:condition>
                                                                <con1:xqueryText>$codError = "1" and 
fn:exists($consultarFaFListResponse/MENSAJE/CONSULTAR_FAFLIST/fafInformationList/Detail/fafIndicator)</con1:xqueryText>
                                                              </con3:condition>
                                                              <con3:actions>
                                                                <con3:replace varName="consultarFaFListRes">
                                                                  <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7cf8</con1:id>
                                                                  <con3:expr>
                                                                    <con1:xqueryTransform>
                                                                      <con1:resource ref="ITEL/Core/Resources/XQueries/ejecutarReglasNegocio_Res_consultarFaFList"/>
                                                                      <con1:param name="wS_Result2">
                                                                        <con1:path>$consultarFaFListResponse</con1:path>
                                                                      </con1:param>
                                                                      <con1:param name="wS_Result1">
                                                                        <con1:path>$consultarFAFTipoResponse</con1:path>
                                                                      </con1:param>
                                                                    </con1:xqueryTransform>
                                                                  </con3:expr>
                                                                </con3:replace>
                                                              </con3:actions>
                                                            </con3:case>
                                                            <con3:default>
                                                              <con3:replace varName="consultarFaFListRes">
                                                                <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7cf7</con1:id>
                                                                <con3:expr>
                                                                  <con1:xqueryTransform>
                                                                    <con1:resource ref="ITEL/Core/Resources/XQueries/ejecutarReglasNegocio_Res_consultarFaFListOffers"/>
                                                                    <con1:param name="wS_Result2">
                                                                      <con1:path>$consultarFaFListResponse</con1:path>
                                                                    </con1:param>
                                                                    <con1:param name="wS_Result1">
                                                                      <con1:path>$consultarOfferResponse</con1:path>
                                                                    </con1:param>
                                                                  </con1:xqueryTransform>
                                                                </con3:expr>
                                                              </con3:replace>
                                                            </con3:default>
                                                          </con3:ifThenElse>
                                                        </con3:actions>
                                                      </con3:case>
                                                      <con3:default/>
                                                    </con3:ifThenElse>
                                                    <con3:ifThenElse>
                                                      <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7cf0</con1:id>
                                                      <con3:case>
                                                        <con3:condition>
                                                          <con1:xqueryText>$codError = "1"</con1:xqueryText>
                                                        </con3:condition>
                                                        <con3:actions>
                                                          <con3:assign varName="validarFNF">
                                                            <con1:id>_ActionId-7789993448742844017--62b80176.15771753ce1.-7f1f</con1:id>
                                                            <con3:expr>
                                                              <con1:xqueryTransform>
                                                                <con1:resource ref="ITEL/Core/Resources/XQueries/ejecutarReglasNegocio_Req_validarFNF"/>
                                                                <con1:param name="wS_Result1">
                                                                  <con1:path>$consultarFaFListResponse</con1:path>
                                                                </con1:param>
                                                                <con1:param name="amigosList">
                                                                  <con1:path>data($body/ejec:Input_Parameters/PARAMETROS_TRAMA/PARAMETRO[NOMBRE='MONTORECARGA']/VALOR)</con1:path>
                                                                </con1:param>
                                                              </con1:xqueryTransform>
                                                            </con3:expr>
                                                          </con3:assign>
                                                          <con3:insert varName="reglasNegocioResponse">
                                                            <con1:id>_ActionId-7789993448742844017--62b80176.15771753ce1.-7f1d</con1:id>
                                                            <con3:location>
                                                              <con1:xpathText>./MENSAJE/PARAMETROS</con1:xpathText>
                                                            </con3:location>
                                                            <con3:where>last-child</con3:where>
                                                            <con3:expr>
                                                              <con1:xqueryText><![CDATA[<PARAMETRO>
	<NOMBRE>VALIDARFNF</NOMBRE>
	<TIPO>string</TIPO>
	<VALOR>{$validarFNF}</VALOR>
</PARAMETRO>]]></con1:xqueryText>
                                                            </con3:expr>
                                                          </con3:insert>
                                                          <con3:assign varName="elegidosNRN">
                                                            <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7cef</con1:id>
                                                            <con3:expr>
                                                              <con1:xqueryText>data($body/ejec:Input_Parameters/PARAMETROS_TRAMA/PARAMETRO[NOMBRE='MONTORECARGA']/VALOR)</con1:xqueryText>
                                                            </con3:expr>
                                                          </con3:assign>
                                                          <con3:insert varName="reglasNegocioResponse">
                                                            <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7cee</con1:id>
                                                            <con3:location>
                                                              <con1:xpathText>./MENSAJE/PARAMETROS</con1:xpathText>
                                                            </con3:location>
                                                            <con3:where>last-child</con3:where>
                                                            <con3:expr>
                                                              <con1:xqueryText><![CDATA[<PARAMETRO>
	<NOMBRE>ELEGIDOSNRN</NOMBRE>
	<TIPO>string</TIPO>
	<VALOR>{$elegidosNRN}</VALOR>
</PARAMETRO>]]></con1:xqueryText>
                                                            </con3:expr>
                                                          </con3:insert>
                                                          <con3:wsCallout>
                                                            <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7cec</con1:id>
                                                            <con3:service xsi:type="ref:ProxyRef" ref="ITEL/Core/Proxies/consultarContratoEsPostpagoLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                                            <con3:operation>consultarContratoEsPostpago</con3:operation>
                                                            <con3:request>
                                                              <con3:body>$consultarContratoEsPospagoRequest</con3:body>
                                                            </con3:request>
                                                            <con3:response>
                                                              <con3:body>consultarContratoEsPospagoResponse</con3:body>
                                                            </con3:response>
                                                            <con3:requestTransform>
                                                              <con3:assign varName="consultarContratoEsPospagoRequest">
                                                                <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7ced</con1:id>
                                                                <con3:expr>
                                                                  <con1:xqueryText>&lt;con:Input_Parameters xmlns:con="http://www.comcel.com.co/ConsultarContractEsPostPago">
    &lt;con:CONTRACT>{ data($suscriptorOCSResponse/MENSAJE/CONSULTAR_SUSCRIPTOR/*:suscriptor/*:PublicRatePlanCode) }&lt;/con:CONTRACT>
&lt;/con:Input_Parameters></con1:xqueryText>
                                                                </con3:expr>
                                                              </con3:assign>
                                                            </con3:requestTransform>
                                                            <con3:responseTransform/>
                                                          </con3:wsCallout>
                                                          <con3:insert varName="reglasNegocioResponse">
                                                            <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7ceb</con1:id>
                                                            <con3:location>
                                                              <con1:xpathText>./*:MENSAJE/*:PARAMETROS</con1:xpathText>
                                                            </con3:location>
                                                            <con3:where>last-child</con3:where>
                                                            <con3:expr>
                                                              <con1:xqueryText><![CDATA[<PARAMETRO>
	<NOMBRE>ESPOSTPAGO</NOMBRE>
	<TIPO>string</TIPO>
	<VALOR>{ data($consultarContratoEsPospagoResponse/*:MENSAJE/*:ESPOSTPAGO) }</VALOR>
</PARAMETRO>]]></con1:xqueryText>
                                                            </con3:expr>
                                                          </con3:insert>
                                                        </con3:actions>
                                                      </con3:case>
                                                      <con3:default/>
                                                    </con3:ifThenElse>
                                                  </con3:actions>
                                                </con3:case>
                                                <con3:default/>
                                              </con3:ifThenElse>
                                            </con3:actions>
                                          </con3:case>
                                          <con3:case>
                                            <con3:condition>
                                              <con1:xqueryText>$metodo = '310'</con1:xqueryText>
                                            </con3:condition>
                                            <con3:actions>
                                              <con3:ifThenElse>
                                                <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7e75</con1:id>
                                                <con3:case>
                                                  <con3:condition>
                                                    <con1:xqueryText>$codError = '1'</con1:xqueryText>
                                                  </con3:condition>
                                                  <con3:actions>
                                                    <con3:wsCallout>
                                                      <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7e5f</con1:id>
                                                      <con3:service xsi:type="ref:ProxyRef" ref="ITEL/Core/Proxies/consultarFAFIDVigenciaLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                                      <con3:operation>consultarFAFIDVigencia</con3:operation>
                                                      <con3:request>
                                                        <con3:body>$fafIdVigenciaRequest</con3:body>
                                                      </con3:request>
                                                      <con3:response>
                                                        <con3:body>fafIdVigenciaResponse</con3:body>
                                                      </con3:response>
                                                      <con3:requestTransform>
                                                        <con1:assign varName="fafIdVigenciaRequest" xmlns:con3="http://www.bea.com/wli/sb/typesystem/config" xmlns:con2="http://www.bea.com/wli/sb/stages/config" xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
                                                          <con6:id xmlns:con6="http://www.bea.com/wli/sb/stages/config">_ActionId-2215439518611274108-740768fe.1574d206712.-7e69</con6:id>
                                                          <con1:expr>
                                                            <con6:xqueryTransform xmlns:con6="http://www.bea.com/wli/sb/stages/config">
                                                              <con6:resource ref="ITEL/Core/Resources/XQueries/consultarFAFIDVigenciaPS_Req"/>
                                                              <con6:param name="serviceClass">
                                                                <con6:path>number(data($suscriptorOCSResponse/MENSAJE/CONSULTAR_SUSCRIPTOR/*:suscriptor/*:PublicRatePlanCode))</con6:path>
                                                              </con6:param>
                                                              <con6:param name="tipo">
                                                                <con6:path>"FNF"</con6:path>
                                                              </con6:param>
                                                              <con6:param name="fafIdGroup">
                                                                <con6:path>data($suscriptorOCSResponse/MENSAJE/CONSULTAR_SUSCRIPTOR/*:suscriptor/*:AccountGroupID)</con6:path>
                                                              </con6:param>
                                                              <con6:param name="vigencia">
                                                                <con6:path>"0"</con6:path>
                                                              </con6:param>
                                                            </con6:xqueryTransform>
                                                          </con1:expr>
                                                        </con1:assign>
                                                      </con3:requestTransform>
                                                      <con3:responseTransform>
                                                        <con1:ifThenElse xmlns:con3="http://www.bea.com/wli/sb/typesystem/config" xmlns:con2="http://www.bea.com/wli/sb/stages/config" xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
                                                          <con6:id xmlns:con6="http://www.bea.com/wli/sb/stages/config">_ActionId-2215439518611274108-740768fe.1574d206712.-7e68</con6:id>
                                                          <con1:case>
                                                            <con1:condition>
                                                              <con6:xqueryText xmlns:con6="http://www.bea.com/wli/sb/stages/config">$fafIdVigenciaResponse/CODIGO = "OK" and data($fafIdVigenciaResponse/MENSAJE/FAFID)!=""</con6:xqueryText>
                                                            </con1:condition>
                                                            <con1:actions>
                                                              <con6:assign varName="reglasNegocioResponse1" xmlns:con3="http://www.bea.com/wli/sb/stages/transform/config" xmlns:con2="http://www.bea.com/wli/sb/typesystem/config" xmlns:con1="http://www.bea.com/wli/sb/stages/config" xmlns:con6="http://www.bea.com/wli/sb/stages/transform/config">
                                                                <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7e67</con1:id>
                                                                <con6:expr>
                                                                  <con1:xqueryText><![CDATA[let $fafids := tokenize(data($fafIdVigenciaResponse/MENSAJE/FAFID), ";")
return
<ns0:WS_Result xmlns:ns0="http://www.comcel.com.co/ConsultarReglas/">
	<CODIGO>1</CODIGO>
	<MENSAJE>
		<ERROR>1</ERROR>
		<ERRORDESC></ERRORDESC>
		<CONSULTASUSCRIPTOR>FALSE</CONSULTASUSCRIPTOR>
		<PARAMETROS>
			<PARAMETRO>
				<NOMBRE>FAFID_FNF</NOMBRE>
				<TIPO>string</TIPO>
				<VALOR>{ $fafids[1] }</VALOR>
			</PARAMETRO>
			{
			if( exists($fafids[2]) and $fafids[2]!="") then
				<PARAMETRO>
					<NOMBRE>FAFID_FA</NOMBRE>
					<TIPO>string</TIPO>
					<VALOR>{ $fafids[2] }</VALOR>
				</PARAMETRO>
			else ()
			}
		</PARAMETROS>
	</MENSAJE>
</ns0:WS_Result>]]></con1:xqueryText>
                                                                </con6:expr>
                                                              </con6:assign>
                                                              <con1:assign varName="fafID_fnf">
                                                                <con6:id xmlns:con6="http://www.bea.com/wli/sb/stages/config">_ActionId-2215439518611274108-740768fe.1574d206712.-7e66</con6:id>
                                                                <con1:expr>
                                                                  <con6:xqueryText xmlns:con6="http://www.bea.com/wli/sb/stages/config"><![CDATA[let $fafids := tokenize(data($fafIdVigenciaResponse/MENSAJE/FAFID), ";")
return
	 <PARAMETRO>
		 <NOMBRE>FAFID_FNF</NOMBRE>
		 <TIPO>string</TIPO>
		 <VALOR>{ $fafids[1] }</VALOR>
	 </PARAMETRO>]]></con6:xqueryText>
                                                                </con1:expr>
                                                              </con1:assign>
                                                              <con1:assign varName="fafID_fa">
                                                                <con6:id xmlns:con6="http://www.bea.com/wli/sb/stages/config">_ActionId-2215439518611274108-740768fe.1574d206712.-7e65</con6:id>
                                                                <con1:expr>
                                                                  <con6:xqueryText xmlns:con6="http://www.bea.com/wli/sb/stages/config"><![CDATA[let $fafids := tokenize(data($fafIdVigenciaResponse/MENSAJE/FAFID), ";")
return
 if( exists($fafids[2]) and $fafids[2]!="") then
		 <PARAMETRO>
			 <NOMBRE>FAFID_FA</NOMBRE>
			 <TIPO>string</TIPO>
			 <VALOR>{ $fafids[2] }</VALOR>
		 </PARAMETRO>
 else ()]]></con6:xqueryText>
                                                                </con1:expr>
                                                              </con1:assign>
                                                              <con1:ifThenElse>
                                                                <con6:id xmlns:con6="http://www.bea.com/wli/sb/stages/config">_ActionId-2215439518611274108-740768fe.1574d206712.-7e64</con6:id>
                                                                <con1:case>
                                                                  <con1:condition>
                                                                    <con6:xqueryText xmlns:con6="http://www.bea.com/wli/sb/stages/config">exists($fafID_fa)</con6:xqueryText>
                                                                  </con1:condition>
                                                                  <con1:actions>
                                                                    <con3:insert varName="reglasNegocioResponse" xmlns:con1="http://www.bea.com/wli/sb/stages/config" xmlns:con2="http://www.bea.com/wli/sb/typesystem/config" xmlns:con3="http://www.bea.com/wli/sb/stages/transform/config">
                                                                      <con6:id xmlns:con6="http://www.bea.com/wli/sb/stages/config">_ActionId-2215439518611274108-740768fe.1574d206712.-7e63</con6:id>
                                                                      <con3:location>
                                                                        <con6:xpathText xmlns:con6="http://www.bea.com/wli/sb/stages/config">./MENSAJE/PARAMETROS</con6:xpathText>
                                                                      </con3:location>
                                                                      <con3:where>last-child</con3:where>
                                                                      <con3:expr>
                                                                        <con6:xqueryText xmlns:con6="http://www.bea.com/wli/sb/stages/config">$fafID_fa</con6:xqueryText>
                                                                      </con3:expr>
                                                                    </con3:insert>
                                                                  </con1:actions>
                                                                </con1:case>
                                                                <con1:default/>
                                                              </con1:ifThenElse>
                                                              <con3:insert varName="reglasNegocioResponse" xmlns:con1="http://www.bea.com/wli/sb/stages/config" xmlns:con2="http://www.bea.com/wli/sb/typesystem/config" xmlns:con3="http://www.bea.com/wli/sb/stages/transform/config">
                                                                <con6:id xmlns:con6="http://www.bea.com/wli/sb/stages/config">_ActionId-2215439518611274108-740768fe.1574d206712.-7e62</con6:id>
                                                                <con3:location>
                                                                  <con6:xpathText xmlns:con6="http://www.bea.com/wli/sb/stages/config">./MENSAJE/PARAMETROS</con6:xpathText>
                                                                </con3:location>
                                                                <con3:where>last-child</con3:where>
                                                                <con3:expr>
                                                                  <con6:xqueryText xmlns:con6="http://www.bea.com/wli/sb/stages/config">$fafID_fnf</con6:xqueryText>
                                                                </con3:expr>
                                                              </con3:insert>
                                                            </con1:actions>
                                                          </con1:case>
                                                          <con1:case>
                                                            <con1:condition>
                                                              <con6:xqueryText xmlns:con6="http://www.bea.com/wli/sb/stages/config">$fafIdVigenciaResponse/CODIGO = "OK" and data($fafIdVigenciaResponse/MENSAJE/FAFID)=""</con6:xqueryText>
                                                            </con1:condition>
                                                            <con1:actions>
                                                              <con1:assign varName="codError">
                                                                <con6:id xmlns:con6="http://www.bea.com/wli/sb/stages/config">_ActionId-2215439518611274108-740768fe.1574d206712.-7e61</con6:id>
                                                                <con1:expr>
                                                                  <con6:xqueryText xmlns:con6="http://www.bea.com/wli/sb/stages/config">"912"</con6:xqueryText>
                                                                </con1:expr>
                                                              </con1:assign>
                                                            </con1:actions>
                                                          </con1:case>
                                                          <con1:default>
                                                            <con1:assign varName="codError">
                                                              <con6:id xmlns:con6="http://www.bea.com/wli/sb/stages/config">_ActionId-2215439518611274108-740768fe.1574d206712.-7e60</con6:id>
                                                              <con1:expr>
                                                                <con6:xqueryText xmlns:con6="http://www.bea.com/wli/sb/stages/config">"909"</con6:xqueryText>
                                                              </con1:expr>
                                                            </con1:assign>
                                                          </con1:default>
                                                        </con1:ifThenElse>
                                                      </con3:responseTransform>
                                                    </con3:wsCallout>
                                                    <con3:ifThenElse>
                                                      <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7e4b</con1:id>
                                                      <con3:case>
                                                        <con3:condition>
                                                          <con1:xqueryText>$codError = "1"</con1:xqueryText>
                                                        </con3:condition>
                                                        <con3:actions>
                                                          <con3:wsCallout>
                                                            <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7e49</con1:id>
                                                            <con3:service xsi:type="ref:ProxyRef" ref="ITEL/OCS/OLM/Proxies/consultarSuscripcionOCSLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                                            <con3:operation>consultarSuscripcionOCS</con3:operation>
                                                            <con3:request>
                                                              <con3:body>$consultarSuscripcionOCSRequest</con3:body>
                                                            </con3:request>
                                                            <con3:response>
                                                              <con3:body>consultarSuscripcionOCSResponse</con3:body>
                                                            </con3:response>
                                                            <con3:requestTransform>
                                                              <con3:assign varName="consultarSuscripcionOCSRequest">
                                                                <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7e4a</con1:id>
                                                                <con3:expr>
                                                                  <con1:xqueryTransform>
                                                                    <con1:resource ref="ITEL/Core/Resources/XQueries/consultarSuscripcionOCSPS_Req"/>
                                                                    <con1:param name="min">
                                                                      <con1:path>data($body/ejec:Input_Parameters/MIN_DESTINO)</con1:path>
                                                                    </con1:param>
                                                                  </con1:xqueryTransform>
                                                                </con3:expr>
                                                              </con3:assign>
                                                            </con3:requestTransform>
                                                            <con3:responseTransform/>
                                                          </con3:wsCallout>
                                                          <con1:wsCallout xmlns:con3="http://www.bea.com/wli/sb/typesystem/config" xmlns:con2="http://www.bea.com/wli/sb/stages/config" xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
                                                            <con6:id xmlns:con6="http://www.bea.com/wli/sb/stages/config">_ActionId-2215439518611274108-740768fe.1574d206712.-7e45</con6:id>
                                                            <con1:service xsi:type="ref:ProxyRef" ref="ITEL/OCS/AIR/Proxies/consultarFaFListOCSLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                                            <con1:operation>consultarFaFList</con1:operation>
                                                            <con1:request>
                                                              <con1:body>$consultarFaFListRequest</con1:body>
                                                            </con1:request>
                                                            <con1:response>
                                                              <con1:body>consultarFaFListResponse</con1:body>
                                                            </con1:response>
                                                            <con1:requestTransform>
                                                              <con1:assign varName="consultarFaFListRequest">
                                                                <con6:id xmlns:con6="http://www.bea.com/wli/sb/stages/config">_ActionId-2215439518611274108-740768fe.1574d206712.-7e48</con6:id>
                                                                <con1:expr>
                                                                  <con6:xqueryTransform xmlns:con6="http://www.bea.com/wli/sb/stages/config">
                                                                    <con6:resource ref="ITEL/Core/Resources/XQueries/consultarFaFListPS_Req"/>
                                                                    <con6:param name="min">
                                                                      <con6:path>data($body/ejec:Input_Parameters/MIN_DESTINO)</con6:path>
                                                                    </con6:param>
                                                                  </con6:xqueryTransform>
                                                                </con1:expr>
                                                              </con1:assign>
                                                            </con1:requestTransform>
                                                            <con1:responseTransform>
                                                              <con1:ifThenElse>
                                                                <con6:id xmlns:con6="http://www.bea.com/wli/sb/stages/config">_ActionId-2215439518611274108-740768fe.1574d206712.-7e47</con6:id>
                                                                <con1:case>
                                                                  <con1:condition>
                                                                    <con6:xqueryText xmlns:con6="http://www.bea.com/wli/sb/stages/config">data($consultarFaFListResponse/CODIGO) != '1'</con6:xqueryText>
                                                                  </con1:condition>
                                                                  <con1:actions>
                                                                    <con6:assign varName="codError" xmlns:con3="http://www.bea.com/wli/sb/stages/transform/config" xmlns:con2="http://www.bea.com/wli/sb/typesystem/config" xmlns:con1="http://www.bea.com/wli/sb/stages/config" xmlns:con6="http://www.bea.com/wli/sb/stages/transform/config">
                                                                      <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7e46</con1:id>
                                                                      <con6:expr>
                                                                        <con1:xqueryText>data($consultarFaFListResponse/CODIGO)</con1:xqueryText>
                                                                      </con6:expr>
                                                                    </con6:assign>
                                                                  </con1:actions>
                                                                </con1:case>
                                                                <con1:default/>
                                                              </con1:ifThenElse>
                                                            </con1:responseTransform>
                                                          </con1:wsCallout>
                                                          <con3:wsCallout>
                                                            <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7e41</con1:id>
                                                            <con3:service xsi:type="ref:ProxyRef" ref="ITEL/OCS/AIR/Proxies/consultarOfferOCSLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                                            <con3:operation>consultarOffer</con3:operation>
                                                            <con3:request>
                                                              <con3:body>$consultarOfferRequest</con3:body>
                                                            </con3:request>
                                                            <con3:response>
                                                              <con3:body>consultarOfferResponse</con3:body>
                                                            </con3:response>
                                                            <con3:requestTransform>
                                                              <con3:assign varName="consultarOfferRequest">
                                                                <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7e44</con1:id>
                                                                <con3:expr>
                                                                  <con1:xqueryTransform>
                                                                    <con1:resource ref="ITEL/Core/Resources/XQueries/consultarOfferPS_Req"/>
                                                                    <con1:param name="min">
                                                                      <con1:path>data($body/ejec:Input_Parameters/MIN_DESTINO)</con1:path>
                                                                    </con1:param>
                                                                  </con1:xqueryTransform>
                                                                </con3:expr>
                                                              </con3:assign>
                                                            </con3:requestTransform>
                                                            <con3:responseTransform>
                                                              <con1:ifThenElse xmlns:con3="http://www.bea.com/wli/sb/typesystem/config" xmlns:con2="http://www.bea.com/wli/sb/stages/config" xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
                                                                <con6:id xmlns:con6="http://www.bea.com/wli/sb/stages/config">_ActionId-2215439518611274108-740768fe.1574d206712.-7e43</con6:id>
                                                                <con1:case>
                                                                  <con1:condition>
                                                                    <con6:xqueryText xmlns:con6="http://www.bea.com/wli/sb/stages/config">data($consultarOfferResponse/CODIGO) != '1'</con6:xqueryText>
                                                                  </con1:condition>
                                                                  <con1:actions>
                                                                    <con6:assign varName="codError" xmlns:con3="http://www.bea.com/wli/sb/stages/transform/config" xmlns:con2="http://www.bea.com/wli/sb/typesystem/config" xmlns:con1="http://www.bea.com/wli/sb/stages/config" xmlns:con6="http://www.bea.com/wli/sb/stages/transform/config">
                                                                      <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7e42</con1:id>
                                                                      <con6:expr>
                                                                        <con1:xqueryText>data($consultarOfferResponse/CODIGO)</con1:xqueryText>
                                                                      </con6:expr>
                                                                    </con6:assign>
                                                                  </con1:actions>
                                                                </con1:case>
                                                                <con1:default/>
                                                              </con1:ifThenElse>
                                                            </con3:responseTransform>
                                                          </con3:wsCallout>
                                                          <con3:ifThenElse>
                                                            <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7e40</con1:id>
                                                            <con3:case>
                                                              <con3:condition>
                                                                <con1:xqueryText>$codError = "1" and 
fn:exists($consultarFaFListResponse/MENSAJE/CONSULTAR_FAFLIST/fafInformationList/Detail/fafIndicator)</con1:xqueryText>
                                                              </con3:condition>
                                                              <con3:actions>
                                                                <con3:wsCallout>
                                                                  <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7e3c</con1:id>
                                                                  <con3:service xsi:type="ref:ProxyRef" ref="ITEL/Core/Proxies/consultarFAFTipoLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                                                  <con3:operation>consultarFAFTipo</con3:operation>
                                                                  <con3:request>
                                                                    <con3:body>$consultarFAFTipoRequest</con3:body>
                                                                  </con3:request>
                                                                  <con3:response>
                                                                    <con3:body>consultarFAFTipoResponse</con3:body>
                                                                  </con3:response>
                                                                  <con3:requestTransform>
                                                                    <con3:assign varName="consultarFAFTipoRequest">
                                                                      <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7e3f</con1:id>
                                                                      <con3:expr>
                                                                        <con1:xqueryTransform>
                                                                          <con1:resource ref="ITEL/Core/Resources/XQueries/consultarFAFTipoPS_Req"/>
                                                                          <con1:param name="wS_Result1">
                                                                            <con1:path>$consultarFaFListResponse</con1:path>
                                                                          </con1:param>
                                                                        </con1:xqueryTransform>
                                                                      </con3:expr>
                                                                    </con3:assign>
                                                                  </con3:requestTransform>
                                                                  <con3:responseTransform>
                                                                    <con1:ifThenElse xmlns:con3="http://www.bea.com/wli/sb/typesystem/config" xmlns:con2="http://www.bea.com/wli/sb/stages/config" xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
                                                                      <con6:id xmlns:con6="http://www.bea.com/wli/sb/stages/config">_ActionId-2215439518611274108-740768fe.1574d206712.-7e3e</con6:id>
                                                                      <con1:case>
                                                                        <con1:condition>
                                                                          <con6:xqueryText xmlns:con6="http://www.bea.com/wli/sb/stages/config">data($consultarFAFTipoResponse/CODIGO) != 'OK'</con6:xqueryText>
                                                                        </con1:condition>
                                                                        <con1:actions>
                                                                          <con6:assign varName="codError" xmlns:con3="http://www.bea.com/wli/sb/stages/transform/config" xmlns:con2="http://www.bea.com/wli/sb/typesystem/config" xmlns:con1="http://www.bea.com/wli/sb/stages/config" xmlns:con6="http://www.bea.com/wli/sb/stages/transform/config">
                                                                            <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7e3d</con1:id>
                                                                            <con6:expr>
                                                                              <con1:xqueryText>"909"</con1:xqueryText>
                                                                            </con6:expr>
                                                                          </con6:assign>
                                                                        </con1:actions>
                                                                      </con1:case>
                                                                      <con1:default/>
                                                                    </con1:ifThenElse>
                                                                  </con3:responseTransform>
                                                                </con3:wsCallout>
                                                              </con3:actions>
                                                            </con3:case>
                                                            <con3:default/>
                                                          </con3:ifThenElse>
                                                          <con3:ifThenElse>
                                                            <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7e3b</con1:id>
                                                            <con3:case>
                                                              <con3:condition>
                                                                <con1:xqueryText>$codError = "1" and 
fn:exists($consultarFaFListResponse/MENSAJE/CONSULTAR_FAFLIST/fafInformationList/Detail/fafIndicator)</con1:xqueryText>
                                                              </con3:condition>
                                                              <con3:actions>
                                                                <con3:replace varName="consultarFaFListRes">
                                                                  <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7e3a</con1:id>
                                                                  <con3:expr>
                                                                    <con1:xqueryTransform>
                                                                      <con1:resource ref="ITEL/Core/Resources/XQueries/ejecutarReglasNegocio_Res_consultarFaFList"/>
                                                                      <con1:param name="wS_Result2">
                                                                        <con1:path>$consultarFaFListResponse</con1:path>
                                                                      </con1:param>
                                                                      <con1:param name="wS_Result1">
                                                                        <con1:path>$consultarFAFTipoResponse</con1:path>
                                                                      </con1:param>
                                                                    </con1:xqueryTransform>
                                                                  </con3:expr>
                                                                </con3:replace>
                                                              </con3:actions>
                                                            </con3:case>
                                                            <con3:default>
                                                              <con3:replace varName="consultarFaFListRes">
                                                                <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7e39</con1:id>
                                                                <con3:expr>
                                                                  <con1:xqueryTransform>
                                                                    <con1:resource ref="ITEL/Core/Resources/XQueries/ejecutarReglasNegocio_Res_consultarFaFListOffers"/>
                                                                    <con1:param name="wS_Result2">
                                                                      <con1:path>$consultarFaFListResponse</con1:path>
                                                                    </con1:param>
                                                                    <con1:param name="wS_Result1">
                                                                      <con1:path>$consultarOfferResponse</con1:path>
                                                                    </con1:param>
                                                                  </con1:xqueryTransform>
                                                                </con3:expr>
                                                              </con3:replace>
                                                            </con3:default>
                                                          </con3:ifThenElse>
                                                        </con3:actions>
                                                      </con3:case>
                                                      <con3:default/>
                                                    </con3:ifThenElse>
                                                    <con3:ifThenElse>
                                                      <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7e32</con1:id>
                                                      <con3:case>
                                                        <con3:condition>
                                                          <con1:xqueryText>$codError = "1"</con1:xqueryText>
                                                        </con3:condition>
                                                        <con3:actions>
                                                          <con3:assign varName="elegidosNRN">
                                                            <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7e31</con1:id>
                                                            <con3:expr>
                                                              <con1:xqueryText>data($body/ejec:Input_Parameters/PARAMETROS_TRAMA/PARAMETRO[NOMBRE='MONTORECARGA']/VALOR)</con1:xqueryText>
                                                            </con3:expr>
                                                          </con3:assign>
                                                          <con3:insert varName="reglasNegocioResponse">
                                                            <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7e30</con1:id>
                                                            <con3:location>
                                                              <con1:xpathText>./MENSAJE/PARAMETROS</con1:xpathText>
                                                            </con3:location>
                                                            <con3:where>last-child</con3:where>
                                                            <con3:expr>
                                                              <con1:xqueryText><![CDATA[<PARAMETRO>
	<NOMBRE>ELEGIDOSNRN</NOMBRE>
	<TIPO>string</TIPO>
	<VALOR>{$elegidosNRN}</VALOR>
</PARAMETRO>]]></con1:xqueryText>
                                                            </con3:expr>
                                                          </con3:insert>
                                                          <con3:wsCallout>
                                                            <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7e2e</con1:id>
                                                            <con3:service xsi:type="ref:ProxyRef" ref="ITEL/Core/Proxies/consultarContratoEsPostpagoLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                                            <con3:operation>consultarContratoEsPostpago</con3:operation>
                                                            <con3:request>
                                                              <con3:body>$consultarContratoEsPospagoRequest</con3:body>
                                                            </con3:request>
                                                            <con3:response>
                                                              <con3:body>consultarContratoEsPospagoResponse</con3:body>
                                                            </con3:response>
                                                            <con3:requestTransform>
                                                              <con3:assign varName="consultarContratoEsPospagoRequest">
                                                                <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7e2f</con1:id>
                                                                <con3:expr>
                                                                  <con1:xqueryText>&lt;con:Input_Parameters xmlns:con="http://www.comcel.com.co/ConsultarContractEsPostPago">
    &lt;con:CONTRACT>{ data($suscriptorOCSResponse/MENSAJE/CONSULTAR_SUSCRIPTOR/*:suscriptor/*:PublicRatePlanCode) }&lt;/con:CONTRACT>
&lt;/con:Input_Parameters></con1:xqueryText>
                                                                </con3:expr>
                                                              </con3:assign>
                                                            </con3:requestTransform>
                                                            <con3:responseTransform/>
                                                          </con3:wsCallout>
                                                          <con3:insert varName="reglasNegocioResponse">
                                                            <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7e2d</con1:id>
                                                            <con3:location>
                                                              <con1:xpathText>./*:MENSAJE/*:PARAMETROS</con1:xpathText>
                                                            </con3:location>
                                                            <con3:where>last-child</con3:where>
                                                            <con3:expr>
                                                              <con1:xqueryText><![CDATA[<PARAMETRO>
	<NOMBRE>ESPOSTPAGO</NOMBRE>
	<TIPO>string</TIPO>
	<VALOR>{ data($consultarContratoEsPospagoResponse/*:MENSAJE/*:ESPOSTPAGO) }</VALOR>
</PARAMETRO>]]></con1:xqueryText>
                                                            </con3:expr>
                                                          </con3:insert>
                                                        </con3:actions>
                                                      </con3:case>
                                                      <con3:default/>
                                                    </con3:ifThenElse>
                                                  </con3:actions>
                                                </con3:case>
                                                <con3:default/>
                                              </con3:ifThenElse>
                                            </con3:actions>
                                          </con3:case>
                                          <con3:case>
                                            <con3:condition>
                                              <con1:xqueryText>$metodo = '313'</con1:xqueryText>
                                            </con3:condition>
                                            <con3:actions>
                                              <con3:assign varName="esPostPago">
                                                <con1:id>_ActionId-2999359011571076042--72c97c75.156955b6f47.-67fc</con1:id>
                                                <con3:expr>
                                                  <con1:xqueryText>data($suscriptorOCSResponse/MENSAJE/CONSULTAR_SUSCRIPTOR/*:suscriptor/*:PublicRatePlanCode)</con1:xqueryText>
                                                </con3:expr>
                                              </con3:assign>
                                              <con3:ifThenElse>
                                                <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7aa1</con1:id>
                                                <con3:case>
                                                  <con3:condition>
                                                    <con1:xqueryText>$codError = '1'</con1:xqueryText>
                                                  </con3:condition>
                                                  <con3:actions>
                                                    <con3:wsCallout>
                                                      <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7a95</con1:id>
                                                      <con3:service xsi:type="ref:ProxyRef" ref="ITEL/Core/Proxies/consultarFAFTipoLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                                      <con3:operation>consultarFAFTipo</con3:operation>
                                                      <con3:request>
                                                        <con3:body>$consultarFAFTipoRequest</con3:body>
                                                      </con3:request>
                                                      <con3:response>
                                                        <con3:body>consultarFAFTipoResponse</con3:body>
                                                      </con3:response>
                                                      <con3:requestTransform>
                                                        <con3:assign varName="consultarFAFTipoRequest">
                                                          <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7a9a</con1:id>
                                                          <con3:expr>
                                                            <con1:xqueryTransform>
                                                              <con1:resource ref="ITEL/Core/Resources/XQueries/consultaFAFTipoPS_Req"/>
                                                              <con1:param name="faf">
                                                                <con1:path>data($body/ejec:Input_Parameters/PARAMETROS_TRAMA/PARAMETRO[NOMBRE="HOSTID"]/VALOR)</con1:path>
                                                              </con1:param>
                                                            </con1:xqueryTransform>
                                                          </con3:expr>
                                                        </con3:assign>
                                                      </con3:requestTransform>
                                                      <con3:responseTransform>
                                                        <con1:ifThenElse xmlns:con3="http://www.bea.com/wli/sb/typesystem/config" xmlns:con2="http://www.bea.com/wli/sb/stages/config" xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
                                                          <con6:id xmlns:con6="http://www.bea.com/wli/sb/stages/config">_ActionId-2215439518611274108-740768fe.1574d206712.-7a99</con6:id>
                                                          <con1:case>
                                                            <con1:condition>
                                                              <con6:xqueryText xmlns:con6="http://www.bea.com/wli/sb/stages/config">data($consultarFAFTipoResponse/CODIGO) != 'OK'</con6:xqueryText>
                                                            </con1:condition>
                                                            <con1:actions>
                                                              <con6:assign varName="codError" xmlns:con3="http://www.bea.com/wli/sb/stages/transform/config" xmlns:con2="http://www.bea.com/wli/sb/typesystem/config" xmlns:con1="http://www.bea.com/wli/sb/stages/config" xmlns:con6="http://www.bea.com/wli/sb/stages/transform/config">
                                                                <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7a98</con1:id>
                                                                <con6:expr>
                                                                  <con1:xqueryText>"909"</con1:xqueryText>
                                                                </con6:expr>
                                                              </con6:assign>
                                                            </con1:actions>
                                                          </con1:case>
                                                          <con1:default>
                                                            <con6:insert varName="reglasNegocioResponse" xmlns:con3="http://www.bea.com/wli/sb/stages/transform/config" xmlns:con2="http://www.bea.com/wli/sb/typesystem/config" xmlns:con1="http://www.bea.com/wli/sb/stages/config" xmlns:con6="http://www.bea.com/wli/sb/stages/transform/config">
                                                              <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7a97</con1:id>
                                                              <con6:location>
                                                                <con1:xpathText>./MENSAJE/PARAMETROS</con1:xpathText>
                                                              </con6:location>
                                                              <con6:where>last-child</con6:where>
                                                              <con6:expr>
                                                                <con1:xqueryText><![CDATA[let $fafids := tokenize(data($consultarFAFTipoResponse/MENSAJE/FAFTIPO/FAF_TIPO), ";")
return
<PARAMETRO>
	<NOMBRE>OFFER_ID</NOMBRE>
	<TIPO>string</TIPO>
	<VALOR>{$fafids[3]}</VALOR>
</PARAMETRO>]]></con1:xqueryText>
                                                              </con6:expr>
                                                            </con6:insert>
                                                            <con6:insert varName="reglasNegocioResponse" xmlns:con3="http://www.bea.com/wli/sb/stages/transform/config" xmlns:con2="http://www.bea.com/wli/sb/typesystem/config" xmlns:con1="http://www.bea.com/wli/sb/stages/config" xmlns:con6="http://www.bea.com/wli/sb/stages/transform/config">
                                                              <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7a96</con1:id>
                                                              <con6:location>
                                                                <con1:xpathText>./MENSAJE/PARAMETROS</con1:xpathText>
                                                              </con6:location>
                                                              <con6:where>last-child</con6:where>
                                                              <con6:expr>
                                                                <con1:xqueryText><![CDATA[let $fafids := tokenize(data($consultarFAFTipoResponse/MENSAJE/FAFTIPO/FAF_TIPO), ";")
return
<PARAMETRO>
	<NOMBRE>FAF_ID</NOMBRE>
	<TIPO>string</TIPO>
	<VALOR>{$fafids[1]}</VALOR>
</PARAMETRO>]]></con1:xqueryText>
                                                              </con6:expr>
                                                            </con6:insert>
                                                          </con1:default>
                                                        </con1:ifThenElse>
                                                      </con3:responseTransform>
                                                    </con3:wsCallout>
                                                    <con3:ifThenElse>
                                                      <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7a6f</con1:id>
                                                      <con3:case>
                                                        <con3:condition>
                                                          <con1:xqueryText>fn:exists($consultarFAFTipoResponse/MENSAJE/FAFTIPO/FAF_TIPO)</con1:xqueryText>
                                                        </con3:condition>
                                                        <con3:actions>
                                                          <con3:wsCallout>
                                                            <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7a6d</con1:id>
                                                            <con3:service xsi:type="ref:ProxyRef" ref="ITEL/OCS/OLM/Proxies/consultarSuscripcionOCSLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                                            <con3:operation>consultarSuscripcionOCS</con3:operation>
                                                            <con3:request>
                                                              <con3:body>$consultarSuscripcionOCSRequest</con3:body>
                                                            </con3:request>
                                                            <con3:response>
                                                              <con3:body>consultarSuscripcionOCSResponse</con3:body>
                                                            </con3:response>
                                                            <con3:requestTransform>
                                                              <con3:assign varName="consultarSuscripcionOCSRequest">
                                                                <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7a6e</con1:id>
                                                                <con3:expr>
                                                                  <con1:xqueryTransform>
                                                                    <con1:resource ref="ITEL/Core/Resources/XQueries/consultarSuscripcionOCSPS_Req"/>
                                                                    <con1:param name="min">
                                                                      <con1:path>data($body/ejec:Input_Parameters/MIN_DESTINO)</con1:path>
                                                                    </con1:param>
                                                                  </con1:xqueryTransform>
                                                                </con3:expr>
                                                              </con3:assign>
                                                            </con3:requestTransform>
                                                            <con3:responseTransform/>
                                                          </con3:wsCallout>
                                                          <con1:wsCallout xmlns:con3="http://www.bea.com/wli/sb/typesystem/config" xmlns:con2="http://www.bea.com/wli/sb/stages/config" xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
                                                            <con6:id xmlns:con6="http://www.bea.com/wli/sb/stages/config">_ActionId-2215439518611274108-740768fe.1574d206712.-7a69</con6:id>
                                                            <con1:service xsi:type="ref:ProxyRef" ref="ITEL/OCS/AIR/Proxies/consultarFaFListOCSLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                                            <con1:operation>consultarFaFList</con1:operation>
                                                            <con1:request>
                                                              <con1:body>$consultarFaFListRequest</con1:body>
                                                            </con1:request>
                                                            <con1:response>
                                                              <con1:body>consultarFaFListResponse</con1:body>
                                                            </con1:response>
                                                            <con1:requestTransform>
                                                              <con1:assign varName="consultarFaFListRequest">
                                                                <con6:id xmlns:con6="http://www.bea.com/wli/sb/stages/config">_ActionId-2215439518611274108-740768fe.1574d206712.-7a6c</con6:id>
                                                                <con1:expr>
                                                                  <con6:xqueryTransform xmlns:con6="http://www.bea.com/wli/sb/stages/config">
                                                                    <con6:resource ref="ITEL/Core/Resources/XQueries/consultarFaFListPS_Req"/>
                                                                    <con6:param name="min">
                                                                      <con6:path>data($body/ejec:Input_Parameters/MIN_DESTINO)</con6:path>
                                                                    </con6:param>
                                                                  </con6:xqueryTransform>
                                                                </con1:expr>
                                                              </con1:assign>
                                                            </con1:requestTransform>
                                                            <con1:responseTransform>
                                                              <con1:ifThenElse>
                                                                <con6:id xmlns:con6="http://www.bea.com/wli/sb/stages/config">_ActionId-2215439518611274108-740768fe.1574d206712.-7a6b</con6:id>
                                                                <con1:case>
                                                                  <con1:condition>
                                                                    <con6:xqueryText xmlns:con6="http://www.bea.com/wli/sb/stages/config">data($consultarFaFListResponse/CODIGO) != '1'</con6:xqueryText>
                                                                  </con1:condition>
                                                                  <con1:actions>
                                                                    <con6:assign varName="codError" xmlns:con3="http://www.bea.com/wli/sb/stages/transform/config" xmlns:con2="http://www.bea.com/wli/sb/typesystem/config" xmlns:con1="http://www.bea.com/wli/sb/stages/config" xmlns:con6="http://www.bea.com/wli/sb/stages/transform/config">
                                                                      <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7a6a</con1:id>
                                                                      <con6:expr>
                                                                        <con1:xqueryText>data($consultarFaFListResponse/CODIGO)</con1:xqueryText>
                                                                      </con6:expr>
                                                                    </con6:assign>
                                                                  </con1:actions>
                                                                </con1:case>
                                                                <con1:default/>
                                                              </con1:ifThenElse>
                                                            </con1:responseTransform>
                                                          </con1:wsCallout>
                                                          <con3:wsCallout>
                                                            <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7a65</con1:id>
                                                            <con3:service xsi:type="ref:ProxyRef" ref="ITEL/OCS/AIR/Proxies/consultarOfferOCSLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                                            <con3:operation>consultarOffer</con3:operation>
                                                            <con3:request>
                                                              <con3:body>$consultarOfferRequest</con3:body>
                                                            </con3:request>
                                                            <con3:response>
                                                              <con3:body>consultarOfferResponse</con3:body>
                                                            </con3:response>
                                                            <con3:requestTransform>
                                                              <con3:assign varName="consultarOfferRequest">
                                                                <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7a68</con1:id>
                                                                <con3:expr>
                                                                  <con1:xqueryTransform>
                                                                    <con1:resource ref="ITEL/Core/Resources/XQueries/consultarOfferPS_Req"/>
                                                                    <con1:param name="min">
                                                                      <con1:path>data($body/ejec:Input_Parameters/MIN_DESTINO)</con1:path>
                                                                    </con1:param>
                                                                  </con1:xqueryTransform>
                                                                </con3:expr>
                                                              </con3:assign>
                                                            </con3:requestTransform>
                                                            <con3:responseTransform>
                                                              <con1:ifThenElse xmlns:con3="http://www.bea.com/wli/sb/typesystem/config" xmlns:con2="http://www.bea.com/wli/sb/stages/config" xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
                                                                <con6:id xmlns:con6="http://www.bea.com/wli/sb/stages/config">_ActionId-2215439518611274108-740768fe.1574d206712.-7a67</con6:id>
                                                                <con1:case>
                                                                  <con1:condition>
                                                                    <con6:xqueryText xmlns:con6="http://www.bea.com/wli/sb/stages/config">data($consultarOfferResponse/CODIGO) != '1'</con6:xqueryText>
                                                                  </con1:condition>
                                                                  <con1:actions>
                                                                    <con6:assign varName="codError" xmlns:con3="http://www.bea.com/wli/sb/stages/transform/config" xmlns:con2="http://www.bea.com/wli/sb/typesystem/config" xmlns:con1="http://www.bea.com/wli/sb/stages/config" xmlns:con6="http://www.bea.com/wli/sb/stages/transform/config">
                                                                      <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7a66</con1:id>
                                                                      <con6:expr>
                                                                        <con1:xqueryText>data($consultarOfferResponse/CODIGO)</con1:xqueryText>
                                                                      </con6:expr>
                                                                    </con6:assign>
                                                                  </con1:actions>
                                                                </con1:case>
                                                                <con1:default/>
                                                              </con1:ifThenElse>
                                                            </con3:responseTransform>
                                                          </con3:wsCallout>
                                                          <con3:ifThenElse>
                                                            <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7a64</con1:id>
                                                            <con3:case>
                                                              <con3:condition>
                                                                <con1:xqueryText>$codError = "1" and 
fn:exists($consultarFaFListResponse/MENSAJE/CONSULTAR_FAFLIST/fafInformationList/Detail/fafIndicator)</con1:xqueryText>
                                                              </con3:condition>
                                                              <con3:actions>
                                                                <con3:replace varName="consultarFaFListRes">
                                                                  <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7a63</con1:id>
                                                                  <con3:expr>
                                                                    <con1:xqueryTransform>
                                                                      <con1:resource ref="ITEL/Core/Resources/XQueries/ejecutarReglasNegocio_Res_consultarFaFList"/>
                                                                      <con1:param name="wS_Result2">
                                                                        <con1:path>$consultarFaFListResponse</con1:path>
                                                                      </con1:param>
                                                                      <con1:param name="wS_Result1">
                                                                        <con1:path>$consultarFAFTipoResponse</con1:path>
                                                                      </con1:param>
                                                                    </con1:xqueryTransform>
                                                                  </con3:expr>
                                                                </con3:replace>
                                                              </con3:actions>
                                                            </con3:case>
                                                            <con3:default>
                                                              <con3:replace varName="consultarFaFListRes">
                                                                <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7a62</con1:id>
                                                                <con3:expr>
                                                                  <con1:xqueryTransform>
                                                                    <con1:resource ref="ITEL/Core/Resources/XQueries/ejecutarReglasNegocio_Res_consultarFaFListOffers"/>
                                                                    <con1:param name="wS_Result2">
                                                                      <con1:path>$consultarFaFListResponse</con1:path>
                                                                    </con1:param>
                                                                    <con1:param name="wS_Result1">
                                                                      <con1:path>$consultarOfferResponse</con1:path>
                                                                    </con1:param>
                                                                  </con1:xqueryTransform>
                                                                </con3:expr>
                                                              </con3:replace>
                                                            </con3:default>
                                                          </con3:ifThenElse>
                                                          <con3:ifThenElse>
                                                            <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7a61</con1:id>
                                                            <con3:case>
                                                              <con3:condition>
                                                                <con1:xqueryText>$codError = "1"
and data($body/ejec:Input_Parameters/PARAMETROS_TRAMA/PARAMETRO[NOMBRE='HOSTID']/VALOR)="501"</con1:xqueryText>
                                                              </con3:condition>
                                                              <con3:actions>
                                                                <con3:assign varName="elegidos">
                                                                  <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7a60</con1:id>
                                                                  <con3:expr>
                                                                    <con1:xqueryText>&lt;ELEGIDOS>
{	let $elegidos := fn:tokenize($body/ejec:Input_Parameters/PARAMETROS_TRAMA/PARAMETRO[NOMBRE='MONTORECARGA']/VALOR, ';')
	for $i in (1 to fn:count($elegidos))
	return 
	&lt;ELEGIDO>{$elegidos[$i]}&lt;/ELEGIDO>
}
&lt;/ELEGIDOS></con1:xqueryText>
                                                                  </con3:expr>
                                                                </con3:assign>
                                                                <con3:assign varName="elegidosNRN">
                                                                  <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7a5f</con1:id>
                                                                  <con3:expr>
                                                                    <con1:xqueryText>''</con1:xqueryText>
                                                                  </con3:expr>
                                                                </con3:assign>
                                                                <con3:foreach>
                                                                  <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7a53</con1:id>
                                                                  <con3:variable>elegidos</con3:variable>
                                                                  <con3:expression>
                                                                    <con1:xpathText>./ELEGIDO</con1:xpathText>
                                                                  </con3:expression>
                                                                  <con3:value-variable>elegido</con3:value-variable>
                                                                  <con3:index-variable>indice</con3:index-variable>
                                                                  <con3:total-variable>total</con3:total-variable>
                                                                  <con3:actions>
                                                                    <con3:ifThenElse>
                                                                      <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7a5e</con1:id>
                                                                      <con3:case>
                                                                        <con3:condition>
                                                                          <con1:xqueryText>substring(data($elegido), 1, 2) != '03'</con1:xqueryText>
                                                                        </con3:condition>
                                                                        <con3:actions>
                                                                          <con3:wsCallout>
                                                                            <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7a5c</con1:id>
                                                                            <con3:service xsi:type="ref:ProxyRef" ref="ITEL/OCS/SOI/Proxies/consultarSuscriptorOCSLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                                                            <con3:operation>consultarSuscriptorOCS</con3:operation>
                                                                            <con3:request>
                                                                              <con3:body>$suscriptorOCSRequest</con3:body>
                                                                            </con3:request>
                                                                            <con3:response>
                                                                              <con3:body>suscriptorOCSResponse</con3:body>
                                                                            </con3:response>
                                                                            <con3:requestTransform>
                                                                              <con3:assign varName="suscriptorOCSRequest">
                                                                                <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7a5d</con1:id>
                                                                                <con3:expr>
                                                                                  <con1:xqueryTransform>
                                                                                    <con1:resource ref="ITEL/Core/Resources/XQueries/consultarSuscriptorOCSPS_Req"/>
                                                                                    <con1:param name="timeout">
                                                                                      <con1:path>2000</con1:path>
                                                                                    </con1:param>
                                                                                    <con1:param name="in">
                                                                                      <con1:path>data($body/ejec:Input_Parameters/IN_DESTINO)</con1:path>
                                                                                    </con1:param>
                                                                                    <con1:param name="min">
                                                                                      <con1:path>data($elegido)</con1:path>
                                                                                    </con1:param>
                                                                                  </con1:xqueryTransform>
                                                                                </con3:expr>
                                                                              </con3:assign>
                                                                            </con3:requestTransform>
                                                                            <con3:responseTransform/>
                                                                          </con3:wsCallout>
                                                                          <con3:ifThenElse>
                                                                            <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7a5b</con1:id>
                                                                            <con3:case>
                                                                              <con3:condition>
                                                                                <con1:xqueryText>data($suscriptorOCSResponse/CODIGO) = '1'</con1:xqueryText>
                                                                              </con3:condition>
                                                                              <con3:actions>
                                                                                <con3:assign varName="elegidosNRN">
                                                                                  <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7a5a</con1:id>
                                                                                  <con3:expr>
                                                                                    <con1:xqueryText>let $eleg := concat('132', $elegido)
return if($elegidosNRN = '') then 
	   		$eleg
       else  concat($elegidosNRN, ';', $eleg)</con1:xqueryText>
                                                                                  </con3:expr>
                                                                                </con3:assign>
                                                                              </con3:actions>
                                                                            </con3:case>
                                                                            <con3:default>
                                                                              <con3:wsCallout>
                                                                                <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7a55</con1:id>
                                                                                <con3:service xsi:type="ref:ProxyRef" ref="ITEL/Core/Proxies/consultarNRNLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                                                                <con3:operation>consultarNRN</con3:operation>
                                                                                <con3:request>
                                                                                  <con3:body>$nrnRequest</con3:body>
                                                                                </con3:request>
                                                                                <con3:response>
                                                                                  <con3:body>nrnResponse</con3:body>
                                                                                </con3:response>
                                                                                <con3:requestTransform>
                                                                                  <con3:assign varName="nrnRequest">
                                                                                    <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7a59</con1:id>
                                                                                    <con3:expr>
                                                                                      <con1:xqueryTransform>
                                                                                        <con1:resource ref="ITEL/Core/Resources/XQueries/consultarNRNPS_Req"/>
                                                                                        <con1:param name="min">
                                                                                          <con1:path>data($elegido)</con1:path>
                                                                                        </con1:param>
                                                                                      </con1:xqueryTransform>
                                                                                    </con3:expr>
                                                                                  </con3:assign>
                                                                                </con3:requestTransform>
                                                                                <con3:responseTransform>
                                                                                  <con3:ifThenElse>
                                                                                    <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7a58</con1:id>
                                                                                    <con3:case>
                                                                                      <con3:condition>
                                                                                        <con1:xqueryText>data($nrnResponse/CODIGO) != "OK" or data($nrnResponse/MENSAJE/NRN) = "ERROR"</con1:xqueryText>
                                                                                      </con3:condition>
                                                                                      <con3:actions>
                                                                                        <con3:assign varName="codError">
                                                                                          <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7a57</con1:id>
                                                                                          <con3:expr>
                                                                                            <con1:xqueryText>"52"</con1:xqueryText>
                                                                                          </con3:expr>
                                                                                        </con3:assign>
                                                                                      </con3:actions>
                                                                                    </con3:case>
                                                                                    <con3:default>
                                                                                      <con3:assign varName="elegidosNRN">
                                                                                        <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7a56</con1:id>
                                                                                        <con3:expr>
                                                                                          <con1:xqueryText>let $eleg := concat(data($nrnResponse/MENSAJE/NRN), $elegido)
return if($elegidosNRN = '') then 
	   		$eleg
       else  concat($elegidosNRN, ';', $eleg)</con1:xqueryText>
                                                                                        </con3:expr>
                                                                                      </con3:assign>
                                                                                    </con3:default>
                                                                                  </con3:ifThenElse>
                                                                                </con3:responseTransform>
                                                                              </con3:wsCallout>
                                                                            </con3:default>
                                                                          </con3:ifThenElse>
                                                                        </con3:actions>
                                                                      </con3:case>
                                                                      <con3:default>
                                                                        <con3:assign varName="elegidosNRN">
                                                                          <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7a54</con1:id>
                                                                          <con3:expr>
                                                                            <con1:xqueryText>if($elegidosNRN = '') then 
	   		data($elegido)
else  concat($elegidosNRN, ';', data($elegido))</con1:xqueryText>
                                                                          </con3:expr>
                                                                        </con3:assign>
                                                                      </con3:default>
                                                                    </con3:ifThenElse>
                                                                  </con3:actions>
                                                                </con3:foreach>
                                                                <con3:insert varName="reglasNegocioResponse">
                                                                  <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7a52</con1:id>
                                                                  <con3:location>
                                                                    <con1:xpathText>./MENSAJE/PARAMETROS</con1:xpathText>
                                                                  </con3:location>
                                                                  <con3:where>last-child</con3:where>
                                                                  <con3:expr>
                                                                    <con1:xqueryText><![CDATA[<PARAMETRO>
	<NOMBRE>ELEGIDOSNRN</NOMBRE>
	<TIPO>string</TIPO>
	<VALOR>{$elegidosNRN}</VALOR>
</PARAMETRO>]]></con1:xqueryText>
                                                                  </con3:expr>
                                                                </con3:insert>
                                                              </con3:actions>
                                                            </con3:case>
                                                            <con3:case>
                                                              <con3:condition>
                                                                <con1:xqueryText>$codError = "1"</con1:xqueryText>
                                                              </con3:condition>
                                                              <con3:actions>
                                                                <con3:assign varName="elegidosNRN">
                                                                  <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7a51</con1:id>
                                                                  <con3:expr>
                                                                    <con1:xqueryText>data($body/ejec:Input_Parameters/PARAMETROS_TRAMA/PARAMETRO[NOMBRE='MONTORECARGA']/VALOR)</con1:xqueryText>
                                                                  </con3:expr>
                                                                </con3:assign>
                                                                <con3:insert varName="reglasNegocioResponse">
                                                                  <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7a50</con1:id>
                                                                  <con3:location>
                                                                    <con1:xpathText>./MENSAJE/PARAMETROS</con1:xpathText>
                                                                  </con3:location>
                                                                  <con3:where>last-child</con3:where>
                                                                  <con3:expr>
                                                                    <con1:xqueryText><![CDATA[<PARAMETRO>
	<NOMBRE>ELEGIDOSNRN</NOMBRE>
	<TIPO>string</TIPO>
	<VALOR>{$elegidosNRN}</VALOR>
</PARAMETRO>]]></con1:xqueryText>
                                                                  </con3:expr>
                                                                </con3:insert>
                                                              </con3:actions>
                                                            </con3:case>
                                                            <con3:default/>
                                                          </con3:ifThenElse>
                                                          <con3:ifThenElse>
                                                            <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7a4f</con1:id>
                                                            <con3:case>
                                                              <con3:condition>
                                                                <con1:xqueryText>$codError = "1"</con1:xqueryText>
                                                              </con3:condition>
                                                              <con3:actions>
                                                                <con3:wsCallout>
                                                                  <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7a4d</con1:id>
                                                                  <con3:service xsi:type="ref:ProxyRef" ref="ITEL/Core/Proxies/consultarContratoEsPostpagoLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                                                  <con3:operation>consultarContratoEsPostpago</con3:operation>
                                                                  <con3:request>
                                                                    <con3:body>$consultarContratoEsPospagoRequest</con3:body>
                                                                  </con3:request>
                                                                  <con3:response>
                                                                    <con3:body>consultarContratoEsPospagoResponse</con3:body>
                                                                  </con3:response>
                                                                  <con3:requestTransform>
                                                                    <con3:assign varName="consultarContratoEsPospagoRequest">
                                                                      <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7a4e</con1:id>
                                                                      <con3:expr>
                                                                        <con1:xqueryText>&lt;con:Input_Parameters xmlns:con="http://www.comcel.com.co/ConsultarContractEsPostPago">
    &lt;con:CONTRACT>{ $esPostPago }&lt;/con:CONTRACT>
&lt;/con:Input_Parameters></con1:xqueryText>
                                                                      </con3:expr>
                                                                    </con3:assign>
                                                                  </con3:requestTransform>
                                                                  <con3:responseTransform/>
                                                                </con3:wsCallout>
                                                                <con3:insert varName="reglasNegocioResponse">
                                                                  <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7a4c</con1:id>
                                                                  <con3:location>
                                                                    <con1:xpathText>./*:MENSAJE/*:PARAMETROS</con1:xpathText>
                                                                  </con3:location>
                                                                  <con3:where>last-child</con3:where>
                                                                  <con3:expr>
                                                                    <con1:xqueryText><![CDATA[<PARAMETRO>
	<NOMBRE>ESPOSTPAGO</NOMBRE>
	<TIPO>string</TIPO>
	<VALOR>{ data($consultarContratoEsPospagoResponse/*:MENSAJE/*:ESPOSTPAGO) }</VALOR>
</PARAMETRO>]]></con1:xqueryText>
                                                                  </con3:expr>
                                                                </con3:insert>
                                                              </con3:actions>
                                                            </con3:case>
                                                            <con3:default/>
                                                          </con3:ifThenElse>
                                                        </con3:actions>
                                                      </con3:case>
                                                      <con3:default>
                                                        <con3:assign varName="codError">
                                                          <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7a4b</con1:id>
                                                          <con3:expr>
                                                            <con1:xqueryText>"912"</con1:xqueryText>
                                                          </con3:expr>
                                                        </con3:assign>
                                                      </con3:default>
                                                    </con3:ifThenElse>
                                                  </con3:actions>
                                                </con3:case>
                                                <con3:default/>
                                              </con3:ifThenElse>
                                            </con3:actions>
                                          </con3:case>
                                          <con3:case>
                                            <con3:condition>
                                              <con1:xqueryText>$metodo = ("302","303","304","305","308","311","312", "314","315")</con1:xqueryText>
                                            </con3:condition>
                                            <con3:actions>
                                              <con3:ifThenElse>
                                                <con1:id>_ActionId-6729830898439867306--5881debc.156a40614bf.-7f9d</con1:id>
                                                <con3:case>
                                                  <con3:condition>
                                                    <con1:xqueryText>$metodo = ("3111")</con1:xqueryText>
                                                  </con3:condition>
                                                  <con3:actions>
                                                    <con3:assign varName="esPostPago">
                                                      <con1:id>_ActionId-6729830898439867306--5881debc.156a40614bf.-7eed</con1:id>
                                                      <con3:expr>
                                                        <con1:xqueryText>data($suscriptorOCSResponse/MENSAJE/CONSULTAR_SUSCRIPTOR/*:suscriptor/*:PublicRatePlanCode)</con1:xqueryText>
                                                      </con3:expr>
                                                    </con3:assign>
                                                    <con3:wsCallout>
                                                      <con1:id>_ActionId-6729830898439867306--5881debc.156a40614bf.-7eef</con1:id>
                                                      <con3:service xsi:type="ref:ProxyRef" ref="ITEL/Core/Proxies/consultarContratoEsPostpagoLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                                      <con3:operation>consultarContratoEsPostpago</con3:operation>
                                                      <con3:request>
                                                        <con3:body>$consultarContratoEsPospagoRequest</con3:body>
                                                      </con3:request>
                                                      <con3:response>
                                                        <con3:body>consultarContratoEsPospagoResponse</con3:body>
                                                      </con3:response>
                                                      <con3:requestTransform>
                                                        <con3:assign varName="consultarContratoEsPospagoRequest">
                                                          <con1:id>_ActionId-6729830898439867306--5881debc.156a40614bf.-7ef0</con1:id>
                                                          <con3:expr>
                                                            <con1:xqueryText>&lt;con:Input_Parameters xmlns:con="http://www.comcel.com.co/ConsultarContractEsPostPago">
    &lt;con:CONTRACT>{ $esPostPago }&lt;/con:CONTRACT>
&lt;/con:Input_Parameters></con1:xqueryText>
                                                          </con3:expr>
                                                        </con3:assign>
                                                      </con3:requestTransform>
                                                      <con3:responseTransform/>
                                                    </con3:wsCallout>
                                                    <con3:insert varName="reglasNegocioResponse">
                                                      <con1:id>_ActionId-6729830898439867306--5881debc.156a40614bf.-7e97</con1:id>
                                                      <con3:location>
                                                        <con1:xpathText>./*:MENSAJE/*:PARAMETROS</con1:xpathText>
                                                      </con3:location>
                                                      <con3:where>last-child</con3:where>
                                                      <con3:expr>
                                                        <con1:xqueryText><![CDATA[<PARAMETRO>
	<NOMBRE>ESPOSTPAGO</NOMBRE>
	<TIPO>string</TIPO>
	<VALOR>{ data($consultarContratoEsPospagoResponse/*:MENSAJE/*:ESPOSTPAGO) }</VALOR>
</PARAMETRO>]]></con1:xqueryText>
                                                      </con3:expr>
                                                    </con3:insert>
                                                  </con3:actions>
                                                </con3:case>
                                                <con3:default/>
                                              </con3:ifThenElse>
                                              <con3:ifThenElse>
                                                <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7c44</con1:id>
                                                <con3:case>
                                                  <con3:condition>
                                                    <con1:xqueryText>$codError = '1'</con1:xqueryText>
                                                  </con3:condition>
                                                  <con3:actions>
                                                    <con1:wsCallout xmlns:con3="http://www.bea.com/wli/sb/typesystem/config" xmlns:con2="http://www.bea.com/wli/sb/stages/config" xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
                                                      <con6:id xmlns:con6="http://www.bea.com/wli/sb/stages/config">_ActionId-2215439518611274108-740768fe.1574d206712.-7c30</con6:id>
                                                      <con1:service xsi:type="ref:ProxyRef" ref="ITEL/OCS/AIR/Proxies/consultarFaFListOCSLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                                      <con1:operation>consultarFaFList</con1:operation>
                                                      <con1:request>
                                                        <con1:body>$consultarFaFListRequest</con1:body>
                                                      </con1:request>
                                                      <con1:response>
                                                        <con1:body>consultarFaFListResponse</con1:body>
                                                      </con1:response>
                                                      <con1:requestTransform>
                                                        <con1:assign varName="consultarFaFListRequest">
                                                          <con6:id xmlns:con6="http://www.bea.com/wli/sb/stages/config">_ActionId-2215439518611274108-740768fe.1574d206712.-7c39</con6:id>
                                                          <con1:expr>
                                                            <con6:xqueryTransform xmlns:con6="http://www.bea.com/wli/sb/stages/config">
                                                              <con6:resource ref="ITEL/Core/Resources/XQueries/consultarFaFListPS_Req"/>
                                                              <con6:param name="min">
                                                                <con6:path>data($body/ejec:Input_Parameters/MIN_DESTINO)</con6:path>
                                                              </con6:param>
                                                            </con6:xqueryTransform>
                                                          </con1:expr>
                                                        </con1:assign>
                                                      </con1:requestTransform>
                                                      <con1:responseTransform>
                                                        <con1:ifThenElse>
                                                          <con6:id xmlns:con6="http://www.bea.com/wli/sb/stages/config">_ActionId-2215439518611274108-740768fe.1574d206712.-7c38</con6:id>
                                                          <con1:case>
                                                            <con1:condition>
                                                              <con6:xqueryText xmlns:con6="http://www.bea.com/wli/sb/stages/config">data($consultarFaFListResponse/CODIGO) != '1'</con6:xqueryText>
                                                            </con1:condition>
                                                            <con1:actions>
                                                              <con6:assign varName="codError" xmlns:con3="http://www.bea.com/wli/sb/stages/transform/config" xmlns:con2="http://www.bea.com/wli/sb/typesystem/config" xmlns:con1="http://www.bea.com/wli/sb/stages/config" xmlns:con6="http://www.bea.com/wli/sb/stages/transform/config">
                                                                <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7c37</con1:id>
                                                                <con6:expr>
                                                                  <con1:xqueryText>data($consultarFaFListResponse/CODIGO)</con1:xqueryText>
                                                                </con6:expr>
                                                              </con6:assign>
                                                            </con1:actions>
                                                          </con1:case>
                                                          <con1:default>
                                                            <con6:assign varName="fafID" xmlns:con6="http://www.bea.com/wli/sb/stages/transform/config">
                                                              <con7:id xmlns:con7="http://www.bea.com/wli/sb/stages/config">_ActionId-2215439518611274108-740768fe.1574d206712.-7c36</con7:id>
                                                              <con6:expr>
                                                                <con7:xqueryTransform xmlns:con7="http://www.bea.com/wli/sb/stages/config">
                                                                  <con7:resource ref="ITEL/Core/Resources/XQueries/obtenerFAFID"/>
                                                                  <con7:param name="fafList">
                                                                    <con7:path>$consultarFaFListResponse</con7:path>
                                                                  </con7:param>
                                                                  <con7:param name="metodoFAF">
                                                                    <con7:path>$tipoFAFResponse</con7:path>
                                                                  </con7:param>
                                                                </con7:xqueryTransform>
                                                              </con6:expr>
                                                            </con6:assign>
                                                            <con1:ifThenElse>
                                                              <con6:id xmlns:con6="http://www.bea.com/wli/sb/stages/config">_ActionId-2215439518611274108-740768fe.1574d206712.-7c35</con6:id>
                                                              <con1:case>
                                                                <con1:condition>
                                                                  <con6:xqueryText xmlns:con6="http://www.bea.com/wli/sb/stages/config">$fafID="" and not($metodo = ("314","315"))</con6:xqueryText>
                                                                </con1:condition>
                                                                <con1:actions>
                                                                  <con1:assign varName="codError">
                                                                    <con6:id xmlns:con6="http://www.bea.com/wli/sb/stages/config">_ActionId-2215439518611274108-740768fe.1574d206712.-7c34</con6:id>
                                                                    <con1:expr>
                                                                      <con6:xqueryText xmlns:con6="http://www.bea.com/wli/sb/stages/config">"924"</con6:xqueryText>
                                                                    </con1:expr>
                                                                  </con1:assign>
                                                                </con1:actions>
                                                              </con1:case>
                                                              <con1:default>
                                                                <con1:ifThenElse>
                                                                  <con6:id xmlns:con6="http://www.bea.com/wli/sb/stages/config">_ActionId-2215439518611274108-740768fe.1574d206712.-7c33</con6:id>
                                                                  <con1:case>
                                                                    <con1:condition>
                                                                      <con6:xqueryText xmlns:con6="http://www.bea.com/wli/sb/stages/config">$metodo = ("311", "314")</con6:xqueryText>
                                                                    </con1:condition>
                                                                    <con1:actions>
                                                                      <con6:insert varName="reglasNegocioResponse" xmlns:con3="http://www.bea.com/wli/sb/stages/transform/config" xmlns:con2="http://www.bea.com/wli/sb/typesystem/config" xmlns:con1="http://www.bea.com/wli/sb/stages/config" xmlns:con6="http://www.bea.com/wli/sb/stages/transform/config">
                                                                        <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7c32</con1:id>
                                                                        <con6:location>
                                                                          <con1:xpathText>./MENSAJE/PARAMETROS</con1:xpathText>
                                                                        </con6:location>
                                                                        <con6:where>last-child</con6:where>
                                                                        <con6:expr>
                                                                          <con1:xqueryText><![CDATA[<PARAMETRO>
	 <NOMBRE>FAFID</NOMBRE>
	 <TIPO>string</TIPO>
	 <VALOR>{ $fafID }</VALOR>
</PARAMETRO>]]></con1:xqueryText>
                                                                        </con6:expr>
                                                                      </con6:insert>
                                                                    </con1:actions>
                                                                  </con1:case>
                                                                  <con1:default>
                                                                    <con6:assign varName="reglasNegocioResponse" xmlns:con3="http://www.bea.com/wli/sb/stages/transform/config" xmlns:con2="http://www.bea.com/wli/sb/typesystem/config" xmlns:con1="http://www.bea.com/wli/sb/stages/config" xmlns:con7="http://www.bea.com/wli/sb/stages/transform/config" xmlns:con6="http://www.bea.com/wli/sb/stages/transform/config">
                                                                      <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7c31</con1:id>
                                                                      <con6:expr>
                                                                        <con1:xqueryText><![CDATA[<ns0:WS_Result xmlns:ns0="http://www.comcel.com.co/ConsultarReglas/">
	<CODIGO>1</CODIGO>
	<MENSAJE>
		<ERROR>1</ERROR>
		<ERRORDESC></ERRORDESC>
		<CONSULTASUSCRIPTOR>FALSE</CONSULTASUSCRIPTOR>
		<PARAMETROS>
			<PARAMETRO>
				<NOMBRE>FAFID</NOMBRE>
				<TIPO>string</TIPO>
				<VALOR>{ $fafID }</VALOR>
			</PARAMETRO>
		</PARAMETROS>
	</MENSAJE>
</ns0:WS_Result>]]></con1:xqueryText>
                                                                      </con6:expr>
                                                                    </con6:assign>
                                                                  </con1:default>
                                                                </con1:ifThenElse>
                                                              </con1:default>
                                                            </con1:ifThenElse>
                                                          </con1:default>
                                                        </con1:ifThenElse>
                                                      </con1:responseTransform>
                                                    </con1:wsCallout>
                                                    <con3:ifThenElse>
                                                      <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7c27</con1:id>
                                                      <con3:case>
                                                        <con3:condition>
                                                          <con1:xqueryText>$metodo = ("314","315")</con1:xqueryText>
                                                        </con3:condition>
                                                        <con3:actions>
                                                          <con3:wsCallout>
                                                            <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7c23</con1:id>
                                                            <con3:service xsi:type="ref:ProxyRef" ref="ITEL/Core/Proxies/consultarFAFTipoLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                                            <con3:operation>consultarFAFTipo</con3:operation>
                                                            <con3:request>
                                                              <con3:body>$consultarFAFTipoRequest</con3:body>
                                                            </con3:request>
                                                            <con3:response>
                                                              <con3:body>consultarFAFTipoResponse</con3:body>
                                                            </con3:response>
                                                            <con3:requestTransform>
                                                              <con3:assign varName="consultarFAFTipoRequest">
                                                                <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7c26</con1:id>
                                                                <con3:expr>
                                                                  <con1:xqueryTransform>
                                                                    <con1:resource ref="ITEL/Core/Resources/XQueries/consultaFAFTipoPS_Req"/>
                                                                    <con1:param name="faf">
                                                                      <con1:path>data($body/ejec:Input_Parameters/PARAMETROS_TRAMA/PARAMETRO[NOMBRE="MONTORECARGA"]/VALOR)</con1:path>
                                                                    </con1:param>
                                                                  </con1:xqueryTransform>
                                                                </con3:expr>
                                                              </con3:assign>
                                                            </con3:requestTransform>
                                                            <con3:responseTransform>
                                                              <con1:ifThenElse xmlns:con3="http://www.bea.com/wli/sb/typesystem/config" xmlns:con2="http://www.bea.com/wli/sb/stages/config" xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
                                                                <con6:id xmlns:con6="http://www.bea.com/wli/sb/stages/config">_ActionId-2215439518611274108-740768fe.1574d206712.-7c25</con6:id>
                                                                <con1:case>
                                                                  <con1:condition>
                                                                    <con6:xqueryText xmlns:con6="http://www.bea.com/wli/sb/stages/config">data($consultarFAFTipoResponse/CODIGO) != 'OK'</con6:xqueryText>
                                                                  </con1:condition>
                                                                  <con1:actions>
                                                                    <con6:assign varName="codError" xmlns:con3="http://www.bea.com/wli/sb/stages/transform/config" xmlns:con2="http://www.bea.com/wli/sb/typesystem/config" xmlns:con1="http://www.bea.com/wli/sb/stages/config" xmlns:con6="http://www.bea.com/wli/sb/stages/transform/config">
                                                                      <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7c24</con1:id>
                                                                      <con6:expr>
                                                                        <con1:xqueryText>"909"</con1:xqueryText>
                                                                      </con6:expr>
                                                                    </con6:assign>
                                                                  </con1:actions>
                                                                </con1:case>
                                                                <con1:default/>
                                                              </con1:ifThenElse>
                                                            </con3:responseTransform>
                                                          </con3:wsCallout>
                                                          <con3:ifThenElse>
                                                            <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7c22</con1:id>
                                                            <con3:case>
                                                              <con3:condition>
                                                                <con1:xqueryText>fn:exists($consultarFAFTipoResponse/MENSAJE/FAFTIPO/FAF_TIPO)</con1:xqueryText>
                                                              </con3:condition>
                                                              <con3:actions>
                                                                <con3:assign varName="codError">
                                                                  <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7c21</con1:id>
                                                                  <con3:expr>
                                                                    <con1:xqueryText>"1"</con1:xqueryText>
                                                                  </con3:expr>
                                                                </con3:assign>
                                                              </con3:actions>
                                                            </con3:case>
                                                            <con3:default>
                                                              <con3:assign varName="codError">
                                                                <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7c20</con1:id>
                                                                <con3:expr>
                                                                  <con1:xqueryText>"912"</con1:xqueryText>
                                                                </con3:expr>
                                                              </con3:assign>
                                                            </con3:default>
                                                          </con3:ifThenElse>
                                                        </con3:actions>
                                                      </con3:case>
                                                      <con3:default/>
                                                    </con3:ifThenElse>
                                                    <con3:ifThenElse>
                                                      <con1:comment>consultarNRN</con1:comment>
                                                      <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7bf5</con1:id>
                                                      <con3:case>
                                                        <con3:condition>
                                                          <con1:xqueryText>$codError = "1" and ($metodo = ("314","315"))
and data($body/ejec:Input_Parameters/PARAMETROS_TRAMA/PARAMETRO[NOMBRE='MONTORECARGA']/VALOR)="501"</con1:xqueryText>
                                                        </con3:condition>
                                                        <con3:actions>
                                                          <con3:assign varName="elegidosNRN">
                                                            <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7bf4</con1:id>
                                                            <con3:expr>
                                                              <con1:xqueryText>""</con1:xqueryText>
                                                            </con3:expr>
                                                          </con3:assign>
                                                          <con3:assign varName="elegidos">
                                                            <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7bf3</con1:id>
                                                            <con3:expr>
                                                              <con1:xqueryText>&lt;ELEGIDOS>
{
	let $elegidos := fn:tokenize($body/ejec:Input_Parameters/PARAMETROS_TRAMA/PARAMETRO[NOMBRE='HOSTID']/VALOR, ';')
	for $i in (1 to fn:count($elegidos))
	return 
	&lt;ELEGIDO>{$elegidos[$i]}&lt;/ELEGIDO>
}
&lt;/ELEGIDOS></con1:xqueryText>
                                                            </con3:expr>
                                                          </con3:assign>
                                                          <con3:ifThenElse>
                                                            <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7bf2</con1:id>
                                                            <con3:case>
                                                              <con3:condition>
                                                                <con1:xqueryText>$body/ejec:Input_Parameters/PARAMETROS_TRAMA/PARAMETRO[NOMBRE='HOSTID']/VALOR != ""</con1:xqueryText>
                                                              </con3:condition>
                                                              <con3:actions>
                                                                <con3:foreach>
                                                                  <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7be6</con1:id>
                                                                  <con3:variable>elegidos</con3:variable>
                                                                  <con3:expression>
                                                                    <con1:xpathText>./ELEGIDO</con1:xpathText>
                                                                  </con3:expression>
                                                                  <con3:value-variable>elegido</con3:value-variable>
                                                                  <con3:index-variable>indice</con3:index-variable>
                                                                  <con3:total-variable>total</con3:total-variable>
                                                                  <con3:actions>
                                                                    <con3:ifThenElse>
                                                                      <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7bf1</con1:id>
                                                                      <con3:case>
                                                                        <con3:condition>
                                                                          <con1:xqueryText>substring(data($elegido), 1, 2) != '03' and data($elegido) != ''</con1:xqueryText>
                                                                        </con3:condition>
                                                                        <con3:actions>
                                                                          <con3:wsCallout>
                                                                            <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7bef</con1:id>
                                                                            <con3:service xsi:type="ref:ProxyRef" ref="ITEL/OCS/SOI/Proxies/consultarSuscriptorOCSLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                                                            <con3:operation>consultarSuscriptorOCS</con3:operation>
                                                                            <con3:request>
                                                                              <con3:body>$suscriptorOCSRequest</con3:body>
                                                                            </con3:request>
                                                                            <con3:response>
                                                                              <con3:body>suscriptorOCSResponse</con3:body>
                                                                            </con3:response>
                                                                            <con3:requestTransform>
                                                                              <con3:assign varName="suscriptorOCSRequest">
                                                                                <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7bf0</con1:id>
                                                                                <con3:expr>
                                                                                  <con1:xqueryTransform>
                                                                                    <con1:resource ref="ITEL/Core/Resources/XQueries/consultarSuscriptorOCSPS_Req"/>
                                                                                    <con1:param name="timeout">
                                                                                      <con1:path>2000</con1:path>
                                                                                    </con1:param>
                                                                                    <con1:param name="in">
                                                                                      <con1:path>data($body/ejec:Input_Parameters/IN_DESTINO)</con1:path>
                                                                                    </con1:param>
                                                                                    <con1:param name="min">
                                                                                      <con1:path>data($elegido)</con1:path>
                                                                                    </con1:param>
                                                                                  </con1:xqueryTransform>
                                                                                </con3:expr>
                                                                              </con3:assign>
                                                                            </con3:requestTransform>
                                                                            <con3:responseTransform/>
                                                                          </con3:wsCallout>
                                                                          <con3:ifThenElse>
                                                                            <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7bee</con1:id>
                                                                            <con3:case>
                                                                              <con3:condition>
                                                                                <con1:xqueryText>data($suscriptorOCSResponse/CODIGO) = '1'</con1:xqueryText>
                                                                              </con3:condition>
                                                                              <con3:actions>
                                                                                <con3:assign varName="elegidosNRN">
                                                                                  <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7bed</con1:id>
                                                                                  <con3:expr>
                                                                                    <con1:xqueryText>let $eleg := concat('132', $elegido)
return if($elegidosNRN = '') then 
	   		$eleg
       else  concat($elegidosNRN, ';', $eleg)</con1:xqueryText>
                                                                                  </con3:expr>
                                                                                </con3:assign>
                                                                              </con3:actions>
                                                                            </con3:case>
                                                                            <con3:default>
                                                                              <con3:wsCallout>
                                                                                <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7be8</con1:id>
                                                                                <con3:service xsi:type="ref:ProxyRef" ref="ITEL/Core/Proxies/consultarNRNLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                                                                <con3:operation>consultarNRN</con3:operation>
                                                                                <con3:request>
                                                                                  <con3:body>$nrnRequest</con3:body>
                                                                                </con3:request>
                                                                                <con3:response>
                                                                                  <con3:body>nrnResponse</con3:body>
                                                                                </con3:response>
                                                                                <con3:requestTransform>
                                                                                  <con3:assign varName="nrnRequest">
                                                                                    <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7bec</con1:id>
                                                                                    <con3:expr>
                                                                                      <con1:xqueryTransform>
                                                                                        <con1:resource ref="ITEL/Core/Resources/XQueries/consultarNRNPS_Req"/>
                                                                                        <con1:param name="min">
                                                                                          <con1:path>data($elegido)</con1:path>
                                                                                        </con1:param>
                                                                                      </con1:xqueryTransform>
                                                                                    </con3:expr>
                                                                                  </con3:assign>
                                                                                </con3:requestTransform>
                                                                                <con3:responseTransform>
                                                                                  <con3:ifThenElse>
                                                                                    <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7beb</con1:id>
                                                                                    <con3:case>
                                                                                      <con3:condition>
                                                                                        <con1:xqueryText>data($nrnResponse/CODIGO) != "OK" or data($nrnResponse/MENSAJE/NRN) = "ERROR"</con1:xqueryText>
                                                                                      </con3:condition>
                                                                                      <con3:actions>
                                                                                        <con3:assign varName="codError">
                                                                                          <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7bea</con1:id>
                                                                                          <con3:expr>
                                                                                            <con1:xqueryText>"52"</con1:xqueryText>
                                                                                          </con3:expr>
                                                                                        </con3:assign>
                                                                                      </con3:actions>
                                                                                    </con3:case>
                                                                                    <con3:default>
                                                                                      <con3:assign varName="elegidosNRN">
                                                                                        <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7be9</con1:id>
                                                                                        <con3:expr>
                                                                                          <con1:xqueryText>let $eleg := concat(data($nrnResponse/MENSAJE/NRN), $elegido)
return if($elegidosNRN = '') then 
	   		$eleg
       else  concat($elegidosNRN, ';', $eleg)</con1:xqueryText>
                                                                                        </con3:expr>
                                                                                      </con3:assign>
                                                                                    </con3:default>
                                                                                  </con3:ifThenElse>
                                                                                </con3:responseTransform>
                                                                              </con3:wsCallout>
                                                                            </con3:default>
                                                                          </con3:ifThenElse>
                                                                        </con3:actions>
                                                                      </con3:case>
                                                                      <con3:default>
                                                                        <con3:assign varName="elegidosNRN">
                                                                          <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7be7</con1:id>
                                                                          <con3:expr>
                                                                            <con1:xqueryText>if($elegidosNRN = '') then 
	   		data($elegido)
else  concat($elegidosNRN, ';', data($elegido))</con1:xqueryText>
                                                                          </con3:expr>
                                                                        </con3:assign>
                                                                      </con3:default>
                                                                    </con3:ifThenElse>
                                                                  </con3:actions>
                                                                </con3:foreach>
                                                                <con3:ifThenElse>
                                                                  <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7be5</con1:id>
                                                                  <con3:case>
                                                                    <con3:condition>
                                                                      <con1:xqueryText>$codError = "1" and $metodo = ("314")</con1:xqueryText>
                                                                    </con3:condition>
                                                                    <con3:actions>
                                                                      <con3:assign varName="elegidosReemplazarNRN">
                                                                        <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7be4</con1:id>
                                                                        <con3:expr>
                                                                          <con1:xqueryText>""</con1:xqueryText>
                                                                        </con3:expr>
                                                                      </con3:assign>
                                                                      <con3:assign varName="elegidosReemplazar">
                                                                        <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7be3</con1:id>
                                                                        <con3:expr>
                                                                          <con1:xqueryText>&lt;ELEGIDOS>
{
	let $elegidos := fn:tokenize($body/ejec:Input_Parameters/PARAMETROS_TRAMA/PARAMETRO[NOMBRE='BONIFICAR']/VALOR, ';')
	for $i in (1 to fn:count($elegidos))
	return 
	&lt;ELEGIDO>{fn:normalize-space($elegidos[$i])}&lt;/ELEGIDO>
}
&lt;/ELEGIDOS></con1:xqueryText>
                                                                        </con3:expr>
                                                                      </con3:assign>
                                                                      <con3:ifThenElse>
                                                                        <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7be2</con1:id>
                                                                        <con3:case>
                                                                          <con3:condition>
                                                                            <con1:xqueryText>$body/ejec:Input_Parameters/PARAMETROS_TRAMA/PARAMETRO[NOMBRE='BONIFICAR']/VALOR != ""</con1:xqueryText>
                                                                          </con3:condition>
                                                                          <con3:actions>
                                                                            <con3:foreach>
                                                                              <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7bd6</con1:id>
                                                                              <con3:variable>elegidosReemplazar</con3:variable>
                                                                              <con3:expression>
                                                                                <con1:xpathText>./ELEGIDO</con1:xpathText>
                                                                              </con3:expression>
                                                                              <con3:value-variable>elegidoReemplazar</con3:value-variable>
                                                                              <con3:index-variable>indiceR</con3:index-variable>
                                                                              <con3:total-variable>totalR</con3:total-variable>
                                                                              <con3:actions>
                                                                                <con3:ifThenElse>
                                                                                  <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7be1</con1:id>
                                                                                  <con3:case>
                                                                                    <con3:condition>
                                                                                      <con1:xqueryText>substring(data($elegidoReemplazar), 1, 2) != '03' and data($elegidoReemplazar) != ''</con1:xqueryText>
                                                                                    </con3:condition>
                                                                                    <con3:actions>
                                                                                      <con3:wsCallout>
                                                                                        <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7bdf</con1:id>
                                                                                        <con3:service xsi:type="ref:ProxyRef" ref="ITEL/OCS/SOI/Proxies/consultarSuscriptorOCSLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                                                                        <con3:operation>consultarSuscriptorOCS</con3:operation>
                                                                                        <con3:request>
                                                                                          <con3:body>$suscriptorOCSRequest</con3:body>
                                                                                        </con3:request>
                                                                                        <con3:response>
                                                                                          <con3:body>suscriptorOCSResponse</con3:body>
                                                                                        </con3:response>
                                                                                        <con3:requestTransform>
                                                                                          <con3:assign varName="suscriptorOCSRequest">
                                                                                            <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7be0</con1:id>
                                                                                            <con3:expr>
                                                                                              <con1:xqueryTransform>
                                                                                                <con1:resource ref="ITEL/Core/Resources/XQueries/consultarSuscriptorOCSPS_Req"/>
                                                                                                <con1:param name="timeout">
                                                                                                  <con1:path>2000</con1:path>
                                                                                                </con1:param>
                                                                                                <con1:param name="in">
                                                                                                  <con1:path>data($body/ejec:Input_Parameters/IN_DESTINO)</con1:path>
                                                                                                </con1:param>
                                                                                                <con1:param name="min">
                                                                                                  <con1:path>data($elegidoReemplazar)</con1:path>
                                                                                                </con1:param>
                                                                                              </con1:xqueryTransform>
                                                                                            </con3:expr>
                                                                                          </con3:assign>
                                                                                        </con3:requestTransform>
                                                                                        <con3:responseTransform/>
                                                                                      </con3:wsCallout>
                                                                                      <con3:ifThenElse>
                                                                                        <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7bde</con1:id>
                                                                                        <con3:case>
                                                                                          <con3:condition>
                                                                                            <con1:xqueryText>data($suscriptorOCSResponse/CODIGO) = '1'</con1:xqueryText>
                                                                                          </con3:condition>
                                                                                          <con3:actions>
                                                                                            <con3:assign varName="elegidosReemplazarNRN">
                                                                                              <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7bdd</con1:id>
                                                                                              <con3:expr>
                                                                                                <con1:xqueryText>let $eleg := concat('132', $elegidoReemplazar)
return if($elegidosReemplazarNRN = "") then 
	   		$eleg
       else  concat($elegidosReemplazarNRN, ';', $eleg)</con1:xqueryText>
                                                                                              </con3:expr>
                                                                                            </con3:assign>
                                                                                          </con3:actions>
                                                                                        </con3:case>
                                                                                        <con3:default>
                                                                                          <con3:wsCallout>
                                                                                            <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7bd8</con1:id>
                                                                                            <con3:service xsi:type="ref:ProxyRef" ref="ITEL/Core/Proxies/consultarNRNLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                                                                            <con3:operation>consultarNRN</con3:operation>
                                                                                            <con3:request>
                                                                                              <con3:body>$nrnRequest</con3:body>
                                                                                            </con3:request>
                                                                                            <con3:response>
                                                                                              <con3:body>nrnResponse</con3:body>
                                                                                            </con3:response>
                                                                                            <con3:requestTransform>
                                                                                              <con3:assign varName="nrnRequest">
                                                                                                <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7bdc</con1:id>
                                                                                                <con3:expr>
                                                                                                  <con1:xqueryTransform>
                                                                                                    <con1:resource ref="ITEL/Core/Resources/XQueries/consultarNRNPS_Req"/>
                                                                                                    <con1:param name="min">
                                                                                                      <con1:path>data($elegidoReemplazar)</con1:path>
                                                                                                    </con1:param>
                                                                                                  </con1:xqueryTransform>
                                                                                                </con3:expr>
                                                                                              </con3:assign>
                                                                                            </con3:requestTransform>
                                                                                            <con3:responseTransform>
                                                                                              <con3:ifThenElse>
                                                                                                <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7bdb</con1:id>
                                                                                                <con3:case>
                                                                                                  <con3:condition>
                                                                                                    <con1:xqueryText>data($nrnResponse/CODIGO) != "OK" or data($nrnResponse/MENSAJE/NRN) = "ERROR"</con1:xqueryText>
                                                                                                  </con3:condition>
                                                                                                  <con3:actions>
                                                                                                    <con3:assign varName="codError">
                                                                                                      <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7bda</con1:id>
                                                                                                      <con3:expr>
                                                                                                        <con1:xqueryText>"52"</con1:xqueryText>
                                                                                                      </con3:expr>
                                                                                                    </con3:assign>
                                                                                                  </con3:actions>
                                                                                                </con3:case>
                                                                                                <con3:default>
                                                                                                  <con3:assign varName="elegidosReemplazarNRN">
                                                                                                    <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7bd9</con1:id>
                                                                                                    <con3:expr>
                                                                                                      <con1:xqueryText>let $eleg := concat(data($nrnResponse/MENSAJE/NRN), $elegidoReemplazar)
return if($elegidosReemplazarNRN = "") then 
	   		$eleg
       else  concat($elegidosReemplazarNRN, ';', $eleg)</con1:xqueryText>
                                                                                                    </con3:expr>
                                                                                                  </con3:assign>
                                                                                                </con3:default>
                                                                                              </con3:ifThenElse>
                                                                                            </con3:responseTransform>
                                                                                          </con3:wsCallout>
                                                                                        </con3:default>
                                                                                      </con3:ifThenElse>
                                                                                    </con3:actions>
                                                                                  </con3:case>
                                                                                  <con3:default>
                                                                                    <con3:assign varName="elegidosReemplazarNRN">
                                                                                      <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7bd7</con1:id>
                                                                                      <con3:expr>
                                                                                        <con1:xqueryText>if($elegidosReemplazarNRN = '') then 
	   		$elegidoReemplazar
else  concat($elegidosReemplazarNRN, ';', $elegidoReemplazar)</con1:xqueryText>
                                                                                      </con3:expr>
                                                                                    </con3:assign>
                                                                                  </con3:default>
                                                                                </con3:ifThenElse>
                                                                              </con3:actions>
                                                                            </con3:foreach>
                                                                            <con3:insert varName="reglasNegocioResponse">
                                                                              <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7bd5</con1:id>
                                                                              <con3:location>
                                                                                <con1:xpathText>./MENSAJE/PARAMETROS</con1:xpathText>
                                                                              </con3:location>
                                                                              <con3:where>first-child</con3:where>
                                                                              <con3:expr>
                                                                                <con1:xqueryText><![CDATA[<PARAMETRO>
	<NOMBRE>ELEGIDOSREEMPLAZARNRN</NOMBRE>
	<TIPO>string</TIPO>
	<VALOR>{$elegidosReemplazarNRN}</VALOR>
</PARAMETRO>]]></con1:xqueryText>
                                                                              </con3:expr>
                                                                            </con3:insert>
                                                                          </con3:actions>
                                                                        </con3:case>
                                                                        <con3:default/>
                                                                      </con3:ifThenElse>
                                                                    </con3:actions>
                                                                  </con3:case>
                                                                  <con3:default/>
                                                                </con3:ifThenElse>
                                                              </con3:actions>
                                                            </con3:case>
                                                            <con3:default>
                                                              <con3:assign varName="elegidosNRN">
                                                                <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7bd4</con1:id>
                                                                <con3:expr>
                                                                  <con1:xqueryText>if($elegidosNRN = '') then 
	   		data($elegido)
else  concat($elegidosNRN, ';', data($elegido))</con1:xqueryText>
                                                                </con3:expr>
                                                              </con3:assign>
                                                            </con3:default>
                                                          </con3:ifThenElse>
                                                          <con3:insert varName="reglasNegocioResponse">
                                                            <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7bd3</con1:id>
                                                            <con3:location>
                                                              <con1:xpathText>./MENSAJE/PARAMETROS</con1:xpathText>
                                                            </con3:location>
                                                            <con3:where>last-child</con3:where>
                                                            <con3:expr>
                                                              <con1:xqueryText><![CDATA[<PARAMETRO>
	<NOMBRE>ELEGIDOSNRN</NOMBRE>
	<TIPO>string</TIPO>
	<VALOR>{$elegidosNRN}</VALOR>
</PARAMETRO>]]></con1:xqueryText>
                                                            </con3:expr>
                                                          </con3:insert>
                                                        </con3:actions>
                                                      </con3:case>
                                                      <con3:case>
                                                        <con3:condition>
                                                          <con1:xqueryText>$codError = "1" and not($metodo = ("303"))</con1:xqueryText>
                                                        </con3:condition>
                                                        <con3:actions>
                                                          <con3:assign varName="elegidosNRN">
                                                            <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7bd2</con1:id>
                                                            <con3:expr>
                                                              <con1:xqueryText>if($metodo = "305") then
	data($body/ejec:Input_Parameters/PARAMETROS_TRAMA/PARAMETRO[NOMBRE='MONTORECARGA']/VALOR)
else if($metodo = "308") then
     fn:concat(data($body/ejec:Input_Parameters/PARAMETROS_TRAMA/PARAMETRO[NOMBRE='COMENTARIO']/VALOR), ';', data($body/ejec:Input_Parameters/PARAMETROS_TRAMA/PARAMETRO[NOMBRE='HOSTID']/VALOR))
else if($metodo = "311") then
    fn:concat(data($body/ejec:Input_Parameters/PARAMETROS_TRAMA/PARAMETRO[NOMBRE='COMENTARIO']/VALOR), ';', data($body/ejec:Input_Parameters/PARAMETROS_TRAMA/PARAMETRO[NOMBRE='HOSTID']/VALOR))
else
	data($body/ejec:Input_Parameters/PARAMETROS_TRAMA/PARAMETRO[NOMBRE='HOSTID']/VALOR)</con1:xqueryText>
                                                            </con3:expr>
                                                          </con3:assign>
                                                          <con3:ifThenElse>
                                                            <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7bd1</con1:id>
                                                            <con3:case>
                                                              <con3:condition>
                                                                <con1:xqueryText>$body/ejec:Input_Parameters/PARAMETROS_TRAMA/PARAMETRO[NOMBRE='HOSTID']/VALOR != "" 
or $metodo = '305'</con1:xqueryText>
                                                              </con3:condition>
                                                              <con3:actions>
                                                                <con3:ifThenElse>
                                                                  <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7bd0</con1:id>
                                                                  <con3:case>
                                                                    <con3:condition>
                                                                      <con1:xqueryText>$codError = "1" and $metodo = ("314")</con1:xqueryText>
                                                                    </con3:condition>
                                                                    <con3:actions>
                                                                      <con3:assign varName="elegidosReemplazarNRN">
                                                                        <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7bcf</con1:id>
                                                                        <con3:expr>
                                                                          <con1:xqueryText>data($body/ejec:Input_Parameters/PARAMETROS_TRAMA/PARAMETRO[NOMBRE='BONIFICAR']/VALOR)</con1:xqueryText>
                                                                        </con3:expr>
                                                                      </con3:assign>
                                                                      <con3:ifThenElse>
                                                                        <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7bce</con1:id>
                                                                        <con3:case>
                                                                          <con3:condition>
                                                                            <con1:xqueryText>$body/ejec:Input_Parameters/PARAMETROS_TRAMA/PARAMETRO[NOMBRE='BONIFICAR']/VALOR != ""</con1:xqueryText>
                                                                          </con3:condition>
                                                                          <con3:actions>
                                                                            <con3:insert varName="reglasNegocioResponse">
                                                                              <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7bcd</con1:id>
                                                                              <con3:location>
                                                                                <con1:xpathText>./MENSAJE/PARAMETROS</con1:xpathText>
                                                                              </con3:location>
                                                                              <con3:where>first-child</con3:where>
                                                                              <con3:expr>
                                                                                <con1:xqueryText><![CDATA[<PARAMETRO>
	<NOMBRE>ELEGIDOSREEMPLAZARNRN</NOMBRE>
	<TIPO>string</TIPO>
	<VALOR>{$elegidosReemplazarNRN}</VALOR>
</PARAMETRO>]]></con1:xqueryText>
                                                                              </con3:expr>
                                                                            </con3:insert>
                                                                          </con3:actions>
                                                                        </con3:case>
                                                                        <con3:default/>
                                                                      </con3:ifThenElse>
                                                                    </con3:actions>
                                                                  </con3:case>
                                                                  <con3:default/>
                                                                </con3:ifThenElse>
                                                              </con3:actions>
                                                            </con3:case>
                                                            <con3:default/>
                                                          </con3:ifThenElse>
                                                          <con3:insert varName="reglasNegocioResponse">
                                                            <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7bcc</con1:id>
                                                            <con3:location>
                                                              <con1:xpathText>./MENSAJE/PARAMETROS</con1:xpathText>
                                                            </con3:location>
                                                            <con3:where>last-child</con3:where>
                                                            <con3:expr>
                                                              <con1:xqueryText><![CDATA[<PARAMETRO>
	<NOMBRE>ELEGIDOSNRN</NOMBRE>
	<TIPO>string</TIPO>
	<VALOR>{$elegidosNRN}</VALOR>
</PARAMETRO>]]></con1:xqueryText>
                                                            </con3:expr>
                                                          </con3:insert>
                                                        </con3:actions>
                                                      </con3:case>
                                                      <con3:default/>
                                                    </con3:ifThenElse>
                                                    <con3:ifThenElse>
                                                      <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7bc8</con1:id>
                                                      <con3:case>
                                                        <con3:condition>
                                                          <con1:xqueryText>$metodo = '302','308','314'</con1:xqueryText>
                                                        </con3:condition>
                                                        <con3:actions>
                                                          <con3:wsCallout>
                                                            <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7bc6</con1:id>
                                                            <con3:service xsi:type="ref:ProxyRef" ref="ITEL/Core/Proxies/consultarContratoEsPostpagoLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                                            <con3:operation>consultarContratoEsPostpago</con3:operation>
                                                            <con3:request>
                                                              <con3:body>$consultarContratoEsPospagoRequest</con3:body>
                                                            </con3:request>
                                                            <con3:response>
                                                              <con3:body>consultarContratoEsPospagoResponse</con3:body>
                                                            </con3:response>
                                                            <con3:requestTransform>
                                                              <con3:assign varName="consultarContratoEsPospagoRequest">
                                                                <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7bc7</con1:id>
                                                                <con3:expr>
                                                                  <con1:xqueryText>&lt;con:Input_Parameters xmlns:con="http://www.comcel.com.co/ConsultarContractEsPostPago">
    &lt;con:CONTRACT>{ data($serviceClass) }&lt;/con:CONTRACT>
&lt;/con:Input_Parameters></con1:xqueryText>
                                                                </con3:expr>
                                                              </con3:assign>
                                                            </con3:requestTransform>
                                                            <con3:responseTransform/>
                                                          </con3:wsCallout>
                                                        </con3:actions>
                                                      </con3:case>
                                                      <con3:default/>
                                                    </con3:ifThenElse>
                                                    <con3:ifThenElse>
                                                      <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7b94</con1:id>
                                                      <con3:case>
                                                        <con3:condition>
                                                          <con1:xqueryText>$codError = "1" and $metodo = "302"</con1:xqueryText>
                                                        </con3:condition>
                                                        <con3:actions>
                                                          <con3:ifThenElse>
                                                            <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7b93</con1:id>
                                                            <con3:case>
                                                              <con3:condition>
                                                                <con1:xqueryText>fn:exists($consultarFaFListResponse/MENSAJE/CONSULTAR_FAFLIST/fafInformationList/Detail/fafIndicator)</con1:xqueryText>
                                                              </con3:condition>
                                                              <con3:actions>
                                                                <con3:wsCallout>
                                                                  <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7b8f</con1:id>
                                                                  <con3:service xsi:type="ref:ProxyRef" ref="ITEL/Core/Proxies/consultarFAFTipoLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                                                  <con3:operation>consultarFAFTipo</con3:operation>
                                                                  <con3:request>
                                                                    <con3:body>$consultarFAFTipoRequest</con3:body>
                                                                  </con3:request>
                                                                  <con3:response>
                                                                    <con3:body>consultarFAFTipoResponse</con3:body>
                                                                  </con3:response>
                                                                  <con3:requestTransform>
                                                                    <con3:assign varName="consultarFAFTipoRequest">
                                                                      <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7b92</con1:id>
                                                                      <con3:expr>
                                                                        <con1:xqueryTransform>
                                                                          <con1:resource ref="ITEL/Core/Resources/XQueries/consultarFAFTipoPS_Req"/>
                                                                          <con1:param name="wS_Result1">
                                                                            <con1:path>$consultarFaFListResponse</con1:path>
                                                                          </con1:param>
                                                                        </con1:xqueryTransform>
                                                                      </con3:expr>
                                                                    </con3:assign>
                                                                  </con3:requestTransform>
                                                                  <con3:responseTransform>
                                                                    <con1:ifThenElse xmlns:con3="http://www.bea.com/wli/sb/typesystem/config" xmlns:con2="http://www.bea.com/wli/sb/stages/config" xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
                                                                      <con6:id xmlns:con6="http://www.bea.com/wli/sb/stages/config">_ActionId-2215439518611274108-740768fe.1574d206712.-7b91</con6:id>
                                                                      <con1:case>
                                                                        <con1:condition>
                                                                          <con6:xqueryText xmlns:con6="http://www.bea.com/wli/sb/stages/config">data($consultarFAFTipoResponse/CODIGO) != 'OK'</con6:xqueryText>
                                                                        </con1:condition>
                                                                        <con1:actions>
                                                                          <con6:assign varName="codError" xmlns:con3="http://www.bea.com/wli/sb/stages/transform/config" xmlns:con2="http://www.bea.com/wli/sb/typesystem/config" xmlns:con1="http://www.bea.com/wli/sb/stages/config" xmlns:con6="http://www.bea.com/wli/sb/stages/transform/config">
                                                                            <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7b90</con1:id>
                                                                            <con6:expr>
                                                                              <con1:xqueryText>"909"</con1:xqueryText>
                                                                            </con6:expr>
                                                                          </con6:assign>
                                                                        </con1:actions>
                                                                      </con1:case>
                                                                      <con1:default/>
                                                                    </con1:ifThenElse>
                                                                  </con3:responseTransform>
                                                                </con3:wsCallout>
                                                                <con3:ifThenElse>
                                                                  <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7b8e</con1:id>
                                                                  <con3:case>
                                                                    <con3:condition>
                                                                      <con1:xqueryText>$codError = "1" and 
fn:exists($consultarFaFListResponse/MENSAJE/CONSULTAR_FAFLIST/fafInformationList/Detail/fafIndicator)</con1:xqueryText>
                                                                    </con3:condition>
                                                                    <con3:actions>
                                                                      <con3:replace varName="consultarFaFListRes">
                                                                        <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7b8d</con1:id>
                                                                        <con3:expr>
                                                                          <con1:xqueryTransform>
                                                                            <con1:resource ref="ITEL/Core/Resources/XQueries/ejecutarReglasNegocio_Res_consultarFaFList"/>
                                                                            <con1:param name="wS_Result2">
                                                                              <con1:path>$consultarFaFListResponse</con1:path>
                                                                            </con1:param>
                                                                            <con1:param name="wS_Result1">
                                                                              <con1:path>$consultarFAFTipoResponse</con1:path>
                                                                            </con1:param>
                                                                          </con1:xqueryTransform>
                                                                        </con3:expr>
                                                                      </con3:replace>
                                                                    </con3:actions>
                                                                  </con3:case>
                                                                  <con3:default>
                                                                    <con3:wsCallout>
                                                                      <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7b89</con1:id>
                                                                      <con3:service xsi:type="ref:ProxyRef" ref="ITEL/OCS/AIR/Proxies/consultarOfferOCSLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                                                      <con3:operation>consultarOffer</con3:operation>
                                                                      <con3:request>
                                                                        <con3:body>$consultarOfferRequest</con3:body>
                                                                      </con3:request>
                                                                      <con3:response>
                                                                        <con3:body>consultarOfferResponse</con3:body>
                                                                      </con3:response>
                                                                      <con3:requestTransform>
                                                                        <con3:assign varName="consultarOfferRequest">
                                                                          <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7b8c</con1:id>
                                                                          <con3:expr>
                                                                            <con1:xqueryTransform>
                                                                              <con1:resource ref="ITEL/Core/Resources/XQueries/consultarOfferPS_Req"/>
                                                                              <con1:param name="min">
                                                                                <con1:path>data($body/ejec:Input_Parameters/MIN_DESTINO)</con1:path>
                                                                              </con1:param>
                                                                            </con1:xqueryTransform>
                                                                          </con3:expr>
                                                                        </con3:assign>
                                                                      </con3:requestTransform>
                                                                      <con3:responseTransform>
                                                                        <con1:ifThenElse xmlns:con3="http://www.bea.com/wli/sb/typesystem/config" xmlns:con2="http://www.bea.com/wli/sb/stages/config" xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
                                                                          <con6:id xmlns:con6="http://www.bea.com/wli/sb/stages/config">_ActionId-2215439518611274108-740768fe.1574d206712.-7b8b</con6:id>
                                                                          <con1:case>
                                                                            <con1:condition>
                                                                              <con6:xqueryText xmlns:con6="http://www.bea.com/wli/sb/stages/config">data($consultarOfferResponse/CODIGO) != '1'</con6:xqueryText>
                                                                            </con1:condition>
                                                                            <con1:actions>
                                                                              <con6:assign varName="codError" xmlns:con3="http://www.bea.com/wli/sb/stages/transform/config" xmlns:con2="http://www.bea.com/wli/sb/typesystem/config" xmlns:con1="http://www.bea.com/wli/sb/stages/config" xmlns:con6="http://www.bea.com/wli/sb/stages/transform/config">
                                                                                <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7b8a</con1:id>
                                                                                <con6:expr>
                                                                                  <con1:xqueryText>data($consultarOfferResponse/CODIGO)</con1:xqueryText>
                                                                                </con6:expr>
                                                                              </con6:assign>
                                                                            </con1:actions>
                                                                          </con1:case>
                                                                          <con1:default/>
                                                                        </con1:ifThenElse>
                                                                      </con3:responseTransform>
                                                                    </con3:wsCallout>
                                                                    <con3:replace varName="consultarFaFListRes">
                                                                      <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7b88</con1:id>
                                                                      <con3:expr>
                                                                        <con1:xqueryTransform>
                                                                          <con1:resource ref="ITEL/Core/Resources/XQueries/ejecutarReglasNegocio_Res_consultarFaFListOffers"/>
                                                                          <con1:param name="wS_Result2">
                                                                            <con1:path>$consultarFaFListResponse</con1:path>
                                                                          </con1:param>
                                                                          <con1:param name="wS_Result1">
                                                                            <con1:path>$consultarOfferResponse</con1:path>
                                                                          </con1:param>
                                                                        </con1:xqueryTransform>
                                                                      </con3:expr>
                                                                    </con3:replace>
                                                                  </con3:default>
                                                                </con3:ifThenElse>
                                                              </con3:actions>
                                                            </con3:case>
                                                            <con3:default/>
                                                          </con3:ifThenElse>
                                                        </con3:actions>
                                                      </con3:case>
                                                      <con3:case>
                                                        <con3:condition>
                                                          <con1:xqueryText>$codError = "1" and $metodo = "311"</con1:xqueryText>
                                                        </con3:condition>
                                                        <con3:actions>
                                                          <con3:ifThenElse>
                                                            <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7b87</con1:id>
                                                            <con3:case>
                                                              <con3:condition>
                                                                <con1:xqueryText>fn:exists($consultarFaFListResponse/MENSAJE/CONSULTAR_FAFLIST/fafInformationList/Detail/fafIndicator)</con1:xqueryText>
                                                              </con3:condition>
                                                              <con3:actions>
                                                                <con3:wsCallout>
                                                                  <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7b83</con1:id>
                                                                  <con3:service xsi:type="ref:ProxyRef" ref="ITEL/Core/Proxies/consultarFAFTipoLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                                                  <con3:operation>consultarFAFTipo</con3:operation>
                                                                  <con3:request>
                                                                    <con3:body>$consultarFAFTipoRequest</con3:body>
                                                                  </con3:request>
                                                                  <con3:response>
                                                                    <con3:body>consultarFAFTipoResponse</con3:body>
                                                                  </con3:response>
                                                                  <con3:requestTransform>
                                                                    <con3:assign varName="consultarFAFTipoRequest">
                                                                      <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7b86</con1:id>
                                                                      <con3:expr>
                                                                        <con1:xqueryTransform>
                                                                          <con1:resource ref="ITEL/Core/Resources/XQueries/consultarFAFTipoPS_Req"/>
                                                                          <con1:param name="wS_Result1">
                                                                            <con1:path>$consultarFaFListResponse</con1:path>
                                                                          </con1:param>
                                                                        </con1:xqueryTransform>
                                                                      </con3:expr>
                                                                    </con3:assign>
                                                                  </con3:requestTransform>
                                                                  <con3:responseTransform>
                                                                    <con1:ifThenElse xmlns:con3="http://www.bea.com/wli/sb/typesystem/config" xmlns:con2="http://www.bea.com/wli/sb/stages/config" xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
                                                                      <con6:id xmlns:con6="http://www.bea.com/wli/sb/stages/config">_ActionId-2215439518611274108-740768fe.1574d206712.-7b85</con6:id>
                                                                      <con1:case>
                                                                        <con1:condition>
                                                                          <con6:xqueryText xmlns:con6="http://www.bea.com/wli/sb/stages/config">data($consultarFAFTipoResponse/CODIGO) != 'OK'</con6:xqueryText>
                                                                        </con1:condition>
                                                                        <con1:actions>
                                                                          <con6:assign varName="codError" xmlns:con3="http://www.bea.com/wli/sb/stages/transform/config" xmlns:con2="http://www.bea.com/wli/sb/typesystem/config" xmlns:con1="http://www.bea.com/wli/sb/stages/config" xmlns:con6="http://www.bea.com/wli/sb/stages/transform/config">
                                                                            <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7b84</con1:id>
                                                                            <con6:expr>
                                                                              <con1:xqueryText>"909"</con1:xqueryText>
                                                                            </con6:expr>
                                                                          </con6:assign>
                                                                        </con1:actions>
                                                                      </con1:case>
                                                                      <con1:default/>
                                                                    </con1:ifThenElse>
                                                                  </con3:responseTransform>
                                                                </con3:wsCallout>
                                                                <con3:ifThenElse>
                                                                  <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7b82</con1:id>
                                                                  <con3:case>
                                                                    <con3:condition>
                                                                      <con1:xqueryText>$codError = "1" and 
fn:exists($consultarFaFListResponse/MENSAJE/CONSULTAR_FAFLIST/fafInformationList/Detail/fafIndicator)</con1:xqueryText>
                                                                    </con3:condition>
                                                                    <con3:actions>
                                                                      <con3:replace varName="consultarFaFListRes">
                                                                        <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7b81</con1:id>
                                                                        <con3:expr>
                                                                          <con1:xqueryTransform>
                                                                            <con1:resource ref="ITEL/Core/Resources/XQueries/ejecutarReglasNegocio_Res_consultarFaFList"/>
                                                                            <con1:param name="wS_Result2">
                                                                              <con1:path>$consultarFaFListResponse</con1:path>
                                                                            </con1:param>
                                                                            <con1:param name="wS_Result1">
                                                                              <con1:path>$consultarFAFTipoResponse</con1:path>
                                                                            </con1:param>
                                                                          </con1:xqueryTransform>
                                                                        </con3:expr>
                                                                      </con3:replace>
                                                                    </con3:actions>
                                                                  </con3:case>
                                                                  <con3:default>
                                                                    <con3:wsCallout>
                                                                      <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7b7d</con1:id>
                                                                      <con3:service xsi:type="ref:ProxyRef" ref="ITEL/OCS/AIR/Proxies/consultarOfferOCSLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                                                      <con3:operation>consultarOffer</con3:operation>
                                                                      <con3:request>
                                                                        <con3:body>$consultarOfferRequest</con3:body>
                                                                      </con3:request>
                                                                      <con3:response>
                                                                        <con3:body>consultarOfferResponse</con3:body>
                                                                      </con3:response>
                                                                      <con3:requestTransform>
                                                                        <con3:assign varName="consultarOfferRequest">
                                                                          <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7b80</con1:id>
                                                                          <con3:expr>
                                                                            <con1:xqueryTransform>
                                                                              <con1:resource ref="ITEL/Core/Resources/XQueries/consultarOfferPS_Req"/>
                                                                              <con1:param name="min">
                                                                                <con1:path>data($body/ejec:Input_Parameters/MIN_DESTINO)</con1:path>
                                                                              </con1:param>
                                                                            </con1:xqueryTransform>
                                                                          </con3:expr>
                                                                        </con3:assign>
                                                                      </con3:requestTransform>
                                                                      <con3:responseTransform>
                                                                        <con1:ifThenElse xmlns:con3="http://www.bea.com/wli/sb/typesystem/config" xmlns:con2="http://www.bea.com/wli/sb/stages/config" xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
                                                                          <con6:id xmlns:con6="http://www.bea.com/wli/sb/stages/config">_ActionId-2215439518611274108-740768fe.1574d206712.-7b7f</con6:id>
                                                                          <con1:case>
                                                                            <con1:condition>
                                                                              <con6:xqueryText xmlns:con6="http://www.bea.com/wli/sb/stages/config">data($consultarOfferResponse/CODIGO) != '1'</con6:xqueryText>
                                                                            </con1:condition>
                                                                            <con1:actions>
                                                                              <con6:assign varName="codError" xmlns:con3="http://www.bea.com/wli/sb/stages/transform/config" xmlns:con2="http://www.bea.com/wli/sb/typesystem/config" xmlns:con1="http://www.bea.com/wli/sb/stages/config" xmlns:con6="http://www.bea.com/wli/sb/stages/transform/config">
                                                                                <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7b7e</con1:id>
                                                                                <con6:expr>
                                                                                  <con1:xqueryText>data($consultarOfferResponse/CODIGO)</con1:xqueryText>
                                                                                </con6:expr>
                                                                              </con6:assign>
                                                                            </con1:actions>
                                                                          </con1:case>
                                                                          <con1:default/>
                                                                        </con1:ifThenElse>
                                                                      </con3:responseTransform>
                                                                    </con3:wsCallout>
                                                                    <con3:replace varName="consultarFaFListRes">
                                                                      <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7b7c</con1:id>
                                                                      <con3:expr>
                                                                        <con1:xqueryTransform>
                                                                          <con1:resource ref="ITEL/Core/Resources/XQueries/ejecutarReglasNegocio_Res_consultarFaFListOffers"/>
                                                                          <con1:param name="wS_Result2">
                                                                            <con1:path>$consultarFaFListResponse</con1:path>
                                                                          </con1:param>
                                                                          <con1:param name="wS_Result1">
                                                                            <con1:path>$consultarOfferResponse</con1:path>
                                                                          </con1:param>
                                                                        </con1:xqueryTransform>
                                                                      </con3:expr>
                                                                    </con3:replace>
                                                                  </con3:default>
                                                                </con3:ifThenElse>
                                                              </con3:actions>
                                                            </con3:case>
                                                            <con3:default/>
                                                          </con3:ifThenElse>
                                                        </con3:actions>
                                                      </con3:case>
                                                      <con3:case>
                                                        <con3:condition>
                                                          <con1:xqueryText>$codError = "1" and $metodo = "305"</con1:xqueryText>
                                                        </con3:condition>
                                                        <con3:actions>
                                                          <con3:ifThenElse>
                                                            <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7b7b</con1:id>
                                                            <con3:case>
                                                              <con3:condition>
                                                                <con1:xqueryText>fn:exists($consultarFaFListResponse/MENSAJE/CONSULTAR_FAFLIST/fafInformationList/Detail/fafIndicator)</con1:xqueryText>
                                                              </con3:condition>
                                                              <con3:actions>
                                                                <con3:wsCallout>
                                                                  <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7b77</con1:id>
                                                                  <con3:service xsi:type="ref:ProxyRef" ref="ITEL/Core/Proxies/consultarFAFTipoLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                                                  <con3:operation>consultarFAFTipo</con3:operation>
                                                                  <con3:request>
                                                                    <con3:body>$consultarFAFTipoRequest</con3:body>
                                                                  </con3:request>
                                                                  <con3:response>
                                                                    <con3:body>consultarFAFTipoResponse</con3:body>
                                                                  </con3:response>
                                                                  <con3:requestTransform>
                                                                    <con3:assign varName="consultarFAFTipoRequest">
                                                                      <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7b7a</con1:id>
                                                                      <con3:expr>
                                                                        <con1:xqueryTransform>
                                                                          <con1:resource ref="ITEL/Core/Resources/XQueries/consultarFAFTipoPS_Req"/>
                                                                          <con1:param name="wS_Result1">
                                                                            <con1:path>$consultarFaFListResponse</con1:path>
                                                                          </con1:param>
                                                                        </con1:xqueryTransform>
                                                                      </con3:expr>
                                                                    </con3:assign>
                                                                  </con3:requestTransform>
                                                                  <con3:responseTransform>
                                                                    <con1:ifThenElse xmlns:con3="http://www.bea.com/wli/sb/typesystem/config" xmlns:con2="http://www.bea.com/wli/sb/stages/config" xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
                                                                      <con6:id xmlns:con6="http://www.bea.com/wli/sb/stages/config">_ActionId-2215439518611274108-740768fe.1574d206712.-7b79</con6:id>
                                                                      <con1:case>
                                                                        <con1:condition>
                                                                          <con6:xqueryText xmlns:con6="http://www.bea.com/wli/sb/stages/config">data($consultarFAFTipoResponse/CODIGO) != 'OK'</con6:xqueryText>
                                                                        </con1:condition>
                                                                        <con1:actions>
                                                                          <con6:assign varName="codError" xmlns:con3="http://www.bea.com/wli/sb/stages/transform/config" xmlns:con2="http://www.bea.com/wli/sb/typesystem/config" xmlns:con1="http://www.bea.com/wli/sb/stages/config" xmlns:con6="http://www.bea.com/wli/sb/stages/transform/config">
                                                                            <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7b78</con1:id>
                                                                            <con6:expr>
                                                                              <con1:xqueryText>"909"</con1:xqueryText>
                                                                            </con6:expr>
                                                                          </con6:assign>
                                                                        </con1:actions>
                                                                      </con1:case>
                                                                      <con1:default/>
                                                                    </con1:ifThenElse>
                                                                  </con3:responseTransform>
                                                                </con3:wsCallout>
                                                                <con3:ifThenElse>
                                                                  <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7b76</con1:id>
                                                                  <con3:case>
                                                                    <con3:condition>
                                                                      <con1:xqueryText>$codError = "1" and 
fn:exists($consultarFaFListResponse/MENSAJE/CONSULTAR_FAFLIST/fafInformationList/Detail/fafIndicator)</con1:xqueryText>
                                                                    </con3:condition>
                                                                    <con3:actions>
                                                                      <con3:replace varName="consultarFaFListRes">
                                                                        <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7b75</con1:id>
                                                                        <con3:expr>
                                                                          <con1:xqueryTransform>
                                                                            <con1:resource ref="ITEL/Core/Resources/XQueries/ejecutarReglasNegocio_Res_consultarFaFList"/>
                                                                            <con1:param name="wS_Result2">
                                                                              <con1:path>$consultarFaFListResponse</con1:path>
                                                                            </con1:param>
                                                                            <con1:param name="wS_Result1">
                                                                              <con1:path>$consultarFAFTipoResponse</con1:path>
                                                                            </con1:param>
                                                                          </con1:xqueryTransform>
                                                                        </con3:expr>
                                                                      </con3:replace>
                                                                    </con3:actions>
                                                                  </con3:case>
                                                                  <con3:default>
                                                                    <con3:wsCallout>
                                                                      <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7b71</con1:id>
                                                                      <con3:service xsi:type="ref:ProxyRef" ref="ITEL/OCS/AIR/Proxies/consultarOfferOCSLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                                                      <con3:operation>consultarOffer</con3:operation>
                                                                      <con3:request>
                                                                        <con3:body>$consultarOfferRequest</con3:body>
                                                                      </con3:request>
                                                                      <con3:response>
                                                                        <con3:body>consultarOfferResponse</con3:body>
                                                                      </con3:response>
                                                                      <con3:requestTransform>
                                                                        <con3:assign varName="consultarOfferRequest">
                                                                          <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7b74</con1:id>
                                                                          <con3:expr>
                                                                            <con1:xqueryTransform>
                                                                              <con1:resource ref="ITEL/Core/Resources/XQueries/consultarOfferPS_Req"/>
                                                                              <con1:param name="min">
                                                                                <con1:path>data($body/ejec:Input_Parameters/MIN_DESTINO)</con1:path>
                                                                              </con1:param>
                                                                            </con1:xqueryTransform>
                                                                          </con3:expr>
                                                                        </con3:assign>
                                                                      </con3:requestTransform>
                                                                      <con3:responseTransform>
                                                                        <con1:ifThenElse xmlns:con3="http://www.bea.com/wli/sb/typesystem/config" xmlns:con2="http://www.bea.com/wli/sb/stages/config" xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
                                                                          <con6:id xmlns:con6="http://www.bea.com/wli/sb/stages/config">_ActionId-2215439518611274108-740768fe.1574d206712.-7b73</con6:id>
                                                                          <con1:case>
                                                                            <con1:condition>
                                                                              <con6:xqueryText xmlns:con6="http://www.bea.com/wli/sb/stages/config">data($consultarOfferResponse/CODIGO) != '1'</con6:xqueryText>
                                                                            </con1:condition>
                                                                            <con1:actions>
                                                                              <con6:assign varName="codError" xmlns:con3="http://www.bea.com/wli/sb/stages/transform/config" xmlns:con2="http://www.bea.com/wli/sb/typesystem/config" xmlns:con1="http://www.bea.com/wli/sb/stages/config" xmlns:con6="http://www.bea.com/wli/sb/stages/transform/config">
                                                                                <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7b72</con1:id>
                                                                                <con6:expr>
                                                                                  <con1:xqueryText>data($consultarOfferResponse/CODIGO)</con1:xqueryText>
                                                                                </con6:expr>
                                                                              </con6:assign>
                                                                            </con1:actions>
                                                                          </con1:case>
                                                                          <con1:default/>
                                                                        </con1:ifThenElse>
                                                                      </con3:responseTransform>
                                                                    </con3:wsCallout>
                                                                    <con3:replace varName="consultarFaFListRes">
                                                                      <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7b70</con1:id>
                                                                      <con3:expr>
                                                                        <con1:xqueryTransform>
                                                                          <con1:resource ref="ITEL/Core/Resources/XQueries/ejecutarReglasNegocio_Res_consultarFaFListOffers"/>
                                                                          <con1:param name="wS_Result2">
                                                                            <con1:path>$consultarFaFListResponse</con1:path>
                                                                          </con1:param>
                                                                          <con1:param name="wS_Result1">
                                                                            <con1:path>$consultarOfferResponse</con1:path>
                                                                          </con1:param>
                                                                        </con1:xqueryTransform>
                                                                      </con3:expr>
                                                                    </con3:replace>
                                                                  </con3:default>
                                                                </con3:ifThenElse>
                                                              </con3:actions>
                                                            </con3:case>
                                                            <con3:default/>
                                                          </con3:ifThenElse>
                                                        </con3:actions>
                                                      </con3:case>
                                                      <con3:case>
                                                        <con3:condition>
                                                          <con1:xqueryText>$codError = "1" and $metodo = "308"</con1:xqueryText>
                                                        </con3:condition>
                                                        <con3:actions>
                                                          <con3:ifThenElse>
                                                            <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7b6f</con1:id>
                                                            <con3:case>
                                                              <con3:condition>
                                                                <con1:xqueryText>fn:exists($consultarFaFListResponse/MENSAJE/CONSULTAR_FAFLIST/fafInformationList/Detail/fafIndicator)</con1:xqueryText>
                                                              </con3:condition>
                                                              <con3:actions>
                                                                <con3:wsCallout>
                                                                  <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7b6b</con1:id>
                                                                  <con3:service xsi:type="ref:ProxyRef" ref="ITEL/Core/Proxies/consultarFAFTipoLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                                                  <con3:operation>consultarFAFTipo</con3:operation>
                                                                  <con3:request>
                                                                    <con3:body>$consultarFAFTipoRequest</con3:body>
                                                                  </con3:request>
                                                                  <con3:response>
                                                                    <con3:body>consultarFAFTipoResponse</con3:body>
                                                                  </con3:response>
                                                                  <con3:requestTransform>
                                                                    <con3:assign varName="consultarFAFTipoRequest">
                                                                      <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7b6e</con1:id>
                                                                      <con3:expr>
                                                                        <con1:xqueryTransform>
                                                                          <con1:resource ref="ITEL/Core/Resources/XQueries/consultarFAFTipoPS_Req"/>
                                                                          <con1:param name="wS_Result1">
                                                                            <con1:path>$consultarFaFListResponse</con1:path>
                                                                          </con1:param>
                                                                        </con1:xqueryTransform>
                                                                      </con3:expr>
                                                                    </con3:assign>
                                                                  </con3:requestTransform>
                                                                  <con3:responseTransform>
                                                                    <con1:ifThenElse xmlns:con3="http://www.bea.com/wli/sb/typesystem/config" xmlns:con2="http://www.bea.com/wli/sb/stages/config" xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
                                                                      <con6:id xmlns:con6="http://www.bea.com/wli/sb/stages/config">_ActionId-2215439518611274108-740768fe.1574d206712.-7b6d</con6:id>
                                                                      <con1:case>
                                                                        <con1:condition>
                                                                          <con6:xqueryText xmlns:con6="http://www.bea.com/wli/sb/stages/config">data($consultarFAFTipoResponse/CODIGO) != 'OK'</con6:xqueryText>
                                                                        </con1:condition>
                                                                        <con1:actions>
                                                                          <con6:assign varName="codError" xmlns:con3="http://www.bea.com/wli/sb/stages/transform/config" xmlns:con2="http://www.bea.com/wli/sb/typesystem/config" xmlns:con1="http://www.bea.com/wli/sb/stages/config" xmlns:con6="http://www.bea.com/wli/sb/stages/transform/config">
                                                                            <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7b6c</con1:id>
                                                                            <con6:expr>
                                                                              <con1:xqueryText>"909"</con1:xqueryText>
                                                                            </con6:expr>
                                                                          </con6:assign>
                                                                        </con1:actions>
                                                                      </con1:case>
                                                                      <con1:default/>
                                                                    </con1:ifThenElse>
                                                                  </con3:responseTransform>
                                                                </con3:wsCallout>
                                                                <con3:ifThenElse>
                                                                  <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7b6a</con1:id>
                                                                  <con3:case>
                                                                    <con3:condition>
                                                                      <con1:xqueryText>$codError = "1" and 
fn:exists($consultarFaFListResponse/MENSAJE/CONSULTAR_FAFLIST/fafInformationList/Detail/fafIndicator)</con1:xqueryText>
                                                                    </con3:condition>
                                                                    <con3:actions>
                                                                      <con3:replace varName="consultarFaFListRes">
                                                                        <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7b69</con1:id>
                                                                        <con3:expr>
                                                                          <con1:xqueryTransform>
                                                                            <con1:resource ref="ITEL/Core/Resources/XQueries/ejecutarReglasNegocio_Res_consultarFaFList"/>
                                                                            <con1:param name="wS_Result2">
                                                                              <con1:path>$consultarFaFListResponse</con1:path>
                                                                            </con1:param>
                                                                            <con1:param name="wS_Result1">
                                                                              <con1:path>$consultarFAFTipoResponse</con1:path>
                                                                            </con1:param>
                                                                          </con1:xqueryTransform>
                                                                        </con3:expr>
                                                                      </con3:replace>
                                                                    </con3:actions>
                                                                  </con3:case>
                                                                  <con3:default>
                                                                    <con3:wsCallout>
                                                                      <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7b65</con1:id>
                                                                      <con3:service xsi:type="ref:ProxyRef" ref="ITEL/OCS/AIR/Proxies/consultarOfferOCSLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                                                      <con3:operation>consultarOffer</con3:operation>
                                                                      <con3:request>
                                                                        <con3:body>$consultarOfferRequest</con3:body>
                                                                      </con3:request>
                                                                      <con3:response>
                                                                        <con3:body>consultarOfferResponse</con3:body>
                                                                      </con3:response>
                                                                      <con3:requestTransform>
                                                                        <con3:assign varName="consultarOfferRequest">
                                                                          <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7b68</con1:id>
                                                                          <con3:expr>
                                                                            <con1:xqueryTransform>
                                                                              <con1:resource ref="ITEL/Core/Resources/XQueries/consultarOfferPS_Req"/>
                                                                              <con1:param name="min">
                                                                                <con1:path>data($body/ejec:Input_Parameters/MIN_DESTINO)</con1:path>
                                                                              </con1:param>
                                                                            </con1:xqueryTransform>
                                                                          </con3:expr>
                                                                        </con3:assign>
                                                                      </con3:requestTransform>
                                                                      <con3:responseTransform>
                                                                        <con1:ifThenElse xmlns:con3="http://www.bea.com/wli/sb/typesystem/config" xmlns:con2="http://www.bea.com/wli/sb/stages/config" xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
                                                                          <con6:id xmlns:con6="http://www.bea.com/wli/sb/stages/config">_ActionId-2215439518611274108-740768fe.1574d206712.-7b67</con6:id>
                                                                          <con1:case>
                                                                            <con1:condition>
                                                                              <con6:xqueryText xmlns:con6="http://www.bea.com/wli/sb/stages/config">data($consultarOfferResponse/CODIGO) != '1'</con6:xqueryText>
                                                                            </con1:condition>
                                                                            <con1:actions>
                                                                              <con6:assign varName="codError" xmlns:con3="http://www.bea.com/wli/sb/stages/transform/config" xmlns:con2="http://www.bea.com/wli/sb/typesystem/config" xmlns:con1="http://www.bea.com/wli/sb/stages/config" xmlns:con6="http://www.bea.com/wli/sb/stages/transform/config">
                                                                                <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7b66</con1:id>
                                                                                <con6:expr>
                                                                                  <con1:xqueryText>data($consultarOfferResponse/CODIGO)</con1:xqueryText>
                                                                                </con6:expr>
                                                                              </con6:assign>
                                                                            </con1:actions>
                                                                          </con1:case>
                                                                          <con1:default/>
                                                                        </con1:ifThenElse>
                                                                      </con3:responseTransform>
                                                                    </con3:wsCallout>
                                                                    <con3:replace varName="consultarFaFListRes">
                                                                      <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7b64</con1:id>
                                                                      <con3:expr>
                                                                        <con1:xqueryTransform>
                                                                          <con1:resource ref="ITEL/Core/Resources/XQueries/ejecutarReglasNegocio_Res_consultarFaFListOffers"/>
                                                                          <con1:param name="wS_Result2">
                                                                            <con1:path>$consultarFaFListResponse</con1:path>
                                                                          </con1:param>
                                                                          <con1:param name="wS_Result1">
                                                                            <con1:path>$consultarOfferResponse</con1:path>
                                                                          </con1:param>
                                                                        </con1:xqueryTransform>
                                                                      </con3:expr>
                                                                    </con3:replace>
                                                                  </con3:default>
                                                                </con3:ifThenElse>
                                                              </con3:actions>
                                                            </con3:case>
                                                            <con3:default/>
                                                          </con3:ifThenElse>
                                                        </con3:actions>
                                                      </con3:case>
                                                      <con3:default/>
                                                    </con3:ifThenElse>
                                                    <con3:ifThenElse>
                                                      <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7b5e</con1:id>
                                                      <con3:case>
                                                        <con3:condition>
                                                          <con1:xqueryText>$metodo = '302','308','314'</con1:xqueryText>
                                                        </con3:condition>
                                                        <con3:actions>
                                                          <con3:insert varName="reglasNegocioResponse">
                                                            <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7b5d</con1:id>
                                                            <con3:location>
                                                              <con1:xpathText>./*:MENSAJE/*:PARAMETROS</con1:xpathText>
                                                            </con3:location>
                                                            <con3:where>last-child</con3:where>
                                                            <con3:expr>
                                                              <con1:xqueryText><![CDATA[<PARAMETRO>
	<NOMBRE>CANTIDAD_MODIFICACION_ELEGIDOS</NOMBRE>
	<TIPO>decimal</TIPO>
	<VALOR>{ $body/ejec:Input_Parameters/PARAMETROS_TRAMA/PARAMETRO[NOMBRE='CANTIDAD_MODIFICACION_ELEGIDOS']/VALOR/text() }</VALOR>
</PARAMETRO>]]></con1:xqueryText>
                                                            </con3:expr>
                                                          </con3:insert>
                                                          <con3:insert varName="reglasNegocioResponse">
                                                            <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7b5c</con1:id>
                                                            <con3:location>
                                                              <con1:xpathText>./*:MENSAJE/*:PARAMETROS</con1:xpathText>
                                                            </con3:location>
                                                            <con3:where>last-child</con3:where>
                                                            <con3:expr>
                                                              <con1:xqueryText><![CDATA[<PARAMETRO>
	<NOMBRE>ELEGIDOS_MODIFICADOS</NOMBRE>
	<TIPO>decimal</TIPO>
	<VALOR>{ $body/ejec:Input_Parameters/PARAMETROS_TRAMA/PARAMETRO[NOMBRE='ELEGIDOS_MODIFICADOS']/VALOR/text() }</VALOR>
</PARAMETRO>]]></con1:xqueryText>
                                                            </con3:expr>
                                                          </con3:insert>
                                                          <con3:insert varName="reglasNegocioResponse">
                                                            <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7b5b</con1:id>
                                                            <con3:location>
                                                              <con1:xpathText>./*:MENSAJE/*:PARAMETROS</con1:xpathText>
                                                            </con3:location>
                                                            <con3:where>last-child</con3:where>
                                                            <con3:expr>
                                                              <con1:xqueryText><![CDATA[<PARAMETRO>
	<NOMBRE>ESPOSTPAGO</NOMBRE>
	<TIPO>string</TIPO>
	<VALOR>{ data($consultarContratoEsPospagoResponse/*:MENSAJE/*:ESPOSTPAGO) }</VALOR>
</PARAMETRO>]]></con1:xqueryText>
                                                            </con3:expr>
                                                          </con3:insert>
                                                          <con3:insert varName="reglasNegocioResponse">
                                                            <con1:id>_ActionId-2215439518611274108-740768fe.1574d206712.-7b5a</con1:id>
                                                            <con3:location>
                                                              <con1:xpathText>./*:MENSAJE/*:PARAMETROS</con1:xpathText>
                                                            </con3:location>
                                                            <con3:where>last-child</con3:where>
                                                            <con3:expr>
                                                              <con1:xqueryText><![CDATA[<PARAMETRO>
	<NOMBRE>FAF_TIPO</NOMBRE>
	<TIPO>string</TIPO>
	<VALOR>{ if($metodo = '314') then fn:tokenize(data($consultarFAFTipoResponse/*:MENSAJE/*:FAFTIPO/*:FAF_TIPO),';')[2] else 'ILIMITADO' }</VALOR>
</PARAMETRO>]]></con1:xqueryText>
                                                            </con3:expr>
                                                          </con3:insert>
                                                        </con3:actions>
                                                      </con3:case>
                                                      <con3:default/>
                                                    </con3:ifThenElse>
                                                  </con3:actions>
                                                </con3:case>
                                                <con3:default/>
                                              </con3:ifThenElse>
                                            </con3:actions>
                                          </con3:case>
                                          <con3:case>
                                            <con3:condition>
                                              <con1:xqueryText>$metodo = '701'</con1:xqueryText>
                                            </con3:condition>
                                            <con3:actions>
                                              <con3:assign varName="fafID">
                                                <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-780d</con1:id>
                                                <con3:expr>
                                                  <con1:xqueryText>""</con1:xqueryText>
                                                </con3:expr>
                                              </con3:assign>
                                              <con1:ifThenElse xmlns:con3="http://www.bea.com/wli/sb/typesystem/config" xmlns:con2="http://www.bea.com/wli/sb/stages/config" xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
                                                <con6:id xmlns:con6="http://www.bea.com/wli/sb/stages/config">_ActionId-8096952212429106120-1bbaa577.15405e544f1.-780c</con6:id>
                                                <con1:case>
                                                  <con1:condition>
                                                    <con6:xqueryText xmlns:con6="http://www.bea.com/wli/sb/stages/config">not(exists($fafID)) or $fafID=""</con6:xqueryText>
                                                  </con1:condition>
                                                  <con1:actions>
                                                    <con1:wsCallout>
                                                      <con6:id xmlns:con6="http://www.bea.com/wli/sb/stages/config">_ActionId-8096952212429106120-1bbaa577.15405e544f1.-7806</con6:id>
                                                      <con1:service xsi:type="ref:ProxyRef" ref="ITEL/Core/Proxies/consultarFAFIDVigenciaLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                                      <con1:operation>consultarFAFIDVigencia</con1:operation>
                                                      <con1:request>
                                                        <con1:body>$fafIdVigenciaRequest</con1:body>
                                                      </con1:request>
                                                      <con1:response>
                                                        <con1:body>fafIdVigenciaResponse</con1:body>
                                                      </con1:response>
                                                      <con1:requestTransform>
                                                        <con1:assign varName="fafIdVigenciaRequest">
                                                          <con6:id xmlns:con6="http://www.bea.com/wli/sb/stages/config">_ActionId-8096952212429106120-1bbaa577.15405e544f1.-780b</con6:id>
                                                          <con1:expr>
                                                            <con6:xqueryTransform xmlns:con6="http://www.bea.com/wli/sb/stages/config">
                                                              <con6:resource ref="ITEL/Core/Resources/XQueries/consultarFAFIDVigenciaPS_Req"/>
                                                              <con6:param name="serviceClass">
                                                                <con6:path>number(data($suscriptorOCSResponse/MENSAJE/CONSULTAR_SUSCRIPTOR/*:suscriptor/*:PublicRatePlanCode))</con6:path>
                                                              </con6:param>
                                                              <con6:param name="tipo">
                                                                <con6:path>if(data($body/ejec:Input_Parameters/PARAMETROS_TRAMA/PARAMETRO[NOMBRE='BONIFICAR']/VALOR) = "0") then
 "SMS ONNET"
else if(data($body/ejec:Input_Parameters/PARAMETROS_TRAMA/PARAMETRO[NOMBRE='BONIFICAR']/VALOR) = "1") then
 "SMS OFFNET"
else "SMS ANY"</con6:path>
                                                              </con6:param>
                                                              <con6:param name="fafIdGroup">
                                                                <con6:path>data($suscriptorOCSResponse/MENSAJE/CONSULTAR_SUSCRIPTOR/*:suscriptor/*:AccountGroupID)</con6:path>
                                                              </con6:param>
                                                              <con6:param name="vigencia">
                                                                <con6:path>if(data($body/ejec:Input_Parameters/PARAMETROS_TRAMA/PARAMETRO[NOMBRE='DIASVIGENCIA']/VALOR)="") then 
data($body/ejec:Input_Parameters/VIGENCIA)
else
data($body/ejec:Input_Parameters/PARAMETROS_TRAMA/PARAMETRO[NOMBRE='DIASVIGENCIA']/VALOR)</con6:path>
                                                              </con6:param>
                                                            </con6:xqueryTransform>
                                                          </con1:expr>
                                                        </con1:assign>
                                                      </con1:requestTransform>
                                                      <con1:responseTransform>
                                                        <con1:ifThenElse>
                                                          <con6:id xmlns:con6="http://www.bea.com/wli/sb/stages/config">_ActionId-8096952212429106120-1bbaa577.15405e544f1.-780a</con6:id>
                                                          <con1:case>
                                                            <con1:condition>
                                                              <con6:xqueryText xmlns:con6="http://www.bea.com/wli/sb/stages/config">$fafIdVigenciaResponse/CODIGO = "OK" and data($fafIdVigenciaResponse/MENSAJE/FAFID)!=""</con6:xqueryText>
                                                            </con1:condition>
                                                            <con1:actions>
                                                              <con6:assign varName="reglasNegocioResponse" xmlns:con3="http://www.bea.com/wli/sb/stages/transform/config" xmlns:con2="http://www.bea.com/wli/sb/typesystem/config" xmlns:con1="http://www.bea.com/wli/sb/stages/config" xmlns:con6="http://www.bea.com/wli/sb/stages/transform/config">
                                                                <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-7809</con1:id>
                                                                <con6:expr>
                                                                  <con1:xqueryText><![CDATA[<ns0:WS_Result xmlns:ns0="http://www.comcel.com.co/ConsultarReglas/">
	<CODIGO>1</CODIGO>
	<MENSAJE>
		<ERROR>1</ERROR>
		<ERRORDESC></ERRORDESC>
		<CONSULTASUSCRIPTOR>FALSE</CONSULTASUSCRIPTOR>
		<PARAMETROS>
			<PARAMETRO>
				<NOMBRE>FAFID</NOMBRE>
				<TIPO>string</TIPO>
				<VALOR>{ data($fafIdVigenciaResponse/MENSAJE/FAFID) }</VALOR>
			</PARAMETRO>
			<PARAMETRO>
				<NOMBRE>VIGENCIA_DEFECTO</NOMBRE>
				<TIPO>string</TIPO>
				<VALOR>{ data($body/ejec:Input_Parameters/VIGENCIA) }</VALOR>
			</PARAMETRO>
		</PARAMETROS>
	</MENSAJE>
</ns0:WS_Result>]]></con1:xqueryText>
                                                                </con6:expr>
                                                              </con6:assign>
                                                            </con1:actions>
                                                          </con1:case>
                                                          <con1:case>
                                                            <con1:condition>
                                                              <con6:xqueryText xmlns:con6="http://www.bea.com/wli/sb/stages/config">$fafIdVigenciaResponse/CODIGO = "OK" and data($fafIdVigenciaResponse/MENSAJE/FAFID)=""</con6:xqueryText>
                                                            </con1:condition>
                                                            <con1:actions>
                                                              <con1:assign varName="codError">
                                                                <con6:id xmlns:con6="http://www.bea.com/wli/sb/stages/config">_ActionId-8096952212429106120-1bbaa577.15405e544f1.-7808</con6:id>
                                                                <con1:expr>
                                                                  <con6:xqueryText xmlns:con6="http://www.bea.com/wli/sb/stages/config">"912"</con6:xqueryText>
                                                                </con1:expr>
                                                              </con1:assign>
                                                            </con1:actions>
                                                          </con1:case>
                                                          <con1:default>
                                                            <con1:assign varName="codError">
                                                              <con6:id xmlns:con6="http://www.bea.com/wli/sb/stages/config">_ActionId-8096952212429106120-1bbaa577.15405e544f1.-7807</con6:id>
                                                              <con1:expr>
                                                                <con6:xqueryText xmlns:con6="http://www.bea.com/wli/sb/stages/config">"909"</con6:xqueryText>
                                                              </con1:expr>
                                                            </con1:assign>
                                                          </con1:default>
                                                        </con1:ifThenElse>
                                                      </con1:responseTransform>
                                                    </con1:wsCallout>
                                                  </con1:actions>
                                                </con1:case>
                                                <con1:default>
                                                  <con6:assign varName="reglasNegocioResponse" xmlns:con3="http://www.bea.com/wli/sb/stages/transform/config" xmlns:con2="http://www.bea.com/wli/sb/typesystem/config" xmlns:con1="http://www.bea.com/wli/sb/stages/config" xmlns:con6="http://www.bea.com/wli/sb/stages/transform/config">
                                                    <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-7805</con1:id>
                                                    <con6:expr>
                                                      <con1:xqueryText><![CDATA[<ns0:WS_Result xmlns:ns0="http://www.comcel.com.co/ConsultarReglas/">
	<CODIGO>1</CODIGO>
	<MENSAJE>
		<ERROR>1</ERROR>
		<ERRORDESC></ERRORDESC>
		<CONSULTASUSCRIPTOR>FALSE</CONSULTASUSCRIPTOR>
		<PARAMETROS>
			<PARAMETRO>
				<NOMBRE>FAFID</NOMBRE>
				<TIPO>string</TIPO>
				<VALOR>{ $fafID }</VALOR>
			</PARAMETRO>
			<PARAMETRO>
				<NOMBRE>VIGENCIA_DEFECTO</NOMBRE>
				<TIPO>string</TIPO>
				<VALOR>{ data($body/ejec:Input_Parameters/VIGENCIA) }</VALOR>
			</PARAMETRO>
		</PARAMETROS>
	</MENSAJE>
</ns0:WS_Result>]]></con1:xqueryText>
                                                    </con6:expr>
                                                  </con6:assign>
                                                </con1:default>
                                              </con1:ifThenElse>
                                              <con3:ifThenElse>
                                                <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-7804</con1:id>
                                                <con3:case>
                                                  <con3:condition>
                                                    <con1:xqueryText>$codError = "1"</con1:xqueryText>
                                                  </con3:condition>
                                                  <con3:actions>
                                                    <con1:wsCallout xmlns:con3="http://www.bea.com/wli/sb/typesystem/config" xmlns:con2="http://www.bea.com/wli/sb/stages/config" xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
                                                      <con6:id xmlns:con6="http://www.bea.com/wli/sb/stages/config">_ActionId-8096952212429106120-1bbaa577.15405e544f1.-7802</con6:id>
                                                      <con1:service xsi:type="ref:ProxyRef" ref="ITEL/OCS/AIR/Proxies/consultarFaFListOCSLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                                      <con1:operation>consultarFaFList</con1:operation>
                                                      <con1:request>
                                                        <con1:body>$consultarFaFListRequest</con1:body>
                                                      </con1:request>
                                                      <con1:response>
                                                        <con1:body>consultarFaFListResponse</con1:body>
                                                      </con1:response>
                                                      <con1:requestTransform>
                                                        <con1:assign varName="consultarFaFListRequest">
                                                          <con6:id xmlns:con6="http://www.bea.com/wli/sb/stages/config">_ActionId-8096952212429106120-1bbaa577.15405e544f1.-7803</con6:id>
                                                          <con1:expr>
                                                            <con6:xqueryTransform xmlns:con6="http://www.bea.com/wli/sb/stages/config">
                                                              <con6:resource ref="ITEL/Core/Resources/XQueries/consultarFaFListPS_Req"/>
                                                              <con6:param name="min">
                                                                <con6:path>data($body/ejec:Input_Parameters/MIN_DESTINO)</con6:path>
                                                              </con6:param>
                                                            </con6:xqueryTransform>
                                                          </con1:expr>
                                                        </con1:assign>
                                                      </con1:requestTransform>
                                                      <con1:responseTransform/>
                                                    </con1:wsCallout>
                                                  </con3:actions>
                                                </con3:case>
                                                <con3:default/>
                                              </con3:ifThenElse>
                                              <con3:ifThenElse>
                                                <con1:comment>Validacion elegidos</con1:comment>
                                                <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-7801</con1:id>
                                                <con3:case>
                                                  <con3:condition>
                                                    <con1:xqueryText>$codError = "1"</con1:xqueryText>
                                                  </con3:condition>
                                                  <con3:actions>
                                                    <con3:assign varName="elegidos">
                                                      <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-7800</con1:id>
                                                      <con3:expr>
                                                        <con1:xqueryText>&lt;ELEGIDOS>
{let $elegidos := fn:tokenize($body/ejec:Input_Parameters/PARAMETROS_TRAMA/PARAMETRO[NOMBRE='HOSTID']/VALOR, ';')
	for $i in (1 to fn:count($elegidos))
	return 
	&lt;ELEGIDO>{$elegidos[$i]}&lt;/ELEGIDO>
}
&lt;/ELEGIDOS></con1:xqueryText>
                                                      </con3:expr>
                                                    </con3:assign>
                                                    <con3:foreach>
                                                      <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-77e5</con1:id>
                                                      <con3:variable>elegidos</con3:variable>
                                                      <con3:expression>
                                                        <con1:xpathText>./ELEGIDO</con1:xpathText>
                                                      </con3:expression>
                                                      <con3:value-variable>elegido</con3:value-variable>
                                                      <con3:index-variable>indice</con3:index-variable>
                                                      <con3:total-variable>total</con3:total-variable>
                                                      <con3:actions>
                                                        <con3:wsCallout>
                                                          <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-77fa</con1:id>
                                                          <con3:service xsi:type="ref:ProxyRef" ref="ITEL/Core/Proxies/consultarRangoMinLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                                          <con3:operation>consultarRangoMin</con3:operation>
                                                          <con3:request>
                                                            <con3:body>$rangosRequest</con3:body>
                                                          </con3:request>
                                                          <con3:response>
                                                            <con3:body>rangosResponse</con3:body>
                                                          </con3:response>
                                                          <con3:requestTransform>
                                                            <con1:assign varName="rangosRequest" xmlns:con2="http://www.bea.com/wli/sb/stages/config" xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
                                                              <con6:id xmlns:con6="http://www.bea.com/wli/sb/stages/config">_ActionId-8096952212429106120-1bbaa577.15405e544f1.-77ff</con6:id>
                                                              <con1:expr>
                                                                <con6:xqueryTransform xmlns:con6="http://www.bea.com/wli/sb/stages/config">
                                                                  <con6:resource ref="ITEL/Core/Resources/XQueries/consultarRangoMin_Req"/>
                                                                  <con6:param name="min">
                                                                    <con6:path>data($elegido)</con6:path>
                                                                  </con6:param>
                                                                </con6:xqueryTransform>
                                                              </con1:expr>
                                                            </con1:assign>
                                                          </con3:requestTransform>
                                                          <con3:responseTransform>
                                                            <con1:ifThenElse xmlns:con2="http://www.bea.com/wli/sb/stages/config" xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
                                                              <con6:id xmlns:con6="http://www.bea.com/wli/sb/stages/config">_ActionId-8096952212429106120-1bbaa577.15405e544f1.-77fe</con6:id>
                                                              <con1:case>
                                                                <con1:condition>
                                                                  <con6:xqueryText xmlns:con6="http://www.bea.com/wli/sb/stages/config">data($rangosResponse/CODIGO) != "OK"</con6:xqueryText>
                                                                </con1:condition>
                                                                <con1:actions>
                                                                  <con1:assign varName="codError">
                                                                    <con6:id xmlns:con6="http://www.bea.com/wli/sb/stages/config">_ActionId-8096952212429106120-1bbaa577.15405e544f1.-77fd</con6:id>
                                                                    <con1:expr>
                                                                      <con6:xqueryText xmlns:con6="http://www.bea.com/wli/sb/stages/config">"909"</con6:xqueryText>
                                                                    </con1:expr>
                                                                  </con1:assign>
                                                                </con1:actions>
                                                              </con1:case>
                                                              <con1:case>
                                                                <con1:condition>
                                                                  <con6:xqueryText xmlns:con6="http://www.bea.com/wli/sb/stages/config">data($rangosResponse/MENSAJE/RMCESTADO) = "0" or data($rangosResponse/MENSAJE/RMCESTADO) = "-1"</con6:xqueryText>
                                                                </con1:condition>
                                                                <con1:actions>
                                                                  <con1:assign varName="codError">
                                                                    <con6:id xmlns:con6="http://www.bea.com/wli/sb/stages/config">_ActionId-8096952212429106120-1bbaa577.15405e544f1.-77fc</con6:id>
                                                                    <con1:expr>
                                                                      <con6:xqueryText xmlns:con6="http://www.bea.com/wli/sb/stages/config">"17"</con6:xqueryText>
                                                                    </con1:expr>
                                                                  </con1:assign>
                                                                </con1:actions>
                                                              </con1:case>
                                                              <con1:default>
                                                                <con1:assign varName="inElegido">
                                                                  <con6:id xmlns:con6="http://www.bea.com/wli/sb/stages/config">_ActionId-8096952212429106120-1bbaa577.15405e544f1.-77fb</con6:id>
                                                                  <con1:expr>
                                                                    <con6:xqueryText xmlns:con6="http://www.bea.com/wli/sb/stages/config">data($rangosResponse/MENSAJE/RMCCODIGOIN)</con6:xqueryText>
                                                                  </con1:expr>
                                                                </con1:assign>
                                                              </con1:default>
                                                            </con1:ifThenElse>
                                                          </con3:responseTransform>
                                                        </con3:wsCallout>
                                                        <con3:ifThenElse>
                                                          <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-77f9</con1:id>
                                                          <con3:case>
                                                            <con3:condition>
                                                              <con1:xqueryText>$codError = "1"</con1:xqueryText>
                                                            </con3:condition>
                                                            <con3:actions>
                                                              <con3:ifThenElse>
                                                                <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-77f8</con1:id>
                                                                <con3:case>
                                                                  <con3:condition>
                                                                    <con1:xqueryText>number($inElegido) &lt; 50</con1:xqueryText>
                                                                  </con3:condition>
                                                                  <con3:actions>
                                                                    <con3:wsCallout>
                                                                      <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-77f6</con1:id>
                                                                      <con3:service xsi:type="ref:ProxyRef" ref="ITEL/IN/Proxies/consultarSuscriptorINLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                                                      <con3:operation>consultarSuscriptorIN</con3:operation>
                                                                      <con3:request>
                                                                        <con3:body>$suscriptorRequest</con3:body>
                                                                      </con3:request>
                                                                      <con3:response>
                                                                        <con3:body>suscriptorResponse</con3:body>
                                                                      </con3:response>
                                                                      <con3:requestTransform>
                                                                        <con3:assign varName="suscriptorRequest">
                                                                          <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-77f7</con1:id>
                                                                          <con3:expr>
                                                                            <con1:xqueryTransform>
                                                                              <con1:resource ref="ITEL/Core/Resources/XQueries/ejecutarReglasNegocio_Req_consultarDatosSuscriptorLocal"/>
                                                                              <con1:param name="timeout">
                                                                                <con1:path>$timeout</con1:path>
                                                                              </con1:param>
                                                                              <con1:param name="min">
                                                                                <con1:path>data($elegido)</con1:path>
                                                                              </con1:param>
                                                                              <con1:param name="in">
                                                                                <con1:path>$inElegido</con1:path>
                                                                              </con1:param>
                                                                              <con1:param name="prefijo">
                                                                                <con1:path>$prefijo</con1:path>
                                                                              </con1:param>
                                                                            </con1:xqueryTransform>
                                                                          </con3:expr>
                                                                        </con3:assign>
                                                                      </con3:requestTransform>
                                                                      <con3:responseTransform/>
                                                                    </con3:wsCallout>
                                                                    <con3:ifThenElse>
                                                                      <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-77f5</con1:id>
                                                                      <con3:case>
                                                                        <con3:condition>
                                                                          <con1:xqueryText>$suscriptorResponse/CODIGO/text() = "1"</con1:xqueryText>
                                                                        </con3:condition>
                                                                        <con3:actions>
                                                                          <con3:ifThenElse>
                                                                            <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-77f4</con1:id>
                                                                            <con3:case>
                                                                              <con3:condition>
                                                                                <con1:xqueryText>data($body/ejec:Input_Parameters/PARAMETROS_TRAMA/PARAMETRO[NOMBRE='BONIFICAR']/VALOR)="1"</con1:xqueryText>
                                                                              </con3:condition>
                                                                              <con3:actions>
                                                                                <con3:assign varName="codError">
                                                                                  <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-77f3</con1:id>
                                                                                  <con3:expr>
                                                                                    <con1:xqueryText>"17"</con1:xqueryText>
                                                                                  </con3:expr>
                                                                                </con3:assign>
                                                                                <con1:skip>
                                                                                  <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-77f2</con1:id>
                                                                                </con1:skip>
                                                                              </con3:actions>
                                                                            </con3:case>
                                                                            <con3:default/>
                                                                          </con3:ifThenElse>
                                                                        </con3:actions>
                                                                      </con3:case>
                                                                      <con3:case>
                                                                        <con3:condition>
                                                                          <con1:xqueryText>data($body/ejec:Input_Parameters/PARAMETROS_TRAMA/PARAMETRO[NOMBRE='BONIFICAR']/VALOR)="1"</con1:xqueryText>
                                                                        </con3:condition>
                                                                        <con3:actions/>
                                                                      </con3:case>
                                                                      <con3:default>
                                                                        <con3:assign varName="codError">
                                                                          <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-77f1</con1:id>
                                                                          <con3:expr>
                                                                            <con1:xqueryText>"17"</con1:xqueryText>
                                                                          </con3:expr>
                                                                        </con3:assign>
                                                                        <con1:skip>
                                                                          <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-77f0</con1:id>
                                                                        </con1:skip>
                                                                      </con3:default>
                                                                    </con3:ifThenElse>
                                                                  </con3:actions>
                                                                </con3:case>
                                                                <con3:default>
                                                                  <con3:wsCallout>
                                                                    <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-77ee</con1:id>
                                                                    <con3:service xsi:type="ref:ProxyRef" ref="ITEL/OCS/SOI/Proxies/consultarSuscriptorOCSLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                                                    <con3:operation>consultarSuscriptorOCS</con3:operation>
                                                                    <con3:request>
                                                                      <con3:body>$elegidoOCSRequest</con3:body>
                                                                    </con3:request>
                                                                    <con3:response>
                                                                      <con3:body>elegidoOCSResponse</con3:body>
                                                                    </con3:response>
                                                                    <con3:requestTransform>
                                                                      <con3:assign varName="elegidoOCSRequest">
                                                                        <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-77ef</con1:id>
                                                                        <con3:expr>
                                                                          <con1:xqueryTransform>
                                                                            <con1:resource ref="ITEL/Core/Resources/XQueries/consultarSuscriptorOCSPS_Req"/>
                                                                            <con1:param name="timeout">
                                                                              <con1:path>2000</con1:path>
                                                                            </con1:param>
                                                                            <con1:param name="min">
                                                                              <con1:path>data($elegido)</con1:path>
                                                                            </con1:param>
                                                                            <con1:param name="in">
                                                                              <con1:path>$inElegido</con1:path>
                                                                            </con1:param>
                                                                          </con1:xqueryTransform>
                                                                        </con3:expr>
                                                                      </con3:assign>
                                                                    </con3:requestTransform>
                                                                    <con3:responseTransform/>
                                                                  </con3:wsCallout>
                                                                  <con3:ifThenElse>
                                                                    <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-77ed</con1:id>
                                                                    <con3:case>
                                                                      <con3:condition>
                                                                        <con1:xqueryText>data($elegidoOCSResponse/CODIGO) = '1'</con1:xqueryText>
                                                                      </con3:condition>
                                                                      <con3:actions>
                                                                        <con3:ifThenElse>
                                                                          <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-77ec</con1:id>
                                                                          <con3:case>
                                                                            <con3:condition>
                                                                              <con1:xqueryText>data($body/ejec:Input_Parameters/PARAMETROS_TRAMA/PARAMETRO[NOMBRE='BONIFICAR']/VALOR)="1"</con1:xqueryText>
                                                                            </con3:condition>
                                                                            <con3:actions>
                                                                              <con3:assign varName="codError">
                                                                                <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-77eb</con1:id>
                                                                                <con3:expr>
                                                                                  <con1:xqueryText>"17"</con1:xqueryText>
                                                                                </con3:expr>
                                                                              </con3:assign>
                                                                              <con1:skip>
                                                                                <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-77ea</con1:id>
                                                                              </con1:skip>
                                                                            </con3:actions>
                                                                          </con3:case>
                                                                          <con3:default/>
                                                                        </con3:ifThenElse>
                                                                      </con3:actions>
                                                                    </con3:case>
                                                                    <con3:case>
                                                                      <con3:condition>
                                                                        <con1:xqueryText>data($body/ejec:Input_Parameters/PARAMETROS_TRAMA/PARAMETRO[NOMBRE='BONIFICAR']/VALOR)="1"</con1:xqueryText>
                                                                      </con3:condition>
                                                                      <con3:actions/>
                                                                    </con3:case>
                                                                    <con3:default>
                                                                      <con3:assign varName="codError">
                                                                        <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-77e9</con1:id>
                                                                        <con3:expr>
                                                                          <con1:xqueryText>"17"</con1:xqueryText>
                                                                        </con3:expr>
                                                                      </con3:assign>
                                                                      <con1:skip>
                                                                        <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-77e8</con1:id>
                                                                      </con1:skip>
                                                                    </con3:default>
                                                                  </con3:ifThenElse>
                                                                </con3:default>
                                                              </con3:ifThenElse>
                                                            </con3:actions>
                                                          </con3:case>
                                                          <con3:case>
                                                            <con3:condition>
                                                              <con1:xqueryText>$codError = "17" and data($body/ejec:Input_Parameters/PARAMETROS_TRAMA/PARAMETRO[NOMBRE='BONIFICAR']/VALOR)="1"</con1:xqueryText>
                                                            </con3:condition>
                                                            <con3:actions>
                                                              <con3:assign varName="codError">
                                                                <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-77e7</con1:id>
                                                                <con3:expr>
                                                                  <con1:xqueryText>"1"</con1:xqueryText>
                                                                </con3:expr>
                                                              </con3:assign>
                                                            </con3:actions>
                                                          </con3:case>
                                                          <con3:default>
                                                            <con1:skip>
                                                              <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-77e6</con1:id>
                                                            </con1:skip>
                                                          </con3:default>
                                                        </con3:ifThenElse>
                                                      </con3:actions>
                                                    </con3:foreach>
                                                  </con3:actions>
                                                </con3:case>
                                                <con3:default/>
                                              </con3:ifThenElse>
                                            </con3:actions>
                                          </con3:case>
                                          <con3:case>
                                            <con3:condition>
                                              <con1:xqueryText>$metodo = ("702","703","704")</con1:xqueryText>
                                            </con3:condition>
                                            <con3:actions>
                                              <con1:wsCallout xmlns:con3="http://www.bea.com/wli/sb/typesystem/config" xmlns:con2="http://www.bea.com/wli/sb/stages/config" xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
                                                <con6:id xmlns:con6="http://www.bea.com/wli/sb/stages/config">_ActionId-8096952212429106120-1bbaa577.15405e544f1.-77dd</con6:id>
                                                <con1:service xsi:type="ref:ProxyRef" ref="ITEL/OCS/AIR/Proxies/consultarFaFListOCSLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                                <con1:operation>consultarFaFList</con1:operation>
                                                <con1:request>
                                                  <con1:body>$consultarFaFListRequest</con1:body>
                                                </con1:request>
                                                <con1:response>
                                                  <con1:body>consultarFaFListResponse</con1:body>
                                                </con1:response>
                                                <con1:requestTransform>
                                                  <con1:assign varName="consultarFaFListRequest">
                                                    <con6:id xmlns:con6="http://www.bea.com/wli/sb/stages/config">_ActionId-8096952212429106120-1bbaa577.15405e544f1.-77e4</con6:id>
                                                    <con1:expr>
                                                      <con6:xqueryTransform xmlns:con6="http://www.bea.com/wli/sb/stages/config">
                                                        <con6:resource ref="ITEL/Core/Resources/XQueries/consultarFaFListPS_Req"/>
                                                        <con6:param name="min">
                                                          <con6:path>data($body/ejec:Input_Parameters/MIN_DESTINO)</con6:path>
                                                        </con6:param>
                                                      </con6:xqueryTransform>
                                                    </con1:expr>
                                                  </con1:assign>
                                                </con1:requestTransform>
                                                <con1:responseTransform>
                                                  <con1:ifThenElse>
                                                    <con6:id xmlns:con6="http://www.bea.com/wli/sb/stages/config">_ActionId-8096952212429106120-1bbaa577.15405e544f1.-77e3</con6:id>
                                                    <con1:case>
                                                      <con1:condition>
                                                        <con6:xqueryText xmlns:con6="http://www.bea.com/wli/sb/stages/config">data($consultarFaFListResponse/CODIGO) != '1'</con6:xqueryText>
                                                      </con1:condition>
                                                      <con1:actions>
                                                        <con6:assign varName="codError" xmlns:con3="http://www.bea.com/wli/sb/stages/transform/config" xmlns:con2="http://www.bea.com/wli/sb/typesystem/config" xmlns:con1="http://www.bea.com/wli/sb/stages/config" xmlns:con6="http://www.bea.com/wli/sb/stages/transform/config">
                                                          <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-77e2</con1:id>
                                                          <con6:expr>
                                                            <con1:xqueryText>data($consultarFaFListResponse/CODIGO)</con1:xqueryText>
                                                          </con6:expr>
                                                        </con6:assign>
                                                      </con1:actions>
                                                    </con1:case>
                                                    <con1:default>
                                                      <con6:assign varName="fafID" xmlns:con6="http://www.bea.com/wli/sb/stages/transform/config">
                                                        <con7:id xmlns:con7="http://www.bea.com/wli/sb/stages/config">_ActionId-8096952212429106120-1bbaa577.15405e544f1.-77e1</con7:id>
                                                        <con6:expr>
                                                          <con7:xqueryTransform xmlns:con7="http://www.bea.com/wli/sb/stages/config">
                                                            <con7:resource ref="ITEL/Core/Resources/XQueries/obtenerFAFID"/>
                                                            <con7:param name="fafList">
                                                              <con7:path>$consultarFaFListResponse</con7:path>
                                                            </con7:param>
                                                            <con7:param name="metodoFAF">
                                                              <con7:path>$tipoFAFResponse</con7:path>
                                                            </con7:param>
                                                          </con7:xqueryTransform>
                                                        </con6:expr>
                                                      </con6:assign>
                                                      <con1:ifThenElse>
                                                        <con6:id xmlns:con6="http://www.bea.com/wli/sb/stages/config">_ActionId-8096952212429106120-1bbaa577.15405e544f1.-77e0</con6:id>
                                                        <con1:case>
                                                          <con1:condition>
                                                            <con6:xqueryText xmlns:con6="http://www.bea.com/wli/sb/stages/config">$fafID=""</con6:xqueryText>
                                                          </con1:condition>
                                                          <con1:actions>
                                                            <con1:assign varName="codError">
                                                              <con6:id xmlns:con6="http://www.bea.com/wli/sb/stages/config">_ActionId-8096952212429106120-1bbaa577.15405e544f1.-77df</con6:id>
                                                              <con1:expr>
                                                                <con6:xqueryText xmlns:con6="http://www.bea.com/wli/sb/stages/config">"60"</con6:xqueryText>
                                                              </con1:expr>
                                                            </con1:assign>
                                                          </con1:actions>
                                                        </con1:case>
                                                        <con1:default>
                                                          <con6:assign varName="reglasNegocioResponse" xmlns:con3="http://www.bea.com/wli/sb/stages/transform/config" xmlns:con2="http://www.bea.com/wli/sb/typesystem/config" xmlns:con1="http://www.bea.com/wli/sb/stages/config" xmlns:con7="http://www.bea.com/wli/sb/stages/transform/config" xmlns:con6="http://www.bea.com/wli/sb/stages/transform/config">
                                                            <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-77de</con1:id>
                                                            <con6:expr>
                                                              <con1:xqueryText><![CDATA[<ns0:WS_Result xmlns:ns0="http://www.comcel.com.co/ConsultarReglas/">
	<CODIGO>1</CODIGO>
	<MENSAJE>
		<ERROR>1</ERROR>
		<ERRORDESC></ERRORDESC>
		<CONSULTASUSCRIPTOR>FALSE</CONSULTASUSCRIPTOR>
		<PARAMETROS>
			<PARAMETRO>
				<NOMBRE>FAFID</NOMBRE>
				<TIPO>string</TIPO>
				<VALOR>{ $fafID }</VALOR>
			</PARAMETRO>
		</PARAMETROS>
	</MENSAJE>
</ns0:WS_Result>]]></con1:xqueryText>
                                                            </con6:expr>
                                                          </con6:assign>
                                                        </con1:default>
                                                      </con1:ifThenElse>
                                                    </con1:default>
                                                  </con1:ifThenElse>
                                                </con1:responseTransform>
                                              </con1:wsCallout>
                                              <con3:ifThenElse>
                                                <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-77dc</con1:id>
                                                <con3:case>
                                                  <con3:condition>
                                                    <con1:xqueryText>$codError = "1" and  $metodo = "702"</con1:xqueryText>
                                                  </con3:condition>
                                                  <con3:actions>
                                                    <con3:assign varName="elegidos">
                                                      <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-77db</con1:id>
                                                      <con3:expr>
                                                        <con1:xqueryText>&lt;ELEGIDOS>
{
    let $elegidoTemp := fn:concat(data($body/ejec:Input_Parameters/PARAMETROS_TRAMA/PARAMETRO[NOMBRE='HOSTID']/VALOR), ';', data($body/ejec:Input_Parameters/PARAMETROS_TRAMA/PARAMETRO[NOMBRE='DIASVIGENCIA']/VALOR)),
	    $elegidos := fn:tokenize($elegidoTemp, ';')
	for $i in (1 to fn:count($elegidos))
	return 
	&lt;ELEGIDO>{$elegidos[$i]}&lt;/ELEGIDO>		
}
&lt;/ELEGIDOS></con1:xqueryText>
                                                      </con3:expr>
                                                    </con3:assign>
                                                    <con3:foreach>
                                                      <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-77c0</con1:id>
                                                      <con3:variable>elegidos</con3:variable>
                                                      <con3:expression>
                                                        <con1:xpathText>./ELEGIDO</con1:xpathText>
                                                      </con3:expression>
                                                      <con3:value-variable>elegido</con3:value-variable>
                                                      <con3:index-variable>indice</con3:index-variable>
                                                      <con3:total-variable>total</con3:total-variable>
                                                      <con3:actions>
                                                        <con3:wsCallout>
                                                          <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-77d5</con1:id>
                                                          <con3:service xsi:type="ref:ProxyRef" ref="ITEL/Core/Proxies/consultarRangoMinLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                                          <con3:operation>consultarRangoMin</con3:operation>
                                                          <con3:request>
                                                            <con3:body>$rangosRequest</con3:body>
                                                          </con3:request>
                                                          <con3:response>
                                                            <con3:body>rangosResponse</con3:body>
                                                          </con3:response>
                                                          <con3:requestTransform>
                                                            <con1:assign varName="rangosRequest" xmlns:con2="http://www.bea.com/wli/sb/stages/config" xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
                                                              <con6:id xmlns:con6="http://www.bea.com/wli/sb/stages/config">_ActionId-8096952212429106120-1bbaa577.15405e544f1.-77da</con6:id>
                                                              <con1:expr>
                                                                <con6:xqueryTransform xmlns:con6="http://www.bea.com/wli/sb/stages/config">
                                                                  <con6:resource ref="ITEL/Core/Resources/XQueries/consultarRangoMin_Req"/>
                                                                  <con6:param name="min">
                                                                    <con6:path>data($elegido)</con6:path>
                                                                  </con6:param>
                                                                </con6:xqueryTransform>
                                                              </con1:expr>
                                                            </con1:assign>
                                                          </con3:requestTransform>
                                                          <con3:responseTransform>
                                                            <con1:ifThenElse xmlns:con2="http://www.bea.com/wli/sb/stages/config" xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
                                                              <con6:id xmlns:con6="http://www.bea.com/wli/sb/stages/config">_ActionId-8096952212429106120-1bbaa577.15405e544f1.-77d9</con6:id>
                                                              <con1:case>
                                                                <con1:condition>
                                                                  <con6:xqueryText xmlns:con6="http://www.bea.com/wli/sb/stages/config">data($rangosResponse/CODIGO) != "OK"</con6:xqueryText>
                                                                </con1:condition>
                                                                <con1:actions>
                                                                  <con1:assign varName="codError">
                                                                    <con6:id xmlns:con6="http://www.bea.com/wli/sb/stages/config">_ActionId-8096952212429106120-1bbaa577.15405e544f1.-77d8</con6:id>
                                                                    <con1:expr>
                                                                      <con6:xqueryText xmlns:con6="http://www.bea.com/wli/sb/stages/config">"909"</con6:xqueryText>
                                                                    </con1:expr>
                                                                  </con1:assign>
                                                                </con1:actions>
                                                              </con1:case>
                                                              <con1:case>
                                                                <con1:condition>
                                                                  <con6:xqueryText xmlns:con6="http://www.bea.com/wli/sb/stages/config">data($rangosResponse/MENSAJE/RMCESTADO) = "0" or data($rangosResponse/MENSAJE/RMCESTADO) = "-1"</con6:xqueryText>
                                                                </con1:condition>
                                                                <con1:actions>
                                                                  <con1:assign varName="codError">
                                                                    <con6:id xmlns:con6="http://www.bea.com/wli/sb/stages/config">_ActionId-8096952212429106120-1bbaa577.15405e544f1.-77d7</con6:id>
                                                                    <con1:expr>
                                                                      <con6:xqueryText xmlns:con6="http://www.bea.com/wli/sb/stages/config">"17"</con6:xqueryText>
                                                                    </con1:expr>
                                                                  </con1:assign>
                                                                </con1:actions>
                                                              </con1:case>
                                                              <con1:default>
                                                                <con1:assign varName="inElegido">
                                                                  <con6:id xmlns:con6="http://www.bea.com/wli/sb/stages/config">_ActionId-8096952212429106120-1bbaa577.15405e544f1.-77d6</con6:id>
                                                                  <con1:expr>
                                                                    <con6:xqueryText xmlns:con6="http://www.bea.com/wli/sb/stages/config">data($rangosResponse/MENSAJE/RMCCODIGOIN)</con6:xqueryText>
                                                                  </con1:expr>
                                                                </con1:assign>
                                                              </con1:default>
                                                            </con1:ifThenElse>
                                                          </con3:responseTransform>
                                                        </con3:wsCallout>
                                                        <con3:ifThenElse>
                                                          <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-77d4</con1:id>
                                                          <con3:case>
                                                            <con3:condition>
                                                              <con1:xqueryText>$codError = "1"</con1:xqueryText>
                                                            </con3:condition>
                                                            <con3:actions>
                                                              <con3:ifThenElse>
                                                                <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-77d3</con1:id>
                                                                <con3:case>
                                                                  <con3:condition>
                                                                    <con1:xqueryText>number($inElegido) &lt; 50</con1:xqueryText>
                                                                  </con3:condition>
                                                                  <con3:actions>
                                                                    <con3:wsCallout>
                                                                      <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-77d1</con1:id>
                                                                      <con3:service xsi:type="ref:ProxyRef" ref="ITEL/IN/Proxies/consultarSuscriptorINLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                                                      <con3:operation>consultarSuscriptorIN</con3:operation>
                                                                      <con3:request>
                                                                        <con3:body>$suscriptorRequest</con3:body>
                                                                      </con3:request>
                                                                      <con3:response>
                                                                        <con3:body>suscriptorResponse</con3:body>
                                                                      </con3:response>
                                                                      <con3:requestTransform>
                                                                        <con3:assign varName="suscriptorRequest">
                                                                          <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-77d2</con1:id>
                                                                          <con3:expr>
                                                                            <con1:xqueryTransform>
                                                                              <con1:resource ref="ITEL/Core/Resources/XQueries/ejecutarReglasNegocio_Req_consultarDatosSuscriptorLocal"/>
                                                                              <con1:param name="timeout">
                                                                                <con1:path>$timeout</con1:path>
                                                                              </con1:param>
                                                                              <con1:param name="min">
                                                                                <con1:path>data($elegido)</con1:path>
                                                                              </con1:param>
                                                                              <con1:param name="in">
                                                                                <con1:path>$inElegido</con1:path>
                                                                              </con1:param>
                                                                              <con1:param name="prefijo">
                                                                                <con1:path>$prefijo</con1:path>
                                                                              </con1:param>
                                                                            </con1:xqueryTransform>
                                                                          </con3:expr>
                                                                        </con3:assign>
                                                                      </con3:requestTransform>
                                                                      <con3:responseTransform/>
                                                                    </con3:wsCallout>
                                                                    <con3:ifThenElse>
                                                                      <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-77d0</con1:id>
                                                                      <con3:case>
                                                                        <con3:condition>
                                                                          <con1:xqueryText>$suscriptorResponse/CODIGO/text() = "1"</con1:xqueryText>
                                                                        </con3:condition>
                                                                        <con3:actions>
                                                                          <con3:ifThenElse>
                                                                            <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-77cf</con1:id>
                                                                            <con3:case>
                                                                              <con3:condition>
                                                                                <con1:xqueryText>data($body/ejec:Input_Parameters/PARAMETROS_TRAMA/PARAMETRO[NOMBRE='BONIFICAR']/VALOR)="1"</con1:xqueryText>
                                                                              </con3:condition>
                                                                              <con3:actions>
                                                                                <con3:assign varName="codError">
                                                                                  <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-77ce</con1:id>
                                                                                  <con3:expr>
                                                                                    <con1:xqueryText>"17"</con1:xqueryText>
                                                                                  </con3:expr>
                                                                                </con3:assign>
                                                                                <con1:skip>
                                                                                  <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-77cd</con1:id>
                                                                                </con1:skip>
                                                                              </con3:actions>
                                                                            </con3:case>
                                                                            <con3:default/>
                                                                          </con3:ifThenElse>
                                                                        </con3:actions>
                                                                      </con3:case>
                                                                      <con3:case>
                                                                        <con3:condition>
                                                                          <con1:xqueryText>data($body/ejec:Input_Parameters/PARAMETROS_TRAMA/PARAMETRO[NOMBRE='BONIFICAR']/VALOR)="1"</con1:xqueryText>
                                                                        </con3:condition>
                                                                        <con3:actions/>
                                                                      </con3:case>
                                                                      <con3:default>
                                                                        <con3:assign varName="codError">
                                                                          <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-77cc</con1:id>
                                                                          <con3:expr>
                                                                            <con1:xqueryText>"17"</con1:xqueryText>
                                                                          </con3:expr>
                                                                        </con3:assign>
                                                                        <con1:skip>
                                                                          <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-77cb</con1:id>
                                                                        </con1:skip>
                                                                      </con3:default>
                                                                    </con3:ifThenElse>
                                                                  </con3:actions>
                                                                </con3:case>
                                                                <con3:default>
                                                                  <con3:wsCallout>
                                                                    <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-77c9</con1:id>
                                                                    <con3:service xsi:type="ref:ProxyRef" ref="ITEL/OCS/SOI/Proxies/consultarSuscriptorOCSLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                                                    <con3:operation>consultarSuscriptorOCS</con3:operation>
                                                                    <con3:request>
                                                                      <con3:body>$elegidoOCSRequest</con3:body>
                                                                    </con3:request>
                                                                    <con3:response>
                                                                      <con3:body>elegidoOCSResponse</con3:body>
                                                                    </con3:response>
                                                                    <con3:requestTransform>
                                                                      <con3:assign varName="elegidoOCSRequest">
                                                                        <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-77ca</con1:id>
                                                                        <con3:expr>
                                                                          <con1:xqueryTransform>
                                                                            <con1:resource ref="ITEL/Core/Resources/XQueries/consultarSuscriptorOCSPS_Req"/>
                                                                            <con1:param name="timeout">
                                                                              <con1:path>2000</con1:path>
                                                                            </con1:param>
                                                                            <con1:param name="min">
                                                                              <con1:path>data($elegido)</con1:path>
                                                                            </con1:param>
                                                                            <con1:param name="in">
                                                                              <con1:path>$inElegido</con1:path>
                                                                            </con1:param>
                                                                          </con1:xqueryTransform>
                                                                        </con3:expr>
                                                                      </con3:assign>
                                                                    </con3:requestTransform>
                                                                    <con3:responseTransform/>
                                                                  </con3:wsCallout>
                                                                  <con3:ifThenElse>
                                                                    <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-77c8</con1:id>
                                                                    <con3:case>
                                                                      <con3:condition>
                                                                        <con1:xqueryText>data($elegidoOCSResponse/CODIGO) = '1'</con1:xqueryText>
                                                                      </con3:condition>
                                                                      <con3:actions>
                                                                        <con3:ifThenElse>
                                                                          <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-77c7</con1:id>
                                                                          <con3:case>
                                                                            <con3:condition>
                                                                              <con1:xqueryText>data($body/ejec:Input_Parameters/PARAMETROS_TRAMA/PARAMETRO[NOMBRE='BONIFICAR']/VALOR)="1"</con1:xqueryText>
                                                                            </con3:condition>
                                                                            <con3:actions>
                                                                              <con3:assign varName="codError">
                                                                                <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-77c6</con1:id>
                                                                                <con3:expr>
                                                                                  <con1:xqueryText>"17"</con1:xqueryText>
                                                                                </con3:expr>
                                                                              </con3:assign>
                                                                              <con1:skip>
                                                                                <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-77c5</con1:id>
                                                                              </con1:skip>
                                                                            </con3:actions>
                                                                          </con3:case>
                                                                          <con3:default/>
                                                                        </con3:ifThenElse>
                                                                      </con3:actions>
                                                                    </con3:case>
                                                                    <con3:case>
                                                                      <con3:condition>
                                                                        <con1:xqueryText>data($body/ejec:Input_Parameters/PARAMETROS_TRAMA/PARAMETRO[NOMBRE='BONIFICAR']/VALOR)="1"</con1:xqueryText>
                                                                      </con3:condition>
                                                                      <con3:actions/>
                                                                    </con3:case>
                                                                    <con3:default>
                                                                      <con3:assign varName="codError">
                                                                        <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-77c4</con1:id>
                                                                        <con3:expr>
                                                                          <con1:xqueryText>"17"</con1:xqueryText>
                                                                        </con3:expr>
                                                                      </con3:assign>
                                                                      <con1:skip>
                                                                        <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-77c3</con1:id>
                                                                      </con1:skip>
                                                                    </con3:default>
                                                                  </con3:ifThenElse>
                                                                </con3:default>
                                                              </con3:ifThenElse>
                                                            </con3:actions>
                                                          </con3:case>
                                                          <con3:case>
                                                            <con3:condition>
                                                              <con1:xqueryText>$codError = "17" and data($body/ejec:Input_Parameters/PARAMETROS_TRAMA/PARAMETRO[NOMBRE='BONIFICAR']/VALOR)="1"</con1:xqueryText>
                                                            </con3:condition>
                                                            <con3:actions>
                                                              <con3:assign varName="codError">
                                                                <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-77c2</con1:id>
                                                                <con3:expr>
                                                                  <con1:xqueryText>"1"</con1:xqueryText>
                                                                </con3:expr>
                                                              </con3:assign>
                                                            </con3:actions>
                                                          </con3:case>
                                                          <con3:default>
                                                            <con1:skip>
                                                              <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-77c1</con1:id>
                                                            </con1:skip>
                                                          </con3:default>
                                                        </con3:ifThenElse>
                                                      </con3:actions>
                                                    </con3:foreach>
                                                  </con3:actions>
                                                </con3:case>
                                                <con3:default/>
                                              </con3:ifThenElse>
                                            </con3:actions>
                                          </con3:case>
                                          <con3:default/>
                                        </con3:ifThenElse>
                                      </con3:actions>
                                    </con3:case>
                                    <con3:default/>
                                  </con3:ifThenElse>
                                </con3:actions>
                              </con3:case>
                              <con3:default>
                                <con3:ifThenElse>
                                  <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-77bf</con1:id>
                                  <con3:case>
                                    <con3:condition>
                                      <con1:xqueryText>$metodo = ("400","401","403")</con1:xqueryText>
                                    </con3:condition>
                                    <con3:actions/>
                                  </con3:case>
                                  <con3:default>
                                    <con3:wsCallout>
                                      <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-77bd</con1:id>
                                      <con3:service xsi:type="ref:ProxyRef" ref="ITEL/Core/Proxies/consultarDatosMinesLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                      <con3:operation>consultarDatosMines</con3:operation>
                                      <con3:request>
                                        <con3:body>$datos</con3:body>
                                      </con3:request>
                                      <con3:response>
                                        <con3:body>respMines</con3:body>
                                      </con3:response>
                                      <con3:requestTransform>
                                        <con3:assign varName="datos">
                                          <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-77be</con1:id>
                                          <con3:expr>
                                            <con1:xqueryTransform>
                                              <con1:resource ref="ITEL/Core/Resources/XQueries/ejecutarReglasNegocio_Req_consultarDatosMines"/>
                                              <con1:param name="inOrigen">
                                                <con1:path>if($inOrigen!= "" and number($inOrigen) &lt; 50) then
$inOrigen
else ""</con1:path>
                                              </con1:param>
                                              <con1:param name="timeout">
                                                <con1:path>$timeout</con1:path>
                                              </con1:param>
                                              <con1:param name="minOrigen">
                                                <con1:path>if($inOrigen!= "" and number($inOrigen) &lt; 50) then
$minOrigen
else ""</con1:path>
                                              </con1:param>
                                              <con1:param name="minDestino">
                                                <con1:path>if(number($body/ejec:Input_Parameters/IN_DESTINO) &lt; 50) then
data($body/ejec:Input_Parameters/MIN_DESTINO)
else ""</con1:path>
                                              </con1:param>
                                              <con1:param name="prefijo">
                                                <con1:path>$prefijo</con1:path>
                                              </con1:param>
                                              <con1:param name="inDestino">
                                                <con1:path>if(number($body/ejec:Input_Parameters/IN_DESTINO) &lt; 50) then
data($body/ejec:Input_Parameters/IN_DESTINO)
else ""</con1:path>
                                              </con1:param>
                                            </con1:xqueryTransform>
                                          </con3:expr>
                                        </con3:assign>
                                      </con3:requestTransform>
                                      <con3:responseTransform/>
                                    </con3:wsCallout>
                                  </con3:default>
                                </con3:ifThenElse>
                                <con3:ifThenElse>
                                  <con1:comment>Validaciones datos suscriptor</con1:comment>
                                  <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-77bc</con1:id>
                                  <con3:case>
                                    <con3:condition>
                                      <con1:xqueryText>$respMines/CODIGO/text() = "1"</con1:xqueryText>
                                    </con3:condition>
                                    <con3:actions>
                                      <con3:ifThenElse>
                                        <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-77bb</con1:id>
                                        <con3:case>
                                          <con3:condition>
                                            <con1:xqueryText>$metodo = ("401","402")</con1:xqueryText>
                                          </con3:condition>
                                          <con3:actions>
                                            <con3:ifThenElse>
                                              <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-77ba</con1:id>
                                              <con3:case>
                                                <con3:condition>
                                                  <con1:xqueryText>number($body/ejec:Input_Parameters/IN_DESTINO) &lt; 50</con1:xqueryText>
                                                </con3:condition>
                                                <con3:actions>
                                                  <con3:ifThenElse>
                                                    <con1:comment>Validacion de bloqueo</con1:comment>
                                                    <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-77b9</con1:id>
                                                    <con3:case>
                                                      <con3:condition>
                                                        <con1:xqueryText>$respMines/MENSAJE/DatosOrigen/*:IsFraudLocked/text() = "TRUE"</con1:xqueryText>
                                                      </con3:condition>
                                                      <con3:actions>
                                                        <con3:assign varName="codError">
                                                          <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-77b8</con1:id>
                                                          <con3:expr>
                                                            <con1:xqueryText>"910"</con1:xqueryText>
                                                          </con3:expr>
                                                        </con3:assign>
                                                      </con3:actions>
                                                    </con3:case>
                                                    <con3:case>
                                                      <con3:condition>
                                                        <con1:xqueryText>$respMines/MENSAJE/DatosOrigen/*:IsLocked/text() = "TRUE"</con1:xqueryText>
                                                      </con3:condition>
                                                      <con3:actions>
                                                        <con3:assign varName="codError">
                                                          <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-77b7</con1:id>
                                                          <con3:expr>
                                                            <con1:xqueryText>"902"</con1:xqueryText>
                                                          </con3:expr>
                                                        </con3:assign>
                                                      </con3:actions>
                                                    </con3:case>
                                                    <con3:default/>
                                                  </con3:ifThenElse>
                                                </con3:actions>
                                              </con3:case>
                                              <con3:default/>
                                            </con3:ifThenElse>
                                            <con3:ifThenElse>
                                              <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-77b6</con1:id>
                                              <con3:case>
                                                <con3:condition>
                                                  <con1:xqueryText>number($body/ejec:Input_Parameters/IN_ORIGEN) >= 50</con1:xqueryText>
                                                </con3:condition>
                                                <con3:actions>
                                                  <con3:wsCallout>
                                                    <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-77b4</con1:id>
                                                    <con3:service xsi:type="ref:ProxyRef" ref="ITEL/OCS/AIR/Proxies/consultarBalancesOCSLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                                    <con3:operation>consultarBalances</con3:operation>
                                                    <con3:request>
                                                      <con3:body>$balancesRequest</con3:body>
                                                    </con3:request>
                                                    <con3:response>
                                                      <con3:body>balancesResponse</con3:body>
                                                    </con3:response>
                                                    <con3:requestTransform>
                                                      <con3:assign varName="balancesRequest">
                                                        <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-77b5</con1:id>
                                                        <con3:expr>
                                                          <con1:xqueryTransform>
                                                            <con1:resource ref="ITEL/Core/Resources/XQueries/consultarBalancesPS_Req"/>
                                                            <con1:param name="min">
                                                              <con1:path>data($body/ejec:Input_Parameters/MIN_ORIGEN)</con1:path>
                                                            </con1:param>
                                                          </con1:xqueryTransform>
                                                        </con3:expr>
                                                      </con3:assign>
                                                    </con3:requestTransform>
                                                    <con3:responseTransform/>
                                                  </con3:wsCallout>
                                                  <con3:ifThenElse>
                                                    <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-77b3</con1:id>
                                                    <con3:case>
                                                      <con3:condition>
                                                        <con1:xqueryText>data($balancesResponse/CODIGO) != '1'</con1:xqueryText>
                                                      </con3:condition>
                                                      <con3:actions>
                                                        <con3:assign varName="codError">
                                                          <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-77b2</con1:id>
                                                          <con3:expr>
                                                            <con1:xqueryText>data($balancesResponse/CODIGO)</con1:xqueryText>
                                                          </con3:expr>
                                                        </con3:assign>
                                                      </con3:actions>
                                                    </con3:case>
                                                    <con3:case>
                                                      <con3:condition>
                                                        <con1:xqueryText>let $fechaActual := xs:date(fn:substring(string(fn:current-date()), 1, 10)),
    $exp := data($balancesResponse/MENSAJE/CONSULTAR_BALANCES/MethodResponse/expiryDate),
    $expiracion := concat(substring($exp, 1, 4), '-',substring($exp, 5, 2), '-',substring($exp, 7, 2)),
    $dias := days-from-duration(xs:date($expiracion) - $fechaActual)
return    
$dias &lt; 0</con1:xqueryText>
                                                      </con3:condition>
                                                      <con3:actions>
                                                        <con3:assign varName="codError">
                                                          <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-77b1</con1:id>
                                                          <con3:expr>
                                                            <con1:xqueryText>"944"</con1:xqueryText>
                                                          </con3:expr>
                                                        </con3:assign>
                                                      </con3:actions>
                                                    </con3:case>
                                                    <con3:default/>
                                                  </con3:ifThenElse>
                                                </con3:actions>
                                              </con3:case>
                                              <con3:default/>
                                            </con3:ifThenElse>
                                          </con3:actions>
                                        </con3:case>
                                        <con3:case>
                                          <con3:condition>
                                            <con1:xqueryText>$metodo = "601"</con1:xqueryText>
                                          </con3:condition>
                                          <con3:actions>
                                            <con3:ifThenElse>
                                              <con1:comment>Validaciones contrato postpago</con1:comment>
                                              <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-77b0</con1:id>
                                              <con3:case>
                                                <con3:condition>
                                                  <con1:xqueryText>fn:contains(fn:upper-case($body/ejec:Input_Parameters/CONTRATO),
     fn:upper-case("Postpago")) = fn:false()</con1:xqueryText>
                                                </con3:condition>
                                                <con3:actions>
                                                  <con3:wsCallout>
                                                    <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-77ae</con1:id>
                                                    <con3:service xsi:type="ref:ProxyRef" ref="ITEL/Core/Proxies/consultarContratoEsPostpagoLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                                    <con3:operation>consultarContratoEsPostpago</con3:operation>
                                                    <con3:request>
                                                      <con3:body>$contratoRequest</con3:body>
                                                    </con3:request>
                                                    <con3:response>
                                                      <con3:body>contratoResponse</con3:body>
                                                    </con3:response>
                                                    <con3:requestTransform>
                                                      <con3:assign varName="contratoRequest">
                                                        <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-77af</con1:id>
                                                        <con3:expr>
                                                          <con1:xqueryTransform>
                                                            <con1:resource ref="ITEL/Core/Resources/XQueries/validar_Req_consultarContratoEsPostpago"/>
                                                            <con1:param name="contract">
                                                              <con1:path>data( $body/ejec:Input_Parameters/CONTRATO)</con1:path>
                                                            </con1:param>
                                                          </con1:xqueryTransform>
                                                        </con3:expr>
                                                      </con3:assign>
                                                    </con3:requestTransform>
                                                    <con3:responseTransform/>
                                                  </con3:wsCallout>
                                                  <con3:ifThenElse>
                                                    <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-77ad</con1:id>
                                                    <con3:case>
                                                      <con3:condition>
                                                        <con1:xqueryText>data($contratoResponse/con:CODIGO) != "1"</con1:xqueryText>
                                                      </con3:condition>
                                                      <con3:actions>
                                                        <con3:assign varName="codigoError">
                                                          <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-77ac</con1:id>
                                                          <con3:expr>
                                                            <con1:xqueryText>"909"</con1:xqueryText>
                                                          </con3:expr>
                                                        </con3:assign>
                                                      </con3:actions>
                                                    </con3:case>
                                                    <con3:case>
                                                      <con3:condition>
                                                        <con1:xqueryText>data($contratoResponse/con:MENSAJE/con:ESPOSTPAGO) = "NO_DATA"</con1:xqueryText>
                                                      </con3:condition>
                                                      <con3:actions>
                                                        <con3:assign varName="codigoError">
                                                          <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-77ab</con1:id>
                                                          <con3:expr>
                                                            <con1:xqueryText>"933"</con1:xqueryText>
                                                          </con3:expr>
                                                        </con3:assign>
                                                      </con3:actions>
                                                    </con3:case>
                                                    <con3:case>
                                                      <con3:condition>
                                                        <con1:xqueryText>$contratoResponse/*:MENSAJE/*:ESPOSTPAGO/text() = "FALSE"</con1:xqueryText>
                                                      </con3:condition>
                                                      <con3:actions>
                                                        <con3:ifThenElse>
                                                          <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-77aa</con1:id>
                                                          <con3:case>
                                                            <con3:condition>
                                                              <con1:xqueryText>$respMines/MENSAJE/DatosDestino/*:IsFraudLocked/text() = "TRUE"</con1:xqueryText>
                                                            </con3:condition>
                                                            <con3:actions>
                                                              <con3:assign varName="codError">
                                                                <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-77a9</con1:id>
                                                                <con3:expr>
                                                                  <con1:xqueryText>"910"</con1:xqueryText>
                                                                </con3:expr>
                                                              </con3:assign>
                                                            </con3:actions>
                                                          </con3:case>
                                                          <con3:case>
                                                            <con3:condition>
                                                              <con1:xqueryText>$respMines/MENSAJE/DatosDestino/*:IsLocked/text() = "TRUE"</con1:xqueryText>
                                                            </con3:condition>
                                                            <con3:actions>
                                                              <con3:assign varName="codError">
                                                                <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-77a8</con1:id>
                                                                <con3:expr>
                                                                  <con1:xqueryText>"902"</con1:xqueryText>
                                                                </con3:expr>
                                                              </con3:assign>
                                                            </con3:actions>
                                                          </con3:case>
                                                          <con3:default/>
                                                        </con3:ifThenElse>
                                                      </con3:actions>
                                                    </con3:case>
                                                    <con3:default/>
                                                  </con3:ifThenElse>
                                                </con3:actions>
                                              </con3:case>
                                              <con3:default/>
                                            </con3:ifThenElse>
                                          </con3:actions>
                                        </con3:case>
                                        <con3:case>
                                          <con3:condition>
                                            <con1:xqueryText>$metodo = "600" and number($body/ejec:Input_Parameters/IN_ORIGEN) &lt; 50</con1:xqueryText>
                                          </con3:condition>
                                          <con3:actions>
                                            <con3:assign varName="codError">
                                              <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-77a7</con1:id>
                                              <con3:expr>
                                                <con1:xqueryText>"922"</con1:xqueryText>
                                              </con3:expr>
                                            </con3:assign>
                                          </con3:actions>
                                        </con3:case>
                                        <con3:case>
                                          <con3:condition>
                                            <con1:xqueryText>$metodo = "100"</con1:xqueryText>
                                          </con3:condition>
                                          <con3:actions>
                                            <con3:assign varName="codError">
                                              <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-77a6</con1:id>
                                              <con3:expr>
                                                <con1:xqueryText>"921"</con1:xqueryText>
                                              </con3:expr>
                                            </con3:assign>
                                          </con3:actions>
                                        </con3:case>
                                        <con3:case>
                                          <con3:condition>
                                            <con1:xqueryText>($metodo = ("701","702")) and data($reglasNegocioResponse/MENSAJE/PARAMETROS/PARAMETRO[NOMBRE='VALIDA_MIN_COMCEL']/VALOR) = 'true'</con1:xqueryText>
                                          </con3:condition>
                                          <con3:actions>
                                            <con3:assign varName="elegidos">
                                              <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-77a5</con1:id>
                                              <con3:expr>
                                                <con1:xqueryText><![CDATA[<ELEGIDOS>
{if($metodo = "702") then
    let $elegidoTemp := fn:concat(data($body/ejec:Input_Parameters/PARAMETROS_TRAMA/PARAMETRO[NOMBRE='HOSTID']/VALOR), ';', data($body/ejec:Input_Parameters/PARAMETROS_TRAMA/PARAMETRO[NOMBRE='DIASVIGENCIA']/VALOR)),
	    $elegidos := fn:tokenize($elegidoTemp, ';')
	for $i in (1 to fn:count($elegidos))
	return 
	<ELEGIDO>{$elegidos[$i]}</ELEGIDO>		
else
	let $elegidos := fn:tokenize($body/ejec:Input_Parameters/PARAMETROS_TRAMA/PARAMETRO[NOMBRE='HOSTID']/VALOR, ';')
	for $i in (1 to fn:count($elegidos))
	return 
	<ELEGIDO>{$elegidos[$i]}</ELEGIDO>
}
</ELEGIDOS>]]></con1:xqueryText>
                                              </con3:expr>
                                            </con3:assign>
                                            <con3:foreach>
                                              <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-778d</con1:id>
                                              <con3:variable>elegidos</con3:variable>
                                              <con3:expression>
                                                <con1:xpathText>./ELEGIDO</con1:xpathText>
                                              </con3:expression>
                                              <con3:value-variable>elegido</con3:value-variable>
                                              <con3:index-variable>indice</con3:index-variable>
                                              <con3:total-variable>total</con3:total-variable>
                                              <con3:actions>
                                                <con3:wsCallout>
                                                  <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-779f</con1:id>
                                                  <con3:service xsi:type="ref:ProxyRef" ref="ITEL/Core/Proxies/consultarRangoMinLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                                  <con3:operation>consultarRangoMin</con3:operation>
                                                  <con3:request>
                                                    <con3:body>$rangosRequest</con3:body>
                                                  </con3:request>
                                                  <con3:response>
                                                    <con3:body>rangosResponse</con3:body>
                                                  </con3:response>
                                                  <con3:requestTransform>
                                                    <con1:assign varName="rangosRequest" xmlns:con2="http://www.bea.com/wli/sb/stages/config" xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
                                                      <con6:id xmlns:con6="http://www.bea.com/wli/sb/stages/config">_ActionId-8096952212429106120-1bbaa577.15405e544f1.-77a4</con6:id>
                                                      <con1:expr>
                                                        <con6:xqueryTransform xmlns:con6="http://www.bea.com/wli/sb/stages/config">
                                                          <con6:resource ref="ITEL/Core/Resources/XQueries/consultarRangoMin_Req"/>
                                                          <con6:param name="min">
                                                            <con6:path>data($elegido)</con6:path>
                                                          </con6:param>
                                                        </con6:xqueryTransform>
                                                      </con1:expr>
                                                    </con1:assign>
                                                  </con3:requestTransform>
                                                  <con3:responseTransform>
                                                    <con1:ifThenElse xmlns:con2="http://www.bea.com/wli/sb/stages/config" xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
                                                      <con6:id xmlns:con6="http://www.bea.com/wli/sb/stages/config">_ActionId-8096952212429106120-1bbaa577.15405e544f1.-77a3</con6:id>
                                                      <con1:case>
                                                        <con1:condition>
                                                          <con6:xqueryText xmlns:con6="http://www.bea.com/wli/sb/stages/config">data($rangosResponse/CODIGO) != "OK"</con6:xqueryText>
                                                        </con1:condition>
                                                        <con1:actions>
                                                          <con1:assign varName="codError">
                                                            <con6:id xmlns:con6="http://www.bea.com/wli/sb/stages/config">_ActionId-8096952212429106120-1bbaa577.15405e544f1.-77a2</con6:id>
                                                            <con1:expr>
                                                              <con6:xqueryText xmlns:con6="http://www.bea.com/wli/sb/stages/config">"909"</con6:xqueryText>
                                                            </con1:expr>
                                                          </con1:assign>
                                                        </con1:actions>
                                                      </con1:case>
                                                      <con1:case>
                                                        <con1:condition>
                                                          <con6:xqueryText xmlns:con6="http://www.bea.com/wli/sb/stages/config">data($rangosResponse/MENSAJE/RMCESTADO) = "0" or data($rangosResponse/MENSAJE/RMCESTADO) = "-1"</con6:xqueryText>
                                                        </con1:condition>
                                                        <con1:actions>
                                                          <con1:assign varName="codError">
                                                            <con6:id xmlns:con6="http://www.bea.com/wli/sb/stages/config">_ActionId-8096952212429106120-1bbaa577.15405e544f1.-77a1</con6:id>
                                                            <con1:expr>
                                                              <con6:xqueryText xmlns:con6="http://www.bea.com/wli/sb/stages/config">"17"</con6:xqueryText>
                                                            </con1:expr>
                                                          </con1:assign>
                                                        </con1:actions>
                                                      </con1:case>
                                                      <con1:default>
                                                        <con1:assign varName="inElegido">
                                                          <con6:id xmlns:con6="http://www.bea.com/wli/sb/stages/config">_ActionId-8096952212429106120-1bbaa577.15405e544f1.-77a0</con6:id>
                                                          <con1:expr>
                                                            <con6:xqueryText xmlns:con6="http://www.bea.com/wli/sb/stages/config">data($rangosResponse/MENSAJE/RMCCODIGOIN)</con6:xqueryText>
                                                          </con1:expr>
                                                        </con1:assign>
                                                      </con1:default>
                                                    </con1:ifThenElse>
                                                  </con3:responseTransform>
                                                </con3:wsCallout>
                                                <con3:ifThenElse>
                                                  <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-779e</con1:id>
                                                  <con3:case>
                                                    <con3:condition>
                                                      <con1:xqueryText>$codError = "1"</con1:xqueryText>
                                                    </con3:condition>
                                                    <con3:actions>
                                                      <con3:ifThenElse>
                                                        <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-779d</con1:id>
                                                        <con3:case>
                                                          <con3:condition>
                                                            <con1:xqueryText>number($inElegido) &lt; 50</con1:xqueryText>
                                                          </con3:condition>
                                                          <con3:actions>
                                                            <con3:wsCallout>
                                                              <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-779a</con1:id>
                                                              <con3:service xsi:type="ref:ProxyRef" ref="ITEL/IN/Proxies/consultarSuscriptorINLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                                              <con3:operation>consultarSuscriptorIN</con3:operation>
                                                              <con3:request>
                                                                <con3:body>$suscriptorRequest</con3:body>
                                                              </con3:request>
                                                              <con3:response>
                                                                <con3:body>suscriptorResponse</con3:body>
                                                              </con3:response>
                                                              <con3:requestTransform>
                                                                <con3:assign varName="suscriptorRequest">
                                                                  <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-779c</con1:id>
                                                                  <con3:expr>
                                                                    <con1:xqueryTransform>
                                                                      <con1:resource ref="ITEL/Core/Resources/XQueries/ejecutarReglasNegocio_Req_consultarDatosSuscriptorLocal"/>
                                                                      <con1:param name="timeout">
                                                                        <con1:path>$timeout</con1:path>
                                                                      </con1:param>
                                                                      <con1:param name="min">
                                                                        <con1:path>data($elegido)</con1:path>
                                                                      </con1:param>
                                                                      <con1:param name="in">
                                                                        <con1:path>$inElegido</con1:path>
                                                                      </con1:param>
                                                                      <con1:param name="prefijo">
                                                                        <con1:path>$prefijo</con1:path>
                                                                      </con1:param>
                                                                    </con1:xqueryTransform>
                                                                  </con3:expr>
                                                                </con3:assign>
                                                              </con3:requestTransform>
                                                              <con3:responseTransform>
                                                                <con3:assign varName="codError">
                                                                  <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-779b</con1:id>
                                                                  <con3:expr>
                                                                    <con1:xqueryText>data($suscriptorResponse/CODIGO)</con1:xqueryText>
                                                                  </con3:expr>
                                                                </con3:assign>
                                                              </con3:responseTransform>
                                                            </con3:wsCallout>
                                                          </con3:actions>
                                                        </con3:case>
                                                        <con3:default>
                                                          <con3:wsCallout>
                                                            <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-7797</con1:id>
                                                            <con3:service xsi:type="ref:ProxyRef" ref="ITEL/OCS/SOI/Proxies/consultarSuscriptorOCSLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                                            <con3:operation>consultarSuscriptorOCS</con3:operation>
                                                            <con3:request>
                                                              <con3:body>$elegidoOCSRequest</con3:body>
                                                            </con3:request>
                                                            <con3:response>
                                                              <con3:body>elegidoOCSResponse</con3:body>
                                                            </con3:response>
                                                            <con3:requestTransform>
                                                              <con3:assign varName="elegidoOCSRequest">
                                                                <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-7799</con1:id>
                                                                <con3:expr>
                                                                  <con1:xqueryTransform>
                                                                    <con1:resource ref="ITEL/Core/Resources/XQueries/consultarSuscriptorOCSPS_Req"/>
                                                                    <con1:param name="timeout">
                                                                      <con1:path>2000</con1:path>
                                                                    </con1:param>
                                                                    <con1:param name="min">
                                                                      <con1:path>data($elegido)</con1:path>
                                                                    </con1:param>
                                                                    <con1:param name="in">
                                                                      <con1:path>$inElegido</con1:path>
                                                                    </con1:param>
                                                                  </con1:xqueryTransform>
                                                                </con3:expr>
                                                              </con3:assign>
                                                            </con3:requestTransform>
                                                            <con3:responseTransform>
                                                              <con3:assign varName="codError">
                                                                <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-7798</con1:id>
                                                                <con3:expr>
                                                                  <con1:xqueryText>data($elegidoOCSResponse/CODIGO)</con1:xqueryText>
                                                                </con3:expr>
                                                              </con3:assign>
                                                            </con3:responseTransform>
                                                          </con3:wsCallout>
                                                        </con3:default>
                                                      </con3:ifThenElse>
                                                      <con3:ifThenElse>
                                                        <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-7796</con1:id>
                                                        <con3:case>
                                                          <con3:condition>
                                                            <con1:xqueryText>$codError = "1"</con1:xqueryText>
                                                          </con3:condition>
                                                          <con3:actions>
                                                            <con3:ifThenElse>
                                                              <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-7795</con1:id>
                                                              <con3:case>
                                                                <con3:condition>
                                                                  <con1:xqueryText>data($body/ejec:Input_Parameters/PARAMETROS_TRAMA/PARAMETRO[NOMBRE='BONIFICAR']/VALOR)="1"</con1:xqueryText>
                                                                </con3:condition>
                                                                <con3:actions>
                                                                  <con3:assign varName="codError">
                                                                    <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-7794</con1:id>
                                                                    <con3:expr>
                                                                      <con1:xqueryText>"17"</con1:xqueryText>
                                                                    </con3:expr>
                                                                  </con3:assign>
                                                                  <con1:skip>
                                                                    <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-7793</con1:id>
                                                                  </con1:skip>
                                                                </con3:actions>
                                                              </con3:case>
                                                              <con3:default/>
                                                            </con3:ifThenElse>
                                                          </con3:actions>
                                                        </con3:case>
                                                        <con3:case>
                                                          <con3:condition>
                                                            <con1:xqueryText>data($body/ejec:Input_Parameters/PARAMETROS_TRAMA/PARAMETRO[NOMBRE='BONIFICAR']/VALOR)="1"</con1:xqueryText>
                                                          </con3:condition>
                                                          <con3:actions>
                                                            <con3:assign varName="codError">
                                                              <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-7792</con1:id>
                                                              <con3:expr>
                                                                <con1:xqueryText>"1"</con1:xqueryText>
                                                              </con3:expr>
                                                            </con3:assign>
                                                          </con3:actions>
                                                        </con3:case>
                                                        <con3:default>
                                                          <con3:assign varName="codError">
                                                            <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-7791</con1:id>
                                                            <con3:expr>
                                                              <con1:xqueryText>"17"</con1:xqueryText>
                                                            </con3:expr>
                                                          </con3:assign>
                                                          <con1:skip>
                                                            <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-7790</con1:id>
                                                          </con1:skip>
                                                        </con3:default>
                                                      </con3:ifThenElse>
                                                    </con3:actions>
                                                  </con3:case>
                                                  <con3:case>
                                                    <con3:condition>
                                                      <con1:xqueryText>$codError = "17" and data($body/ejec:Input_Parameters/PARAMETROS_TRAMA/PARAMETRO[NOMBRE='BONIFICAR']/VALOR)="1"</con1:xqueryText>
                                                    </con3:condition>
                                                    <con3:actions>
                                                      <con3:assign varName="codError">
                                                        <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-778f</con1:id>
                                                        <con3:expr>
                                                          <con1:xqueryText>"1"</con1:xqueryText>
                                                        </con3:expr>
                                                      </con3:assign>
                                                    </con3:actions>
                                                  </con3:case>
                                                  <con3:default>
                                                    <con1:skip>
                                                      <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-778e</con1:id>
                                                    </con1:skip>
                                                  </con3:default>
                                                </con3:ifThenElse>
                                              </con3:actions>
                                            </con3:foreach>
                                          </con3:actions>
                                        </con3:case>
                                        <con3:case>
                                          <con3:condition>
                                            <con1:xqueryText>$metodo = "306" and data($reglasNegocioResponse/MENSAJE/PARAMETROS/PARAMETRO[NOMBRE='VALIDA_MIN_COMCEL']/VALOR) = 'true'</con1:xqueryText>
                                          </con3:condition>
                                          <con3:actions/>
                                        </con3:case>
                                        <con3:default>
                                          <con3:assign varName="codError">
                                            <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-778c</con1:id>
                                            <con3:expr>
                                              <con1:xqueryText>$respMines/CODIGO/text()</con1:xqueryText>
                                            </con3:expr>
                                          </con3:assign>
                                        </con3:default>
                                      </con3:ifThenElse>
                                    </con3:actions>
                                  </con3:case>
                                  <con3:case>
                                    <con3:condition>
                                      <con1:xqueryText>$metodo = "600" and $respMines/CODIGO/text() = "900"</con1:xqueryText>
                                    </con3:condition>
                                    <con3:actions>
                                      <con3:ifThenElse>
                                        <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-778b</con1:id>
                                        <con3:case>
                                          <con3:condition>
                                            <con1:xqueryText>fn:string-length($respMines/MENSAJE/DatosDestino) = 0</con1:xqueryText>
                                          </con3:condition>
                                          <con3:actions>
                                            <con3:assign varName="datosOrigenLenght">
                                              <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-778a</con1:id>
                                              <con3:expr>
                                                <con1:xqueryText>fn:string-length($respMines/MENSAJE/DatosOrigen)</con1:xqueryText>
                                              </con3:expr>
                                            </con3:assign>
                                            <con3:ifThenElse>
                                              <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-7789</con1:id>
                                              <con3:case>
                                                <con3:condition>
                                                  <con1:xqueryText>fn:string-length($respMines/MENSAJE/DatosOrigen) > 0</con1:xqueryText>
                                                </con3:condition>
                                                <con3:actions>
                                                  <con3:ifThenElse>
                                                    <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-7788</con1:id>
                                                    <con3:case>
                                                      <con3:condition>
                                                        <con1:xqueryText>fn:contains(fn:upper-case($respMines//MENSAJE/DatosOrigen/oper:Contract),
     fn:upper-case("Postpago")) = fn:false()</con1:xqueryText>
                                                      </con3:condition>
                                                      <con3:actions>
                                                        <con3:wsCallout>
                                                          <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-7786</con1:id>
                                                          <con3:service xsi:type="ref:ProxyRef" ref="ITEL/Core/Proxies/consultarContratoEsPostpagoLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                                          <con3:operation>consultarContratoEsPostpago</con3:operation>
                                                          <con3:request>
                                                            <con3:body>$contratoRequest</con3:body>
                                                          </con3:request>
                                                          <con3:response>
                                                            <con3:body>contratoResponse</con3:body>
                                                          </con3:response>
                                                          <con3:requestTransform>
                                                            <con3:assign varName="contratoRequest">
                                                              <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-7787</con1:id>
                                                              <con3:expr>
                                                                <con1:xqueryTransform>
                                                                  <con1:resource ref="ITEL/Core/Resources/XQueries/validar_Req_consultarContratoEsPostpago"/>
                                                                  <con1:param name="contract">
                                                                    <con1:path>data( $respMines/MENSAJE/DatosOrigen/oper:Contract)</con1:path>
                                                                  </con1:param>
                                                                </con1:xqueryTransform>
                                                              </con3:expr>
                                                            </con3:assign>
                                                          </con3:requestTransform>
                                                          <con3:responseTransform/>
                                                        </con3:wsCallout>
                                                        <con3:ifThenElse>
                                                          <con1:comment>Validaciones si el contrato es postpago</con1:comment>
                                                          <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-7785</con1:id>
                                                          <con3:case>
                                                            <con3:condition>
                                                              <con1:xqueryText>data($contratoResponse/con:CODIGO) != "1"</con1:xqueryText>
                                                            </con3:condition>
                                                            <con3:actions>
                                                              <con3:assign varName="codigoError">
                                                                <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-7784</con1:id>
                                                                <con3:expr>
                                                                  <con1:xqueryText>"909"</con1:xqueryText>
                                                                </con3:expr>
                                                              </con3:assign>
                                                            </con3:actions>
                                                          </con3:case>
                                                          <con3:case>
                                                            <con3:condition>
                                                              <con1:xqueryText>data($contratoResponse/con:MENSAJE/con:ESPOSTPAGO) = "NO_DATA"</con1:xqueryText>
                                                            </con3:condition>
                                                            <con3:actions>
                                                              <con3:assign varName="codigoError">
                                                                <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-7783</con1:id>
                                                                <con3:expr>
                                                                  <con1:xqueryText>"933"</con1:xqueryText>
                                                                </con3:expr>
                                                              </con3:assign>
                                                            </con3:actions>
                                                          </con3:case>
                                                          <con3:case>
                                                            <con3:condition>
                                                              <con1:xqueryText>$contratoResponse/*:MENSAJE/*:ESPOSTPAGO/text() = "FALSE"</con1:xqueryText>
                                                            </con3:condition>
                                                            <con3:actions>
                                                              <con3:ifThenElse>
                                                                <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-7782</con1:id>
                                                                <con3:case>
                                                                  <con3:condition>
                                                                    <con1:xqueryText>$respMines/MENSAJE/DatosOrigen/*:IsFraudLocked/text() = "TRUE"</con1:xqueryText>
                                                                  </con3:condition>
                                                                  <con3:actions>
                                                                    <con3:assign varName="codError">
                                                                      <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-7781</con1:id>
                                                                      <con3:expr>
                                                                        <con1:xqueryText>"910"</con1:xqueryText>
                                                                      </con3:expr>
                                                                    </con3:assign>
                                                                  </con3:actions>
                                                                </con3:case>
                                                                <con3:case>
                                                                  <con3:condition>
                                                                    <con1:xqueryText>$respMines/MENSAJE/DatosOrigen/*:IsLocked/text() = "TRUE"</con1:xqueryText>
                                                                  </con3:condition>
                                                                  <con3:actions>
                                                                    <con3:assign varName="codError">
                                                                      <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-7780</con1:id>
                                                                      <con3:expr>
                                                                        <con1:xqueryText>"902"</con1:xqueryText>
                                                                      </con3:expr>
                                                                    </con3:assign>
                                                                  </con3:actions>
                                                                </con3:case>
                                                                <con3:default/>
                                                              </con3:ifThenElse>
                                                            </con3:actions>
                                                          </con3:case>
                                                          <con3:default/>
                                                        </con3:ifThenElse>
                                                      </con3:actions>
                                                    </con3:case>
                                                    <con3:default/>
                                                  </con3:ifThenElse>
                                                </con3:actions>
                                              </con3:case>
                                              <con3:default>
                                                <con3:assign varName="codError">
                                                  <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-777f</con1:id>
                                                  <con3:expr>
                                                    <con1:xqueryText>"900"</con1:xqueryText>
                                                  </con3:expr>
                                                </con3:assign>
                                              </con3:default>
                                            </con3:ifThenElse>
                                          </con3:actions>
                                        </con3:case>
                                        <con3:case>
                                          <con3:condition>
                                            <con1:xqueryText>number($body/ejec:Input_Parameters/IN_ORIGEN) &lt; 50</con1:xqueryText>
                                          </con3:condition>
                                          <con3:actions>
                                            <con3:assign varName="codError">
                                              <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-777e</con1:id>
                                              <con3:expr>
                                                <con1:xqueryText>"922"</con1:xqueryText>
                                              </con3:expr>
                                            </con3:assign>
                                          </con3:actions>
                                        </con3:case>
                                        <con3:default/>
                                      </con3:ifThenElse>
                                    </con3:actions>
                                  </con3:case>
                                  <con3:case>
                                    <con3:condition>
                                      <con1:xqueryText>$metodo = "100" and $respMines/CODIGO/text() = "900"</con1:xqueryText>
                                    </con3:condition>
                                    <con3:actions/>
                                  </con3:case>
                                  <con3:default>
                                    <con3:assign varName="codError">
                                      <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-777d</con1:id>
                                      <con3:expr>
                                        <con1:xqueryText>$respMines/CODIGO/text()</con1:xqueryText>
                                      </con3:expr>
                                    </con3:assign>
                                  </con3:default>
                                </con3:ifThenElse>
                              </con3:default>
                            </con3:ifThenElse>
                            <con3:ifThenElse>
                              <con1:comment>Validaciones bloqueo y contrato metodo</con1:comment>
                              <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-777c</con1:id>
                              <con3:case>
                                <con3:condition>
                                  <con1:xqueryText>$codError = "1"</con1:xqueryText>
                                </con3:condition>
                                <con3:actions>
                                  <con3:ifThenElse>
                                    <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-777b</con1:id>
                                    <con3:case>
                                      <con3:condition>
                                        <con1:xqueryText>$esOCS = "false"</con1:xqueryText>
                                      </con3:condition>
                                      <con3:actions>
                                        <con3:ifThenElse>
                                          <con1:comment>Validaciones bloqueo y contrato metodo</con1:comment>
                                          <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-777a</con1:id>
                                          <con3:case>
                                            <con3:condition>
                                              <con1:xqueryText>$respMines/MENSAJE/DatosDestino/*:IsFraudLocked/text() = "TRUE" and not($metodo= ('100','201','501','602','603'))</con1:xqueryText>
                                            </con3:condition>
                                            <con3:actions>
                                              <con3:assign varName="codError">
                                                <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-7779</con1:id>
                                                <con3:expr>
                                                  <con1:xqueryText>"910"</con1:xqueryText>
                                                </con3:expr>
                                              </con3:assign>
                                            </con3:actions>
                                          </con3:case>
                                          <con3:case>
                                            <con3:condition>
                                              <con1:xqueryText>$respMines/MENSAJE/DatosDestino/*:IsLocked/text() = "TRUE" and not($metodo = ('100','201','501','602','603'))</con1:xqueryText>
                                            </con3:condition>
                                            <con3:actions>
                                              <con3:assign varName="codError">
                                                <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-7778</con1:id>
                                                <con3:expr>
                                                  <con1:xqueryText>"902"</con1:xqueryText>
                                                </con3:expr>
                                              </con3:assign>
                                            </con3:actions>
                                          </con3:case>
                                          <con3:default>
                                            <con3:wsCallout>
                                              <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-776a</con1:id>
                                              <con3:service xsi:type="ref:ProxyRef" ref="ITEL/Core/Proxies/validarContratoMetodoLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                              <con3:operation>validarContratoMetodo</con3:operation>
                                              <con3:request>
                                                <con3:body>$contratoMetodoRequest</con3:body>
                                              </con3:request>
                                              <con3:response>
                                                <con3:body>contratoMetodoResponse</con3:body>
                                              </con3:response>
                                              <con3:requestTransform>
                                                <con3:ifThenElse>
                                                  <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-7777</con1:id>
                                                  <con3:case>
                                                    <con3:condition>
                                                      <con1:xqueryText>$metodo = "600"</con1:xqueryText>
                                                    </con3:condition>
                                                    <con3:actions>
                                                      <con3:assign varName="contratoMetodoRequest">
                                                        <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-7776</con1:id>
                                                        <con3:expr>
                                                          <con1:xqueryTransform>
                                                            <con1:resource ref="ITEL/Core/Resources/XQueries/validarContratoMetodo_Req"/>
                                                            <con1:param name="metodo">
                                                              <con1:path>data($body/ejec:Input_Parameters/METODO)</con1:path>
                                                            </con1:param>
                                                            <con1:param name="contrato">
                                                              <con1:path>if (data($respMines/MENSAJE/DatosOrigen/*:Contract) != "") then data($respMines/MENSAJE/DatosOrigen/*:Contract) else data($respMines/MENSAJE/DatosDestino/*:Contract)</con1:path>
                                                            </con1:param>
                                                          </con1:xqueryTransform>
                                                        </con3:expr>
                                                      </con3:assign>
                                                    </con3:actions>
                                                  </con3:case>
                                                  <con3:case>
                                                    <con3:condition>
                                                      <con1:xqueryText>$metodo = "100"</con1:xqueryText>
                                                    </con3:condition>
                                                    <con3:actions>
                                                      <con3:assign varName="contratoMetodoRequest">
                                                        <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-7775</con1:id>
                                                        <con3:expr>
                                                          <con1:xqueryTransform>
                                                            <con1:resource ref="ITEL/Core/Resources/XQueries/validarContratoMetodo_Req"/>
                                                            <con1:param name="metodo">
                                                              <con1:path>data($body/ejec:Input_Parameters/METODO)</con1:path>
                                                            </con1:param>
                                                            <con1:param name="contrato">
                                                              <con1:path>data($body/ejec:Input_Parameters/CONTRATO)</con1:path>
                                                            </con1:param>
                                                          </con1:xqueryTransform>
                                                        </con3:expr>
                                                      </con3:assign>
                                                    </con3:actions>
                                                  </con3:case>
                                                  <con3:default>
                                                    <con3:assign varName="contratoMetodoRequest">
                                                      <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-7774</con1:id>
                                                      <con3:expr>
                                                        <con1:xqueryTransform>
                                                          <con1:resource ref="ITEL/Core/Resources/XQueries/validarContratoMetodo_Req"/>
                                                          <con1:param name="metodo">
                                                            <con1:path>data($body/ejec:Input_Parameters/METODO)</con1:path>
                                                          </con1:param>
                                                          <con1:param name="contrato">
                                                            <con1:path>data($respMines/MENSAJE/DatosDestino/*:Contract)</con1:path>
                                                          </con1:param>
                                                        </con1:xqueryTransform>
                                                      </con3:expr>
                                                    </con3:assign>
                                                  </con3:default>
                                                </con3:ifThenElse>
                                              </con3:requestTransform>
                                              <con3:responseTransform>
                                                <con3:ifThenElse>
                                                  <con1:comment>Validacion contrato metodo</con1:comment>
                                                  <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-7773</con1:id>
                                                  <con3:case>
                                                    <con3:condition>
                                                      <con1:xqueryText>$contratoMetodoResponse/CODIGO/text() = "OK" and $contratoMetodoResponse/MENSAJE/text() = "FALSE"</con1:xqueryText>
                                                    </con3:condition>
                                                    <con3:actions>
                                                      <con3:assign varName="codError">
                                                        <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-7772</con1:id>
                                                        <con3:expr>
                                                          <con1:xqueryText>"917"</con1:xqueryText>
                                                        </con3:expr>
                                                      </con3:assign>
                                                    </con3:actions>
                                                  </con3:case>
                                                  <con3:case>
                                                    <con3:condition>
                                                      <con1:xqueryText>$metodo = ("302","303","305","308","309")</con1:xqueryText>
                                                    </con3:condition>
                                                    <con3:actions>
                                                      <con3:insert varName="respMines">
                                                        <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-7771</con1:id>
                                                        <con3:location>
                                                          <con1:xpathText>./MENSAJE/DatosDestino</con1:xpathText>
                                                        </con3:location>
                                                        <con3:where>last-child</con3:where>
                                                        <con3:expr>
                                                          <con1:xqueryText>&lt;VIGENCIA_ELEGIDO>{data($vigenciaResponse/MENSAJE/VIGENCIA)}&lt;/VIGENCIA_ELEGIDO></con1:xqueryText>
                                                        </con3:expr>
                                                      </con3:insert>
                                                      <con3:insert varName="respMines">
                                                        <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-7770</con1:id>
                                                        <con3:location>
                                                          <con1:xpathText>./MENSAJE/DatosDestino</con1:xpathText>
                                                        </con3:location>
                                                        <con3:where>last-child</con3:where>
                                                        <con3:expr>
                                                          <con1:xqueryText>&lt;FECHA_CREACION_ELEGIDO>{data($vigenciaResponse/MENSAJE/FECHA_CREACION)}&lt;/FECHA_CREACION_ELEGIDO></con1:xqueryText>
                                                        </con3:expr>
                                                      </con3:insert>
                                                      <con3:insert varName="respMines">
                                                        <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-776f</con1:id>
                                                        <con3:location>
                                                          <con1:xpathText>./MENSAJE/DatosDestino</con1:xpathText>
                                                        </con3:location>
                                                        <con3:where>last-child</con3:where>
                                                        <con3:expr>
                                                          <con1:xqueryText>let $fecha := data($vigenciaResponse/MENSAJE/FECHA_EXPIRACION)
return
&lt;FECHA_EXPIRACION_ELEGIDO>{concat(substring($fecha, 1, 10), ' ',substring($fecha, 12, 8) )}&lt;/FECHA_EXPIRACION_ELEGIDO></con1:xqueryText>
                                                        </con3:expr>
                                                      </con3:insert>
                                                    </con3:actions>
                                                  </con3:case>
                                                  <con3:case>
                                                    <con3:condition>
                                                      <con1:xqueryText>$metodo = ("702","703","704")</con1:xqueryText>
                                                    </con3:condition>
                                                    <con3:actions>
                                                      <con3:insert varName="respMines">
                                                        <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-776e</con1:id>
                                                        <con3:location>
                                                          <con1:xpathText>./MENSAJE/DatosDestino</con1:xpathText>
                                                        </con3:location>
                                                        <con3:where>last-child</con3:where>
                                                        <con3:expr>
                                                          <con1:xqueryText>&lt;VIGENCIA_ELEGIDO>{data($vigenciaSMSResponse/MENSAJE/VIGENCIA)}&lt;/VIGENCIA_ELEGIDO></con1:xqueryText>
                                                        </con3:expr>
                                                      </con3:insert>
                                                      <con3:insert varName="respMines">
                                                        <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-776d</con1:id>
                                                        <con3:location>
                                                          <con1:xpathText>./MENSAJE/DatosDestino</con1:xpathText>
                                                        </con3:location>
                                                        <con3:where>last-child</con3:where>
                                                        <con3:expr>
                                                          <con1:xqueryText>&lt;FECHA_CREACION_ELEGIDO>{data($vigenciaSMSResponse/MENSAJE/FECHA_CREACION)}&lt;/FECHA_CREACION_ELEGIDO></con1:xqueryText>
                                                        </con3:expr>
                                                      </con3:insert>
                                                      <con3:insert varName="respMines">
                                                        <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-776c</con1:id>
                                                        <con3:location>
                                                          <con1:xpathText>./MENSAJE/DatosDestino</con1:xpathText>
                                                        </con3:location>
                                                        <con3:where>last-child</con3:where>
                                                        <con3:expr>
                                                          <con1:xqueryText>let $fecha := data($vigenciaResponse/MENSAJE/FECHA_EXPIRACION)
return
&lt;FECHA_EXPIRACION_ELEGIDO>{concat(substring($fecha, 1, 10), ' ',substring($fecha, 12, 8) )}&lt;/FECHA_EXPIRACION_ELEGIDO></con1:xqueryText>
                                                        </con3:expr>
                                                      </con3:insert>
                                                      <con3:insert varName="respMines">
                                                        <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-776b</con1:id>
                                                        <con3:location>
                                                          <con1:xpathText>./MENSAJE/DatosDestino</con1:xpathText>
                                                        </con3:location>
                                                        <con3:where>last-child</con3:where>
                                                        <con3:expr>
                                                          <con1:xqueryText>&lt;SUSCRIPCION_ELEGIDO>{data($vigenciaSMSResponse/MENSAJE/SUSCRIPCION)}&lt;/SUSCRIPCION_ELEGIDO></con1:xqueryText>
                                                        </con3:expr>
                                                      </con3:insert>
                                                    </con3:actions>
                                                  </con3:case>
                                                  <con3:default/>
                                                </con3:ifThenElse>
                                              </con3:responseTransform>
                                            </con3:wsCallout>
                                            <con3:ifThenElse>
                                              <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-7769</con1:id>
                                              <con3:case>
                                                <con3:condition>
                                                  <con1:xqueryText>$codError = "1" and $metodo = "201"</con1:xqueryText>
                                                </con3:condition>
                                                <con3:actions>
                                                  <con3:wsCallout>
                                                    <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-7763</con1:id>
                                                    <con3:service xsi:type="ref:ProxyRef" ref="ITEL/Core/Proxies/consultarProvTarLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                                    <con3:operation>consultarProvTar</con3:operation>
                                                    <con3:request>
                                                      <con3:body>$providerRequest</con3:body>
                                                    </con3:request>
                                                    <con3:response>
                                                      <con3:body>providerResponse</con3:body>
                                                    </con3:response>
                                                    <con3:requestTransform>
                                                      <con3:assign varName="providerRequest">
                                                        <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-7768</con1:id>
                                                        <con3:expr>
                                                          <con1:xqueryTransform>
                                                            <con1:resource ref="ITEL/Core/Resources/XQueries/consultarProvTarPS_Req"/>
                                                            <con1:param name="contrato">
                                                              <con1:path>data($respMines/MENSAJE/DatosDestino/*:Contract)</con1:path>
                                                            </con1:param>
                                                          </con1:xqueryTransform>
                                                        </con3:expr>
                                                      </con3:assign>
                                                    </con3:requestTransform>
                                                    <con3:responseTransform>
                                                      <con3:ifThenElse>
                                                        <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-7767</con1:id>
                                                        <con3:case>
                                                          <con3:condition>
                                                            <con1:xqueryText>data($providerResponse/CODIGO) = "OK" and data($providerResponse/MENSAJE/PROVIDER) > -1</con1:xqueryText>
                                                          </con3:condition>
                                                          <con3:actions>
                                                            <con3:insert varName="respMines">
                                                              <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-7766</con1:id>
                                                              <con3:location>
                                                                <con1:xpathText>./MENSAJE/DatosDestino</con1:xpathText>
                                                              </con3:location>
                                                              <con3:where>last-child</con3:where>
                                                              <con3:expr>
                                                                <con1:xqueryText>&lt;PROVIDER>{data($providerResponse/MENSAJE/PROVIDER)}&lt;/PROVIDER></con1:xqueryText>
                                                              </con3:expr>
                                                            </con3:insert>
                                                            <con3:insert varName="respMines">
                                                              <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-7765</con1:id>
                                                              <con3:location>
                                                                <con1:xpathText>./MENSAJE/DatosDestino</con1:xpathText>
                                                              </con3:location>
                                                              <con3:where>last-child</con3:where>
                                                              <con3:expr>
                                                                <con1:xqueryText>&lt;TARIFF>{data($providerResponse/MENSAJE/TARIFF)}&lt;/TARIFF></con1:xqueryText>
                                                              </con3:expr>
                                                            </con3:insert>
                                                          </con3:actions>
                                                        </con3:case>
                                                        <con3:default>
                                                          <con3:assign varName="codError">
                                                            <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-7764</con1:id>
                                                            <con3:expr>
                                                              <con1:xqueryText>"909"</con1:xqueryText>
                                                            </con3:expr>
                                                          </con3:assign>
                                                        </con3:default>
                                                      </con3:ifThenElse>
                                                    </con3:responseTransform>
                                                  </con3:wsCallout>
                                                </con3:actions>
                                              </con3:case>
                                              <con3:case>
                                                <con3:condition>
                                                  <con1:xqueryText>$codError = "1" and $metodo = "600" and number($body/ejec:Input_Parameters/IN_ORIGEN) >= 50</con1:xqueryText>
                                                </con3:condition>
                                                <con3:actions>
                                                  <con3:wsCallout>
                                                    <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-7761</con1:id>
                                                    <con3:service xsi:type="ref:ProxyRef" ref="ITEL/OCS/SOI/Proxies/consultarSuscriptorOCSLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                                    <con3:operation>consultarSuscriptorOCS</con3:operation>
                                                    <con3:request>
                                                      <con3:body>$suscriptorOCSRequest</con3:body>
                                                    </con3:request>
                                                    <con3:response>
                                                      <con3:body>suscriptorOCSResponse</con3:body>
                                                    </con3:response>
                                                    <con3:requestTransform>
                                                      <con3:assign varName="suscriptorOCSRequest">
                                                        <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-7762</con1:id>
                                                        <con3:expr>
                                                          <con1:xqueryTransform>
                                                            <con1:resource ref="ITEL/Core/Resources/XQueries/consultarSuscriptorOCSPS_Req"/>
                                                            <con1:param name="timeout">
                                                              <con1:path>2000</con1:path>
                                                            </con1:param>
                                                            <con1:param name="min">
                                                              <con1:path>data($body/ejec:Input_Parameters/MIN_ORIGEN)</con1:path>
                                                            </con1:param>
                                                            <con1:param name="in">
                                                              <con1:path>data($body/ejec:Input_Parameters/IN_ORIGEN)</con1:path>
                                                            </con1:param>
                                                          </con1:xqueryTransform>
                                                        </con3:expr>
                                                      </con3:assign>
                                                    </con3:requestTransform>
                                                    <con3:responseTransform/>
                                                  </con3:wsCallout>
                                                  <con3:ifThenElse>
                                                    <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-7760</con1:id>
                                                    <con3:case>
                                                      <con3:condition>
                                                        <con1:xqueryText>data($suscriptorOCSResponse/CODIGO) = '1'</con1:xqueryText>
                                                      </con3:condition>
                                                      <con3:actions>
                                                        <con3:assign varName="codError">
                                                          <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-775f</con1:id>
                                                          <con3:expr>
                                                            <con1:xqueryText>"922"</con1:xqueryText>
                                                          </con3:expr>
                                                        </con3:assign>
                                                      </con3:actions>
                                                    </con3:case>
                                                    <con3:case>
                                                      <con3:condition>
                                                        <con1:xqueryText>data($suscriptorOCSResponse/CODIGO) = '900'</con1:xqueryText>
                                                      </con3:condition>
                                                      <con3:actions>
                                                        <con3:wsCallout>
                                                          <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-7758</con1:id>
                                                          <con3:service xsi:type="ref:ProxyRef" ref="ITEL/Core/Proxies/consultarContractTemp_ContractLocal_PS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                                          <con3:operation>consultarContractTemp_Contract</con3:operation>
                                                          <con3:request>
                                                            <con3:body>$consultarContractTempContractRequest</con3:body>
                                                          </con3:request>
                                                          <con3:response>
                                                            <con3:body>consultarContractTempContractResponse</con3:body>
                                                          </con3:response>
                                                          <con3:requestTransform>
                                                            <con3:assign varName="consultarContractTempContractRequest">
                                                              <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-775e</con1:id>
                                                              <con3:expr>
                                                                <con1:xqueryTransform>
                                                                  <con1:resource ref="ITEL/Core/Resources/XQueries/consultarContractTempContractPS_Req"/>
                                                                  <con1:param name="serviceClass">
                                                                    <con1:path>0</con1:path>
                                                                  </con1:param>
                                                                  <con1:param name="contract">
                                                                    <con1:path>data($respMines/MENSAJE/DatosDestino/*:Contract)</con1:path>
                                                                  </con1:param>
                                                                  <con1:param name="fafidgroup">
                                                                    <con1:path>0</con1:path>
                                                                  </con1:param>
                                                                </con1:xqueryTransform>
                                                              </con3:expr>
                                                            </con3:assign>
                                                          </con3:requestTransform>
                                                          <con3:responseTransform>
                                                            <con3:ifThenElse>
                                                              <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-775d</con1:id>
                                                              <con3:case>
                                                                <con3:condition>
                                                                  <con1:xqueryText>data($consultarContractTempContractResponse/CODIGO) = "OK"</con1:xqueryText>
                                                                </con3:condition>
                                                                <con3:actions>
                                                                  <con3:insert varName="respMines">
                                                                    <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-775c</con1:id>
                                                                    <con3:location>
                                                                      <con1:xpathText>./MENSAJE/DatosDestino</con1:xpathText>
                                                                    </con3:location>
                                                                    <con3:where>last-child</con3:where>
                                                                    <con3:expr>
                                                                      <con1:xqueryText>&lt;CONTRACT_TEMPLATE>{data($consultarContractTempContractResponse/MENSAJE/CONTRACT_TEMPLATE)}&lt;/CONTRACT_TEMPLATE></con1:xqueryText>
                                                                    </con3:expr>
                                                                  </con3:insert>
                                                                  <con3:insert varName="respMines">
                                                                    <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-775b</con1:id>
                                                                    <con3:location>
                                                                      <con1:xpathText>./MENSAJE/DatosDestino</con1:xpathText>
                                                                    </con3:location>
                                                                    <con3:where>last-child</con3:where>
                                                                    <con3:expr>
                                                                      <con1:xqueryText>&lt;FAFIDGROUP>{data($consultarContractTempContractResponse/MENSAJE/FAFIDGROUP)}&lt;/FAFIDGROUP></con1:xqueryText>
                                                                    </con3:expr>
                                                                  </con3:insert>
                                                                  <con3:insert varName="respMines">
                                                                    <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-775a</con1:id>
                                                                    <con3:location>
                                                                      <con1:xpathText>./MENSAJE/DatosDestino</con1:xpathText>
                                                                    </con3:location>
                                                                    <con3:where>last-child</con3:where>
                                                                    <con3:expr>
                                                                      <con1:xqueryText>&lt;FAFIDS>{fn:string-join(data($consultarContractTempContractResponse/MENSAJE/FAFIDS/FAFID),";")}&lt;/FAFIDS></con1:xqueryText>
                                                                    </con3:expr>
                                                                  </con3:insert>
                                                                </con3:actions>
                                                              </con3:case>
                                                              <con3:default>
                                                                <con3:assign varName="codError">
                                                                  <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-7759</con1:id>
                                                                  <con3:expr>
                                                                    <con1:xqueryText>"909"</con1:xqueryText>
                                                                  </con3:expr>
                                                                </con3:assign>
                                                              </con3:default>
                                                            </con3:ifThenElse>
                                                          </con3:responseTransform>
                                                        </con3:wsCallout>
                                                      </con3:actions>
                                                    </con3:case>
                                                    <con3:default>
                                                      <con3:assign varName="codError">
                                                        <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-7757</con1:id>
                                                        <con3:expr>
                                                          <con1:xqueryText>"901"</con1:xqueryText>
                                                        </con3:expr>
                                                      </con3:assign>
                                                    </con3:default>
                                                  </con3:ifThenElse>
                                                </con3:actions>
                                              </con3:case>
                                              <con3:default/>
                                            </con3:ifThenElse>
                                          </con3:default>
                                        </con3:ifThenElse>
                                      </con3:actions>
                                    </con3:case>
                                    <con3:default/>
                                  </con3:ifThenElse>
                                </con3:actions>
                              </con3:case>
                              <con3:default/>
                            </con3:ifThenElse>
                          </con3:actions>
                        </con3:case>
                        <con3:default/>
                      </con3:ifThenElse>
                    </con3:actions>
                  </con3:case>
                  <con3:default>
                    <con3:assign varName="descripcion">
                      <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-7756</con1:id>
                      <con3:expr>
                        <con1:xqueryText>data($reglasNegocioResponse/DESCRIPCION)</con1:xqueryText>
                      </con3:expr>
                    </con3:assign>
                  </con3:default>
                </con3:ifThenElse>
                <con3:ifThenElse>
                  <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-7755</con1:id>
                  <con3:case>
                    <con3:condition>
                      <con1:xqueryText>$metodo = ("400","401","403") and $esOCS != "true"</con1:xqueryText>
                    </con3:condition>
                    <con3:actions/>
                  </con3:case>
                  <con3:default>
                    <con3:assign varName="duracionSuscriptor">
                      <con1:id>_ActionId-8096952212429106120-1bbaa577.15405e544f1.-7754</con1:id>
                      <con3:expr>
                        <con1:xqueryText>fn:seconds-from-duration(fn:current-dateTime() - xs:dateTime($tiempoReglas)) * 1000</con1:xqueryText>
                      </con3:expr>
                    </con3:assign>
                  </con3:default>
                </con3:ifThenElse>
              </con3:actions>
            </con3:case>
            <con3:default/>
          </con3:ifThenElse>
        </con:actions>
      </con:stage>
    </con:pipeline>
    <con:pipeline type="response" name="PipelinePairNode1_response">
      <con:stage name="respuesta" errorHandler="_onErrorHandler-1684182584636093251-6b8ad8d.12f92005b76.-7939">
        <con:context/>
        <con:actions>
          <con3:replace contents-only="true" varName="body">
            <con1:id>_ActionId-3712703115507925614-5d7c170d.1336eb77365.-7cef</con1:id>
            <con3:expr>
              <con1:xqueryTransform>
                <con1:resource ref="ITEL/Core/Resources/XQueries/ejecutarReglasNegocio_Res"/>
                <con1:param name="balancesOCS">
                  <con1:path>if( fn:empty( $balancesResponse) ) then
	&lt;con:WS_Result xmlns:con="http://www.comcel.com.co/ConsultarBalancesOCS/" />
else
	$balancesResponse</con1:path>
                </con1:param>
                <con1:param name="descripcion">
                  <con1:path>if( fn:empty( $descripcion) ) then
	"Reglas ejecutadas correctamente"
else
	$descripcion</con1:path>
                </con1:param>
                <con1:param name="datosContProvTar">
                  <con1:path>if( fn:empty( $consultarContProvTarResponse) ) then
	&lt;con:WS_Result xmlns:con="http://www.comcel.com.co/ConsultarContProvTar/" />
else
	$consultarContProvTarResponse</con1:path>
                </con1:param>
                <con1:param name="codigo">
                  <con1:path>$codError</con1:path>
                </con1:param>
                <con1:param name="datosOCS">
                  <con1:path>if( fn:empty( $suscriptorOCSResponse) ) then
	&lt;con:WS_Result xmlns:con="http://www.comcel.com.co/ConsultarSuscriptorOCS/" />
else
	$suscriptorOCSResponse</con1:path>
                </con1:param>
                <con1:param name="suscripcionOCS">
                  <con1:path>if( fn:empty( $consultarSuscripcionOCSResponse) ) then
	&lt;con:WS_Result xmlns:con="http://www.comcel.com.co/ConsultarSuscripcionOCS/" />
else
	$consultarSuscripcionOCSResponse</con1:path>
                </con1:param>
                <con1:param name="parametros">
                  <con1:path>if( fn:empty( $reglasNegocioResponse) ) then
	&lt;con:WS_Result xmlns:con="http://www.comcel.com.co/ConsultarReglas/" />
else
	$reglasNegocioResponse</con1:path>
                </con1:param>
                <con1:param name="datosMines">
                  <con1:path>if( fn:empty( $respMines) ) then
	&lt;con:WS_Result xmlns:env="http://schemas.xmlsoap.org/soap/envelope/" xmlns:con="http://www.comcel.com.co/ConsultarDatosMines/" />
else
	$respMines</con1:path>
                </con1:param>
                <con1:param name="fafListOCS">
                  <con1:path>if( fn:empty( $consultarFaFListResponse) ) then
	&lt;con:WS_Result xmlns:con="http://www.comcel.com.co/ConsultarFaFListOCS/" />
else
	$consultarFaFListResponse</con1:path>
                </con1:param>
                <con1:param name="duracionSuscriptor">
                  <con1:path>if( fn:empty( $duracionSuscriptor) ) then
0
else
$duracionSuscriptor</con1:path>
                </con1:param>
                <con1:param name="duracionReglas">
                  <con1:path>if( fn:empty( $duracionReglas) ) then
0
else
$duracionReglas</con1:path>
                </con1:param>
              </con1:xqueryTransform>
            </con3:expr>
          </con3:replace>
        </con:actions>
      </con:stage>
    </con:pipeline>
    <con:pipeline type="error" name="_onErrorHandler-6072017332753721301-6568e233.12f8f27409e.-7e16">
      <con:stage name="error">
        <con:context/>
        <con:actions>
          <con3:assign varName="codError">
            <con1:id>_ActionId-6072017332753721301-6568e233.12f8f27409e.-7ce1</con1:id>
            <con3:expr>
              <con1:xqueryText>"912"</con1:xqueryText>
            </con3:expr>
          </con3:assign>
          <con1:resume>
            <con1:id>_ActionId-8827054014983889751--18642ce4.1301d40be36.-7d1c</con1:id>
          </con1:resume>
        </con:actions>
      </con:stage>
    </con:pipeline>
    <con:pipeline type="error" name="_onErrorHandler-1684182584636093251-6b8ad8d.12f92005b76.-7939">
      <con:stage name="error">
        <con:context/>
        <con:actions>
          <con3:replace contents-only="true" varName="body">
            <con1:id>_ActionId-8073125071243916261-60098686.12f97807b1e.-7fec</con1:id>
            <con3:expr>
              <con1:xqueryTransform>
                <con1:resource ref="ITEL/Core/Resources/XQueries/ejecutarReglasNegocio_Error"/>
                <con1:param name="tiempoI">
                  <con1:path>$tiempo</con1:path>
                </con1:param>
                <con1:param name="descripcion">
                  <con1:path>"Error ejecutando las reglas de negocio "</con1:path>
                </con1:param>
                <con1:param name="codigo">
                  <con1:path>$codError</con1:path>
                </con1:param>
              </con1:xqueryTransform>
            </con3:expr>
          </con3:replace>
          <con1:reply>
            <con1:id>_ActionId-8827054014983889751--18642ce4.1301d40be36.-7d3a</con1:id>
          </con1:reply>
        </con:actions>
      </con:stage>
    </con:pipeline>
    <con:pipeline type="error" name="_onErrorHandler-1641293207969743559--28a4b30a.12fb0e9a486.-7fd3">
      <con:stage name="error">
        <con:context/>
        <con:actions>
          <con3:replace contents-only="true" varName="body">
            <con1:id>_ActionId-1641293207969743559--28a4b30a.12fb0e9a486.-7f64</con1:id>
            <con3:expr>
              <con1:xqueryTransform>
                <con1:resource ref="ITEL/Core/Resources/XQueries/ejecutarReglasNegocio_Error"/>
                <con1:param name="tiempoI">
                  <con1:path>$tiempo</con1:path>
                </con1:param>
                <con1:param name="descripcion">
                  <con1:path>$fault/ctx:reason/text()</con1:path>
                </con1:param>
                <con1:param name="codigo">
                  <con1:path>"7"</con1:path>
                </con1:param>
              </con1:xqueryTransform>
            </con3:expr>
          </con3:replace>
          <con1:reply>
            <con1:id>_ActionId-8827054014983889751--18642ce4.1301d40be36.-7d53</con1:id>
          </con1:reply>
        </con:actions>
      </con:stage>
    </con:pipeline>
    <con:pipeline type="error" name="_onErrorHandler-5985043086313793460-3dcd6be3.1374b9d51ec.-7105">
      <con:stage name="error">
        <con:context/>
        <con:actions>
          <con3:assign varName="codError">
            <con1:id>_ActionId-5985043086313793460-3dcd6be3.1374b9d51ec.-7095</con1:id>
            <con3:expr>
              <con1:xqueryText>"912"</con1:xqueryText>
            </con3:expr>
          </con3:assign>
          <con1:resume>
            <con1:id>_ActionId-5985043086313793460-3dcd6be3.1374b9d51ec.-7094</con1:id>
          </con1:resume>
        </con:actions>
      </con:stage>
    </con:pipeline>
    <con:flow>
      <con:pipeline-node name="PipelinePairNode1">
        <con:request>PipelinePairNode1_request</con:request>
        <con:response>PipelinePairNode1_response</con:response>
      </con:pipeline-node>
    </con:flow>
  </ser:router>
</xml-fragment>